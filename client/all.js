(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){},{}],2:[function(require,module,exports){(function(process){function normalizeArray(parts,allowAboveRoot){var up=0;for(var i=parts.length-1;i>=0;i--){var last=parts[i];if(last==="."){parts.splice(i,1)}else if(last===".."){parts.splice(i,1);up++}else if(up){parts.splice(i,1);up--}}if(allowAboveRoot){for(;up--;up){parts.unshift("..")}}return parts}var splitPathRe=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;var splitPath=function(filename){return splitPathRe.exec(filename).slice(1)};exports.resolve=function(){var resolvedPath="",resolvedAbsolute=false;for(var i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path=i>=0?arguments[i]:process.cwd();if(typeof path!=="string"){throw new TypeError("Arguments to path.resolve must be strings")}else if(!path){continue}resolvedPath=path+"/"+resolvedPath;resolvedAbsolute=path.charAt(0)==="/"}resolvedPath=normalizeArray(filter(resolvedPath.split("/"),function(p){return!!p}),!resolvedAbsolute).join("/");return(resolvedAbsolute?"/":"")+resolvedPath||"."};exports.normalize=function(path){var isAbsolute=exports.isAbsolute(path),trailingSlash=substr(path,-1)==="/";path=normalizeArray(filter(path.split("/"),function(p){return!!p}),!isAbsolute).join("/");if(!path&&!isAbsolute){path="."}if(path&&trailingSlash){path+="/"}return(isAbsolute?"/":"")+path};exports.isAbsolute=function(path){return path.charAt(0)==="/"};exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(paths,function(p,index){if(typeof p!=="string"){throw new TypeError("Arguments to path.join must be strings")}return p}).join("/"))};exports.relative=function(from,to){from=exports.resolve(from).substr(1);to=exports.resolve(to).substr(1);function trim(arr){var start=0;for(;start<arr.length;start++){if(arr[start]!=="")break}var end=arr.length-1;for(;end>=0;end--){if(arr[end]!=="")break}if(start>end)return[];return arr.slice(start,end-start+1)}var fromParts=trim(from.split("/"));var toParts=trim(to.split("/"));var length=Math.min(fromParts.length,toParts.length);var samePartsLength=length;for(var i=0;i<length;i++){if(fromParts[i]!==toParts[i]){samePartsLength=i;break}}var outputParts=[];for(var i=samePartsLength;i<fromParts.length;i++){outputParts.push("..")}outputParts=outputParts.concat(toParts.slice(samePartsLength));return outputParts.join("/")};exports.sep="/";exports.delimiter=":";exports.dirname=function(path){var result=splitPath(path),root=result[0],dir=result[1];if(!root&&!dir){return"."}if(dir){dir=dir.substr(0,dir.length-1)}return root+dir};exports.basename=function(path,ext){var f=splitPath(path)[2];if(ext&&f.substr(-1*ext.length)===ext){f=f.substr(0,f.length-ext.length)}return f};exports.extname=function(path){return splitPath(path)[3]};function filter(xs,f){if(xs.filter)return xs.filter(f);var res=[];for(var i=0;i<xs.length;i++){if(f(xs[i],i,xs))res.push(xs[i])}return res}var substr="ab".substr(-1)==="b"?function(str,start,len){return str.substr(start,len)}:function(str,start,len){if(start<0)start=str.length+start;return str.substr(start,len)}}).call(this,require("_process"))},{_process:3}],3:[function(require,module,exports){var process=module.exports={};process.nextTick=function(){var canSetImmediate=typeof window!=="undefined"&&window.setImmediate;var canPost=typeof window!=="undefined"&&window.postMessage&&window.addEventListener;if(canSetImmediate){return function(f){return window.setImmediate(f)}}if(canPost){var queue=[];window.addEventListener("message",function(ev){var source=ev.source;if((source===window||source===null)&&ev.data==="process-tick"){ev.stopPropagation();if(queue.length>0){var fn=queue.shift();fn()}}},true);return function nextTick(fn){queue.push(fn);window.postMessage("process-tick","*")}}return function nextTick(fn){setTimeout(fn,0)}}();process.title="browser";process.browser=true;process.env={};process.argv=[];function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")}},{}],4:[function(require,module,exports){var saveAs=saveAs||function(view){"use strict";if(typeof navigator!=="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent)){return}var doc=view.document,get_URL=function(){return view.URL||view.webkitURL||view},save_link=doc.createElementNS("http://www.w3.org/1999/xhtml","a"),can_use_save_link="download"in save_link,click=function(node){var event=doc.createEvent("MouseEvents");event.initMouseEvent("click",true,false,view,0,0,0,0,0,false,false,false,false,0,null);node.dispatchEvent(event)},webkit_req_fs=view.webkitRequestFileSystem,req_fs=view.requestFileSystem||webkit_req_fs||view.mozRequestFileSystem,throw_outside=function(ex){(view.setImmediate||view.setTimeout)(function(){throw ex},0)},force_saveable_type="application/octet-stream",fs_min_size=0,arbitrary_revoke_timeout=500,revoke=function(file){var revoker=function(){if(typeof file==="string"){get_URL().revokeObjectURL(file)}else{file.remove()}};if(view.chrome){revoker()}else{setTimeout(revoker,arbitrary_revoke_timeout)}},dispatch=function(filesaver,event_types,event){event_types=[].concat(event_types);var i=event_types.length;while(i--){var listener=filesaver["on"+event_types[i]];if(typeof listener==="function"){try{listener.call(filesaver,event||filesaver)}catch(ex){throw_outside(ex)}}}},auto_bom=function(blob){if(/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(blob.type)){return new Blob(["\ufeff",blob],{type:blob.type})}return blob},FileSaver=function(blob,name){blob=auto_bom(blob);var filesaver=this,type=blob.type,blob_changed=false,object_url,target_view,dispatch_all=function(){dispatch(filesaver,"writestart progress write writeend".split(" "))},fs_error=function(){if(blob_changed||!object_url){object_url=get_URL().createObjectURL(blob)}if(target_view){target_view.location.href=object_url}else{var new_tab=view.open(object_url,"_blank");if(new_tab==undefined&&typeof safari!=="undefined"){view.location.href=object_url}}filesaver.readyState=filesaver.DONE;dispatch_all();revoke(object_url)},abortable=function(func){return function(){if(filesaver.readyState!==filesaver.DONE){return func.apply(this,arguments)}}},create_if_not_found={create:true,exclusive:false},slice;filesaver.readyState=filesaver.INIT;if(!name){name="download"}if(can_use_save_link){object_url=get_URL().createObjectURL(blob);save_link.href=object_url;save_link.download=name;click(save_link);filesaver.readyState=filesaver.DONE;dispatch_all();revoke(object_url);return}if(view.chrome&&type&&type!==force_saveable_type){slice=blob.slice||blob.webkitSlice;blob=slice.call(blob,0,blob.size,force_saveable_type);blob_changed=true}if(webkit_req_fs&&name!=="download"){name+=".download"}if(type===force_saveable_type||webkit_req_fs){target_view=view}if(!req_fs){fs_error();return}fs_min_size+=blob.size;req_fs(view.TEMPORARY,fs_min_size,abortable(function(fs){fs.root.getDirectory("saved",create_if_not_found,abortable(function(dir){var save=function(){dir.getFile(name,create_if_not_found,abortable(function(file){file.createWriter(abortable(function(writer){writer.onwriteend=function(event){target_view.location.href=file.toURL();filesaver.readyState=filesaver.DONE;dispatch(filesaver,"writeend",event);revoke(file)};writer.onerror=function(){var error=writer.error;if(error.code!==error.ABORT_ERR){fs_error()}};"writestart progress write abort".split(" ").forEach(function(event){writer["on"+event]=filesaver["on"+event]});writer.write(blob);filesaver.abort=function(){writer.abort();filesaver.readyState=filesaver.DONE};filesaver.readyState=filesaver.WRITING}),fs_error)}),fs_error)};dir.getFile(name,{create:false},abortable(function(file){file.remove();save()}),abortable(function(ex){if(ex.code===ex.NOT_FOUND_ERR){save()}else{fs_error()}}))}),fs_error)}),fs_error)},FS_proto=FileSaver.prototype,saveAs=function(blob,name){return new FileSaver(blob,name)};if(typeof navigator!=="undefined"&&navigator.msSaveOrOpenBlob){return function(blob,name){return navigator.msSaveOrOpenBlob(auto_bom(blob),name)}}FS_proto.abort=function(){var filesaver=this;filesaver.readyState=filesaver.DONE;dispatch(filesaver,"abort")};FS_proto.readyState=FS_proto.INIT=0;FS_proto.WRITING=1;FS_proto.DONE=2;FS_proto.error=FS_proto.onwritestart=FS_proto.onprogress=FS_proto.onwrite=FS_proto.onabort=FS_proto.onerror=FS_proto.onwriteend=null;return saveAs}(typeof self!=="undefined"&&self||typeof window!=="undefined"&&window||this.content);if(typeof module!=="undefined"&&module.exports){module.exports.saveAs=saveAs}else if(typeof define!=="undefined"&&define!==null&&define.amd!=null){define([],function(){return saveAs})}},{}],5:[function(require,module,exports){module.exports={charts_left:require("./template/leftsidebar.hbs"),charts_center:require("./template/topcontent.hbs"),info_panel:require("./template/infopanel.hbs"),charts_right:require("./template/rightsidebar.hbs")}},{"./template/infopanel.hbs":53,"./template/leftsidebar.hbs":54,"./template/rightsidebar.hbs":55,"./template/topcontent.hbs":56}],6:[function(require,module,exports){"use strict";var Backbone=require("./backbone");Equota.Views=require("./views/");module.exports=Backbone.Router.extend({root:"charts/",routes:function(){var toReturn={};toReturn[this.root]="energyChart";return toReturn},energyChart:function(){Equota.currentView=new Equota.Views.Charts({el:".js-signup-box"})}})},{"./backbone":10,"./views/":60}],7:[function(require,module,exports){(function(global){(function(){var $=require("./jquery");var Backbone=require("./backbone");var _=require("underscore");var Handlebars=require("handlebars");global.Equota={Views:{},Models:{},Collections:{},notifications:{},router:null};_.extend(Equota,Backbone.Events);var Router=require("./Router");var Models=require("./models");var View=require("./views/index.js");var init=function(){Equota.router=new Router;Equota.Views=View;Equota.Models=Models;Backbone.history.start({pushState:true,hashChange:false,root:"/"})};init()})()}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./Router":6,"./backbone":10,"./jquery":12,"./models":13,"./views/index.js":60,handlebars:36,underscore:52}],8:[function(require,module,exports){var factory=function(_,Backbone){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i}return-1};if(typeof Backbone==="undefined"||Backbone===null){throw new Error("Backbone is not defined. Please include the latest version from http://documentcloud.github.com/backbone/backbone.js")}Backbone.Modal=function(_super){__extends(Modal,_super);Modal.prototype.prefix="bbm";function Modal(){this.triggerCancel=__bind(this.triggerCancel,this);this.triggerSubmit=__bind(this.triggerSubmit,this);this.triggerView=__bind(this.triggerView,this);this.clickOutside=__bind(this.clickOutside,this);this.checkKey=__bind(this.checkKey,this);this.args=Array.prototype.slice.apply(arguments);Backbone.View.prototype.constructor.apply(this,this.args);this.setUIElements();this.delegateModalEvents()}Modal.prototype.render=function(options){var data,_ref,_this=this;if(options==null){options={}}data=this.serializeData();this.$el.addClass(""+this.prefix+"-wrapper");this.modalEl=Backbone.$("<div />").addClass(""+this.prefix+"-modal");if(this.template){this.modalEl.html(this.template(data))}this.$el.html(this.modalEl);Backbone.$("body").on("keyup",this.checkKey);Backbone.$("body").on("click",this.clickOutside);if(this.viewContainer){this.viewContainerEl=this.modalEl.find(this.viewContainer);this.viewContainerEl.addClass(""+this.prefix+"-modal__views")}else{this.viewContainerEl=this.modalEl}this.$el.show();if(((_ref=this.views)!=null?_ref.length:void 0)>0){this.openAt(0)}if(typeof this.onRender==="function"){this.onRender()}this.modalEl.css({opacity:0});this.$el.fadeIn({duration:100,complete:function(){return _this.modalEl.css({opacity:1}).addClass(""+_this.prefix+"-modal--open")}});return this};Modal.prototype.setUIElements=function(){var _ref;this.template=this.getOption("template");this.views=this.getOption("views");if((_ref=this.views)!=null){_ref.length=_.size(this.views)}this.viewContainer=this.getOption("viewContainer");this.$el.hide();if(_.isUndefined(this.template)&&_.isUndefined(this.views)){throw new Error("No template or views defined for Backbone.Modal")}if(this.template&&this.views&&_.isUndefined(this.viewContainer)){throw new Error("No viewContainer defined for Backbone.Modal")}};Modal.prototype.getOption=function(option){if(!option){return}if(this.options&&__indexOf.call(this.options,option)>=0&&this.options[option]!=null){return this.options[option]}else{return this[option]}};Modal.prototype.serializeData=function(){var data;data={};if(this.model){data=_.extend(data,this.model.toJSON())}if(this.collection){data=_.extend(data,{items:this.collection.toJSON()})}return data};Modal.prototype.delegateModalEvents=function(){var cancelEl,key,match,selector,submitEl,trigger,_results;this.active=true;cancelEl=this.getOption("cancelEl");submitEl=this.getOption("submitEl");if(submitEl){this.$el.on("click",submitEl,this.triggerSubmit)}if(cancelEl){this.$el.on("click",cancelEl,this.triggerCancel)}_results=[];for(key in this.views){if(key!=="length"){match=key.match(/^(\S+)\s*(.*)$/);trigger=match[1];selector=match[2];_results.push(this.$el.on(trigger,selector,this.views[key],this.triggerView))}else{_results.push(void 0)}}return _results};Modal.prototype.undelegateModalEvents=function(){var cancelEl,key,match,selector,submitEl,trigger,_results;this.active=false;cancelEl=this.getOption("cancelEl");submitEl=this.getOption("submitEl");if(submitEl){this.$el.off("click",submitEl,this.triggerSubmit)}if(cancelEl){this.$el.off("click",cancelEl,this.triggerCancel)}_results=[];for(key in this.views){if(key!=="length"){match=key.match(/^(\S+)\s*(.*)$/);trigger=match[1];selector=match[2];_results.push(this.$el.off(trigger,selector,this.views[key],this.triggerView))}else{_results.push(void 0)}}return _results};Modal.prototype.checkKey=function(e){if(this.active){switch(e.keyCode){case 27:return this.triggerCancel();case 13:return this.triggerSubmit()}}};Modal.prototype.clickOutside=function(e){if(Backbone.$(e.target).hasClass(""+this.prefix+"-wrapper")&&this.active){return this.triggerCancel(null,true)}};Modal.prototype.buildView=function(viewType){var view;if(!viewType){return}if(_.isFunction(viewType)){view=new viewType(this.args[0]);if(view instanceof Backbone.View){return{el:view.render().$el,view:view}}else{return{el:viewType(this.args[0])}}}return{view:viewType,el:viewType.$el}};Modal.prototype.triggerView=function(e){var index,instance,key,options;if(e!=null){if(typeof e.preventDefault==="function"){e.preventDefault()}}options=e.data;instance=this.buildView(options.view);if(this.currentView){this.previousView=this.currentView}this.currentView=instance.view||instance.el;index=0;for(key in this.views){if(options.view===this.views[key].view){this.currentIndex=index}index++}if(options.onActive){if(_.isFunction(options.onActive)){options.onActive(this)}else if(_.isString(options.onActive)){this[options.onActive].call(this,options)}}if(this.shouldAnimate){return this.animateToView(instance.el)}else{this.shouldAnimate=true;return this.$(this.viewContainerEl).html(instance.el)}};Modal.prototype.animateToView=function(view){var container,newHeight,previousHeight,style,tester,_ref,_this=this;style={position:"relative",top:-9999,left:-9999};tester=Backbone.$("<tester/>").css(style);tester.html(this.$el.clone().css(style));if(Backbone.$("tester").length!==0){Backbone.$("tester").replaceWith(tester)}else{Backbone.$("body").append(tester)}if(this.viewContainer){container=tester.find(this.viewContainer)}else{container=tester.find("."+this.prefix+"-modal")}container.removeAttr("style");previousHeight=container.outerHeight();container.html(view);newHeight=container.outerHeight();if(previousHeight===newHeight){this.$(this.viewContainerEl).html(view);return(_ref=this.previousView)!=null?typeof _ref.close==="function"?_ref.close():void 0:void 0}else{this.$(this.viewContainerEl).css({opacity:0});return this.$(this.viewContainerEl).animate({height:newHeight},100,function(){var _ref1;_this.$(_this.viewContainerEl).css({opacity:1}).removeAttr("style");_this.$(_this.viewContainerEl).html(view);return(_ref1=_this.previousView)!=null?typeof _ref1.close==="function"?_ref1.close():void 0:void 0})}};Modal.prototype.triggerSubmit=function(e){if(e!=null){e.preventDefault()}if(this.beforeSubmit){if(this.beforeSubmit()===false){return}}if(typeof this.submit==="function"){this.submit()}if(this.regionEnabled){return this.trigger("modal:close")}else{return this.close()}};Modal.prototype.triggerCancel=function(e){if(e!=null){e.preventDefault()}if(this.beforeCancel){if(this.beforeCancel()===false){return}}if(typeof this.cancel==="function"){this.cancel()}if(this.regionEnabled){return this.trigger("modal:close")}else{return this.close()}};Modal.prototype.close=function(){var _this=this;Backbone.$("body").off("keyup",this.checkKey);Backbone.$("body").off("click",this.clickOutside);if(typeof this.onClose==="function"){this.onClose()}this.shouldAnimate=false;this.modalEl.addClass("{@prefix}-modal--close");this.$el.fadeOut({duration:200});return _.delay(function(){var _ref;if((_ref=_this.currentView)!=null){if(typeof _ref.remove==="function"){_ref.remove()}}return _this.remove()},200)};Modal.prototype.openAt=function(index){var i,key,view;i=0;for(key in this.views){if(key!=="length"){if(i===index){view=this.views[key]}i++}}if(view){this.currentIndex=index;this.triggerView({data:view})}return this};Modal.prototype.next=function(){if(this.currentIndex+1<this.views.length){return this.openAt(this.currentIndex+1)}};Modal.prototype.previous=function(){if(this.currentIndex-1<this.views.length-1){return this.openAt(this.currentIndex-1)}};return Modal}(Backbone.View);return Backbone};module.exports=factory},{}],9:[function(require,module,exports){module.exports=factory;function factory(_,Backbone){"use strict";var _extend=_.extend;var _omit=_.omit;var _clone=_.clone;var _each=_.each;var _pick=_.pick;var _contains=_.contains;var _isEmpty=_.isEmpty;var _pairs=_.pairs;var _invert=_.invert;var _isArray=_.isArray;var _isFunction=_.isFunction;var _isObject=_.isObject;var _keys=_.keys;var _isUndefined=_.isUndefined;var ceil=Math.ceil;var floor=Math.floor;var max=Math.max;var BBColProto=Backbone.Collection.prototype;function finiteInt(val,name){if(!_.isNumber(val)||_.isNaN(val)||!_.isFinite(val)||~~val!==val){throw new TypeError("`"+name+"` must be a finite integer")}return val}Backbone.Collection.prototype.sort=function(options){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");options||(options={});if(_.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{var tempColl=this.models[0].collection;this.models.sort(_.bind(this.comparator,this));this.models.forEach(function(e){e.collection=tempColl;return e})}if(!options.silent)this.trigger("sort",this,options);return this};function queryStringToParams(qs){var kvp,k,v,ls,params={},decode=decodeURIComponent;var kvps=qs.split("&");for(var i=0,l=kvps.length;i<l;i++){var param=kvps[i];kvp=param.split("="),k=kvp[0],v=kvp[1]||true;k=decode(k),v=decode(v),ls=params[k];if(_isArray(ls))ls.push(v);else if(ls)params[k]=[ls,v];else params[k]=v}return params}function runOnceAtLastHandler(col,event,func){var eventHandlers=col._events[event];if(eventHandlers&&eventHandlers.length){var lastHandler=eventHandlers[eventHandlers.length-1];var oldCallback=lastHandler.callback;lastHandler.callback=function(){try{oldCallback.apply(this,arguments);func()}catch(e){throw e}finally{lastHandler.callback=oldCallback}}}else func()}var PARAM_TRIM_RE=/[\s'"]/g;var URL_TRIM_RE=/[<>\s'"]/g;var PageableCollection=Backbone.PageableCollection=Backbone.Collection.extend({state:{firstPage:1,lastPage:null,currentPage:null,pageSize:25,totalPages:null,totalRecords:null,sortKey:null,order:-1},mode:"server",queryParams:{currentPage:"page",pageSize:"per_page",totalPages:"total_pages",totalRecords:"total_entries",sortKey:"sort_by",order:"order",directions:{"-1":"asc",1:"desc"}},constructor:function(models,options){BBColProto.constructor.apply(this,arguments);options=options||{};var mode=this.mode=options.mode||this.mode||PageableProto.mode;var queryParams=_extend({},PageableProto.queryParams,this.queryParams,options.queryParams||{});queryParams.directions=_extend({},PageableProto.queryParams.directions,this.queryParams.directions,queryParams.directions||{});this.queryParams=queryParams;var state=this.state=_extend({},PageableProto.state,this.state,options.state||{});state.currentPage=state.currentPage==null?state.firstPage:state.currentPage;if(!_isArray(models))models=models?[models]:[];models=models.slice();if(mode!="server"&&state.totalRecords==null&&!_isEmpty(models)){state.totalRecords=models.length}this.switchMode(mode,_extend({fetch:false,resetState:false,models:models},options));var comparator=options.comparator;if(state.sortKey&&!comparator){this.setSorting(state.sortKey,state.order,options)}if(mode!="server"){var fullCollection=this.fullCollection;if(comparator&&options.full){this.comparator=null;fullCollection.comparator=comparator}if(options.full)fullCollection.sort();if(models&&!_isEmpty(models)){this.reset(models,_extend({silent:true},options));this.getPage(state.currentPage);models.splice.apply(models,[0,models.length].concat(this.models))}}this._initState=_clone(this.state)},_makeFullCollection:function(models,options){var properties=["url","model","sync","comparator"];var thisProto=this.constructor.prototype;var i,length,prop;var proto={};for(i=0,length=properties.length;i<length;i++){prop=properties[i];if(!_isUndefined(thisProto[prop])){proto[prop]=thisProto[prop]}}var fullCollection=new(Backbone.Collection.extend(proto))(models,options);for(i=0,length=properties.length;i<length;i++){prop=properties[i];if(this[prop]!==thisProto[prop]){fullCollection[prop]=this[prop]}}return fullCollection},_makeCollectionEventHandler:function(pageCol,fullCol){return function collectionEventHandler(event,model,collection,options){var handlers=pageCol._handlers;_each(_keys(handlers),function(event){var handler=handlers[event];pageCol.off(event,handler);fullCol.off(event,handler)});var state=_clone(pageCol.state);var firstPage=state.firstPage;var currentPage=firstPage===0?state.currentPage:state.currentPage-1;var pageSize=state.pageSize;var pageStart=currentPage*pageSize,pageEnd=pageStart+pageSize;if(event=="add"){var pageIndex,fullIndex,addAt,colToAdd,options=options||{};if(collection==fullCol){fullIndex=fullCol.indexOf(model);if(fullIndex>=pageStart&&fullIndex<pageEnd){colToAdd=pageCol;pageIndex=addAt=fullIndex-pageStart}}else{pageIndex=pageCol.indexOf(model);fullIndex=pageStart+pageIndex;colToAdd=fullCol;var addAt=!_isUndefined(options.at)?options.at+pageStart:fullIndex}if(!options.onRemove){++state.totalRecords;delete options.onRemove}pageCol.state=pageCol._checkState(state);if(colToAdd){colToAdd.add(model,_extend({},options||{},{at:addAt}));var modelToRemove=pageIndex>=pageSize?model:!_isUndefined(options.at)&&addAt<pageEnd&&pageCol.length>pageSize?pageCol.at(pageSize):null;if(modelToRemove){runOnceAtLastHandler(collection,event,function(){pageCol.remove(modelToRemove,{onAdd:true})})}}}if(event=="remove"){if(!options.onAdd){if(!--state.totalRecords){state.totalRecords=null;state.totalPages=null}else{var totalPages=state.totalPages=ceil(state.totalRecords/pageSize);state.lastPage=firstPage===0?totalPages-1:totalPages||firstPage;if(state.currentPage>totalPages)state.currentPage=state.lastPage}pageCol.state=pageCol._checkState(state);var nextModel,removedIndex=options.index;if(collection==pageCol){if(nextModel=fullCol.at(pageEnd)){runOnceAtLastHandler(pageCol,event,function(){pageCol.push(nextModel,{onRemove:true})})}else if(!pageCol.length&&state.totalRecords){pageCol.reset(fullCol.models.slice(pageStart-pageSize,pageEnd-pageSize),_extend({},options,{parse:false}))}fullCol.remove(model)}else if(removedIndex>=pageStart&&removedIndex<pageEnd){if(nextModel=fullCol.at(pageEnd-1)){runOnceAtLastHandler(pageCol,event,function(){pageCol.push(nextModel,{onRemove:true})})}pageCol.remove(model);if(!pageCol.length&&state.totalRecords){pageCol.reset(fullCol.models.slice(pageStart-pageSize,pageEnd-pageSize),_extend({},options,{parse:false}))}}}else delete options.onAdd}if(event=="reset"){options=collection;collection=model;if(collection==pageCol&&options.from==null&&options.to==null){var head=fullCol.models.slice(0,pageStart);var tail=fullCol.models.slice(pageStart+pageCol.models.length);fullCol.reset(head.concat(pageCol.models).concat(tail),options)}else if(collection==fullCol){if(!(state.totalRecords=fullCol.models.length)){state.totalRecords=null;state.totalPages=null}if(pageCol.mode=="client"){state.lastPage=state.currentPage=state.firstPage}pageCol.state=pageCol._checkState(state);pageCol.reset(fullCol.models.slice(pageStart,pageEnd),_extend({},options,{parse:false}))}}if(event=="sort"){options=collection;collection=model;if(collection===fullCol){pageCol.reset(fullCol.models.slice(pageStart,pageEnd),_extend({},options,{parse:false}))}}_each(_keys(handlers),function(event){var handler=handlers[event];_each([pageCol,fullCol],function(col){col.on(event,handler);var callbacks=col._events[event]||[];callbacks.unshift(callbacks.pop())})})}},_checkState:function(state){var mode=this.mode;var links=this.links;var totalRecords=state.totalRecords;var pageSize=state.pageSize;var currentPage=state.currentPage;var firstPage=state.firstPage;var totalPages=state.totalPages;if(totalRecords!=null&&pageSize!=null&&currentPage!=null&&firstPage!=null&&(mode=="infinite"?links:true)){totalRecords=finiteInt(totalRecords,"totalRecords");pageSize=finiteInt(pageSize,"pageSize");currentPage=finiteInt(currentPage,"currentPage");firstPage=finiteInt(firstPage,"firstPage");if(pageSize<1){throw new RangeError("`pageSize` must be >= 1")}totalPages=state.totalPages=ceil(totalRecords/pageSize);if(firstPage<0||firstPage>1){throw new RangeError("`firstPage must be 0 or 1`")}state.lastPage=firstPage===0?max(0,totalPages-1):totalPages||firstPage;if(mode=="infinite"){if(!links[currentPage+""]){throw new RangeError("No link found for page "+currentPage)}}else if(currentPage<firstPage||totalPages>0&&(firstPage?currentPage>totalPages:currentPage>=totalPages)){throw new RangeError("`currentPage` must be firstPage <= currentPage "+(firstPage?">":">=")+" totalPages if "+firstPage+"-based. Got "+currentPage+".")}}return state},setPageSize:function(pageSize,options){pageSize=finiteInt(pageSize,"pageSize");options=options||{first:false};var state=this.state;var totalPages=ceil(state.totalRecords/pageSize);var currentPage=totalPages?max(state.firstPage,floor(totalPages*state.currentPage/state.totalPages)):state.firstPage;state=this.state=this._checkState(_extend({},state,{pageSize:pageSize,currentPage:options.first?state.firstPage:currentPage,totalPages:totalPages}));return this.getPage(state.currentPage,_omit(options,["first"]))},switchMode:function(mode,options){if(!_contains(["server","client","infinite"],mode)){throw new TypeError('`mode` must be one of "server", "client" or "infinite"')}options=options||{fetch:true,resetState:true};var state=this.state=options.resetState?_clone(this._initState):this._checkState(_extend({},this.state));this.mode=mode;var self=this;var fullCollection=this.fullCollection;var handlers=this._handlers=this._handlers||{},handler;if(mode!="server"&&!fullCollection){fullCollection=this._makeFullCollection(options.models||[],options);fullCollection.pageableCollection=this;this.fullCollection=fullCollection;var allHandler=this._makeCollectionEventHandler(this,fullCollection);_each(["add","remove","reset","sort"],function(event){handlers[event]=handler=_.bind(allHandler,{},event);self.on(event,handler);fullCollection.on(event,handler)});fullCollection.comparator=this._fullComparator}else if(mode=="server"&&fullCollection){_each(_keys(handlers),function(event){handler=handlers[event];self.off(event,handler);fullCollection.off(event,handler)});delete this._handlers;this._fullComparator=fullCollection.comparator;delete this.fullCollection}if(mode=="infinite"){var links=this.links={};var firstPage=state.firstPage;var totalPages=ceil(state.totalRecords/state.pageSize);var lastPage=firstPage===0?max(0,totalPages-1):totalPages||firstPage;for(var i=state.firstPage;i<=lastPage;i++){links[i]=this.url}}else if(this.links)delete this.links;return options.fetch?this.fetch(_omit(options,"fetch","resetState")):this},hasPreviousPage:function(){var state=this.state;var currentPage=state.currentPage;if(this.mode!="infinite")return currentPage>state.firstPage;return!!this.links[currentPage-1]},hasNextPage:function(){var state=this.state;var currentPage=this.state.currentPage;if(this.mode!="infinite")return currentPage<state.lastPage;return!!this.links[currentPage+1]},getFirstPage:function(options){return this.getPage("first",options)},getPreviousPage:function(options){return this.getPage("prev",options)},getNextPage:function(options){return this.getPage("next",options)},getLastPage:function(options){return this.getPage("last",options)},getPage:function(index,options){var mode=this.mode,fullCollection=this.fullCollection;options=options||{fetch:false};var state=this.state,firstPage=state.firstPage,currentPage=state.currentPage,lastPage=state.lastPage,pageSize=state.pageSize;var pageNum=index;switch(index){case"first":pageNum=firstPage;break;case"prev":pageNum=currentPage-1;break;case"next":pageNum=currentPage+1;break;case"last":pageNum=lastPage;break;default:pageNum=finiteInt(index,"index")}this.state=this._checkState(_extend({},state,{currentPage:pageNum}));options.from=currentPage,options.to=pageNum;var pageStart=(firstPage===0?pageNum:pageNum-1)*pageSize;var pageModels=fullCollection&&fullCollection.length?fullCollection.models.slice(pageStart,pageStart+pageSize):[];if((mode=="client"||mode=="infinite"&&!_isEmpty(pageModels))&&!options.fetch){this.reset(pageModels,_omit(options,"fetch"));return this}if(mode=="infinite")options.url=this.links[pageNum];return this.fetch(_omit(options,"fetch"))},getPageByOffset:function(offset,options){if(offset<0){throw new RangeError("`offset must be > 0`")}offset=finiteInt(offset);var page=floor(offset/this.state.pageSize);if(this.state.firstPage!==0)page++;if(page>this.state.lastPage)page=this.state.lastPage;return this.getPage(page,options)},sync:function(method,model,options){var self=this;if(self.mode=="infinite"){var success=options.success;var currentPage=self.state.currentPage;options.success=function(resp,status,xhr){var links=self.links;var newLinks=self.parseLinks(resp,_extend({xhr:xhr},options));if(newLinks.first)links[self.state.firstPage]=newLinks.first;
if(newLinks.prev)links[currentPage-1]=newLinks.prev;if(newLinks.next)links[currentPage+1]=newLinks.next;if(success)success(resp,status,xhr)}}return(BBColProto.sync||Backbone.sync).call(self,method,model,options)},parseLinks:function(resp,options){var links={};var linkHeader=options.xhr.getResponseHeader("Link");if(linkHeader){var relations=["first","prev","next"];_each(linkHeader.split(","),function(linkValue){var linkParts=linkValue.split(";");var url=linkParts[0].replace(URL_TRIM_RE,"");var params=linkParts.slice(1);_each(params,function(param){var paramParts=param.split("=");var key=paramParts[0].replace(PARAM_TRIM_RE,"");var value=paramParts[1].replace(PARAM_TRIM_RE,"");if(key=="rel"&&_contains(relations,value))links[value]=url})})}return links},parse:function(resp,options){var newState=this.parseState(resp,_clone(this.queryParams),_clone(this.state),options);if(newState)this.state=this._checkState(_extend({},this.state,newState));return this.parseRecords(resp,options)},parseState:function(resp,queryParams,state,options){if(resp&&resp.length===2&&_isObject(resp[0])&&_isArray(resp[1])){var newState=_clone(state);var serverState=resp[0];_each(_pairs(_omit(queryParams,"directions")),function(kvp){var k=kvp[0],v=kvp[1];var serverVal=serverState[v];if(!_isUndefined(serverVal)&&!_.isNull(serverVal))newState[k]=serverState[v]});if(serverState.order){newState.order=_invert(queryParams.directions)[serverState.order]*1}return newState}},parseRecords:function(resp,options){if(resp&&resp.length===2&&_isObject(resp[0])&&_isArray(resp[1])){return resp[1]}return resp},fetch:function(options){options=options||{};var state=this._checkState(this.state);var mode=this.mode;if(mode=="infinite"&&!options.url){options.url=this.links[state.currentPage]}var data=options.data||{};var url=options.url||this.url||"";if(_isFunction(url))url=url.call(this);var qsi=url.indexOf("?");if(qsi!=-1){_extend(data,queryStringToParams(url.slice(qsi+1)));url=url.slice(0,qsi)}options.url=url;options.data=data;var queryParams=this.mode=="client"?_pick(this.queryParams,"sortKey","order"):_omit(_pick(this.queryParams,_keys(PageableProto.queryParams)),"directions");var i,kvp,k,v,kvps=_pairs(queryParams),thisCopy=_clone(this);for(i=0;i<kvps.length;i++){kvp=kvps[i],k=kvp[0],v=kvp[1];v=_isFunction(v)?v.call(thisCopy):v;if(state[k]!=null&&v!=null){data[v]=state[k]}}if(state.sortKey&&state.order){var o=_isFunction(queryParams.order)?queryParams.order.call(thisCopy):queryParams.order;data[o]=this.queryParams.directions[state.order+""]}else if(!state.sortKey)delete data[queryParams.order];var extraKvps=_pairs(_omit(this.queryParams,_keys(PageableProto.queryParams)));for(i=0;i<extraKvps.length;i++){kvp=extraKvps[i];v=kvp[1];v=_isFunction(v)?v.call(thisCopy):v;if(v!=null)data[kvp[0]]=v}if(mode!="server"){var self=this,fullCol=this.fullCollection;var success=options.success;options.success=function(col,resp,opts){opts=opts||{};if(_isUndefined(options.silent))delete opts.silent;else opts.silent=options.silent;var models=col.models;if(mode=="client")fullCol.reset(models,opts);else{fullCol.add(models,_extend({at:fullCol.length},_extend(opts,{parse:false})));self.trigger("reset",self,opts)}if(success)success(col,resp,opts)};return BBColProto.fetch.call(this,_extend({},options,{silent:true}))}return BBColProto.fetch.call(this,options)},_makeComparator:function(sortKey,order,sortValue){var state=this.state;sortKey=sortKey||state.sortKey;order=order||state.order;if(!sortKey||!order)return;if(!sortValue)sortValue=function(model,attr){return model.get(attr)};return function(left,right){var l=sortValue(left,sortKey),r=sortValue(right,sortKey),t;if(order===1)t=l,l=r,r=t;if(l===r)return 0;else if(l<r)return-1;return 1}},setSorting:function(sortKey,order,options){var state=this.state;state.sortKey=sortKey;state.order=order=order||state.order;var fullCollection=this.fullCollection;var delComp=false,delFullComp=false;if(!sortKey)delComp=delFullComp=true;var mode=this.mode;options=_extend({side:mode=="client"?mode:"server",full:true},options);var comparator=this._makeComparator(sortKey,order,options.sortValue);var full=options.full,side=options.side;if(side=="client"){if(full){if(fullCollection)fullCollection.comparator=comparator;delComp=true}else{this.comparator=comparator;delFullComp=true}}else if(side=="server"&&!full){this.comparator=comparator}if(delComp)this.comparator=null;if(delFullComp&&fullCollection)fullCollection.comparator=null;return this}});var PageableProto=PageableCollection.prototype;return Backbone}},{}],10:[function(require,module,exports){var Backbone=require("backbone");var _=require("underscore");var Backbone=require("./backbone.modal")(_,Backbone);Backbone=require("./backbone.paginator")(_,Backbone);var $=require("../jquery");Backbone.$=$;module.exports=Backbone},{"../jquery":12,"./backbone.modal":8,"./backbone.paginator":9,backbone:14,underscore:52}],11:[function(require,module,exports){module.exports=function(){var UNDEFINED,doc=document,win=window,math=Math,mathRound=math.round,mathFloor=math.floor,mathCeil=math.ceil,mathMax=math.max,mathMin=math.min,mathAbs=math.abs,mathCos=math.cos,mathSin=math.sin,mathPI=math.PI,deg2rad=mathPI*2/360,userAgent=navigator.userAgent,isOpera=win.opera,isIE=/(msie|trident)/i.test(userAgent)&&!isOpera,docMode8=doc.documentMode===8,isWebKit=/AppleWebKit/.test(userAgent),isFirefox=/Firefox/.test(userAgent),isTouchDevice=/(Mobile|Android|Windows Phone)/.test(userAgent),SVG_NS="http://www.w3.org/2000/svg",hasSVG=!!doc.createElementNS&&!!doc.createElementNS(SVG_NS,"svg").createSVGRect,hasBidiBug=isFirefox&&parseInt(userAgent.split("Firefox/")[1],10)<4,useCanVG=!hasSVG&&!isIE&&!!doc.createElement("canvas").getContext,Renderer,hasTouch,symbolSizes={},idCounter=0,garbageBin,defaultOptions,dateFormat,globalAnimation,pathAnim,timeUnits,noop=function(){return UNDEFINED},charts=[],chartCount=0,PRODUCT="Highstock",VERSION="2.1.7",DIV="div",ABSOLUTE="absolute",RELATIVE="relative",HIDDEN="hidden",PREFIX="highcharts-",VISIBLE="visible",PX="px",NONE="none",M="M",L="L",numRegex=/^[0-9]+$/,NORMAL_STATE="",HOVER_STATE="hover",SELECT_STATE="select",marginNames=["plotTop","marginRight","marginBottom","plotLeft"],AxisPlotLineOrBandExtension,STROKE_WIDTH="stroke-width",Date,makeTime,timezoneOffset,getTimezoneOffset,getMinutes,getHours,getDay,getDate,getMonth,getFullYear,setMilliseconds,setSeconds,setMinutes,setHours,setDate,setMonth,setFullYear,seriesTypes={},Highcharts;Highcharts=win.Highcharts=win.Highcharts?error(16,true):{};Highcharts.seriesTypes=seriesTypes;var extend=Highcharts.extend=function(a,b){var n;if(!a){a={}}for(n in b){a[n]=b[n]}return a};function merge(){var i,args=arguments,len,ret={},doCopy=function(copy,original){var value,key;if(typeof copy!=="object"){copy={}}for(key in original){if(original.hasOwnProperty(key)){value=original[key];if(value&&typeof value==="object"&&Object.prototype.toString.call(value)!=="[object Array]"&&key!=="renderTo"&&typeof value.nodeType!=="number"){copy[key]=doCopy(copy[key]||{},value)}else{copy[key]=original[key]}}}return copy};if(args[0]===true){ret=args[1];args=Array.prototype.slice.call(args,2)}len=args.length;for(i=0;i<len;i++){ret=doCopy(ret,args[i])}return ret}function pInt(s,mag){return parseInt(s,mag||10)}function isString(s){return typeof s==="string"}function isObject(obj){return obj&&typeof obj==="object"}function isArray(obj){return Object.prototype.toString.call(obj)==="[object Array]"}function isNumber(n){return typeof n==="number"}function log2lin(num){return math.log(num)/math.LN10}function lin2log(num){return math.pow(10,num)}function erase(arr,item){var i=arr.length;while(i--){if(arr[i]===item){arr.splice(i,1);break}}}function defined(obj){return obj!==UNDEFINED&&obj!==null}function attr(elem,prop,value){var key,ret;if(isString(prop)){if(defined(value)){elem.setAttribute(prop,value)}else if(elem&&elem.getAttribute){ret=elem.getAttribute(prop)}}else if(defined(prop)&&isObject(prop)){for(key in prop){elem.setAttribute(key,prop[key])}}return ret}function splat(obj){return isArray(obj)?obj:[obj]}var pick=Highcharts.pick=function(){var args=arguments,i,arg,length=args.length;for(i=0;i<length;i++){arg=args[i];if(arg!==UNDEFINED&&arg!==null){return arg}}};function css(el,styles){if(isIE&&!hasSVG){if(styles&&styles.opacity!==UNDEFINED){styles.filter="alpha(opacity="+styles.opacity*100+")"}}extend(el.style,styles)}function createElement(tag,attribs,styles,parent,nopad){var el=doc.createElement(tag);if(attribs){extend(el,attribs)}if(nopad){css(el,{padding:0,border:NONE,margin:0})}if(styles){css(el,styles)}if(parent){parent.appendChild(el)}return el}function extendClass(parent,members){var object=function(){return UNDEFINED};object.prototype=new parent;extend(object.prototype,members);return object}function pad(number,length){return new Array((length||2)+1-String(number).length).join(0)+number}function relativeLength(value,base){return/%$/.test(value)?base*parseFloat(value)/100:parseFloat(value)}var wrap=Highcharts.wrap=function(obj,method,func){var proceed=obj[method];obj[method]=function(){var args=Array.prototype.slice.call(arguments);args.unshift(proceed);return func.apply(this,args)}};function getTZOffset(timestamp){return(getTimezoneOffset&&getTimezoneOffset(timestamp)||timezoneOffset||0)*6e4}dateFormat=function(format,timestamp,capitalize){if(!defined(timestamp)||isNaN(timestamp)){return"Invalid date"}format=pick(format,"%Y-%m-%d %H:%M:%S");var date=new Date(timestamp-getTZOffset(timestamp)),key,hours=date[getHours](),day=date[getDay](),dayOfMonth=date[getDate](),month=date[getMonth](),fullYear=date[getFullYear](),lang=defaultOptions.lang,langWeekdays=lang.weekdays,replacements=extend({a:langWeekdays[day].substr(0,3),A:langWeekdays[day],d:pad(dayOfMonth),e:dayOfMonth,w:day,b:lang.shortMonths[month],B:lang.months[month],m:pad(month+1),y:fullYear.toString().substr(2,2),Y:fullYear,H:pad(hours),I:pad(hours%12||12),l:hours%12||12,M:pad(date[getMinutes]()),p:hours<12?"AM":"PM",P:hours<12?"am":"pm",S:pad(date.getSeconds()),L:pad(mathRound(timestamp%1e3),3)},Highcharts.dateFormats);for(key in replacements){while(format.indexOf("%"+key)!==-1){format=format.replace("%"+key,typeof replacements[key]==="function"?replacements[key](timestamp):replacements[key])}}return capitalize?format.substr(0,1).toUpperCase()+format.substr(1):format};function formatSingle(format,val){var floatRegex=/f$/,decRegex=/\.([0-9])/,lang=defaultOptions.lang,decimals;if(floatRegex.test(format)){decimals=format.match(decRegex);decimals=decimals?decimals[1]:-1;if(val!==null){val=Highcharts.numberFormat(val,decimals,lang.decimalPoint,format.indexOf(",")>-1?lang.thousandsSep:"")}}else{val=dateFormat(format,val)}return val}function format(str,ctx){var splitter="{",isInside=false,segment,valueAndFormat,path,i,len,ret=[],val,index;while((index=str.indexOf(splitter))!==-1){segment=str.slice(0,index);if(isInside){valueAndFormat=segment.split(":");path=valueAndFormat.shift().split(".");len=path.length;val=ctx;for(i=0;i<len;i++){val=val[path[i]]}if(valueAndFormat.length){val=formatSingle(valueAndFormat.join(":"),val)}ret.push(val)}else{ret.push(segment)}str=str.slice(index+1);isInside=!isInside;splitter=isInside?"}":"{"}ret.push(str);return ret.join("")}function getMagnitude(num){return math.pow(10,mathFloor(math.log(num)/math.LN10))}function normalizeTickInterval(interval,multiples,magnitude,allowDecimals,preventExceed){var normalized,i,retInterval=interval;magnitude=pick(magnitude,1);normalized=interval/magnitude;if(!multiples){multiples=[1,2,2.5,5,10];if(allowDecimals===false){if(magnitude===1){multiples=[1,2,5,10]}else if(magnitude<=.1){multiples=[1/magnitude]}}}for(i=0;i<multiples.length;i++){retInterval=multiples[i];if(preventExceed&&retInterval*magnitude>=interval||!preventExceed&&normalized<=(multiples[i]+(multiples[i+1]||multiples[i]))/2){break}}retInterval*=magnitude;return retInterval}function stableSort(arr,sortFunction){var length=arr.length,sortValue,i;for(i=0;i<length;i++){arr[i].ss_i=i}arr.sort(function(a,b){sortValue=sortFunction(a,b);return sortValue===0?a.ss_i-b.ss_i:sortValue});for(i=0;i<length;i++){delete arr[i].ss_i}}function arrayMin(data){var i=data.length,min=data[0];while(i--){if(data[i]<min){min=data[i]}}return min}function arrayMax(data){var i=data.length,max=data[0];while(i--){if(data[i]>max){max=data[i]}}return max}function destroyObjectProperties(obj,except){var n;for(n in obj){if(obj[n]&&obj[n]!==except&&obj[n].destroy){obj[n].destroy()}delete obj[n]}}function discardElement(element){if(!garbageBin){garbageBin=createElement(DIV)}if(element){garbageBin.appendChild(element)}garbageBin.innerHTML=""}function error(code,stop){var msg="Highcharts error #"+code+": www.highcharts.com/errors/"+code;if(stop){throw msg}if(win.console){console.log(msg)}}function correctFloat(num){return parseFloat(num.toPrecision(14))}function setAnimation(animation,chart){globalAnimation=pick(animation,chart.animation)}timeUnits={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:24*36e5,week:7*24*36e5,month:28*24*36e5,year:364*24*36e5};Highcharts.numberFormat=function(number,decimals,decPoint,thousandsSep){var lang=defaultOptions.lang,n=+number||0,c=decimals===-1?mathMin((n.toString().split(".")[1]||"").length,20):isNaN(decimals=mathAbs(decimals))?2:decimals,d=decPoint===undefined?lang.decimalPoint:decPoint,t=thousandsSep===undefined?lang.thousandsSep:thousandsSep,s=n<0?"-":"",i=String(pInt(n=mathAbs(n).toFixed(c))),j=i.length>3?i.length%3:0;return s+(j?i.substr(0,j)+t:"")+i.substr(j).replace(/(\d{3})(?=\d)/g,"$1"+t)+(c?d+mathAbs(n-i).toFixed(c).slice(2):"")};pathAnim={init:function(elem,fromD,toD){fromD=fromD||"";var shift=elem.shift,bezier=fromD.indexOf("C")>-1,numParams=bezier?7:3,endLength,slice,i,start=fromD.split(" "),end=[].concat(toD),startBaseLine,endBaseLine,sixify=function(arr){i=arr.length;while(i--){if(arr[i]===M){arr.splice(i+1,0,arr[i+1],arr[i+2],arr[i+1],arr[i+2])}}};if(bezier){sixify(start);sixify(end)}if(elem.isArea){startBaseLine=start.splice(start.length-6,6);endBaseLine=end.splice(end.length-6,6)}if(shift<=end.length/numParams&&start.length===end.length){while(shift--){end=[].concat(end).splice(0,numParams).concat(end)}}elem.shift=0;if(start.length){endLength=end.length;while(start.length<endLength){slice=[].concat(start).splice(start.length-numParams,numParams);if(bezier){slice[numParams-6]=slice[numParams-2];slice[numParams-5]=slice[numParams-1]}start=start.concat(slice)}}if(startBaseLine){start=start.concat(startBaseLine);end=end.concat(endBaseLine)}return[start,end]},step:function(start,end,pos,complete){var ret=[],i=start.length,startVal;if(pos===1){ret=complete}else if(i===end.length&&pos<1){while(i--){startVal=parseFloat(start[i]);ret[i]=isNaN(startVal)?start[i]:pos*parseFloat(end[i]-startVal)+startVal}}else{ret=end}return ret}};(function($){win.HighchartsAdapter=win.HighchartsAdapter||$&&{init:function(pathAnim){var Fx=$.fx;$.extend($.easing,{easeOutQuad:function(x,t,b,c,d){return-c*(t/=d)*(t-2)+b}});$.each(["cur","_default","width","height","opacity"],function(i,fn){var obj=Fx.step,base;if(fn==="cur"){obj=Fx.prototype}else if(fn==="_default"&&$.Tween){obj=$.Tween.propHooks[fn];fn="set"}base=obj[fn];if(base){obj[fn]=function(fx){var elem;fx=i?fx:this;if(fx.prop==="align"){return}elem=fx.elem;return elem.attr?elem.attr(fx.prop,fn==="cur"?UNDEFINED:fx.now):base.apply(this,arguments)}}});wrap($.cssHooks.opacity,"get",function(proceed,elem,computed){return elem.attr?elem.opacity||0:proceed.call(this,elem,computed)});this.addAnimSetter("d",function(fx){var elem=fx.elem,ends;if(!fx.started){ends=pathAnim.init(elem,elem.d,elem.toD);fx.start=ends[0];fx.end=ends[1];fx.started=true}elem.attr("d",pathAnim.step(fx.start,fx.end,fx.pos,elem.toD))});this.each=Array.prototype.forEach?function(arr,fn){return Array.prototype.forEach.call(arr,fn)}:function(arr,fn){var i,len=arr.length;for(i=0;i<len;i++){if(fn.call(arr[i],arr[i],i,arr)===false){return i}}};$.fn.highcharts=function(){var constr="Chart",args=arguments,options,ret,chart;if(this[0]){if(isString(args[0])){constr=args[0];args=Array.prototype.slice.call(args,1)}options=args[0];if(options!==UNDEFINED){options.chart=options.chart||{};options.chart.renderTo=this[0];chart=new Highcharts[constr](options,args[1]);ret=this}if(options===UNDEFINED){ret=charts[attr(this[0],"data-highcharts-chart")]}}return ret}},addAnimSetter:function(prop,setter){if($.Tween){$.Tween.propHooks[prop]={set:setter}}else{$.fx.step[prop]=setter}},getScript:$.getScript,inArray:$.inArray,adapterRun:function(elem,method){return $(elem)[method]()},grep:$.grep,map:function(arr,fn){var results=[],i=0,len=arr.length;for(;i<len;i++){results[i]=fn.call(arr[i],arr[i],i,arr)}return results},offset:function(el){return $(el).offset()},addEvent:function(el,event,fn){$(el).bind(event,fn)},removeEvent:function(el,eventType,handler){var func=doc.removeEventListener?"removeEventListener":"detachEvent";if(doc[func]&&el&&!el[func]){el[func]=function(){}}$(el).unbind(eventType,handler)},fireEvent:function(el,type,eventArguments,defaultFunction){var event=$.Event(type),detachedType="detached"+type,defaultPrevented;if(!isIE&&eventArguments){delete eventArguments.layerX;delete eventArguments.layerY;delete eventArguments.returnValue}extend(event,eventArguments);if(el[type]){el[detachedType]=el[type];el[type]=null}$.each(["preventDefault","stopPropagation"],function(i,fn){var base=event[fn];event[fn]=function(){try{base.call(event)}catch(e){if(fn==="preventDefault"){defaultPrevented=true}}}});$(el).trigger(event);if(el[detachedType]){el[type]=el[detachedType];el[detachedType]=null}if(defaultFunction&&!event.isDefaultPrevented()&&!defaultPrevented){defaultFunction(event)}},washMouseEvent:function(e){var ret=e.originalEvent||e;if(ret.pageX===UNDEFINED){ret.pageX=e.pageX;ret.pageY=e.pageY}return ret},animate:function(el,params,options){var $el=$(el);if(!el.style){el.style={}}if(params.d){el.toD=params.d;params.d=1}$el.stop();if(params.opacity!==UNDEFINED&&el.attr){params.opacity+="px"}el.hasAnim=1;$el.animate(params,options)},stop:function(el){if(el.hasAnim){$(el).stop()}}}})(win.jQuery);var globalAdapter=win.HighchartsAdapter,adapter=globalAdapter||{};if(globalAdapter){globalAdapter.init.call(globalAdapter,pathAnim)}var adapterRun=adapter.adapterRun,getScript=adapter.getScript,inArray=adapter.inArray,each=Highcharts.each=adapter.each,grep=adapter.grep,offset=adapter.offset,map=adapter.map,addEvent=adapter.addEvent,removeEvent=adapter.removeEvent,fireEvent=adapter.fireEvent,washMouseEvent=adapter.washMouseEvent,animate=adapter.animate,stop=adapter.stop;defaultOptions={colors:["#7cb5ec","#434348","#90ed7d","#f7a35c","#8085e9","#f15c80","#e4d354","#2b908f","#f45b5b","#91e8e1"],symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],decimalPoint:".",numericSymbols:["k","M","G","T","P","E"],resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:" "},global:{useUTC:true,canvasToolsURL:"http://code.highcharts.com/stock/2.1.7/modules/canvas-tools.js",VMLRadialGradientURL:"http://code.highcharts.com/stock/2.1.7/gfx/vml-radial-gradient.png"},chart:{borderColor:"#4572A7",borderRadius:0,defaultSeriesType:"line",ignoreHiddenSeries:true,spacing:[10,10,15,10],backgroundColor:"#FFFFFF",plotBorderColor:"#C0C0C0",resetZoomButton:{theme:{zIndex:20},position:{align:"right",x:-10,y:10}}},title:{text:"Chart title",align:"center",margin:15,style:{color:"#333333",fontSize:"18px"}},subtitle:{text:"",align:"center",style:{color:"#555555"}},plotOptions:{line:{allowPointSelect:false,showCheckbox:false,animation:{duration:1e3},events:{},lineWidth:2,marker:{lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{enabled:true,lineWidthPlus:1,radiusPlus:2},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{align:"center",formatter:function(){return this.y===null?"":Highcharts.numberFormat(this.y,-1)},style:{color:"contrast",fontSize:"11px",fontWeight:"bold",textShadow:"0 0 6px contrast, 0 0 3px contrast"},verticalAlign:"bottom",x:0,y:0,padding:5},cropThreshold:300,pointRange:0,states:{hover:{lineWidthPlus:1,marker:{},halo:{size:10,opacity:.25}},select:{marker:{}}},stickyTracking:true,turboThreshold:1e3}},labels:{style:{position:ABSOLUTE,color:"#3E576F"}},legend:{enabled:true,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderColor:"#909090",borderRadius:0,navigation:{activeColor:"#274b6d",inactiveColor:"#CCC"},shadow:false,itemStyle:{color:"#333333",fontSize:"12px",fontWeight:"bold"},itemHoverStyle:{color:"#000"},itemHiddenStyle:{color:"#CCC"},itemCheckboxStyle:{position:ABSOLUTE,width:"13px",height:"13px"},symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:RELATIVE,top:"45%"},style:{position:ABSOLUTE,backgroundColor:"white",opacity:.5,textAlign:"center"}},tooltip:{enabled:true,animation:hasSVG,backgroundColor:"rgba(249, 249, 249, .85)",borderWidth:1,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},footerFormat:"",headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{point.color}"></span> {series.name}: <b>{point.y}</b><br/>',shadow:true,snap:isTouchDevice?25:10,style:{color:"#333333",cursor:"default",fontSize:"12px",padding:"8px",whiteSpace:"nowrap"}},credits:{enabled:true,text:"Highcharts.com",href:"http://www.highcharts.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#909090",fontSize:"9px"}}};var defaultPlotOptions=defaultOptions.plotOptions,defaultSeriesOptions=defaultPlotOptions.line;setTimeMethods();function setTimeMethods(){var globalOptions=defaultOptions.global,useUTC=globalOptions.useUTC,GET=useUTC?"getUTC":"get",SET=useUTC?"setUTC":"set";Date=globalOptions.Date||window.Date;timezoneOffset=useUTC&&globalOptions.timezoneOffset;getTimezoneOffset=useUTC&&globalOptions.getTimezoneOffset;makeTime=function(year,month,date,hours,minutes,seconds){var d;if(useUTC){d=Date.UTC.apply(0,arguments);d+=getTZOffset(d)}else{d=new Date(year,month,pick(date,1),pick(hours,0),pick(minutes,0),pick(seconds,0)).getTime()}return d};getMinutes=GET+"Minutes";getHours=GET+"Hours";getDay=GET+"Day";getDate=GET+"Date";getMonth=GET+"Month";getFullYear=GET+"FullYear";setMilliseconds=SET+"Milliseconds";setSeconds=SET+"Seconds";setMinutes=SET+"Minutes";setHours=SET+"Hours";setDate=SET+"Date";setMonth=SET+"Month";setFullYear=SET+"FullYear"}function setOptions(options){defaultOptions=merge(true,defaultOptions,options);setTimeMethods();return defaultOptions}function getOptions(){return defaultOptions}var rgbaRegEx=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,hexRegEx=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,rgbRegEx=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/;var Color=function(input){var rgba=[],result,stops;function init(input){if(input&&input.stops){stops=map(input.stops,function(stop){return Color(stop[1])})}else{result=rgbaRegEx.exec(input);if(result){rgba=[pInt(result[1]),pInt(result[2]),pInt(result[3]),parseFloat(result[4],10)]}else{result=hexRegEx.exec(input);if(result){rgba=[pInt(result[1],16),pInt(result[2],16),pInt(result[3],16),1]}else{result=rgbRegEx.exec(input);if(result){rgba=[pInt(result[1]),pInt(result[2]),pInt(result[3]),1]}}}}}function get(format){var ret;if(stops){ret=merge(input);ret.stops=[].concat(ret.stops);each(stops,function(stop,i){ret.stops[i]=[ret.stops[i][0],stop.get(format)]})}else if(rgba&&!isNaN(rgba[0])){if(format==="rgb"){ret="rgb("+rgba[0]+","+rgba[1]+","+rgba[2]+")"}else if(format==="a"){ret=rgba[3]}else{ret="rgba("+rgba.join(",")+")"}}else{ret=input}return ret}function brighten(alpha){if(stops){each(stops,function(stop){stop.brighten(alpha)})}else if(isNumber(alpha)&&alpha!==0){var i;for(i=0;i<3;i++){rgba[i]+=pInt(alpha*255);if(rgba[i]<0){rgba[i]=0}if(rgba[i]>255){rgba[i]=255}}}return this}function setOpacity(alpha){rgba[3]=alpha;return this}init(input);return{get:get,brighten:brighten,rgba:rgba,setOpacity:setOpacity,raw:input}};function SVGElement(){}SVGElement.prototype={opacity:1,textProps:["fontSize","fontWeight","fontFamily","fontStyle","color","lineHeight","width","textDecoration","textShadow"],init:function(renderer,nodeName){var wrapper=this;wrapper.element=nodeName==="span"?createElement(nodeName):doc.createElementNS(SVG_NS,nodeName);wrapper.renderer=renderer},animate:function(params,options,complete){var animOptions=pick(options,globalAnimation,true);stop(this);if(animOptions){animOptions=merge(animOptions,{});if(complete){animOptions.complete=complete}animate(this,params,animOptions)}else{this.attr(params);if(complete){complete()}}return this},colorGradient:function(color,prop,elem){var renderer=this.renderer,colorObject,gradName,gradAttr,gradients,gradientObject,stops,stopColor,stopOpacity,radialReference,n,id,key=[];if(color.linearGradient){gradName="linearGradient"}else if(color.radialGradient){gradName="radialGradient"}if(gradName){gradAttr=color[gradName];gradients=renderer.gradients;stops=color.stops;radialReference=elem.radialReference;if(isArray(gradAttr)){color[gradName]=gradAttr={x1:gradAttr[0],y1:gradAttr[1],x2:gradAttr[2],y2:gradAttr[3],gradientUnits:"userSpaceOnUse"}}if(gradName==="radialGradient"&&radialReference&&!defined(gradAttr.gradientUnits)){gradAttr=merge(gradAttr,{cx:radialReference[0]-radialReference[2]/2+gradAttr.cx*radialReference[2],cy:radialReference[1]-radialReference[2]/2+gradAttr.cy*radialReference[2],r:gradAttr.r*radialReference[2],gradientUnits:"userSpaceOnUse"})}for(n in gradAttr){if(n!=="id"){key.push(n,gradAttr[n])}}for(n in stops){key.push(stops[n])}key=key.join(",");if(gradients[key]){id=gradients[key].attr("id")}else{gradAttr.id=id=PREFIX+idCounter++;gradients[key]=gradientObject=renderer.createElement(gradName).attr(gradAttr).add(renderer.defs);gradientObject.stops=[];each(stops,function(stop){var stopObject;if(stop[1].indexOf("rgba")===0){colorObject=Color(stop[1]);stopColor=colorObject.get("rgb");stopOpacity=colorObject.get("a")}else{stopColor=stop[1];stopOpacity=1}stopObject=renderer.createElement("stop").attr({offset:stop[0],"stop-color":stopColor,"stop-opacity":stopOpacity}).add(gradientObject);gradientObject.stops.push(stopObject)})}elem.setAttribute(prop,"url("+renderer.url+"#"+id+")")}},applyTextShadow:function(textShadow){var elem=this.element,tspans,hasContrast=textShadow.indexOf("contrast")!==-1,styles={},supports=this.renderer.forExport||elem.style.textShadow!==UNDEFINED&&!isIE;if(hasContrast){styles.textShadow=textShadow=textShadow.replace(/contrast/g,this.renderer.getContrast(elem.style.fill))}if(isWebKit){styles.textRendering="geometricPrecision"}if(supports){css(elem,styles)}else{this.fakeTS=true;this.ySetter=this.xSetter;tspans=[].slice.call(elem.getElementsByTagName("tspan"));each(textShadow.split(/\s?,\s?/g),function(textShadow){var firstChild=elem.firstChild,color,strokeWidth;textShadow=textShadow.split(" ");color=textShadow[textShadow.length-1];strokeWidth=textShadow[textShadow.length-2];if(strokeWidth){each(tspans,function(tspan,y){var clone;if(y===0){tspan.setAttribute("x",elem.getAttribute("x"));y=elem.getAttribute("y");tspan.setAttribute("y",y||0);if(y===null){elem.setAttribute("y",0)}}clone=tspan.cloneNode(1);attr(clone,{"class":PREFIX+"text-shadow",fill:color,stroke:color,"stroke-opacity":1/mathMax(pInt(strokeWidth),3),"stroke-width":strokeWidth,"stroke-linejoin":"round"});elem.insertBefore(clone,firstChild)})}})}},attr:function(hash,val){var key,value,element=this.element,hasSetSymbolSize,ret=this,skipAttr;if(typeof hash==="string"&&val!==UNDEFINED){key=hash;hash={};hash[key]=val}if(typeof hash==="string"){ret=(this[hash+"Getter"]||this._defaultGetter).call(this,hash,element)}else{for(key in hash){value=hash[key];skipAttr=false;if(this.symbolName&&/^(x|y|width|height|r|start|end|innerR|anchorX|anchorY)/.test(key)){if(!hasSetSymbolSize){this.symbolAttr(hash);hasSetSymbolSize=true}skipAttr=true}if(this.rotation&&(key==="x"||key==="y")){this.doTransform=true}if(!skipAttr){(this[key+"Setter"]||this._defaultSetter).call(this,value,key,element)}if(this.shadows&&/^(width|height|visibility|x|y|d|transform|cx|cy|r)$/.test(key)){this.updateShadows(key,value)}}if(this.doTransform){this.updateTransform();this.doTransform=false}}return ret},updateShadows:function(key,value){var shadows=this.shadows,i=shadows.length;while(i--){shadows[i].setAttribute(key,key==="height"?mathMax(value-(shadows[i].cutHeight||0),0):key==="d"?this.d:value)}},addClass:function(className){var element=this.element,currentClassName=attr(element,"class")||"";if(currentClassName.indexOf(className)===-1){attr(element,"class",currentClassName+" "+className)}return this},symbolAttr:function(hash){var wrapper=this;each(["x","y","r","start","end","width","height","innerR","anchorX","anchorY"],function(key){wrapper[key]=pick(hash[key],wrapper[key])});wrapper.attr({d:wrapper.renderer.symbols[wrapper.symbolName](wrapper.x,wrapper.y,wrapper.width,wrapper.height,wrapper)})},clip:function(clipRect){return this.attr("clip-path",clipRect?"url("+this.renderer.url+"#"+clipRect.id+")":NONE)},crisp:function(rect){var wrapper=this,key,attribs={},normalizer,strokeWidth=rect.strokeWidth||wrapper.strokeWidth||0;normalizer=mathRound(strokeWidth)%2/2;rect.x=mathFloor(rect.x||wrapper.x||0)+normalizer;rect.y=mathFloor(rect.y||wrapper.y||0)+normalizer;rect.width=mathFloor((rect.width||wrapper.width||0)-2*normalizer);rect.height=mathFloor((rect.height||wrapper.height||0)-2*normalizer);rect.strokeWidth=strokeWidth;for(key in rect){if(wrapper[key]!==rect[key]){wrapper[key]=attribs[key]=rect[key]}}return attribs},css:function(styles){var elemWrapper=this,oldStyles=elemWrapper.styles,newStyles={},elem=elemWrapper.element,textWidth,n,serializedCss="",hyphenate,hasNew=!oldStyles;if(styles&&styles.color){styles.fill=styles.color}if(oldStyles){for(n in styles){if(styles[n]!==oldStyles[n]){newStyles[n]=styles[n];hasNew=true}}}if(hasNew){textWidth=elemWrapper.textWidth=styles&&styles.width&&elem.nodeName.toLowerCase()==="text"&&pInt(styles.width)||elemWrapper.textWidth;if(oldStyles){styles=extend(oldStyles,newStyles)}elemWrapper.styles=styles;if(textWidth&&(useCanVG||!hasSVG&&elemWrapper.renderer.forExport)){delete styles.width}if(isIE&&!hasSVG){css(elemWrapper.element,styles)}else{hyphenate=function(a,b){return"-"+b.toLowerCase()};for(n in styles){serializedCss+=n.replace(/([A-Z])/g,hyphenate)+":"+styles[n]+";"}attr(elem,"style",serializedCss)}if(textWidth&&elemWrapper.added){elemWrapper.renderer.buildText(elemWrapper)}}return elemWrapper},on:function(eventType,handler){var svgElement=this,element=svgElement.element;if(hasTouch&&eventType==="click"){element.ontouchstart=function(e){svgElement.touchEventFired=Date.now();e.preventDefault();handler.call(element,e)};element.onclick=function(e){if(userAgent.indexOf("Android")===-1||Date.now()-(svgElement.touchEventFired||0)>1100){handler.call(element,e)}}}else{element["on"+eventType]=handler}return this},setRadialReference:function(coordinates){this.element.radialReference=coordinates;return this},translate:function(x,y){return this.attr({translateX:x,translateY:y})},invert:function(){var wrapper=this;wrapper.inverted=true;wrapper.updateTransform();return wrapper},updateTransform:function(){var wrapper=this,translateX=wrapper.translateX||0,translateY=wrapper.translateY||0,scaleX=wrapper.scaleX,scaleY=wrapper.scaleY,inverted=wrapper.inverted,rotation=wrapper.rotation,element=wrapper.element,transform;
if(inverted){translateX+=wrapper.attr("width");translateY+=wrapper.attr("height")}transform=["translate("+translateX+","+translateY+")"];if(inverted){transform.push("rotate(90) scale(-1,1)")}else if(rotation){transform.push("rotate("+rotation+" "+(element.getAttribute("x")||0)+" "+(element.getAttribute("y")||0)+")")}if(defined(scaleX)||defined(scaleY)){transform.push("scale("+pick(scaleX,1)+" "+pick(scaleY,1)+")")}if(transform.length){element.setAttribute("transform",transform.join(" "))}},toFront:function(){var element=this.element;element.parentNode.appendChild(element);return this},align:function(alignOptions,alignByTranslate,box){var align,vAlign,x,y,attribs={},alignTo,renderer=this.renderer,alignedObjects=renderer.alignedObjects;if(alignOptions){this.alignOptions=alignOptions;this.alignByTranslate=alignByTranslate;if(!box||isString(box)){this.alignTo=alignTo=box||"renderer";erase(alignedObjects,this);alignedObjects.push(this);box=null}}else{alignOptions=this.alignOptions;alignByTranslate=this.alignByTranslate;alignTo=this.alignTo}box=pick(box,renderer[alignTo],renderer);align=alignOptions.align;vAlign=alignOptions.verticalAlign;x=(box.x||0)+(alignOptions.x||0);y=(box.y||0)+(alignOptions.y||0);if(align==="right"||align==="center"){x+=(box.width-(alignOptions.width||0))/{right:1,center:2}[align]}attribs[alignByTranslate?"translateX":"x"]=mathRound(x);if(vAlign==="bottom"||vAlign==="middle"){y+=(box.height-(alignOptions.height||0))/({bottom:1,middle:2}[vAlign]||1)}attribs[alignByTranslate?"translateY":"y"]=mathRound(y);this[this.placed?"animate":"attr"](attribs);this.placed=true;this.alignAttr=attribs;return this},getBBox:function(reload){var wrapper=this,bBox,renderer=wrapper.renderer,width,height,rotation=wrapper.rotation,element=wrapper.element,styles=wrapper.styles,rad=rotation*deg2rad,textStr=wrapper.textStr,textShadow,elemStyle=element.style,toggleTextShadowShim,cacheKey;if(textStr!==UNDEFINED){cacheKey=["",rotation||0,styles&&styles.fontSize,element.style.width].join(",");if(textStr===""||numRegex.test(textStr)){cacheKey="num:"+textStr.toString().length+cacheKey}else{cacheKey=textStr+cacheKey}}if(cacheKey&&!reload){bBox=renderer.cache[cacheKey]}if(!bBox){if(element.namespaceURI===SVG_NS||renderer.forExport){try{toggleTextShadowShim=this.fakeTS&&function(display){each(element.querySelectorAll("."+PREFIX+"text-shadow"),function(tspan){tspan.style.display=display})};if(isFirefox&&elemStyle.textShadow){textShadow=elemStyle.textShadow;elemStyle.textShadow=""}else if(toggleTextShadowShim){toggleTextShadowShim(NONE)}bBox=element.getBBox?extend({},element.getBBox()):{width:element.offsetWidth,height:element.offsetHeight};if(textShadow){elemStyle.textShadow=textShadow}else if(toggleTextShadowShim){toggleTextShadowShim("")}}catch(e){}if(!bBox||bBox.width<0){bBox={width:0,height:0}}}else{bBox=wrapper.htmlGetBBox()}if(renderer.isSVG){width=bBox.width;height=bBox.height;if(isIE&&styles&&styles.fontSize==="11px"&&height.toPrecision(3)==="16.9"){bBox.height=height=14}if(rotation){bBox.width=mathAbs(height*mathSin(rad))+mathAbs(width*mathCos(rad));bBox.height=mathAbs(height*mathCos(rad))+mathAbs(width*mathSin(rad))}}renderer.cache[cacheKey]=bBox}return bBox},show:function(inherit){if(inherit&&this.element.namespaceURI===SVG_NS){this.element.removeAttribute("visibility")}else{this.attr({visibility:inherit?"inherit":VISIBLE})}return this},hide:function(){return this.attr({visibility:HIDDEN})},fadeOut:function(duration){var elemWrapper=this;elemWrapper.animate({opacity:0},{duration:duration||150,complete:function(){elemWrapper.attr({y:-9999})}})},add:function(parent){var renderer=this.renderer,element=this.element,inserted;if(parent){this.parentGroup=parent}this.parentInverted=parent&&parent.inverted;if(this.textStr!==undefined){renderer.buildText(this)}this.added=true;if(!parent||parent.handleZ||this.zIndex){inserted=this.zIndexSetter()}if(!inserted){(parent?parent.element:renderer.box).appendChild(element)}if(this.onAdd){this.onAdd()}return this},safeRemoveChild:function(element){var parentNode=element.parentNode;if(parentNode){parentNode.removeChild(element)}},destroy:function(){var wrapper=this,element=wrapper.element||{},shadows=wrapper.shadows,parentToClean=wrapper.renderer.isSVG&&element.nodeName==="SPAN"&&wrapper.parentGroup,grandParent,key,i;element.onclick=element.onmouseout=element.onmouseover=element.onmousemove=element.point=null;stop(wrapper);if(wrapper.clipPath){wrapper.clipPath=wrapper.clipPath.destroy()}if(wrapper.stops){for(i=0;i<wrapper.stops.length;i++){wrapper.stops[i]=wrapper.stops[i].destroy()}wrapper.stops=null}wrapper.safeRemoveChild(element);if(shadows){each(shadows,function(shadow){wrapper.safeRemoveChild(shadow)})}while(parentToClean&&parentToClean.div&&parentToClean.div.childNodes.length===0){grandParent=parentToClean.parentGroup;wrapper.safeRemoveChild(parentToClean.div);delete parentToClean.div;parentToClean=grandParent}if(wrapper.alignTo){erase(wrapper.renderer.alignedObjects,wrapper)}for(key in wrapper){delete wrapper[key]}return null},shadow:function(shadowOptions,group,cutOff){var shadows=[],i,shadow,element=this.element,strokeWidth,shadowWidth,shadowElementOpacity,transform;if(shadowOptions){shadowWidth=pick(shadowOptions.width,3);shadowElementOpacity=(shadowOptions.opacity||.15)/shadowWidth;transform=this.parentInverted?"(-1,-1)":"("+pick(shadowOptions.offsetX,1)+", "+pick(shadowOptions.offsetY,1)+")";for(i=1;i<=shadowWidth;i++){shadow=element.cloneNode(0);strokeWidth=shadowWidth*2+1-2*i;attr(shadow,{isShadow:"true",stroke:shadowOptions.color||"black","stroke-opacity":shadowElementOpacity*i,"stroke-width":strokeWidth,transform:"translate"+transform,fill:NONE});if(cutOff){attr(shadow,"height",mathMax(attr(shadow,"height")-strokeWidth,0));shadow.cutHeight=strokeWidth}if(group){group.element.appendChild(shadow)}else{element.parentNode.insertBefore(shadow,element)}shadows.push(shadow)}this.shadows=shadows}return this},xGetter:function(key){if(this.element.nodeName==="circle"){key={x:"cx",y:"cy"}[key]||key}return this._defaultGetter(key)},_defaultGetter:function(key){var ret=pick(this[key],this.element?this.element.getAttribute(key):null,0);if(/^[\-0-9\.]+$/.test(ret)){ret=parseFloat(ret)}return ret},dSetter:function(value,key,element){if(value&&value.join){value=value.join(" ")}if(/(NaN| {2}|^$)/.test(value)){value="M 0 0"}element.setAttribute(key,value);this[key]=value},dashstyleSetter:function(value){var i;value=value&&value.toLowerCase();if(value){value=value.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",");i=value.length;while(i--){value[i]=pInt(value[i])*this["stroke-width"]}value=value.join(",").replace("NaN","none");this.element.setAttribute("stroke-dasharray",value)}},alignSetter:function(value){this.element.setAttribute("text-anchor",{left:"start",center:"middle",right:"end"}[value])},opacitySetter:function(value,key,element){this[key]=value;element.setAttribute(key,value)},titleSetter:function(value){var titleNode=this.element.getElementsByTagName("title")[0];if(!titleNode){titleNode=doc.createElementNS(SVG_NS,"title");this.element.appendChild(titleNode)}titleNode.appendChild(doc.createTextNode(String(pick(value),"").replace(/<[^>]*>/g,"")))},textSetter:function(value){if(value!==this.textStr){delete this.bBox;this.textStr=value;if(this.added){this.renderer.buildText(this)}}},fillSetter:function(value,key,element){if(typeof value==="string"){element.setAttribute(key,value)}else if(value){this.colorGradient(value,key,element)}},zIndexSetter:function(value,key){var renderer=this.renderer,parentGroup=this.parentGroup,parentWrapper=parentGroup||renderer,parentNode=parentWrapper.element||renderer.box,childNodes,otherElement,otherZIndex,element=this.element,inserted,run=this.added,i;if(defined(value)){element.setAttribute(key,value);value=+value;if(this[key]===value){run=false}this[key]=value}if(run){value=this.zIndex;if(value&&parentGroup){parentGroup.handleZ=true}childNodes=parentNode.childNodes;for(i=0;i<childNodes.length&&!inserted;i++){otherElement=childNodes[i];otherZIndex=attr(otherElement,"zIndex");if(otherElement!==element&&(pInt(otherZIndex)>value||!defined(value)&&defined(otherZIndex))){parentNode.insertBefore(element,otherElement);inserted=true}}if(!inserted){parentNode.appendChild(element)}}return inserted},_defaultSetter:function(value,key,element){element.setAttribute(key,value)}};SVGElement.prototype.yGetter=SVGElement.prototype.xGetter;SVGElement.prototype.translateXSetter=SVGElement.prototype.translateYSetter=SVGElement.prototype.rotationSetter=SVGElement.prototype.verticalAlignSetter=SVGElement.prototype.scaleXSetter=SVGElement.prototype.scaleYSetter=function(value,key){this[key]=value;this.doTransform=true};SVGElement.prototype["stroke-widthSetter"]=SVGElement.prototype.strokeSetter=function(value,key,element){this[key]=value;if(this.stroke&&this["stroke-width"]){this.strokeWidth=this["stroke-width"];SVGElement.prototype.fillSetter.call(this,this.stroke,"stroke",element);element.setAttribute("stroke-width",this["stroke-width"]);this.hasStroke=true}else if(key==="stroke-width"&&value===0&&this.hasStroke){element.removeAttribute("stroke");this.hasStroke=false}};var SVGRenderer=function(){this.init.apply(this,arguments)};SVGRenderer.prototype={Element:SVGElement,init:function(container,width,height,style,forExport){var renderer=this,loc=location,boxWrapper,element,desc;boxWrapper=renderer.createElement("svg").attr({version:"1.1"}).css(this.getStyle(style));element=boxWrapper.element;container.appendChild(element);if(container.innerHTML.indexOf("xmlns")===-1){attr(element,"xmlns",SVG_NS)}renderer.isSVG=true;renderer.box=element;renderer.boxWrapper=boxWrapper;renderer.alignedObjects=[];renderer.url=(isFirefox||isWebKit)&&doc.getElementsByTagName("base").length?loc.href.replace(/#.*?$/,"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20"):"";desc=this.createElement("desc").add();desc.element.appendChild(doc.createTextNode("Created with "+PRODUCT+" "+VERSION));renderer.defs=this.createElement("defs").add();renderer.forExport=forExport;renderer.gradients={};renderer.cache={};renderer.setSize(width,height,false);var subPixelFix,rect;if(isFirefox&&container.getBoundingClientRect){renderer.subPixelFix=subPixelFix=function(){css(container,{left:0,top:0});rect=container.getBoundingClientRect();css(container,{left:mathCeil(rect.left)-rect.left+PX,top:mathCeil(rect.top)-rect.top+PX})};subPixelFix();addEvent(win,"resize",subPixelFix)}},getStyle:function(style){return this.style=extend({fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Arial, Helvetica, sans-serif',fontSize:"12px"},style)},isHidden:function(){return!this.boxWrapper.getBBox().width},destroy:function(){var renderer=this,rendererDefs=renderer.defs;renderer.box=null;renderer.boxWrapper=renderer.boxWrapper.destroy();destroyObjectProperties(renderer.gradients||{});renderer.gradients=null;if(rendererDefs){renderer.defs=rendererDefs.destroy()}if(renderer.subPixelFix){removeEvent(win,"resize",renderer.subPixelFix)}renderer.alignedObjects=null;return null},createElement:function(nodeName){var wrapper=new this.Element;wrapper.init(this,nodeName);return wrapper},draw:function(){},buildText:function(wrapper){var textNode=wrapper.element,renderer=this,forExport=renderer.forExport,textStr=pick(wrapper.textStr,"").toString(),hasMarkup=textStr.indexOf("<")!==-1,lines,childNodes=textNode.childNodes,styleRegex,hrefRegex,parentX=attr(textNode,"x"),textStyles=wrapper.styles,width=wrapper.textWidth,textLineHeight=textStyles&&textStyles.lineHeight,textShadow=textStyles&&textStyles.textShadow,ellipsis=textStyles&&textStyles.textOverflow==="ellipsis",i=childNodes.length,tempParent=width&&!wrapper.added&&this.box,getLineHeight=function(tspan){return textLineHeight?pInt(textLineHeight):renderer.fontMetrics(/(px|em)$/.test(tspan&&tspan.style.fontSize)?tspan.style.fontSize:textStyles&&textStyles.fontSize||renderer.style.fontSize||12,tspan).h},unescapeAngleBrackets=function(inputStr){return inputStr.replace(/&lt;/g,"<").replace(/&gt;/g,">")};while(i--){textNode.removeChild(childNodes[i])}if(!hasMarkup&&!textShadow&&!ellipsis&&textStr.indexOf(" ")===-1){textNode.appendChild(doc.createTextNode(unescapeAngleBrackets(textStr)));return}else{styleRegex=/<.*style="([^"]+)".*>/;hrefRegex=/<.*href="(http[^"]+)".*>/;if(tempParent){tempParent.appendChild(textNode)}if(hasMarkup){lines=textStr.replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br.*?>/g)}else{lines=[textStr]}if(lines[lines.length-1]===""){lines.pop()}each(lines,function(line,lineNo){var spans,spanNo=0;line=line.replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||");spans=line.split("|||");each(spans,function(span){if(span!==""||spans.length===1){var attributes={},tspan=doc.createElementNS(SVG_NS,"tspan"),spanStyle;if(styleRegex.test(span)){spanStyle=span.match(styleRegex)[1].replace(/(;| |^)color([ :])/,"$1fill$2");attr(tspan,"style",spanStyle)}if(hrefRegex.test(span)&&!forExport){attr(tspan,"onclick",'location.href="'+span.match(hrefRegex)[1]+'"');css(tspan,{cursor:"pointer"})}span=unescapeAngleBrackets(span.replace(/<(.|\n)*?>/g,"")||" ");if(span!==" "){tspan.appendChild(doc.createTextNode(span));if(!spanNo){if(lineNo&&parentX!==null){attributes.x=parentX}}else{attributes.dx=0}attr(tspan,attributes);textNode.appendChild(tspan);if(!spanNo&&lineNo){if(!hasSVG&&forExport){css(tspan,{display:"block"})}attr(tspan,"dy",getLineHeight(tspan))}if(width){var words=span.replace(/([^\^])-/g,"$1- ").split(" "),hasWhiteSpace=spans.length>1||lineNo||words.length>1&&textStyles.whiteSpace!=="nowrap",tooLong,wasTooLong,actualWidth,rest=[],dy=getLineHeight(tspan),softLineNo=1,rotation=wrapper.rotation,wordStr=span,cursor=wordStr.length,bBox;while((hasWhiteSpace||ellipsis)&&(words.length||rest.length)){wrapper.rotation=0;bBox=wrapper.getBBox(true);actualWidth=bBox.width;if(!hasSVG&&renderer.forExport){actualWidth=renderer.measureSpanWidth(tspan.firstChild.data,wrapper.styles)}tooLong=actualWidth>width;if(wasTooLong===undefined){wasTooLong=tooLong}if(ellipsis&&wasTooLong){cursor/=2;if(wordStr===""||!tooLong&&cursor<.5){words=[]}else{if(tooLong){wasTooLong=true}wordStr=span.substring(0,wordStr.length+(tooLong?-1:1)*mathCeil(cursor));words=[wordStr+(width>3?"":"")];tspan.removeChild(tspan.firstChild)}}else if(!tooLong||words.length===1){words=rest;rest=[];if(words.length){softLineNo++;tspan=doc.createElementNS(SVG_NS,"tspan");attr(tspan,{dy:dy,x:parentX});if(spanStyle){attr(tspan,"style",spanStyle)}textNode.appendChild(tspan)}if(actualWidth>width){width=actualWidth}}else{tspan.removeChild(tspan.firstChild);rest.unshift(words.pop())}if(words.length){tspan.appendChild(doc.createTextNode(words.join(" ").replace(/- /g,"-")))}}if(wasTooLong){wrapper.attr("title",wrapper.textStr)}wrapper.rotation=rotation}spanNo++}}})});if(tempParent){tempParent.removeChild(textNode)}if(textShadow&&wrapper.applyTextShadow){wrapper.applyTextShadow(textShadow)}}},getContrast:function(color){color=Color(color).rgba;return color[0]+color[1]+color[2]>384?"#000000":"#FFFFFF"},button:function(text,x,y,callback,normalState,hoverState,pressedState,disabledState,shape){var label=this.label(text,x,y,shape,null,null,null,null,"button"),curState=0,stateOptions,stateStyle,normalStyle,hoverStyle,pressedStyle,disabledStyle,verticalGradient={x1:0,y1:0,x2:0,y2:1};normalState=merge({"stroke-width":1,stroke:"#CCCCCC",fill:{linearGradient:verticalGradient,stops:[[0,"#FEFEFE"],[1,"#F6F6F6"]]},r:2,padding:5,style:{color:"black"}},normalState);normalStyle=normalState.style;delete normalState.style;hoverState=merge(normalState,{stroke:"#68A",fill:{linearGradient:verticalGradient,stops:[[0,"#FFF"],[1,"#ACF"]]}},hoverState);hoverStyle=hoverState.style;delete hoverState.style;pressedState=merge(normalState,{stroke:"#68A",fill:{linearGradient:verticalGradient,stops:[[0,"#9BD"],[1,"#CDF"]]}},pressedState);pressedStyle=pressedState.style;delete pressedState.style;disabledState=merge(normalState,{style:{color:"#CCC"}},disabledState);disabledStyle=disabledState.style;delete disabledState.style;addEvent(label.element,isIE?"mouseover":"mouseenter",function(){if(curState!==3){label.attr(hoverState).css(hoverStyle)}});addEvent(label.element,isIE?"mouseout":"mouseleave",function(){if(curState!==3){stateOptions=[normalState,hoverState,pressedState][curState];stateStyle=[normalStyle,hoverStyle,pressedStyle][curState];label.attr(stateOptions).css(stateStyle)}});label.setState=function(state){label.state=curState=state;if(!state){label.attr(normalState).css(normalStyle)}else if(state===2){label.attr(pressedState).css(pressedStyle)}else if(state===3){label.attr(disabledState).css(disabledStyle)}};return label.on("click",function(){if(curState!==3){callback.call(label)}}).attr(normalState).css(extend({cursor:"default"},normalStyle))},crispLine:function(points,width){if(points[1]===points[4]){points[1]=points[4]=mathRound(points[1])-width%2/2}if(points[2]===points[5]){points[2]=points[5]=mathRound(points[2])+width%2/2}return points},path:function(path){var attr={fill:NONE};if(isArray(path)){attr.d=path}else if(isObject(path)){extend(attr,path)}return this.createElement("path").attr(attr)},circle:function(x,y,r){var attr=isObject(x)?x:{x:x,y:y,r:r},wrapper=this.createElement("circle");wrapper.xSetter=function(value){this.element.setAttribute("cx",value)};wrapper.ySetter=function(value){this.element.setAttribute("cy",value)};return wrapper.attr(attr)},arc:function(x,y,r,innerR,start,end){var arc;if(isObject(x)){y=x.y;r=x.r;innerR=x.innerR;start=x.start;end=x.end;x=x.x}arc=this.symbol("arc",x||0,y||0,r||0,r||0,{innerR:innerR||0,start:start||0,end:end||0});arc.r=r;return arc},rect:function(x,y,width,height,r,strokeWidth){r=isObject(x)?x.r:r;var wrapper=this.createElement("rect"),attribs=isObject(x)?x:x===UNDEFINED?{}:{x:x,y:y,width:mathMax(width,0),height:mathMax(height,0)};if(strokeWidth!==UNDEFINED){attribs.strokeWidth=strokeWidth;attribs=wrapper.crisp(attribs)}if(r){attribs.r=r}wrapper.rSetter=function(value){attr(this.element,{rx:value,ry:value})};return wrapper.attr(attribs)},setSize:function(width,height,animate){var renderer=this,alignedObjects=renderer.alignedObjects,i=alignedObjects.length;renderer.width=width;renderer.height=height;renderer.boxWrapper[pick(animate,true)?"animate":"attr"]({width:width,height:height});while(i--){alignedObjects[i].align()}},g:function(name){var elem=this.createElement("g");return defined(name)?elem.attr({"class":PREFIX+name}):elem},image:function(src,x,y,width,height){var attribs={preserveAspectRatio:NONE},elemWrapper;if(arguments.length>1){extend(attribs,{x:x,y:y,width:width,height:height})}elemWrapper=this.createElement("image").attr(attribs);if(elemWrapper.element.setAttributeNS){elemWrapper.element.setAttributeNS("http://www.w3.org/1999/xlink","href",src)}else{elemWrapper.element.setAttribute("hc-svg-href",src)}return elemWrapper},symbol:function(symbol,x,y,width,height,options){var obj,symbolFn=this.symbols[symbol],path=symbolFn&&symbolFn(mathRound(x),mathRound(y),width,height,options),imageElement,imageRegex=/^url\((.*?)\)$/,imageSrc,imageSize,centerImage;if(path){obj=this.path(path);extend(obj,{symbolName:symbol,x:x,y:y,width:width,height:height});if(options){extend(obj,options)}}else if(imageRegex.test(symbol)){centerImage=function(img,size){if(img.element){img.attr({width:size[0],height:size[1]});if(!img.alignByTranslate){img.translate(mathRound((width-size[0])/2),mathRound((height-size[1])/2))}}};imageSrc=symbol.match(imageRegex)[1];imageSize=symbolSizes[imageSrc]||options&&options.width&&options.height&&[options.width,options.height];obj=this.image(imageSrc).attr({x:x,y:y});obj.isImg=true;if(imageSize){centerImage(obj,imageSize)}else{obj.attr({width:0,height:0});imageElement=createElement("img",{onload:function(){centerImage(obj,symbolSizes[imageSrc]=[this.width,this.height])},src:imageSrc})}}return obj},symbols:{circle:function(x,y,w,h){var cpw=.166*w;return[M,x+w/2,y,"C",x+w+cpw,y,x+w+cpw,y+h,x+w/2,y+h,"C",x-cpw,y+h,x-cpw,y,x+w/2,y,"Z"]},square:function(x,y,w,h){return[M,x,y,L,x+w,y,x+w,y+h,x,y+h,"Z"]},triangle:function(x,y,w,h){return[M,x+w/2,y,L,x+w,y+h,x,y+h,"Z"]},"triangle-down":function(x,y,w,h){return[M,x,y,L,x+w,y,x+w/2,y+h,"Z"]},diamond:function(x,y,w,h){return[M,x+w/2,y,L,x+w,y+h/2,x+w/2,y+h,x,y+h/2,"Z"]},arc:function(x,y,w,h,options){var start=options.start,radius=options.r||w||h,end=options.end-.001,innerRadius=options.innerR,open=options.open,cosStart=mathCos(start),sinStart=mathSin(start),cosEnd=mathCos(end),sinEnd=mathSin(end),longArc=options.end-start<mathPI?0:1;return[M,x+radius*cosStart,y+radius*sinStart,"A",radius,radius,0,longArc,1,x+radius*cosEnd,y+radius*sinEnd,open?M:L,x+innerRadius*cosEnd,y+innerRadius*sinEnd,"A",innerRadius,innerRadius,0,longArc,0,x+innerRadius*cosStart,y+innerRadius*sinStart,open?"":"Z"]},callout:function(x,y,w,h,options){var arrowLength=6,halfDistance=6,r=mathMin(options&&options.r||0,w,h),safeDistance=r+halfDistance,anchorX=options&&options.anchorX,anchorY=options&&options.anchorY,path;path=["M",x+r,y,"L",x+w-r,y,"C",x+w,y,x+w,y,x+w,y+r,"L",x+w,y+h-r,"C",x+w,y+h,x+w,y+h,x+w-r,y+h,"L",x+r,y+h,"C",x,y+h,x,y+h,x,y+h-r,"L",x,y+r,"C",x,y,x,y,x+r,y];if(anchorX&&anchorX>w&&anchorY>y+safeDistance&&anchorY<y+h-safeDistance){path.splice(13,3,"L",x+w,anchorY-halfDistance,x+w+arrowLength,anchorY,x+w,anchorY+halfDistance,x+w,y+h-r)}else if(anchorX&&anchorX<0&&anchorY>y+safeDistance&&anchorY<y+h-safeDistance){path.splice(33,3,"L",x,anchorY+halfDistance,x-arrowLength,anchorY,x,anchorY-halfDistance,x,y+r)}else if(anchorY&&anchorY>h&&anchorX>x+safeDistance&&anchorX<x+w-safeDistance){path.splice(23,3,"L",anchorX+halfDistance,y+h,anchorX,y+h+arrowLength,anchorX-halfDistance,y+h,x+r,y+h)}else if(anchorY&&anchorY<0&&anchorX>x+safeDistance&&anchorX<x+w-safeDistance){path.splice(3,3,"L",anchorX-halfDistance,y,anchorX,y-arrowLength,anchorX+halfDistance,y,w-r,y)}return path}},clipRect:function(x,y,width,height){var wrapper,id=PREFIX+idCounter++,clipPath=this.createElement("clipPath").attr({id:id}).add(this.defs);wrapper=this.rect(x,y,width,height,0).add(clipPath);wrapper.id=id;wrapper.clipPath=clipPath;wrapper.count=0;return wrapper},text:function(str,x,y,useHTML){var renderer=this,fakeSVG=useCanVG||!hasSVG&&renderer.forExport,wrapper,attr={};if(useHTML&&!renderer.forExport){return renderer.html(str,x,y)}attr.x=Math.round(x||0);if(y){attr.y=Math.round(y)}if(str||str===0){attr.text=str}wrapper=renderer.createElement("text").attr(attr);if(fakeSVG){wrapper.css({position:ABSOLUTE})}if(!useHTML){wrapper.xSetter=function(value,key,element){var tspans=element.getElementsByTagName("tspan"),tspan,parentVal=element.getAttribute(key),i;for(i=0;i<tspans.length;i++){tspan=tspans[i];if(tspan.getAttribute(key)===parentVal){tspan.setAttribute(key,value)}}element.setAttribute(key,value)}}return wrapper},fontMetrics:function(fontSize,elem){var lineHeight,baseline,style;fontSize=fontSize||this.style.fontSize;if(elem&&win.getComputedStyle){elem=elem.element||elem;style=win.getComputedStyle(elem,"");fontSize=style&&style.fontSize}fontSize=/px/.test(fontSize)?pInt(fontSize):/em/.test(fontSize)?parseFloat(fontSize)*12:12;lineHeight=fontSize<24?fontSize+3:mathRound(fontSize*1.2);baseline=mathRound(lineHeight*.8);return{h:lineHeight,b:baseline,f:fontSize}},rotCorr:function(baseline,rotation,alterY){var y=baseline;if(rotation&&alterY){y=mathMax(y*mathCos(rotation*deg2rad),4)}return{x:-baseline/3*mathSin(rotation*deg2rad),y:y}},label:function(str,x,y,shape,anchorX,anchorY,useHTML,baseline,className){var renderer=this,wrapper=renderer.g(className),text=renderer.text("",0,0,useHTML).attr({zIndex:1}),box,bBox,alignFactor=0,padding=3,paddingLeft=0,width,height,wrapperX,wrapperY,crispAdjust=0,deferredAttr={},baselineOffset,needsBox;function updateBoxSize(){var boxX,boxY,style=text.element.style;bBox=(width===undefined||height===undefined||wrapper.styles.textAlign)&&defined(text.textStr)&&text.getBBox();wrapper.width=(width||bBox.width||0)+2*padding+paddingLeft;wrapper.height=(height||bBox.height||0)+2*padding;baselineOffset=padding+renderer.fontMetrics(style&&style.fontSize,text).b;if(needsBox){if(!box){boxX=mathRound(-alignFactor*padding)+crispAdjust;boxY=(baseline?-baselineOffset:0)+crispAdjust;wrapper.box=box=shape?renderer.symbol(shape,boxX,boxY,wrapper.width,wrapper.height,deferredAttr):renderer.rect(boxX,boxY,wrapper.width,wrapper.height,0,deferredAttr[STROKE_WIDTH]);box.attr("fill",NONE).add(wrapper)}if(!box.isImg){box.attr(extend({width:mathRound(wrapper.width),height:mathRound(wrapper.height)},deferredAttr))}deferredAttr=null}}function updateTextPadding(){var styles=wrapper.styles,textAlign=styles&&styles.textAlign,x=paddingLeft+padding*(1-alignFactor),y;y=baseline?0:baselineOffset;if(defined(width)&&bBox&&(textAlign==="center"||textAlign==="right")){x+={center:.5,right:1}[textAlign]*(width-bBox.width)}if(x!==text.x||y!==text.y){text.attr("x",x);if(y!==UNDEFINED){text.attr("y",y)}}text.x=x;text.y=y}function boxAttr(key,value){if(box){box.attr(key,value)}else{deferredAttr[key]=value}}wrapper.onAdd=function(){text.add(wrapper);wrapper.attr({text:str||str===0?str:"",x:x,y:y});if(box&&defined(anchorX)){wrapper.attr({anchorX:anchorX,anchorY:anchorY})}};wrapper.widthSetter=function(value){width=value};wrapper.heightSetter=function(value){height=value};wrapper.paddingSetter=function(value){if(defined(value)&&value!==padding){padding=wrapper.padding=value;updateTextPadding()}};wrapper.paddingLeftSetter=function(value){if(defined(value)&&value!==paddingLeft){paddingLeft=value;updateTextPadding()}};wrapper.alignSetter=function(value){alignFactor={left:0,center:.5,right:1}[value]};wrapper.textSetter=function(value){if(value!==UNDEFINED){text.textSetter(value)}updateBoxSize();updateTextPadding()};wrapper["stroke-widthSetter"]=function(value,key){if(value){needsBox=true}crispAdjust=value%2/2;boxAttr(key,value)};wrapper.strokeSetter=wrapper.fillSetter=wrapper.rSetter=function(value,key){if(key==="fill"&&value){needsBox=true}boxAttr(key,value)};wrapper.anchorXSetter=function(value,key){anchorX=value;boxAttr(key,mathRound(value)-crispAdjust-wrapperX)};wrapper.anchorYSetter=function(value,key){anchorY=value;boxAttr(key,value-wrapperY)};wrapper.xSetter=function(value){wrapper.x=value;if(alignFactor){value-=alignFactor*((width||bBox.width)+padding)}wrapperX=mathRound(value);wrapper.attr("translateX",wrapperX)};wrapper.ySetter=function(value){wrapperY=wrapper.y=mathRound(value);wrapper.attr("translateY",wrapperY)};var baseCss=wrapper.css;return extend(wrapper,{css:function(styles){if(styles){var textStyles={};styles=merge(styles);each(wrapper.textProps,function(prop){if(styles[prop]!==UNDEFINED){textStyles[prop]=styles[prop];delete styles[prop]}});text.css(textStyles)}return baseCss.call(wrapper,styles)},getBBox:function(){return{width:bBox.width+2*padding,height:bBox.height+2*padding,x:bBox.x-padding,y:bBox.y-padding}},shadow:function(b){if(box){box.shadow(b)}return wrapper},destroy:function(){removeEvent(wrapper.element,"mouseenter");removeEvent(wrapper.element,"mouseleave");if(text){text=text.destroy()}if(box){box=box.destroy()}SVGElement.prototype.destroy.call(wrapper);wrapper=renderer=updateBoxSize=updateTextPadding=boxAttr=null}})}};Renderer=SVGRenderer;extend(SVGElement.prototype,{htmlCss:function(styles){var wrapper=this,element=wrapper.element,textWidth=styles&&element.tagName==="SPAN"&&styles.width;if(textWidth){delete styles.width;wrapper.textWidth=textWidth;wrapper.updateTransform()}if(styles&&styles.textOverflow==="ellipsis"){styles.whiteSpace="nowrap";styles.overflow="hidden"}wrapper.styles=extend(wrapper.styles,styles);css(wrapper.element,styles);return wrapper},htmlGetBBox:function(){var wrapper=this,element=wrapper.element;if(element.nodeName==="text"){element.style.position=ABSOLUTE}return{x:element.offsetLeft,y:element.offsetTop,width:element.offsetWidth,height:element.offsetHeight}},htmlUpdateTransform:function(){if(!this.added){this.alignOnAdd=true;return}var wrapper=this,renderer=wrapper.renderer,elem=wrapper.element,translateX=wrapper.translateX||0,translateY=wrapper.translateY||0,x=wrapper.x||0,y=wrapper.y||0,align=wrapper.textAlign||"left",alignCorrection={left:0,center:.5,right:1}[align],shadows=wrapper.shadows,styles=wrapper.styles;css(elem,{marginLeft:translateX,marginTop:translateY});if(shadows){each(shadows,function(shadow){css(shadow,{marginLeft:translateX+1,marginTop:translateY+1})})}if(wrapper.inverted){each(elem.childNodes,function(child){renderer.invertChild(child,elem)})}if(elem.tagName==="SPAN"){var width,rotation=wrapper.rotation,baseline,textWidth=pInt(wrapper.textWidth),currentTextTransform=[rotation,align,elem.innerHTML,wrapper.textWidth].join(",");if(currentTextTransform!==wrapper.cTT){baseline=renderer.fontMetrics(elem.style.fontSize).b;if(defined(rotation)){wrapper.setSpanRotation(rotation,alignCorrection,baseline)}width=pick(wrapper.elemWidth,elem.offsetWidth);if(width>textWidth&&/[ \-]/.test(elem.textContent||elem.innerText)){css(elem,{width:textWidth+PX,display:"block",whiteSpace:styles&&styles.whiteSpace||"normal"});width=textWidth}wrapper.getSpanCorrection(width,baseline,alignCorrection,rotation,align)}css(elem,{left:x+(wrapper.xCorr||0)+PX,top:y+(wrapper.yCorr||0)+PX});if(isWebKit){baseline=elem.offsetHeight}wrapper.cTT=currentTextTransform}},setSpanRotation:function(rotation,alignCorrection,baseline){var rotationStyle={},cssTransformKey=isIE?"-ms-transform":isWebKit?"-webkit-transform":isFirefox?"MozTransform":isOpera?"-o-transform":"";rotationStyle[cssTransformKey]=rotationStyle.transform="rotate("+rotation+"deg)";rotationStyle[cssTransformKey+(isFirefox?"Origin":"-origin")]=rotationStyle.transformOrigin=alignCorrection*100+"% "+baseline+"px";css(this.element,rotationStyle)},getSpanCorrection:function(width,baseline,alignCorrection){this.xCorr=-width*alignCorrection;this.yCorr=-baseline}});extend(SVGRenderer.prototype,{html:function(str,x,y){var wrapper=this.createElement("span"),element=wrapper.element,renderer=wrapper.renderer;wrapper.textSetter=function(value){if(value!==element.innerHTML){delete this.bBox}element.innerHTML=this.textStr=value};wrapper.xSetter=wrapper.ySetter=wrapper.alignSetter=wrapper.rotationSetter=function(value,key){if(key==="align"){key="textAlign"}wrapper[key]=value;wrapper.htmlUpdateTransform()};wrapper.attr({text:str,x:mathRound(x),y:mathRound(y)}).css({position:ABSOLUTE,fontFamily:this.style.fontFamily,fontSize:this.style.fontSize});element.style.whiteSpace="nowrap";wrapper.css=wrapper.htmlCss;if(renderer.isSVG){wrapper.add=function(svgGroupWrapper){var htmlGroup,container=renderer.box.parentNode,parentGroup,parents=[];this.parentGroup=svgGroupWrapper;if(svgGroupWrapper){htmlGroup=svgGroupWrapper.div;if(!htmlGroup){parentGroup=svgGroupWrapper;while(parentGroup){parents.push(parentGroup);parentGroup=parentGroup.parentGroup}each(parents.reverse(),function(parentGroup){var htmlGroupStyle,cls=attr(parentGroup.element,"class");if(cls){cls={className:cls}}htmlGroup=parentGroup.div=parentGroup.div||createElement(DIV,cls,{position:ABSOLUTE,left:(parentGroup.translateX||0)+PX,top:(parentGroup.translateY||0)+PX},htmlGroup||container);htmlGroupStyle=htmlGroup.style;extend(parentGroup,{translateXSetter:function(value,key){htmlGroupStyle.left=value+PX;parentGroup[key]=value;parentGroup.doTransform=true},translateYSetter:function(value,key){htmlGroupStyle.top=value+PX;parentGroup[key]=value;parentGroup.doTransform=true},visibilitySetter:function(value,key){htmlGroupStyle[key]=value}})})}}else{htmlGroup=container}htmlGroup.appendChild(element);wrapper.added=true;if(wrapper.alignOnAdd){wrapper.htmlUpdateTransform()}return wrapper}}
return wrapper}});var VMLRenderer,VMLElement;if(!hasSVG&&!useCanVG){VMLElement={init:function(renderer,nodeName){var wrapper=this,markup=["<",nodeName,' filled="f" stroked="f"'],style=["position: ",ABSOLUTE,";"],isDiv=nodeName===DIV;if(nodeName==="shape"||isDiv){style.push("left:0;top:0;width:1px;height:1px;")}style.push("visibility: ",isDiv?HIDDEN:VISIBLE);markup.push(' style="',style.join(""),'"/>');if(nodeName){markup=isDiv||nodeName==="span"||nodeName==="img"?markup.join(""):renderer.prepVML(markup);wrapper.element=createElement(markup)}wrapper.renderer=renderer},add:function(parent){var wrapper=this,renderer=wrapper.renderer,element=wrapper.element,box=renderer.box,inverted=parent&&parent.inverted,parentNode=parent?parent.element||parent:box;if(inverted){renderer.invertChild(element,parentNode)}parentNode.appendChild(element);wrapper.added=true;if(wrapper.alignOnAdd&&!wrapper.deferUpdateTransform){wrapper.updateTransform()}if(wrapper.onAdd){wrapper.onAdd()}return wrapper},updateTransform:SVGElement.prototype.htmlUpdateTransform,setSpanRotation:function(){var rotation=this.rotation,costheta=mathCos(rotation*deg2rad),sintheta=mathSin(rotation*deg2rad);css(this.element,{filter:rotation?["progid:DXImageTransform.Microsoft.Matrix(M11=",costheta,", M12=",-sintheta,", M21=",sintheta,", M22=",costheta,", sizingMethod='auto expand')"].join(""):NONE})},getSpanCorrection:function(width,baseline,alignCorrection,rotation,align){var costheta=rotation?mathCos(rotation*deg2rad):1,sintheta=rotation?mathSin(rotation*deg2rad):0,height=pick(this.elemHeight,this.element.offsetHeight),quad,nonLeft=align&&align!=="left";this.xCorr=costheta<0&&-width;this.yCorr=sintheta<0&&-height;quad=costheta*sintheta<0;this.xCorr+=sintheta*baseline*(quad?1-alignCorrection:alignCorrection);this.yCorr-=costheta*baseline*(rotation?quad?alignCorrection:1-alignCorrection:1);if(nonLeft){this.xCorr-=width*alignCorrection*(costheta<0?-1:1);if(rotation){this.yCorr-=height*alignCorrection*(sintheta<0?-1:1)}css(this.element,{textAlign:align})}},pathToVML:function(value){var i=value.length,path=[];while(i--){if(isNumber(value[i])){path[i]=mathRound(value[i]*10)-5}else if(value[i]==="Z"){path[i]="x"}else{path[i]=value[i];if(value.isArc&&(value[i]==="wa"||value[i]==="at")){if(path[i+5]===path[i+7]){path[i+7]+=value[i+7]>value[i+5]?1:-1}if(path[i+6]===path[i+8]){path[i+8]+=value[i+8]>value[i+6]?1:-1}}}}return path.join(" ")||"x"},clip:function(clipRect){var wrapper=this,clipMembers,cssRet;if(clipRect){clipMembers=clipRect.members;erase(clipMembers,wrapper);clipMembers.push(wrapper);wrapper.destroyClip=function(){erase(clipMembers,wrapper)};cssRet=clipRect.getCSS(wrapper)}else{if(wrapper.destroyClip){wrapper.destroyClip()}cssRet={clip:docMode8?"inherit":"rect(auto)"}}return wrapper.css(cssRet)},css:SVGElement.prototype.htmlCss,safeRemoveChild:function(element){if(element.parentNode){discardElement(element)}},destroy:function(){if(this.destroyClip){this.destroyClip()}return SVGElement.prototype.destroy.apply(this)},on:function(eventType,handler){this.element["on"+eventType]=function(){var evt=win.event;evt.target=evt.srcElement;handler(evt)};return this},cutOffPath:function(path,length){var len;path=path.split(/[ ,]/);len=path.length;if(len===9||len===11){path[len-4]=path[len-2]=pInt(path[len-2])-10*length}return path.join(" ")},shadow:function(shadowOptions,group,cutOff){var shadows=[],i,element=this.element,renderer=this.renderer,shadow,elemStyle=element.style,markup,path=element.path,strokeWidth,modifiedPath,shadowWidth,shadowElementOpacity;if(path&&typeof path.value!=="string"){path="x"}modifiedPath=path;if(shadowOptions){shadowWidth=pick(shadowOptions.width,3);shadowElementOpacity=(shadowOptions.opacity||.15)/shadowWidth;for(i=1;i<=3;i++){strokeWidth=shadowWidth*2+1-2*i;if(cutOff){modifiedPath=this.cutOffPath(path.value,strokeWidth+.5)}markup=['<shape isShadow="true" strokeweight="',strokeWidth,'" filled="false" path="',modifiedPath,'" coordsize="10 10" style="',element.style.cssText,'" />'];shadow=createElement(renderer.prepVML(markup),null,{left:pInt(elemStyle.left)+pick(shadowOptions.offsetX,1),top:pInt(elemStyle.top)+pick(shadowOptions.offsetY,1)});if(cutOff){shadow.cutOff=strokeWidth+1}markup=['<stroke color="',shadowOptions.color||"black",'" opacity="',shadowElementOpacity*i,'"/>'];createElement(renderer.prepVML(markup),null,null,shadow);if(group){group.element.appendChild(shadow)}else{element.parentNode.insertBefore(shadow,element)}shadows.push(shadow)}this.shadows=shadows}return this},updateShadows:noop,setAttr:function(key,value){if(docMode8){this.element[key]=value}else{this.element.setAttribute(key,value)}},classSetter:function(value){this.element.className=value},dashstyleSetter:function(value,key,element){var strokeElem=element.getElementsByTagName("stroke")[0]||createElement(this.renderer.prepVML(["<stroke/>"]),null,null,element);strokeElem[key]=value||"solid";this[key]=value},dSetter:function(value,key,element){var i,shadows=this.shadows;value=value||[];this.d=value.join&&value.join(" ");element.path=value=this.pathToVML(value);if(shadows){i=shadows.length;while(i--){shadows[i].path=shadows[i].cutOff?this.cutOffPath(value,shadows[i].cutOff):value}}this.setAttr(key,value)},fillSetter:function(value,key,element){var nodeName=element.nodeName;if(nodeName==="SPAN"){element.style.color=value}else if(nodeName!=="IMG"){element.filled=value!==NONE;this.setAttr("fillcolor",this.renderer.color(value,element,key,this))}},opacitySetter:noop,rotationSetter:function(value,key,element){var style=element.style;this[key]=style[key]=value;style.left=-mathRound(mathSin(value*deg2rad)+1)+PX;style.top=mathRound(mathCos(value*deg2rad))+PX},strokeSetter:function(value,key,element){this.setAttr("strokecolor",this.renderer.color(value,element,key))},"stroke-widthSetter":function(value,key,element){element.stroked=!!value;this[key]=value;if(isNumber(value)){value+=PX}this.setAttr("strokeweight",value)},titleSetter:function(value,key){this.setAttr(key,value)},visibilitySetter:function(value,key,element){if(value==="inherit"){value=VISIBLE}if(this.shadows){each(this.shadows,function(shadow){shadow.style[key]=value})}if(element.nodeName==="DIV"){value=value===HIDDEN?"-999em":0;if(!docMode8){element.style[key]=value?VISIBLE:HIDDEN}key="top"}element.style[key]=value},xSetter:function(value,key,element){this[key]=value;if(key==="x"){key="left"}else if(key==="y"){key="top"}if(this.updateClipping){this[key]=value;this.updateClipping()}else{element.style[key]=value}},zIndexSetter:function(value,key,element){element.style[key]=value}};Highcharts.VMLElement=VMLElement=extendClass(SVGElement,VMLElement);VMLElement.prototype.ySetter=VMLElement.prototype.widthSetter=VMLElement.prototype.heightSetter=VMLElement.prototype.xSetter;var VMLRendererExtension={Element:VMLElement,isIE8:userAgent.indexOf("MSIE 8.0")>-1,init:function(container,width,height,style){var renderer=this,boxWrapper,box,css;renderer.alignedObjects=[];boxWrapper=renderer.createElement(DIV).css(extend(this.getStyle(style),{position:RELATIVE}));box=boxWrapper.element;container.appendChild(boxWrapper.element);renderer.isVML=true;renderer.box=box;renderer.boxWrapper=boxWrapper;renderer.cache={};renderer.setSize(width,height,false);if(!doc.namespaces.hcv){doc.namespaces.add("hcv","urn:schemas-microsoft-com:vml");css="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke"+"{ behavior:url(#default#VML); display: inline-block; } ";try{doc.createStyleSheet().cssText=css}catch(e){doc.styleSheets[0].cssText+=css}}},isHidden:function(){return!this.box.offsetWidth},clipRect:function(x,y,width,height){var clipRect=this.createElement(),isObj=isObject(x);return extend(clipRect,{members:[],count:0,left:(isObj?x.x:x)+1,top:(isObj?x.y:y)+1,width:(isObj?x.width:width)-1,height:(isObj?x.height:height)-1,getCSS:function(wrapper){var element=wrapper.element,nodeName=element.nodeName,isShape=nodeName==="shape",inverted=wrapper.inverted,rect=this,top=rect.top-(isShape?element.offsetTop:0),left=rect.left,right=left+rect.width,bottom=top+rect.height,ret={clip:"rect("+mathRound(inverted?left:top)+"px,"+mathRound(inverted?bottom:right)+"px,"+mathRound(inverted?right:bottom)+"px,"+mathRound(inverted?top:left)+"px)"};if(!inverted&&docMode8&&nodeName==="DIV"){extend(ret,{width:right+PX,height:bottom+PX})}return ret},updateClipping:function(){each(clipRect.members,function(member){if(member.element){member.css(clipRect.getCSS(member))}})}})},color:function(color,elem,prop,wrapper){var renderer=this,colorObject,regexRgba=/^rgba/,markup,fillType,ret=NONE;if(color&&color.linearGradient){fillType="gradient"}else if(color&&color.radialGradient){fillType="pattern"}if(fillType){var stopColor,stopOpacity,gradient=color.linearGradient||color.radialGradient,x1,y1,x2,y2,opacity1,opacity2,color1,color2,fillAttr="",stops=color.stops,firstStop,lastStop,colors=[],addFillNode=function(){markup=['<fill colors="'+colors.join(",")+'" opacity="',opacity2,'" o:opacity2="',opacity1,'" type="',fillType,'" ',fillAttr,'focus="100%" method="any" />'];createElement(renderer.prepVML(markup),null,null,elem)};firstStop=stops[0];lastStop=stops[stops.length-1];if(firstStop[0]>0){stops.unshift([0,firstStop[1]])}if(lastStop[0]<1){stops.push([1,lastStop[1]])}each(stops,function(stop,i){if(regexRgba.test(stop[1])){colorObject=Color(stop[1]);stopColor=colorObject.get("rgb");stopOpacity=colorObject.get("a")}else{stopColor=stop[1];stopOpacity=1}colors.push(stop[0]*100+"% "+stopColor);if(!i){opacity1=stopOpacity;color2=stopColor}else{opacity2=stopOpacity;color1=stopColor}});if(prop==="fill"){if(fillType==="gradient"){x1=gradient.x1||gradient[0]||0;y1=gradient.y1||gradient[1]||0;x2=gradient.x2||gradient[2]||0;y2=gradient.y2||gradient[3]||0;fillAttr='angle="'+(90-math.atan((y2-y1)/(x2-x1))*180/mathPI)+'"';addFillNode()}else{var r=gradient.r,sizex=r*2,sizey=r*2,cx=gradient.cx,cy=gradient.cy,radialReference=elem.radialReference,bBox,applyRadialGradient=function(){if(radialReference){bBox=wrapper.getBBox();cx+=(radialReference[0]-bBox.x)/bBox.width-.5;cy+=(radialReference[1]-bBox.y)/bBox.height-.5;sizex*=radialReference[2]/bBox.width;sizey*=radialReference[2]/bBox.height}fillAttr='src="'+defaultOptions.global.VMLRadialGradientURL+'" '+'size="'+sizex+","+sizey+'" '+'origin="0.5,0.5" '+'position="'+cx+","+cy+'" '+'color2="'+color2+'" ';addFillNode()};if(wrapper.added){applyRadialGradient()}else{wrapper.onAdd=applyRadialGradient}ret=color1}}else{ret=stopColor}}else if(regexRgba.test(color)&&elem.tagName!=="IMG"){colorObject=Color(color);markup=["<",prop,' opacity="',colorObject.get("a"),'"/>'];createElement(this.prepVML(markup),null,null,elem);ret=colorObject.get("rgb")}else{var propNodes=elem.getElementsByTagName(prop);if(propNodes.length){propNodes[0].opacity=1;propNodes[0].type="solid"}ret=color}return ret},prepVML:function(markup){var vmlStyle="display:inline-block;behavior:url(#default#VML);",isIE8=this.isIE8;markup=markup.join("");if(isIE8){markup=markup.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />');if(markup.indexOf('style="')===-1){markup=markup.replace("/>",' style="'+vmlStyle+'" />')}else{markup=markup.replace('style="','style="'+vmlStyle)}}else{markup=markup.replace("<","<hcv:")}return markup},text:SVGRenderer.prototype.html,path:function(path){var attr={coordsize:"10 10"};if(isArray(path)){attr.d=path}else if(isObject(path)){extend(attr,path)}return this.createElement("shape").attr(attr)},circle:function(x,y,r){var circle=this.symbol("circle");if(isObject(x)){r=x.r;y=x.y;x=x.x}circle.isCircle=true;circle.r=r;return circle.attr({x:x,y:y})},g:function(name){var wrapper,attribs;if(name){attribs={className:PREFIX+name,"class":PREFIX+name}}wrapper=this.createElement(DIV).attr(attribs);return wrapper},image:function(src,x,y,width,height){var obj=this.createElement("img").attr({src:src});if(arguments.length>1){obj.attr({x:x,y:y,width:width,height:height})}return obj},createElement:function(nodeName){return nodeName==="rect"?this.symbol(nodeName):SVGRenderer.prototype.createElement.call(this,nodeName)},invertChild:function(element,parentNode){var ren=this,parentStyle=parentNode.style,imgStyle=element.tagName==="IMG"&&element.style;css(element,{flip:"x",left:pInt(parentStyle.width)-(imgStyle?pInt(imgStyle.top):1),top:pInt(parentStyle.height)-(imgStyle?pInt(imgStyle.left):1),rotation:-90});each(element.childNodes,function(child){ren.invertChild(child,element)})},symbols:{arc:function(x,y,w,h,options){var start=options.start,end=options.end,radius=options.r||w||h,innerRadius=options.innerR,cosStart=mathCos(start),sinStart=mathSin(start),cosEnd=mathCos(end),sinEnd=mathSin(end),ret;if(end-start===0){return["x"]}ret=["wa",x-radius,y-radius,x+radius,y+radius,x+radius*cosStart,y+radius*sinStart,x+radius*cosEnd,y+radius*sinEnd];if(options.open&&!innerRadius){ret.push("e",M,x,y)}ret.push("at",x-innerRadius,y-innerRadius,x+innerRadius,y+innerRadius,x+innerRadius*cosEnd,y+innerRadius*sinEnd,x+innerRadius*cosStart,y+innerRadius*sinStart,"x","e");ret.isArc=true;return ret},circle:function(x,y,w,h,wrapper){if(wrapper){w=h=2*wrapper.r}if(wrapper&&wrapper.isCircle){x-=w/2;y-=h/2}return["wa",x,y,x+w,y+h,x+w,y+h/2,x+w,y+h/2,"e"]},rect:function(x,y,w,h,options){return SVGRenderer.prototype.symbols[!defined(options)||!options.r?"square":"callout"].call(0,x,y,w,h,options)}}};Highcharts.VMLRenderer=VMLRenderer=function(){this.init.apply(this,arguments)};VMLRenderer.prototype=merge(SVGRenderer.prototype,VMLRendererExtension);Renderer=VMLRenderer}SVGRenderer.prototype.measureSpanWidth=function(text,styles){var measuringSpan=doc.createElement("span"),offsetWidth,textNode=doc.createTextNode(text);measuringSpan.appendChild(textNode);css(measuringSpan,styles);this.box.appendChild(measuringSpan);offsetWidth=measuringSpan.offsetWidth;discardElement(measuringSpan);return offsetWidth};var CanVGRenderer,CanVGController;if(useCanVG){Highcharts.CanVGRenderer=CanVGRenderer=function(){SVG_NS="http://www.w3.org/1999/xhtml"};CanVGRenderer.prototype.symbols={};CanVGController=function(){var deferredRenderCalls=[];function drawDeferred(){var callLength=deferredRenderCalls.length,callIndex;for(callIndex=0;callIndex<callLength;callIndex++){deferredRenderCalls[callIndex]()}deferredRenderCalls=[]}return{push:function(func,scriptLocation){if(deferredRenderCalls.length===0){getScript(scriptLocation,drawDeferred)}deferredRenderCalls.push(func)}}}();Renderer=CanVGRenderer}function Tick(axis,pos,type,noLabel){this.axis=axis;this.pos=pos;this.type=type||"";this.isNew=true;if(!type&&!noLabel){this.addLabel()}}Tick.prototype={addLabel:function(){var tick=this,axis=tick.axis,options=axis.options,chart=axis.chart,categories=axis.categories,names=axis.names,pos=tick.pos,labelOptions=options.labels,str,tickPositions=axis.tickPositions,isFirst=pos===tickPositions[0],isLast=pos===tickPositions[tickPositions.length-1],value=categories?pick(categories[pos],names[pos],pos):pos,label=tick.label,tickPositionInfo=tickPositions.info,dateTimeLabelFormat;if(axis.isDatetimeAxis&&tickPositionInfo){dateTimeLabelFormat=options.dateTimeLabelFormats[tickPositionInfo.higherRanks[pos]||tickPositionInfo.unitName]}tick.isFirst=isFirst;tick.isLast=isLast;str=axis.labelFormatter.call({axis:axis,chart:chart,isFirst:isFirst,isLast:isLast,dateTimeLabelFormat:dateTimeLabelFormat,value:axis.isLog?correctFloat(lin2log(value)):value});if(!defined(label)){tick.label=label=defined(str)&&labelOptions.enabled?chart.renderer.text(str,0,0,labelOptions.useHTML).css(merge(labelOptions.style)).add(axis.labelGroup):null;tick.labelLength=label&&label.getBBox().width;tick.rotation=0}else if(label){label.attr({text:str})}},getLabelSize:function(){return this.label?this.label.getBBox()[this.axis.horiz?"height":"width"]:0},handleOverflow:function(xy){var axis=this.axis,pxPos=xy.x,chartWidth=axis.chart.chartWidth,spacing=axis.chart.spacing,leftBound=pick(axis.labelLeft,mathMin(axis.pos,spacing[3])),rightBound=pick(axis.labelRight,mathMax(axis.pos+axis.len,chartWidth-spacing[1])),label=this.label,rotation=this.rotation,factor={left:0,center:.5,right:1}[axis.labelAlign],labelWidth=label.getBBox().width,slotWidth=axis.slotWidth,xCorrection=factor,goRight=1,leftPos,rightPos,textWidth,css={};if(!rotation){leftPos=pxPos-factor*labelWidth;rightPos=pxPos+(1-factor)*labelWidth;if(leftPos<leftBound){slotWidth=xy.x+slotWidth*(1-factor)-leftBound}else if(rightPos>rightBound){slotWidth=rightBound-xy.x+slotWidth*factor;goRight=-1}slotWidth=mathMin(axis.slotWidth,slotWidth);if(slotWidth<axis.slotWidth&&axis.labelAlign==="center"){xy.x+=goRight*(axis.slotWidth-slotWidth-xCorrection*(axis.slotWidth-mathMin(labelWidth,slotWidth)))}if(labelWidth>slotWidth||axis.autoRotation&&label.styles.width){textWidth=slotWidth}}else if(rotation<0&&pxPos-factor*labelWidth<leftBound){textWidth=mathRound(pxPos/mathCos(rotation*deg2rad)-leftBound)}else if(rotation>0&&pxPos+factor*labelWidth>rightBound){textWidth=mathRound((chartWidth-pxPos)/mathCos(rotation*deg2rad))}if(textWidth){css.width=textWidth;if(!axis.options.labels.style.textOverflow){css.textOverflow="ellipsis"}label.css(css)}},getPosition:function(horiz,pos,tickmarkOffset,old){var axis=this.axis,chart=axis.chart,cHeight=old&&chart.oldChartHeight||chart.chartHeight;return{x:horiz?axis.translate(pos+tickmarkOffset,null,null,old)+axis.transB:axis.left+axis.offset+(axis.opposite?(old&&chart.oldChartWidth||chart.chartWidth)-axis.right-axis.left:0),y:horiz?cHeight-axis.bottom+axis.offset-(axis.opposite?axis.height:0):cHeight-axis.translate(pos+tickmarkOffset,null,null,old)-axis.transB}},getLabelPosition:function(x,y,label,horiz,labelOptions,tickmarkOffset,index,step){var axis=this.axis,transA=axis.transA,reversed=axis.reversed,staggerLines=axis.staggerLines,rotCorr=axis.tickRotCorr||{x:0,y:0},yOffset=pick(labelOptions.y,rotCorr.y+(axis.side===2?8:-(label.getBBox().height/2))),line;x=x+labelOptions.x+rotCorr.x-(tickmarkOffset&&horiz?tickmarkOffset*transA*(reversed?-1:1):0);y=y+yOffset-(tickmarkOffset&&!horiz?tickmarkOffset*transA*(reversed?1:-1):0);if(staggerLines){line=index/(step||1)%staggerLines;y+=line*(axis.labelOffset/staggerLines)}return{x:x,y:mathRound(y)}},getMarkPath:function(x,y,tickLength,tickWidth,horiz,renderer){return renderer.crispLine([M,x,y,L,x+(horiz?0:-tickLength),y+(horiz?tickLength:0)],tickWidth)},render:function(index,old,opacity){var tick=this,axis=tick.axis,options=axis.options,chart=axis.chart,renderer=chart.renderer,horiz=axis.horiz,type=tick.type,label=tick.label,pos=tick.pos,labelOptions=options.labels,gridLine=tick.gridLine,gridPrefix=type?type+"Grid":"grid",tickPrefix=type?type+"Tick":"tick",gridLineWidth=options[gridPrefix+"LineWidth"],gridLineColor=options[gridPrefix+"LineColor"],dashStyle=options[gridPrefix+"LineDashStyle"],tickLength=options[tickPrefix+"Length"],tickWidth=options[tickPrefix+"Width"]||0,tickColor=options[tickPrefix+"Color"],tickPosition=options[tickPrefix+"Position"],gridLinePath,mark=tick.mark,markPath,step=labelOptions.step,attribs,show=true,tickmarkOffset=axis.tickmarkOffset,xy=tick.getPosition(horiz,pos,tickmarkOffset,old),x=xy.x,y=xy.y,reverseCrisp=horiz&&x===axis.pos+axis.len||!horiz&&y===axis.pos?-1:1;opacity=pick(opacity,1);this.isActive=true;if(gridLineWidth){gridLinePath=axis.getPlotLinePath(pos+tickmarkOffset,gridLineWidth*reverseCrisp,old,true);if(gridLine===UNDEFINED){attribs={stroke:gridLineColor,"stroke-width":gridLineWidth};if(dashStyle){attribs.dashstyle=dashStyle}if(!type){attribs.zIndex=1}if(old){attribs.opacity=0}tick.gridLine=gridLine=gridLineWidth?renderer.path(gridLinePath).attr(attribs).add(axis.gridGroup):null}if(!old&&gridLine&&gridLinePath){gridLine[tick.isNew?"attr":"animate"]({d:gridLinePath,opacity:opacity})}}if(tickWidth&&tickLength){if(tickPosition==="inside"){tickLength=-tickLength}if(axis.opposite){tickLength=-tickLength}markPath=tick.getMarkPath(x,y,tickLength,tickWidth*reverseCrisp,horiz,renderer);if(mark){mark.animate({d:markPath,opacity:opacity})}else{tick.mark=renderer.path(markPath).attr({stroke:tickColor,"stroke-width":tickWidth,opacity:opacity}).add(axis.axisGroup)}}if(label&&!isNaN(x)){label.xy=xy=tick.getLabelPosition(x,y,label,horiz,labelOptions,tickmarkOffset,index,step);if(tick.isFirst&&!tick.isLast&&!pick(options.showFirstLabel,1)||tick.isLast&&!tick.isFirst&&!pick(options.showLastLabel,1)){show=false}else if(horiz&&!axis.isRadial&&!labelOptions.step&&!labelOptions.rotation&&!old&&opacity!==0){tick.handleOverflow(xy)}if(step&&index%step){show=false}if(show&&!isNaN(xy.y)){xy.opacity=opacity;label[tick.isNew?"attr":"animate"](xy);tick.isNew=false}else{label.attr("y",-9999)}}},destroy:function(){destroyObjectProperties(this,this.axis)}};Highcharts.PlotLineOrBand=function(axis,options){this.axis=axis;if(options){this.options=options;this.id=options.id}};Highcharts.PlotLineOrBand.prototype={render:function(){var plotLine=this,axis=plotLine.axis,horiz=axis.horiz,options=plotLine.options,optionsLabel=options.label,label=plotLine.label,width=options.width,to=options.to,from=options.from,isBand=defined(from)&&defined(to),value=options.value,dashStyle=options.dashStyle,svgElem=plotLine.svgElem,path=[],addEvent,eventType,xs,ys,x,y,color=options.color,zIndex=options.zIndex,events=options.events,attribs={},renderer=axis.chart.renderer;if(axis.isLog){from=log2lin(from);to=log2lin(to);value=log2lin(value)}if(width){path=axis.getPlotLinePath(value,width);attribs={stroke:color,"stroke-width":width};if(dashStyle){attribs.dashstyle=dashStyle}}else if(isBand){path=axis.getPlotBandPath(from,to,options);if(color){attribs.fill=color}if(options.borderWidth){attribs.stroke=options.borderColor;attribs["stroke-width"]=options.borderWidth}}else{return}if(defined(zIndex)){attribs.zIndex=zIndex}if(svgElem){if(path){svgElem.animate({d:path},null,svgElem.onGetPath)}else{svgElem.hide();svgElem.onGetPath=function(){svgElem.show()};if(label){plotLine.label=label=label.destroy()}}}else if(path&&path.length){plotLine.svgElem=svgElem=renderer.path(path).attr(attribs).add();if(events){addEvent=function(eventType){svgElem.on(eventType,function(e){events[eventType].apply(plotLine,[e])})};for(eventType in events){addEvent(eventType)}}}if(optionsLabel&&defined(optionsLabel.text)&&path&&path.length&&axis.width>0&&axis.height>0){optionsLabel=merge({align:horiz&&isBand&&"center",x:horiz?!isBand&&4:10,verticalAlign:!horiz&&isBand&&"middle",y:horiz?isBand?16:10:isBand?6:-4,rotation:horiz&&!isBand&&90},optionsLabel);if(!label){attribs={align:optionsLabel.textAlign||optionsLabel.align,rotation:optionsLabel.rotation};if(defined(zIndex)){attribs.zIndex=zIndex}plotLine.label=label=renderer.text(optionsLabel.text,0,0,optionsLabel.useHTML).attr(attribs).css(optionsLabel.style).add()}xs=[path[1],path[4],isBand?path[6]:path[1]];ys=[path[2],path[5],isBand?path[7]:path[2]];x=arrayMin(xs);y=arrayMin(ys);label.align(optionsLabel,false,{x:x,y:y,width:arrayMax(xs)-x,height:arrayMax(ys)-y});label.show()}else if(label){label.hide()}return plotLine},destroy:function(){erase(this.axis.plotLinesAndBands,this);delete this.axis;destroyObjectProperties(this)}};AxisPlotLineOrBandExtension={getPlotBandPath:function(from,to){var toPath=this.getPlotLinePath(to,null,null,true),path=this.getPlotLinePath(from,null,null,true);if(path&&toPath&&path.toString()!==toPath.toString()){path.push(toPath[4],toPath[5],toPath[1],toPath[2])}else{path=null}return path},addPlotBand:function(options){return this.addPlotBandOrLine(options,"plotBands")},addPlotLine:function(options){return this.addPlotBandOrLine(options,"plotLines")},addPlotBandOrLine:function(options,coll){var obj=new Highcharts.PlotLineOrBand(this,options).render(),userOptions=this.userOptions;if(obj){if(coll){userOptions[coll]=userOptions[coll]||[];userOptions[coll].push(options)}this.plotLinesAndBands.push(obj)}return obj},removePlotBandOrLine:function(id){var plotLinesAndBands=this.plotLinesAndBands,options=this.options,userOptions=this.userOptions,i=plotLinesAndBands.length;while(i--){if(plotLinesAndBands[i].id===id){plotLinesAndBands[i].destroy()}}each([options.plotLines||[],userOptions.plotLines||[],options.plotBands||[],userOptions.plotBands||[]],function(arr){i=arr.length;while(i--){if(arr[i].id===id){erase(arr,arr[i])}}})}};var Axis=Highcharts.Axis=function(){this.init.apply(this,arguments)};Axis.prototype={defaultOptions:{dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:false,gridLineColor:"#D8D8D8",labels:{enabled:true,style:{color:"#606060",cursor:"default",fontSize:"11px"},x:0,y:15},lineColor:"#C0D0E0",lineWidth:1,minPadding:.01,maxPadding:.01,minorGridLineColor:"#E0E0E0",minorGridLineWidth:1,minorTickColor:"#A0A0A0",minorTickLength:2,minorTickPosition:"outside",startOfWeek:1,startOnTick:false,tickColor:"#C0D0E0",tickLength:10,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",tickWidth:1,title:{align:"middle",style:{color:"#707070"}},type:"linear"},defaultYAxisOptions:{endOnTick:true,gridLineWidth:1,tickPixelInterval:72,showLastLabel:true,labels:{x:-8,y:3},lineWidth:0,maxPadding:.05,minPadding:.05,startOnTick:true,tickWidth:0,title:{rotation:270,text:"Values"},stackLabels:{enabled:false,formatter:function(){return Highcharts.numberFormat(this.total,-1)},style:merge(defaultPlotOptions.line.dataLabels.style,{color:"#000000"})}},defaultLeftAxisOptions:{labels:{x:-15,y:null},title:{rotation:270}},defaultRightAxisOptions:{labels:{x:15,y:null},title:{rotation:90}},defaultBottomAxisOptions:{labels:{autoRotation:[-45],x:0,y:null},title:{rotation:0}},defaultTopAxisOptions:{labels:{autoRotation:[-45],x:0,y:-15},title:{rotation:0}},init:function(chart,userOptions){var isXAxis=userOptions.isX,axis=this;axis.horiz=chart.inverted?!isXAxis:isXAxis;axis.isXAxis=isXAxis;axis.coll=isXAxis?"xAxis":"yAxis";axis.opposite=userOptions.opposite;axis.side=userOptions.side||(axis.horiz?axis.opposite?0:2:axis.opposite?1:3);axis.setOptions(userOptions);var options=this.options,type=options.type,isDatetimeAxis=type==="datetime";axis.labelFormatter=options.labels.formatter||axis.defaultLabelFormatter;axis.userOptions=userOptions;axis.minPixelPadding=0;axis.chart=chart;axis.reversed=options.reversed;axis.zoomEnabled=options.zoomEnabled!==false;axis.categories=options.categories||type==="category";axis.names=axis.names||[];axis.isLog=type==="logarithmic";axis.isDatetimeAxis=isDatetimeAxis;axis.isLinked=defined(options.linkedTo);axis.ticks={};axis.labelEdge=[];axis.minorTicks={};axis.plotLinesAndBands=[];axis.alternateBands={};axis.len=0;axis.minRange=axis.userMinRange=options.minRange||options.maxZoom;axis.range=options.range;axis.offset=options.offset||0;axis.stacks={};axis.oldStacks={};axis.max=null;axis.min=null;axis.crosshair=pick(options.crosshair,splat(chart.options.tooltip.crosshairs)[isXAxis?0:1],false);var eventType,events=axis.options.events;if(inArray(axis,chart.axes)===-1){if(isXAxis&&!this.isColorAxis){chart.axes.splice(chart.xAxis.length,0,axis)}else{chart.axes.push(axis)}chart[axis.coll].push(axis)}axis.series=axis.series||[];if(chart.inverted&&isXAxis&&axis.reversed===UNDEFINED){axis.reversed=true}axis.removePlotBand=axis.removePlotBandOrLine;axis.removePlotLine=axis.removePlotBandOrLine;for(eventType in events){addEvent(axis,eventType,events[eventType])}if(axis.isLog){axis.val2lin=log2lin;axis.lin2val=lin2log}},setOptions:function(userOptions){this.options=merge(this.defaultOptions,this.isXAxis?{}:this.defaultYAxisOptions,[this.defaultTopAxisOptions,this.defaultRightAxisOptions,this.defaultBottomAxisOptions,this.defaultLeftAxisOptions][this.side],merge(defaultOptions[this.coll],userOptions))},defaultLabelFormatter:function(){var axis=this.axis,value=this.value,categories=axis.categories,dateTimeLabelFormat=this.dateTimeLabelFormat,numericSymbols=defaultOptions.lang.numericSymbols,i=numericSymbols&&numericSymbols.length,multi,ret,formatOption=axis.options.labels.format,numericSymbolDetector=axis.isLog?value:axis.tickInterval;if(formatOption){ret=format(formatOption,this)}else if(categories){ret=value}else if(dateTimeLabelFormat){ret=dateFormat(dateTimeLabelFormat,value)}else if(i&&numericSymbolDetector>=1e3){while(i--&&ret===UNDEFINED){multi=Math.pow(1e3,i+1);if(numericSymbolDetector>=multi&&value*10%multi===0&&numericSymbols[i]!==null){ret=Highcharts.numberFormat(value/multi,-1)+numericSymbols[i]}}}if(ret===UNDEFINED){if(mathAbs(value)>=1e4){ret=Highcharts.numberFormat(value,-1)}else{ret=Highcharts.numberFormat(value,-1,UNDEFINED,"")}}return ret},getSeriesExtremes:function(){var axis=this,chart=axis.chart;axis.hasVisibleSeries=false;axis.dataMin=axis.dataMax=axis.ignoreMinPadding=axis.ignoreMaxPadding=null;if(axis.buildStacks){axis.buildStacks()}each(axis.series,function(series){if(series.visible||!chart.options.chart.ignoreHiddenSeries){var seriesOptions=series.options,xData,threshold=seriesOptions.threshold,seriesDataMin,seriesDataMax;axis.hasVisibleSeries=true;if(axis.isLog&&threshold<=0){threshold=null}if(axis.isXAxis){xData=series.xData;if(xData.length){axis.dataMin=mathMin(pick(axis.dataMin,xData[0]),arrayMin(xData));axis.dataMax=mathMax(pick(axis.dataMax,xData[0]),arrayMax(xData))}}else{series.getExtremes();seriesDataMax=series.dataMax;seriesDataMin=series.dataMin;if(defined(seriesDataMin)&&defined(seriesDataMax)){axis.dataMin=mathMin(pick(axis.dataMin,seriesDataMin),seriesDataMin);axis.dataMax=mathMax(pick(axis.dataMax,seriesDataMax),seriesDataMax)}if(defined(threshold)){if(axis.dataMin>=threshold){axis.dataMin=threshold;axis.ignoreMinPadding=true}else if(axis.dataMax<threshold){axis.dataMax=threshold;axis.ignoreMaxPadding=true}}}}})},translate:function(val,backwards,cvsCoord,old,handleLog,pointPlacement){var axis=this.linkedParent||this,sign=1,cvsOffset=0,localA=old?axis.oldTransA:axis.transA,localMin=old?axis.oldMin:axis.min,returnValue,minPixelPadding=axis.minPixelPadding,doPostTranslate=(axis.doPostTranslate||axis.isLog&&handleLog)&&axis.lin2val;if(!localA){localA=axis.transA}if(cvsCoord){sign*=-1;cvsOffset=axis.len}if(axis.reversed){sign*=-1;cvsOffset-=sign*(axis.sector||axis.len)}if(backwards){val=val*sign+cvsOffset;val-=minPixelPadding;returnValue=val/localA+localMin;if(doPostTranslate){returnValue=axis.lin2val(returnValue)}}else{if(doPostTranslate){val=axis.val2lin(val)}if(pointPlacement==="between"){pointPlacement=.5}returnValue=sign*(val-localMin)*localA+cvsOffset+sign*minPixelPadding+(isNumber(pointPlacement)?localA*pointPlacement*axis.pointRange:0)}return returnValue},toPixels:function(value,paneCoordinates){return this.translate(value,false,!this.horiz,null,true)+(paneCoordinates?0:this.pos)},toValue:function(pixel,paneCoordinates){return this.translate(pixel-(paneCoordinates?0:this.pos),true,!this.horiz,null,true)},getPlotLinePath:function(value,lineWidth,old,force,translatedValue){var axis=this,chart=axis.chart,axisLeft=axis.left,axisTop=axis.top,x1,y1,x2,y2,cHeight=old&&chart.oldChartHeight||chart.chartHeight,cWidth=old&&chart.oldChartWidth||chart.chartWidth,skip,transB=axis.transB,between=function(x,a,b){if(x<a||x>b){if(force){x=mathMin(mathMax(a,x),b)}else{skip=true}}return x};translatedValue=pick(translatedValue,axis.translate(value,null,null,old));x1=x2=mathRound(translatedValue+transB);y1=y2=mathRound(cHeight-translatedValue-transB);if(isNaN(translatedValue)){skip=true}else if(axis.horiz){y1=axisTop;y2=cHeight-axis.bottom;x1=x2=between(x1,axisLeft,axisLeft+axis.width)}else{x1=axisLeft;x2=cWidth-axis.right;y1=y2=between(y1,axisTop,axisTop+axis.height)}return skip&&!force?null:chart.renderer.crispLine([M,x1,y1,L,x2,y2],lineWidth||1)},getLinearTickPositions:function(tickInterval,min,max){var pos,lastPos,roundedMin=correctFloat(mathFloor(min/tickInterval)*tickInterval),roundedMax=correctFloat(mathCeil(max/tickInterval)*tickInterval),tickPositions=[];if(min===max&&isNumber(min)){return[min]}pos=roundedMin;while(pos<=roundedMax){tickPositions.push(pos);pos=correctFloat(pos+tickInterval);if(pos===lastPos){break}lastPos=pos;
}return tickPositions},getMinorTickPositions:function(){var axis=this,options=axis.options,tickPositions=axis.tickPositions,minorTickInterval=axis.minorTickInterval,minorTickPositions=[],pos,i,min=axis.min,max=axis.max,range=max-min,len;if(range&&range/minorTickInterval<axis.len/3){if(axis.isLog){len=tickPositions.length;for(i=1;i<len;i++){minorTickPositions=minorTickPositions.concat(axis.getLogTickPositions(minorTickInterval,tickPositions[i-1],tickPositions[i],true))}}else if(axis.isDatetimeAxis&&options.minorTickInterval==="auto"){minorTickPositions=minorTickPositions.concat(axis.getTimeTicks(axis.normalizeTimeTickInterval(minorTickInterval),min,max,options.startOfWeek))}else{for(pos=min+(tickPositions[0]-min)%minorTickInterval;pos<=max;pos+=minorTickInterval){minorTickPositions.push(pos)}}}axis.trimTicks(minorTickPositions);return minorTickPositions},adjustForMinRange:function(){var axis=this,options=axis.options,min=axis.min,max=axis.max,zoomOffset,spaceAvailable=axis.dataMax-axis.dataMin>=axis.minRange,closestDataRange,i,distance,xData,loopLength,minArgs,maxArgs;if(axis.isXAxis&&axis.minRange===UNDEFINED&&!axis.isLog){if(defined(options.min)||defined(options.max)){axis.minRange=null}else{each(axis.series,function(series){xData=series.xData;loopLength=series.xIncrement?1:xData.length-1;for(i=loopLength;i>0;i--){distance=xData[i]-xData[i-1];if(closestDataRange===UNDEFINED||distance<closestDataRange){closestDataRange=distance}}});axis.minRange=mathMin(closestDataRange*5,axis.dataMax-axis.dataMin)}}if(max-min<axis.minRange){var minRange=axis.minRange;zoomOffset=(minRange-max+min)/2;minArgs=[min-zoomOffset,pick(options.min,min-zoomOffset)];if(spaceAvailable){minArgs[2]=axis.dataMin}min=arrayMax(minArgs);maxArgs=[min+minRange,pick(options.max,min+minRange)];if(spaceAvailable){maxArgs[2]=axis.dataMax}max=arrayMin(maxArgs);if(max-min<minRange){minArgs[0]=max-minRange;minArgs[1]=pick(options.min,max-minRange);min=arrayMax(minArgs)}}axis.min=min;axis.max=max},setAxisTranslation:function(saveOld){var axis=this,range=axis.max-axis.min,pointRange=axis.axisPointRange||0,closestPointRange,minPointOffset=0,pointRangePadding=0,linkedParent=axis.linkedParent,ordinalCorrection,hasCategories=!!axis.categories,transA=axis.transA,isXAxis=axis.isXAxis;if(isXAxis||hasCategories||pointRange){if(linkedParent){minPointOffset=linkedParent.minPointOffset;pointRangePadding=linkedParent.pointRangePadding}else{each(axis.series,function(series){var seriesPointRange=hasCategories?1:isXAxis?series.pointRange:axis.axisPointRange||0,pointPlacement=series.options.pointPlacement,seriesClosestPointRange=series.closestPointRange;if(seriesPointRange>range){seriesPointRange=0}pointRange=mathMax(pointRange,seriesPointRange);if(!axis.single){minPointOffset=mathMax(minPointOffset,isString(pointPlacement)?0:seriesPointRange/2);pointRangePadding=mathMax(pointRangePadding,pointPlacement==="on"?0:seriesPointRange)}if(!series.noSharedTooltip&&defined(seriesClosestPointRange)){closestPointRange=defined(closestPointRange)?mathMin(closestPointRange,seriesClosestPointRange):seriesClosestPointRange}})}ordinalCorrection=axis.ordinalSlope&&closestPointRange?axis.ordinalSlope/closestPointRange:1;axis.minPointOffset=minPointOffset=minPointOffset*ordinalCorrection;axis.pointRangePadding=pointRangePadding=pointRangePadding*ordinalCorrection;axis.pointRange=mathMin(pointRange,range);if(isXAxis){axis.closestPointRange=closestPointRange}}if(saveOld){axis.oldTransA=transA}axis.translationSlope=axis.transA=transA=axis.len/(range+pointRangePadding||1);axis.transB=axis.horiz?axis.left:axis.bottom;axis.minPixelPadding=transA*minPointOffset},setTickInterval:function(secondPass){var axis=this,chart=axis.chart,options=axis.options,isLog=axis.isLog,isDatetimeAxis=axis.isDatetimeAxis,isXAxis=axis.isXAxis,isLinked=axis.isLinked,maxPadding=options.maxPadding,minPadding=options.minPadding,length,linkedParentExtremes,tickIntervalOption=options.tickInterval,minTickInterval,tickPixelIntervalOption=options.tickPixelInterval,categories=axis.categories;if(!isDatetimeAxis&&!categories&&!isLinked){this.getTickAmount()}if(isLinked){axis.linkedParent=chart[axis.coll][options.linkedTo];linkedParentExtremes=axis.linkedParent.getExtremes();axis.min=pick(linkedParentExtremes.min,linkedParentExtremes.dataMin);axis.max=pick(linkedParentExtremes.max,linkedParentExtremes.dataMax);if(options.type!==axis.linkedParent.options.type){error(11,1)}}else{axis.min=pick(axis.userMin,options.min,axis.dataMin);axis.max=pick(axis.userMax,options.max,axis.dataMax)}if(isLog){if(!secondPass&&mathMin(axis.min,pick(axis.dataMin,axis.min))<=0){error(10,1)}axis.min=correctFloat(log2lin(axis.min));axis.max=correctFloat(log2lin(axis.max))}if(axis.range&&defined(axis.max)){axis.userMin=axis.min=mathMax(axis.min,axis.max-axis.range);axis.userMax=axis.max;axis.range=null}if(axis.beforePadding){axis.beforePadding()}axis.adjustForMinRange();if(!categories&&!axis.axisPointRange&&!axis.usePercentage&&!isLinked&&defined(axis.min)&&defined(axis.max)){length=axis.max-axis.min;if(length){if(!defined(options.min)&&!defined(axis.userMin)&&minPadding&&(axis.dataMin<0||!axis.ignoreMinPadding)){axis.min-=length*minPadding}if(!defined(options.max)&&!defined(axis.userMax)&&maxPadding&&(axis.dataMax>0||!axis.ignoreMaxPadding)){axis.max+=length*maxPadding}}}if(isNumber(options.floor)){axis.min=mathMax(axis.min,options.floor)}if(isNumber(options.ceiling)){axis.max=mathMin(axis.max,options.ceiling)}if(axis.min===axis.max||axis.min===undefined||axis.max===undefined){axis.tickInterval=1}else if(isLinked&&!tickIntervalOption&&tickPixelIntervalOption===axis.linkedParent.options.tickPixelInterval){axis.tickInterval=tickIntervalOption=axis.linkedParent.tickInterval}else{axis.tickInterval=pick(tickIntervalOption,this.tickAmount?(axis.max-axis.min)/mathMax(this.tickAmount-1,1):undefined,categories?1:(axis.max-axis.min)*tickPixelIntervalOption/mathMax(axis.len,tickPixelIntervalOption))}if(isXAxis&&!secondPass){each(axis.series,function(series){series.processData(axis.min!==axis.oldMin||axis.max!==axis.oldMax)})}axis.setAxisTranslation(true);if(axis.beforeSetTickPositions){axis.beforeSetTickPositions()}if(axis.postProcessTickInterval){axis.tickInterval=axis.postProcessTickInterval(axis.tickInterval)}if(axis.pointRange){axis.tickInterval=mathMax(axis.pointRange,axis.tickInterval)}minTickInterval=pick(options.minTickInterval,axis.isDatetimeAxis&&axis.closestPointRange);if(!tickIntervalOption&&axis.tickInterval<minTickInterval){axis.tickInterval=minTickInterval}if(!isDatetimeAxis&&!isLog&&!tickIntervalOption){axis.tickInterval=normalizeTickInterval(axis.tickInterval,null,getMagnitude(axis.tickInterval),pick(options.allowDecimals,!(axis.tickInterval>.5&&axis.tickInterval<5&&axis.max>1e3&&axis.max<9999)),!!this.tickAmount)}if(!this.tickAmount&&this.len){axis.tickInterval=axis.unsquish()}this.setTickPositions()},setTickPositions:function(){var options=this.options,tickPositions,tickPositionsOption=options.tickPositions,tickPositioner=options.tickPositioner,startOnTick=options.startOnTick,endOnTick=options.endOnTick,single;this.tickmarkOffset=this.categories&&options.tickmarkPlacement==="between"&&this.tickInterval===1?.5:0;this.minorTickInterval=options.minorTickInterval==="auto"&&this.tickInterval?this.tickInterval/5:options.minorTickInterval;this.tickPositions=tickPositions=tickPositionsOption&&tickPositionsOption.slice();if(!tickPositions){if(this.isDatetimeAxis){tickPositions=this.getTimeTicks(this.normalizeTimeTickInterval(this.tickInterval,options.units),this.min,this.max,options.startOfWeek,this.ordinalPositions,this.closestPointRange,true)}else if(this.isLog){tickPositions=this.getLogTickPositions(this.tickInterval,this.min,this.max)}else{tickPositions=this.getLinearTickPositions(this.tickInterval,this.min,this.max)}this.tickPositions=tickPositions;if(tickPositioner){tickPositioner=tickPositioner.apply(this,[this.min,this.max]);if(tickPositioner){this.tickPositions=tickPositions=tickPositioner}}}if(!this.isLinked){this.trimTicks(tickPositions,startOnTick,endOnTick);if(this.min===this.max&&defined(this.min)&&!this.tickAmount){single=true;this.min-=.5;this.max+=.5}this.single=single;if(!tickPositionsOption&&!tickPositioner){this.adjustTickAmount()}}},trimTicks:function(tickPositions,startOnTick,endOnTick){var roundedMin=tickPositions[0],roundedMax=tickPositions[tickPositions.length-1],minPointOffset=this.minPointOffset||0;if(startOnTick){this.min=roundedMin}else if(this.min-minPointOffset>roundedMin){tickPositions.shift()}if(endOnTick){this.max=roundedMax}else if(this.max+minPointOffset<roundedMax){tickPositions.pop()}if(tickPositions.length===0&&defined(roundedMin)){tickPositions.push((roundedMax+roundedMin)/2)}},getTickAmount:function(){var others={},hasOther,options=this.options,tickAmount=options.tickAmount,tickPixelInterval=options.tickPixelInterval;if(!defined(options.tickInterval)&&this.len<tickPixelInterval&&!this.isRadial&&!this.isLog&&options.startOnTick&&options.endOnTick){tickAmount=2}if(!tickAmount&&this.chart.options.chart.alignTicks!==false&&options.alignTicks!==false){each(this.chart[this.coll],function(axis){var options=axis.options,horiz=axis.horiz,key=[horiz?options.left:options.top,horiz?options.width:options.height,options.pane].join(",");if(others[key]){if(axis.series.length){hasOther=true}}else{others[key]=1}});if(hasOther){tickAmount=mathCeil(this.len/tickPixelInterval)+1}}if(tickAmount<4){this.finalTickAmt=tickAmount;tickAmount=5}this.tickAmount=tickAmount},adjustTickAmount:function(){var tickInterval=this.tickInterval,tickPositions=this.tickPositions,tickAmount=this.tickAmount,finalTickAmt=this.finalTickAmt,currentTickAmount=tickPositions&&tickPositions.length,i,len;if(currentTickAmount<tickAmount){while(tickPositions.length<tickAmount){tickPositions.push(correctFloat(tickPositions[tickPositions.length-1]+tickInterval))}this.transA*=(currentTickAmount-1)/(tickAmount-1);this.max=tickPositions[tickPositions.length-1]}else if(currentTickAmount>tickAmount){this.tickInterval*=2;this.setTickPositions()}if(defined(finalTickAmt)){i=len=tickPositions.length;while(i--){if(finalTickAmt===3&&i%2===1||finalTickAmt<=2&&i>0&&i<len-1){tickPositions.splice(i,1)}}this.finalTickAmt=UNDEFINED}},setScale:function(){var axis=this,stacks=axis.stacks,type,i,isDirtyData,isDirtyAxisLength;axis.oldMin=axis.min;axis.oldMax=axis.max;axis.oldAxisLength=axis.len;axis.setAxisSize();isDirtyAxisLength=axis.len!==axis.oldAxisLength;each(axis.series,function(series){if(series.isDirtyData||series.isDirty||series.xAxis.isDirty){isDirtyData=true}});if(isDirtyAxisLength||isDirtyData||axis.isLinked||axis.forceRedraw||axis.userMin!==axis.oldUserMin||axis.userMax!==axis.oldUserMax){if(!axis.isXAxis){for(type in stacks){for(i in stacks[type]){stacks[type][i].total=null;stacks[type][i].cum=0}}}axis.forceRedraw=false;axis.getSeriesExtremes();axis.setTickInterval();axis.oldUserMin=axis.userMin;axis.oldUserMax=axis.userMax;if(!axis.isDirty){axis.isDirty=isDirtyAxisLength||axis.min!==axis.oldMin||axis.max!==axis.oldMax}}else if(!axis.isXAxis){if(axis.oldStacks){stacks=axis.stacks=axis.oldStacks}for(type in stacks){for(i in stacks[type]){stacks[type][i].cum=stacks[type][i].total}}}},setExtremes:function(newMin,newMax,redraw,animation,eventArguments){var axis=this,chart=axis.chart;redraw=pick(redraw,true);each(axis.series,function(serie){delete serie.kdTree});eventArguments=extend(eventArguments,{min:newMin,max:newMax});fireEvent(axis,"setExtremes",eventArguments,function(){axis.userMin=newMin;axis.userMax=newMax;axis.eventArgs=eventArguments;axis.isDirtyExtremes=true;if(redraw){chart.redraw(animation)}})},zoom:function(newMin,newMax){var dataMin=this.dataMin,dataMax=this.dataMax,options=this.options;if(!this.allowZoomOutside){if(defined(dataMin)&&newMin<=mathMin(dataMin,pick(options.min,dataMin))){newMin=UNDEFINED}if(defined(dataMax)&&newMax>=mathMax(dataMax,pick(options.max,dataMax))){newMax=UNDEFINED}}this.displayBtn=newMin!==UNDEFINED||newMax!==UNDEFINED;this.setExtremes(newMin,newMax,false,UNDEFINED,{trigger:"zoom"});return true},setAxisSize:function(){var chart=this.chart,options=this.options,offsetLeft=options.offsetLeft||0,offsetRight=options.offsetRight||0,horiz=this.horiz,width=pick(options.width,chart.plotWidth-offsetLeft+offsetRight),height=pick(options.height,chart.plotHeight),top=pick(options.top,chart.plotTop),left=pick(options.left,chart.plotLeft+offsetLeft),percentRegex=/%$/;if(percentRegex.test(height)){height=parseFloat(height)/100*chart.plotHeight}if(percentRegex.test(top)){top=parseFloat(top)/100*chart.plotHeight+chart.plotTop}this.left=left;this.top=top;this.width=width;this.height=height;this.bottom=chart.chartHeight-height-top;this.right=chart.chartWidth-width-left;this.len=mathMax(horiz?width:height,0);this.pos=horiz?left:top},getExtremes:function(){var axis=this,isLog=axis.isLog;return{min:isLog?correctFloat(lin2log(axis.min)):axis.min,max:isLog?correctFloat(lin2log(axis.max)):axis.max,dataMin:axis.dataMin,dataMax:axis.dataMax,userMin:axis.userMin,userMax:axis.userMax}},getThreshold:function(threshold){var axis=this,isLog=axis.isLog,realMin=isLog?lin2log(axis.min):axis.min,realMax=isLog?lin2log(axis.max):axis.max;if(threshold===null){threshold=realMax<0?realMax:realMin}else if(realMin>threshold){threshold=realMin}else if(realMax<threshold){threshold=realMax}return axis.translate(threshold,0,1,0,1)},autoLabelAlign:function(rotation){var ret,angle=(pick(rotation,0)-this.side*90+720)%360;if(angle>15&&angle<165){ret="right"}else if(angle>195&&angle<345){ret="left"}else{ret="center"}return ret},unsquish:function(){var chart=this.chart,ticks=this.ticks,labelOptions=this.options.labels,horiz=this.horiz,tickInterval=this.tickInterval,newTickInterval=tickInterval,slotSize=this.len/(((this.categories?1:0)+this.max-this.min)/tickInterval),rotation,rotationOption=labelOptions.rotation,labelMetrics=chart.renderer.fontMetrics(labelOptions.style.fontSize,ticks[0]&&ticks[0].label),step,bestScore=Number.MAX_VALUE,autoRotation,getStep=function(spaceNeeded){var step=spaceNeeded/(slotSize||1);step=step>1?mathCeil(step):1;return step*tickInterval};if(horiz){autoRotation=defined(rotationOption)?[rotationOption]:slotSize<pick(labelOptions.autoRotationLimit,80)&&!labelOptions.staggerLines&&!labelOptions.step&&labelOptions.autoRotation;if(autoRotation){each(autoRotation,function(rot){var score;if(rot===rotationOption||rot&&rot>=-90&&rot<=90){step=getStep(mathAbs(labelMetrics.h/mathSin(deg2rad*rot)));score=step+mathAbs(rot/360);if(score<bestScore){bestScore=score;rotation=rot;newTickInterval=step}}})}}else{newTickInterval=getStep(labelMetrics.h)}this.autoRotation=autoRotation;this.labelRotation=rotation;return newTickInterval},renderUnsquish:function(){var chart=this.chart,renderer=chart.renderer,tickPositions=this.tickPositions,ticks=this.ticks,labelOptions=this.options.labels,horiz=this.horiz,margin=chart.margin,slotCount=this.categories?tickPositions.length:tickPositions.length-1,slotWidth=this.slotWidth=horiz&&!labelOptions.step&&!labelOptions.rotation&&(this.staggerLines||1)*chart.plotWidth/slotCount||!horiz&&(margin[3]&&margin[3]-chart.spacing[3]||chart.chartWidth*.33),innerWidth=mathMax(1,mathRound(slotWidth-2*(labelOptions.padding||5))),attr={},labelMetrics=renderer.fontMetrics(labelOptions.style.fontSize,ticks[0]&&ticks[0].label),textOverflowOption=labelOptions.style.textOverflow,css,labelLength=0,label,i,pos;if(!isString(labelOptions.rotation)){attr.rotation=labelOptions.rotation}if(this.autoRotation){each(tickPositions,function(tick){tick=ticks[tick];if(tick&&tick.labelLength>labelLength){labelLength=tick.labelLength}});if(labelLength>innerWidth&&labelLength>labelMetrics.h){attr.rotation=this.labelRotation}else{this.labelRotation=0}}else if(slotWidth){css={width:innerWidth+PX};if(!textOverflowOption){css.textOverflow="clip";i=tickPositions.length;while(!horiz&&i--){pos=tickPositions[i];label=ticks[pos].label;if(label){if(label.styles.textOverflow==="ellipsis"){label.css({textOverflow:"clip"})}if(label.getBBox().height>this.len/tickPositions.length-(labelMetrics.h-labelMetrics.f)){label.specCss={textOverflow:"ellipsis"}}}}}}if(attr.rotation){css={width:(labelLength>chart.chartHeight*.5?chart.chartHeight*.33:chart.chartHeight)+PX};if(!textOverflowOption){css.textOverflow="ellipsis"}}this.labelAlign=attr.align=labelOptions.align||this.autoLabelAlign(this.labelRotation);each(tickPositions,function(pos){var tick=ticks[pos],label=tick&&tick.label;if(label){if(css){label.css(merge(css,label.specCss))}delete label.specCss;label.attr(attr);tick.rotation=attr.rotation}});this.tickRotCorr=renderer.rotCorr(labelMetrics.b,this.labelRotation||0,this.side===2)},hasData:function(){return this.hasVisibleSeries||defined(this.min)&&defined(this.max)&&!!this.tickPositions},getOffset:function(){var axis=this,chart=axis.chart,renderer=chart.renderer,options=axis.options,tickPositions=axis.tickPositions,ticks=axis.ticks,horiz=axis.horiz,side=axis.side,invertedSide=chart.inverted?[1,0,3,2][side]:side,hasData,showAxis,titleOffset=0,titleOffsetOption,titleMargin=0,axisTitleOptions=options.title,labelOptions=options.labels,labelOffset=0,labelOffsetPadded,axisOffset=chart.axisOffset,clipOffset=chart.clipOffset,clip,directionFactor=[-1,1,1,-1][side],n,lineHeightCorrection;hasData=axis.hasData();axis.showAxis=showAxis=hasData||pick(options.showEmpty,true);axis.staggerLines=axis.horiz&&labelOptions.staggerLines;if(!axis.axisGroup){axis.gridGroup=renderer.g("grid").attr({zIndex:options.gridZIndex||1}).add();axis.axisGroup=renderer.g("axis").attr({zIndex:options.zIndex||2}).add();axis.labelGroup=renderer.g("axis-labels").attr({zIndex:labelOptions.zIndex||7}).addClass(PREFIX+axis.coll.toLowerCase()+"-labels").add()}if(hasData||axis.isLinked){each(tickPositions,function(pos){if(!ticks[pos]){ticks[pos]=new Tick(axis,pos)}else{ticks[pos].addLabel()}});axis.renderUnsquish();each(tickPositions,function(pos){if(side===0||side===2||{1:"left",3:"right"}[side]===axis.labelAlign){labelOffset=mathMax(ticks[pos].getLabelSize(),labelOffset)}});if(axis.staggerLines){labelOffset*=axis.staggerLines;axis.labelOffset=labelOffset}}else{for(n in ticks){ticks[n].destroy();delete ticks[n]}}if(axisTitleOptions&&axisTitleOptions.text&&axisTitleOptions.enabled!==false){if(!axis.axisTitle){axis.axisTitle=renderer.text(axisTitleOptions.text,0,0,axisTitleOptions.useHTML).attr({zIndex:7,rotation:axisTitleOptions.rotation||0,align:axisTitleOptions.textAlign||{low:"left",middle:"center",high:"right"}[axisTitleOptions.align]}).addClass(PREFIX+this.coll.toLowerCase()+"-title").css(axisTitleOptions.style).add(axis.axisGroup);axis.axisTitle.isNew=true}if(showAxis){titleOffset=axis.axisTitle.getBBox()[horiz?"height":"width"];titleOffsetOption=axisTitleOptions.offset;titleMargin=defined(titleOffsetOption)?0:pick(axisTitleOptions.margin,horiz?5:10)}axis.axisTitle[showAxis?"show":"hide"]()}axis.offset=directionFactor*pick(options.offset,axisOffset[side]);axis.tickRotCorr=axis.tickRotCorr||{x:0,y:0};lineHeightCorrection=side===2?axis.tickRotCorr.y:0;labelOffsetPadded=labelOffset+titleMargin+(labelOffset&&directionFactor*(horiz?pick(labelOptions.y,axis.tickRotCorr.y+8):labelOptions.x)-lineHeightCorrection);axis.axisTitleMargin=pick(titleOffsetOption,labelOffsetPadded);axisOffset[side]=mathMax(axisOffset[side],axis.axisTitleMargin+titleOffset+directionFactor*axis.offset,labelOffsetPadded);clip=mathFloor(options.lineWidth/2)*2;if(options.offset){clip=mathMax(0,clip-options.offset)}clipOffset[invertedSide]=mathMax(clipOffset[invertedSide],clip)},getLinePath:function(lineWidth){var chart=this.chart,opposite=this.opposite,offset=this.offset,horiz=this.horiz,lineLeft=this.left+(opposite?this.width:0)+offset,lineTop=chart.chartHeight-this.bottom-(opposite?this.height:0)+offset;if(opposite){lineWidth*=-1}return chart.renderer.crispLine([M,horiz?this.left:lineLeft,horiz?lineTop:this.top,L,horiz?chart.chartWidth-this.right:lineLeft,horiz?lineTop:chart.chartHeight-this.bottom],lineWidth)},getTitlePosition:function(){var horiz=this.horiz,axisLeft=this.left,axisTop=this.top,axisLength=this.len,axisTitleOptions=this.options.title,margin=horiz?axisLeft:axisTop,opposite=this.opposite,offset=this.offset,xOption=axisTitleOptions.x||0,yOption=axisTitleOptions.y||0,fontSize=pInt(axisTitleOptions.style.fontSize||12),alongAxis={low:margin+(horiz?0:axisLength),middle:margin+axisLength/2,high:margin+(horiz?axisLength:0)}[axisTitleOptions.align],offAxis=(horiz?axisTop+this.height:axisLeft)+(horiz?1:-1)*(opposite?-1:1)*this.axisTitleMargin+(this.side===2?fontSize:0);return{x:horiz?alongAxis+xOption:offAxis+(opposite?this.width:0)+offset+xOption,y:horiz?offAxis+yOption-(opposite?this.height:0)+offset:alongAxis+yOption}},render:function(){var axis=this,chart=axis.chart,renderer=chart.renderer,options=axis.options,isLog=axis.isLog,isLinked=axis.isLinked,tickPositions=axis.tickPositions,axisTitle=axis.axisTitle,ticks=axis.ticks,minorTicks=axis.minorTicks,alternateBands=axis.alternateBands,stackLabelOptions=options.stackLabels,alternateGridColor=options.alternateGridColor,tickmarkOffset=axis.tickmarkOffset,lineWidth=options.lineWidth,linePath,hasRendered=chart.hasRendered,slideInTicks=hasRendered&&defined(axis.oldMin)&&!isNaN(axis.oldMin),showAxis=axis.showAxis,from,to;axis.labelEdge.length=0;axis.overlap=false;each([ticks,minorTicks,alternateBands],function(coll){var pos;for(pos in coll){coll[pos].isActive=false}});if(axis.hasData()||isLinked){if(axis.minorTickInterval&&!axis.categories){each(axis.getMinorTickPositions(),function(pos){if(!minorTicks[pos]){minorTicks[pos]=new Tick(axis,pos,"minor")}if(slideInTicks&&minorTicks[pos].isNew){minorTicks[pos].render(null,true)}minorTicks[pos].render(null,false,1)})}if(tickPositions.length){each(tickPositions,function(pos,i){if(!isLinked||pos>=axis.min&&pos<=axis.max){if(!ticks[pos]){ticks[pos]=new Tick(axis,pos)}if(slideInTicks&&ticks[pos].isNew){ticks[pos].render(i,true,.1)}ticks[pos].render(i)}});if(tickmarkOffset&&(axis.min===0||axis.single)){if(!ticks[-1]){ticks[-1]=new Tick(axis,-1,null,true)}ticks[-1].render(-1)}}if(alternateGridColor){each(tickPositions,function(pos,i){if(i%2===0&&pos<axis.max){if(!alternateBands[pos]){alternateBands[pos]=new Highcharts.PlotLineOrBand(axis)}from=pos+tickmarkOffset;to=tickPositions[i+1]!==UNDEFINED?tickPositions[i+1]+tickmarkOffset:axis.max;alternateBands[pos].options={from:isLog?lin2log(from):from,to:isLog?lin2log(to):to,color:alternateGridColor};alternateBands[pos].render();alternateBands[pos].isActive=true}})}if(!axis._addedPlotLB){each((options.plotLines||[]).concat(options.plotBands||[]),function(plotLineOptions){axis.addPlotBandOrLine(plotLineOptions)});axis._addedPlotLB=true}}each([ticks,minorTicks,alternateBands],function(coll){var pos,i,forDestruction=[],delay=globalAnimation?globalAnimation.duration||500:0,destroyInactiveItems=function(){i=forDestruction.length;while(i--){if(coll[forDestruction[i]]&&!coll[forDestruction[i]].isActive){coll[forDestruction[i]].destroy();delete coll[forDestruction[i]]}}};for(pos in coll){if(!coll[pos].isActive){coll[pos].render(pos,false,0);coll[pos].isActive=false;forDestruction.push(pos)}}if(coll===alternateBands||!chart.hasRendered||!delay){destroyInactiveItems()}else if(delay){setTimeout(destroyInactiveItems,delay)}});if(lineWidth){linePath=axis.getLinePath(lineWidth);if(!axis.axisLine){axis.axisLine=renderer.path(linePath).attr({stroke:options.lineColor,"stroke-width":lineWidth,zIndex:7}).add(axis.axisGroup)}else{axis.axisLine.animate({d:linePath})}axis.axisLine[showAxis?"show":"hide"]()}if(axisTitle&&showAxis){axisTitle[axisTitle.isNew?"attr":"animate"](axis.getTitlePosition());axisTitle.isNew=false}if(stackLabelOptions&&stackLabelOptions.enabled){axis.renderStackTotals()}axis.isDirty=false},redraw:function(){this.render();each(this.plotLinesAndBands,function(plotLine){plotLine.render()});each(this.series,function(series){series.isDirty=true})},destroy:function(keepEvents){var axis=this,stacks=axis.stacks,stackKey,plotLinesAndBands=axis.plotLinesAndBands,i;if(!keepEvents){removeEvent(axis)}for(stackKey in stacks){destroyObjectProperties(stacks[stackKey]);stacks[stackKey]=null}each([axis.ticks,axis.minorTicks,axis.alternateBands],function(coll){destroyObjectProperties(coll)});i=plotLinesAndBands.length;while(i--){plotLinesAndBands[i].destroy()}each(["stackTotalGroup","axisLine","axisTitle","axisGroup","cross","gridGroup","labelGroup"],function(prop){if(axis[prop]){axis[prop]=axis[prop].destroy()}});if(this.cross){this.cross.destroy()}},drawCrosshair:function(e,point){var path,options=this.crosshair,animation=options.animation,pos,attribs,categorized;if(!this.crosshair||(defined(point)||!pick(this.crosshair.snap,true))===false||point&&point.series&&point.series[this.coll]!==this){this.hideCrosshair()}else{if(!pick(options.snap,true)){pos=this.horiz?e.chartX-this.pos:this.len-e.chartY+this.pos}else if(defined(point)){pos=this.isXAxis?point.plotX:this.len-point.plotY}if(this.isRadial){path=this.getPlotLinePath(this.isXAxis?point.x:pick(point.stackY,point.y))||null}else{path=this.getPlotLinePath(null,null,null,null,pos)||null}if(path===null){this.hideCrosshair();return}if(this.cross){this.cross.attr({visibility:VISIBLE})[animation?"animate":"attr"]({d:path},animation)}else{categorized=this.categories&&!this.isRadial;attribs={"stroke-width":options.width||(categorized?this.transA:1),stroke:options.color||(categorized?"rgba(155,200,255,0.2)":"#C0C0C0"),zIndex:options.zIndex||2};if(options.dashStyle){attribs.dashstyle=options.dashStyle}this.cross=this.chart.renderer.path(path).attr(attribs).add()}}},hideCrosshair:function(){if(this.cross){this.cross.hide()}}};extend(Axis.prototype,AxisPlotLineOrBandExtension);Axis.prototype.getTimeTicks=function(normalizedInterval,min,max,startOfWeek){var tickPositions=[],i,higherRanks={},useUTC=defaultOptions.global.useUTC,minYear,minDate=new Date(min-getTZOffset(min)),interval=normalizedInterval.unitRange,count=normalizedInterval.count;if(defined(min)){minDate[setMilliseconds](interval>=timeUnits.second?0:count*mathFloor(minDate.getMilliseconds()/count));if(interval>=timeUnits.second){minDate[setSeconds](interval>=timeUnits.minute?0:count*mathFloor(minDate.getSeconds()/count))}if(interval>=timeUnits.minute){minDate[setMinutes](interval>=timeUnits.hour?0:count*mathFloor(minDate[getMinutes]()/count))}if(interval>=timeUnits.hour){minDate[setHours](interval>=timeUnits.day?0:count*mathFloor(minDate[getHours]()/count))}if(interval>=timeUnits.day){minDate[setDate](interval>=timeUnits.month?1:count*mathFloor(minDate[getDate]()/count))}if(interval>=timeUnits.month){minDate[setMonth](interval>=timeUnits.year?0:count*mathFloor(minDate[getMonth]()/count));minYear=minDate[getFullYear]()}if(interval>=timeUnits.year){minYear-=minYear%count;minDate[setFullYear](minYear)}if(interval===timeUnits.week){minDate[setDate](minDate[getDate]()-minDate[getDay]()+pick(startOfWeek,1))}i=1;if(timezoneOffset||getTimezoneOffset){minDate=minDate.getTime();minDate=new Date(minDate+getTZOffset(minDate))}minYear=minDate[getFullYear]();var time=minDate.getTime(),minMonth=minDate[getMonth](),minDateDate=minDate[getDate](),localTimezoneOffset=(timeUnits.day+(useUTC?getTZOffset(minDate):minDate.getTimezoneOffset()*60*1e3))%timeUnits.day;while(time<max){tickPositions.push(time);if(interval===timeUnits.year){time=makeTime(minYear+i*count,0)}else if(interval===timeUnits.month){time=makeTime(minYear,minMonth+i*count)}else if(!useUTC&&(interval===timeUnits.day||interval===timeUnits.week)){time=makeTime(minYear,minMonth,minDateDate+i*count*(interval===timeUnits.day?1:7))}else{time+=interval*count}i++}tickPositions.push(time);each(grep(tickPositions,function(time){return interval<=timeUnits.hour&&time%timeUnits.day===localTimezoneOffset}),function(time){higherRanks[time]="day"})}tickPositions.info=extend(normalizedInterval,{higherRanks:higherRanks,totalRange:interval*count});return tickPositions};Axis.prototype.normalizeTimeTickInterval=function(tickInterval,unitsOption){var units=unitsOption||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],unit=units[units.length-1],interval=timeUnits[unit[0]],multiples=unit[1],count,i;for(i=0;i<units.length;i++){unit=units[i];interval=timeUnits[unit[0]];multiples=unit[1];if(units[i+1]){var lessThan=(interval*multiples[multiples.length-1]+timeUnits[units[i+1][0]])/2;if(tickInterval<=lessThan){break}}}if(interval===timeUnits.year&&tickInterval<5*interval){multiples=[1,2,5]}count=normalizeTickInterval(tickInterval/interval,multiples,unit[0]==="year"?mathMax(getMagnitude(tickInterval/interval),1):1);return{unitRange:interval,count:count,unitName:unit[0]}};Axis.prototype.getLogTickPositions=function(interval,min,max,minor){var axis=this,options=axis.options,axisLength=axis.len,positions=[];if(!minor){axis._minorAutoInterval=null}if(interval>=.5){interval=mathRound(interval);positions=axis.getLinearTickPositions(interval,min,max)}else if(interval>=.08){var roundedMin=mathFloor(min),intermediate,i,j,len,pos,lastPos,break2;if(interval>.3){intermediate=[1,2,4]}else if(interval>.15){intermediate=[1,2,4,6,8]}else{intermediate=[1,2,3,4,5,6,7,8,9]}for(i=roundedMin;i<max+1&&!break2;i++){len=intermediate.length;for(j=0;j<len&&!break2;j++){pos=log2lin(lin2log(i)*intermediate[j]);if(pos>min&&(!minor||lastPos<=max)&&lastPos!==UNDEFINED){positions.push(lastPos)}if(lastPos>max){break2=true}lastPos=pos}}}else{var realMin=lin2log(min),realMax=lin2log(max),tickIntervalOption=options[minor?"minorTickInterval":"tickInterval"],filteredTickIntervalOption=tickIntervalOption==="auto"?null:tickIntervalOption,tickPixelIntervalOption=options.tickPixelInterval/(minor?5:1),totalPixelLength=minor?axisLength/axis.tickPositions.length:axisLength;interval=pick(filteredTickIntervalOption,axis._minorAutoInterval,(realMax-realMin)*tickPixelIntervalOption/(totalPixelLength||1));interval=normalizeTickInterval(interval,null,getMagnitude(interval));positions=map(axis.getLinearTickPositions(interval,realMin,realMax),log2lin);if(!minor){axis._minorAutoInterval=interval/5}}if(!minor){axis.tickInterval=interval}return positions};var Tooltip=Highcharts.Tooltip=function(){this.init.apply(this,arguments)};Tooltip.prototype={init:function(chart,options){var borderWidth=options.borderWidth,style=options.style,padding=pInt(style.padding);this.chart=chart;this.options=options;this.crosshairs=[];this.now={x:0,y:0};this.isHidden=true;this.label=chart.renderer.label("",0,0,options.shape||"callout",null,null,options.useHTML,null,"tooltip").attr({padding:padding,fill:options.backgroundColor,"stroke-width":borderWidth,r:options.borderRadius,zIndex:8}).css(style).css({padding:0}).add().attr({y:-9999});if(!useCanVG){this.label.shadow(options.shadow)}this.shared=options.shared},destroy:function(){if(this.label){this.label=this.label.destroy()}clearTimeout(this.hideTimer);clearTimeout(this.tooltipTimeout)},move:function(x,y,anchorX,anchorY){var tooltip=this,now=tooltip.now,animate=tooltip.options.animation!==false&&!tooltip.isHidden&&(mathAbs(x-now.x)>1||mathAbs(y-now.y)>1),skipAnchor=tooltip.followPointer||tooltip.len>1;extend(now,{x:animate?(2*now.x+x)/3:x,y:animate?(now.y+y)/2:y,anchorX:skipAnchor?UNDEFINED:animate?(2*now.anchorX+anchorX)/3:anchorX,anchorY:skipAnchor?UNDEFINED:animate?(now.anchorY+anchorY)/2:anchorY});tooltip.label.attr(now);if(animate){clearTimeout(this.tooltipTimeout);this.tooltipTimeout=setTimeout(function(){if(tooltip){tooltip.move(x,y,anchorX,anchorY)}},32)}},hide:function(delay){var tooltip=this,hoverPoints;clearTimeout(this.hideTimer);if(!this.isHidden){hoverPoints=this.chart.hoverPoints;this.hideTimer=setTimeout(function(){tooltip.label.fadeOut();tooltip.isHidden=true},pick(delay,this.options.hideDelay,500))}},getAnchor:function(points,mouseEvent){var ret,chart=this.chart,inverted=chart.inverted,plotTop=chart.plotTop,plotLeft=chart.plotLeft,plotX=0,plotY=0,yAxis,xAxis;
points=splat(points);ret=points[0].tooltipPos;if(this.followPointer&&mouseEvent){if(mouseEvent.chartX===UNDEFINED){mouseEvent=chart.pointer.normalize(mouseEvent)}ret=[mouseEvent.chartX-chart.plotLeft,mouseEvent.chartY-plotTop]}if(!ret){each(points,function(point){yAxis=point.series.yAxis;xAxis=point.series.xAxis;plotX+=point.plotX+(!inverted&&xAxis?xAxis.left-plotLeft:0);plotY+=(point.plotLow?(point.plotLow+point.plotHigh)/2:point.plotY)+(!inverted&&yAxis?yAxis.top-plotTop:0)});plotX/=points.length;plotY/=points.length;ret=[inverted?chart.plotWidth-plotY:plotX,this.shared&&!inverted&&points.length>1&&mouseEvent?mouseEvent.chartY-plotTop:inverted?chart.plotHeight-plotX:plotY]}return map(ret,mathRound)},getPosition:function(boxWidth,boxHeight,point){var chart=this.chart,distance=this.distance,ret={},h=point.h||0,swapped,first=["y",chart.chartHeight,boxHeight,point.plotY+chart.plotTop],second=["x",chart.chartWidth,boxWidth,point.plotX+chart.plotLeft],preferFarSide=pick(point.ttBelow,chart.inverted&&!point.negative||!chart.inverted&&point.negative),firstDimension=function(dim,outerSize,innerSize,point){var roomLeft=innerSize<point-distance,roomRight=point+distance+innerSize<outerSize,alignedLeft=point-distance-innerSize,alignedRight=point+distance;if(preferFarSide&&roomRight){ret[dim]=alignedRight}else if(!preferFarSide&&roomLeft){ret[dim]=alignedLeft}else if(roomLeft){ret[dim]=alignedLeft-h<0?alignedLeft:alignedLeft-h}else if(roomRight){ret[dim]=alignedRight+h+innerSize>outerSize?alignedRight:alignedRight+h}else{return false}},secondDimension=function(dim,outerSize,innerSize,point){if(point<distance||point>outerSize-distance){return false}else if(point<innerSize/2){ret[dim]=1}else if(point>outerSize-innerSize/2){ret[dim]=outerSize-innerSize-2}else{ret[dim]=point-innerSize/2}},swap=function(count){var temp=first;first=second;second=temp;swapped=count},run=function(){if(firstDimension.apply(0,first)!==false){if(secondDimension.apply(0,second)===false&&!swapped){swap(true);run()}}else if(!swapped){swap(true);run()}else{ret.x=ret.y=0}};if(chart.inverted||this.len>1){swap()}run();return ret},defaultFormatter:function(tooltip){var items=this.points||splat(this),s;s=[tooltip.tooltipFooterHeaderFormatter(items[0])];s=s.concat(tooltip.bodyFormatter(items));s.push(tooltip.tooltipFooterHeaderFormatter(items[0],true));return s.join("")},refresh:function(point,mouseEvent){var tooltip=this,chart=tooltip.chart,label=tooltip.label,options=tooltip.options,x,y,anchor,textConfig={},text,pointConfig=[],formatter=options.formatter||tooltip.defaultFormatter,hoverPoints=chart.hoverPoints,borderColor,shared=tooltip.shared,currentSeries;clearTimeout(this.hideTimer);tooltip.followPointer=splat(point)[0].series.tooltipOptions.followPointer;anchor=tooltip.getAnchor(point,mouseEvent);x=anchor[0];y=anchor[1];if(shared&&!(point.series&&point.series.noSharedTooltip)){chart.hoverPoints=point;if(hoverPoints){each(hoverPoints,function(point){point.setState()})}each(point,function(item){item.setState(HOVER_STATE);pointConfig.push(item.getLabelConfig())});textConfig={x:point[0].category,y:point[0].y};textConfig.points=pointConfig;this.len=pointConfig.length;point=point[0]}else{textConfig=point.getLabelConfig()}text=formatter.call(textConfig,tooltip);currentSeries=point.series;this.distance=pick(currentSeries.tooltipOptions.distance,16);if(text===false){this.hide()}else{if(tooltip.isHidden){stop(label);label.attr("opacity",1).show()}label.attr({text:text});borderColor=options.borderColor||point.color||currentSeries.color||"#606060";label.attr({stroke:borderColor});tooltip.updatePosition({plotX:x,plotY:y,negative:point.negative,ttBelow:point.ttBelow,h:anchor[2]||0});this.isHidden=false}fireEvent(chart,"tooltipRefresh",{text:text,x:x+chart.plotLeft,y:y+chart.plotTop,borderColor:borderColor})},updatePosition:function(point){var chart=this.chart,label=this.label,pos=(this.options.positioner||this.getPosition).call(this,label.width,label.height,point);this.move(mathRound(pos.x),mathRound(pos.y||0),point.plotX+chart.plotLeft,point.plotY+chart.plotTop)},getXDateFormat:function(point,options,xAxis){var xDateFormat,dateTimeLabelFormats=options.dateTimeLabelFormats,closestPointRange=xAxis&&xAxis.closestPointRange,n,blank="01-01 00:00:00.000",strpos={millisecond:15,second:12,minute:9,hour:6,day:3},date,lastN="millisecond";if(closestPointRange){date=dateFormat("%m-%d %H:%M:%S.%L",point.x);for(n in timeUnits){if(closestPointRange===timeUnits.week&&+dateFormat("%w",point.x)===xAxis.options.startOfWeek&&date.substr(6)===blank.substr(6)){n="week";break}else if(timeUnits[n]>closestPointRange){n=lastN;break}else if(strpos[n]&&date.substr(strpos[n])!==blank.substr(strpos[n])){break}if(n!=="week"){lastN=n}}if(n){xDateFormat=dateTimeLabelFormats[n]}}else{xDateFormat=dateTimeLabelFormats.day}return xDateFormat||dateTimeLabelFormats.year},tooltipFooterHeaderFormatter:function(point,isFooter){var footOrHead=isFooter?"footer":"header",series=point.series,tooltipOptions=series.tooltipOptions,xDateFormat=tooltipOptions.xDateFormat,xAxis=series.xAxis,isDateTime=xAxis&&xAxis.options.type==="datetime"&&isNumber(point.key),formatString=tooltipOptions[footOrHead+"Format"];if(isDateTime&&!xDateFormat){xDateFormat=this.getXDateFormat(point,tooltipOptions,xAxis)}if(isDateTime&&xDateFormat){formatString=formatString.replace("{point.key}","{point.key:"+xDateFormat+"}")}return format(formatString,{point:point,series:series})},bodyFormatter:function(items){return map(items,function(item){var tooltipOptions=item.series.tooltipOptions;return(tooltipOptions.pointFormatter||item.point.tooltipFormatter).call(item.point,tooltipOptions.pointFormat)})}};var hoverChartIndex;hasTouch=doc.documentElement.ontouchstart!==UNDEFINED;var Pointer=Highcharts.Pointer=function(chart,options){this.init(chart,options)};Pointer.prototype={init:function(chart,options){var chartOptions=options.chart,chartEvents=chartOptions.events,zoomType=useCanVG?"":chartOptions.zoomType,inverted=chart.inverted,zoomX,zoomY;this.options=options;this.chart=chart;this.zoomX=zoomX=/x/.test(zoomType);this.zoomY=zoomY=/y/.test(zoomType);this.zoomHor=zoomX&&!inverted||zoomY&&inverted;this.zoomVert=zoomY&&!inverted||zoomX&&inverted;this.hasZoom=zoomX||zoomY;this.runChartClick=chartEvents&&!!chartEvents.click;this.pinchDown=[];this.lastValidTouch={};if(Highcharts.Tooltip&&options.tooltip.enabled){chart.tooltip=new Tooltip(chart,options.tooltip);this.followTouchMove=pick(options.tooltip.followTouchMove,true)}this.setDOMEvents()},normalize:function(e,chartPosition){var chartX,chartY,ePos;e=e||window.event;e=washMouseEvent(e);if(!e.target){e.target=e.srcElement}ePos=e.touches?e.touches.length?e.touches.item(0):e.changedTouches[0]:e;if(!chartPosition){this.chartPosition=chartPosition=offset(this.chart.container)}if(ePos.pageX===UNDEFINED){chartX=mathMax(e.x,e.clientX-chartPosition.left);chartY=e.y}else{chartX=ePos.pageX-chartPosition.left;chartY=ePos.pageY-chartPosition.top}return extend(e,{chartX:mathRound(chartX),chartY:mathRound(chartY)})},getCoordinates:function(e){var coordinates={xAxis:[],yAxis:[]};each(this.chart.axes,function(axis){coordinates[axis.isXAxis?"xAxis":"yAxis"].push({axis:axis,value:axis.toValue(e[axis.horiz?"chartX":"chartY"])})});return coordinates},runPointActions:function(e){var pointer=this,chart=pointer.chart,series=chart.series,tooltip=chart.tooltip,shared=tooltip?tooltip.shared:false,followPointer,hoverPoint=chart.hoverPoint,hoverSeries=chart.hoverSeries,i,distance=chart.chartWidth,anchor,noSharedTooltip,directTouch,kdpoints=[],kdpoint,kdpointT;if(!shared&&!hoverSeries){for(i=0;i<series.length;i++){if(series[i].directTouch||!series[i].options.stickyTracking){series=[]}}}if(!shared&&hoverSeries&&hoverSeries.directTouch&&hoverPoint){kdpoint=hoverPoint}else{each(series,function(s){noSharedTooltip=s.noSharedTooltip&&shared;directTouch=!shared&&s.directTouch;if(s.visible&&!noSharedTooltip&&!directTouch&&pick(s.options.enableMouseTracking,true)){kdpointT=s.searchPoint(e,!noSharedTooltip&&s.kdDimensions===1);if(kdpointT){kdpoints.push(kdpointT)}}});each(kdpoints,function(p){if(p&&typeof p.dist==="number"&&p.dist<distance){distance=p.dist;kdpoint=p}})}if(kdpoint&&(kdpoint!==this.prevKDPoint||tooltip&&tooltip.isHidden)){if(shared&&!kdpoint.series.noSharedTooltip){i=kdpoints.length;while(i--){if(kdpoints[i].clientX!==kdpoint.clientX||kdpoints[i].series.noSharedTooltip){kdpoints.splice(i,1)}}if(kdpoints.length&&tooltip){tooltip.refresh(kdpoints,e)}each(kdpoints,function(point){if(point!==kdpoint){point.onMouseOver(e)}});(hoverSeries&&hoverSeries.directTouch&&hoverPoint||kdpoint).onMouseOver(e)}else{if(tooltip){tooltip.refresh(kdpoint,e)}kdpoint.onMouseOver(e)}this.prevKDPoint=kdpoint}else{followPointer=hoverSeries&&hoverSeries.tooltipOptions.followPointer;if(tooltip&&followPointer&&!tooltip.isHidden){anchor=tooltip.getAnchor([{}],e);tooltip.updatePosition({plotX:anchor[0],plotY:anchor[1]})}}if(tooltip&&!pointer._onDocumentMouseMove){pointer._onDocumentMouseMove=function(e){if(charts[hoverChartIndex]){charts[hoverChartIndex].pointer.onDocumentMouseMove(e)}};addEvent(doc,"mousemove",pointer._onDocumentMouseMove)}each(chart.axes,function(axis){axis.drawCrosshair(e,pick(kdpoint,hoverPoint))})},reset:function(allowMove,delay){var pointer=this,chart=pointer.chart,hoverSeries=chart.hoverSeries,hoverPoint=chart.hoverPoint,hoverPoints=chart.hoverPoints,tooltip=chart.tooltip,tooltipPoints=tooltip&&tooltip.shared?hoverPoints:hoverPoint;allowMove=allowMove&&tooltip&&tooltipPoints;if(allowMove&&splat(tooltipPoints)[0].plotX===UNDEFINED){allowMove=false}if(allowMove){tooltip.refresh(tooltipPoints);if(hoverPoint){hoverPoint.setState(hoverPoint.state,true);each(chart.axes,function(axis){if(pick(axis.options.crosshair&&axis.options.crosshair.snap,true)){axis.drawCrosshair(null,hoverPoint)}else{axis.hideCrosshair()}})}}else{if(hoverPoint){hoverPoint.onMouseOut()}if(hoverPoints){each(hoverPoints,function(point){point.setState()})}if(hoverSeries){hoverSeries.onMouseOut()}if(tooltip){tooltip.hide(delay)}if(pointer._onDocumentMouseMove){removeEvent(doc,"mousemove",pointer._onDocumentMouseMove);pointer._onDocumentMouseMove=null}each(chart.axes,function(axis){axis.hideCrosshair()});pointer.hoverX=chart.hoverPoints=chart.hoverPoint=null}},scaleGroups:function(attribs,clip){var chart=this.chart,seriesAttribs;each(chart.series,function(series){seriesAttribs=attribs||series.getPlotBox();if(series.xAxis&&series.xAxis.zoomEnabled){series.group.attr(seriesAttribs);if(series.markerGroup){series.markerGroup.attr(seriesAttribs);series.markerGroup.clip(clip?chart.clipRect:null)}if(series.dataLabelsGroup){series.dataLabelsGroup.attr(seriesAttribs)}}});chart.clipRect.attr(clip||chart.clipBox)},dragStart:function(e){var chart=this.chart;chart.mouseIsDown=e.type;chart.cancelClick=false;chart.mouseDownX=this.mouseDownX=e.chartX;chart.mouseDownY=this.mouseDownY=e.chartY},drag:function(e){var chart=this.chart,chartOptions=chart.options.chart,chartX=e.chartX,chartY=e.chartY,zoomHor=this.zoomHor,zoomVert=this.zoomVert,plotLeft=chart.plotLeft,plotTop=chart.plotTop,plotWidth=chart.plotWidth,plotHeight=chart.plotHeight,clickedInside,size,mouseDownX=this.mouseDownX,mouseDownY=this.mouseDownY,panKey=chartOptions.panKey&&e[chartOptions.panKey+"Key"];if(chartX<plotLeft){chartX=plotLeft}else if(chartX>plotLeft+plotWidth){chartX=plotLeft+plotWidth}if(chartY<plotTop){chartY=plotTop}else if(chartY>plotTop+plotHeight){chartY=plotTop+plotHeight}this.hasDragged=Math.sqrt(Math.pow(mouseDownX-chartX,2)+Math.pow(mouseDownY-chartY,2));if(this.hasDragged>10){clickedInside=chart.isInsidePlot(mouseDownX-plotLeft,mouseDownY-plotTop);if(chart.hasCartesianSeries&&(this.zoomX||this.zoomY)&&clickedInside&&!panKey){if(!this.selectionMarker){this.selectionMarker=chart.renderer.rect(plotLeft,plotTop,zoomHor?1:plotWidth,zoomVert?1:plotHeight,0).attr({fill:chartOptions.selectionMarkerFill||"rgba(69,114,167,0.25)",zIndex:7}).add()}}if(this.selectionMarker&&zoomHor){size=chartX-mouseDownX;this.selectionMarker.attr({width:mathAbs(size),x:(size>0?0:size)+mouseDownX})}if(this.selectionMarker&&zoomVert){size=chartY-mouseDownY;this.selectionMarker.attr({height:mathAbs(size),y:(size>0?0:size)+mouseDownY})}if(clickedInside&&!this.selectionMarker&&chartOptions.panning){chart.pan(e,chartOptions.panning)}}},drop:function(e){var pointer=this,chart=this.chart,hasPinched=this.hasPinched;if(this.selectionMarker){var selectionData={xAxis:[],yAxis:[],originalEvent:e.originalEvent||e},selectionBox=this.selectionMarker,selectionLeft=selectionBox.attr?selectionBox.attr("x"):selectionBox.x,selectionTop=selectionBox.attr?selectionBox.attr("y"):selectionBox.y,selectionWidth=selectionBox.attr?selectionBox.attr("width"):selectionBox.width,selectionHeight=selectionBox.attr?selectionBox.attr("height"):selectionBox.height,runZoom;if(this.hasDragged||hasPinched){each(chart.axes,function(axis){if(axis.zoomEnabled&&defined(axis.min)&&(hasPinched||pointer[{xAxis:"zoomX",yAxis:"zoomY"}[axis.coll]])){var horiz=axis.horiz,minPixelPadding=e.type==="touchend"?axis.minPixelPadding:0,selectionMin=axis.toValue((horiz?selectionLeft:selectionTop)+minPixelPadding),selectionMax=axis.toValue((horiz?selectionLeft+selectionWidth:selectionTop+selectionHeight)-minPixelPadding);selectionData[axis.coll].push({axis:axis,min:mathMin(selectionMin,selectionMax),max:mathMax(selectionMin,selectionMax)});runZoom=true}});if(runZoom){fireEvent(chart,"selection",selectionData,function(args){chart.zoom(extend(args,hasPinched?{animation:false}:null))})}}this.selectionMarker=this.selectionMarker.destroy();if(hasPinched){this.scaleGroups()}}if(chart){css(chart.container,{cursor:chart._cursor});chart.cancelClick=this.hasDragged>10;chart.mouseIsDown=this.hasDragged=this.hasPinched=false;this.pinchDown=[]}},onContainerMouseDown:function(e){e=this.normalize(e);if(e.preventDefault){e.preventDefault()}this.dragStart(e)},onDocumentMouseUp:function(e){if(charts[hoverChartIndex]){charts[hoverChartIndex].pointer.drop(e)}},onDocumentMouseMove:function(e){var chart=this.chart,chartPosition=this.chartPosition;e=this.normalize(e,chartPosition);if(chartPosition&&!this.inClass(e.target,"highcharts-tracker")&&!chart.isInsidePlot(e.chartX-chart.plotLeft,e.chartY-chart.plotTop)){this.reset()}},onContainerMouseLeave:function(){var chart=charts[hoverChartIndex];if(chart){chart.pointer.reset();chart.pointer.chartPosition=null}},onContainerMouseMove:function(e){var chart=this.chart;hoverChartIndex=chart.index;e=this.normalize(e);e.returnValue=false;if(chart.mouseIsDown==="mousedown"){this.drag(e)}if((this.inClass(e.target,"highcharts-tracker")||chart.isInsidePlot(e.chartX-chart.plotLeft,e.chartY-chart.plotTop))&&!chart.openMenu){this.runPointActions(e)}},inClass:function(element,className){var elemClassName;while(element){elemClassName=attr(element,"class");if(elemClassName){if(elemClassName.indexOf(className)!==-1){return true}else if(elemClassName.indexOf(PREFIX+"container")!==-1){return false}}element=element.parentNode}},onTrackerMouseOut:function(e){var series=this.chart.hoverSeries,relatedTarget=e.relatedTarget||e.toElement,relatedSeries=relatedTarget&&relatedTarget.point&&relatedTarget.point.series;if(series&&!series.options.stickyTracking&&!this.inClass(relatedTarget,PREFIX+"tooltip")&&relatedSeries!==series){series.onMouseOut()}},onContainerClick:function(e){var chart=this.chart,hoverPoint=chart.hoverPoint,plotLeft=chart.plotLeft,plotTop=chart.plotTop;e=this.normalize(e);e.originalEvent=e;if(!chart.cancelClick){if(hoverPoint&&this.inClass(e.target,PREFIX+"tracker")){fireEvent(hoverPoint.series,"click",extend(e,{point:hoverPoint}));if(chart.hoverPoint){hoverPoint.firePointEvent("click",e)}}else{extend(e,this.getCoordinates(e));if(chart.isInsidePlot(e.chartX-plotLeft,e.chartY-plotTop)){fireEvent(chart,"click",e)}}}},setDOMEvents:function(){var pointer=this,container=pointer.chart.container;container.onmousedown=function(e){pointer.onContainerMouseDown(e)};container.onmousemove=function(e){pointer.onContainerMouseMove(e)};container.onclick=function(e){pointer.onContainerClick(e)};addEvent(container,"mouseleave",pointer.onContainerMouseLeave);if(chartCount===1){addEvent(doc,"mouseup",pointer.onDocumentMouseUp)}if(hasTouch){container.ontouchstart=function(e){pointer.onContainerTouchStart(e)};container.ontouchmove=function(e){pointer.onContainerTouchMove(e)};if(chartCount===1){addEvent(doc,"touchend",pointer.onDocumentTouchEnd)}}},destroy:function(){var prop;removeEvent(this.chart.container,"mouseleave",this.onContainerMouseLeave);if(!chartCount){removeEvent(doc,"mouseup",this.onDocumentMouseUp);removeEvent(doc,"touchend",this.onDocumentTouchEnd)}clearInterval(this.tooltipTimeout);for(prop in this){this[prop]=null}}};extend(Highcharts.Pointer.prototype,{pinchTranslate:function(pinchDown,touches,transform,selectionMarker,clip,lastValidTouch){if(this.zoomHor||this.pinchHor){this.pinchTranslateDirection(true,pinchDown,touches,transform,selectionMarker,clip,lastValidTouch)}if(this.zoomVert||this.pinchVert){this.pinchTranslateDirection(false,pinchDown,touches,transform,selectionMarker,clip,lastValidTouch)}},pinchTranslateDirection:function(horiz,pinchDown,touches,transform,selectionMarker,clip,lastValidTouch,forcedScale){var chart=this.chart,xy=horiz?"x":"y",XY=horiz?"X":"Y",sChartXY="chart"+XY,wh=horiz?"width":"height",plotLeftTop=chart["plot"+(horiz?"Left":"Top")],selectionWH,selectionXY,clipXY,scale=forcedScale||1,inverted=chart.inverted,bounds=chart.bounds[horiz?"h":"v"],singleTouch=pinchDown.length===1,touch0Start=pinchDown[0][sChartXY],touch0Now=touches[0][sChartXY],touch1Start=!singleTouch&&pinchDown[1][sChartXY],touch1Now=!singleTouch&&touches[1][sChartXY],outOfBounds,transformScale,scaleKey,setScale=function(){if(!singleTouch&&mathAbs(touch0Start-touch1Start)>20){scale=forcedScale||mathAbs(touch0Now-touch1Now)/mathAbs(touch0Start-touch1Start)}clipXY=(plotLeftTop-touch0Now)/scale+touch0Start;selectionWH=chart["plot"+(horiz?"Width":"Height")]/scale};setScale();selectionXY=clipXY;if(selectionXY<bounds.min){selectionXY=bounds.min;outOfBounds=true}else if(selectionXY+selectionWH>bounds.max){selectionXY=bounds.max-selectionWH;outOfBounds=true}if(outOfBounds){touch0Now-=.8*(touch0Now-lastValidTouch[xy][0]);if(!singleTouch){touch1Now-=.8*(touch1Now-lastValidTouch[xy][1])}setScale()}else{lastValidTouch[xy]=[touch0Now,touch1Now]}if(!inverted){clip[xy]=clipXY-plotLeftTop;clip[wh]=selectionWH}scaleKey=inverted?horiz?"scaleY":"scaleX":"scale"+XY;transformScale=inverted?1/scale:scale;selectionMarker[wh]=selectionWH;selectionMarker[xy]=selectionXY;transform[scaleKey]=scale;transform["translate"+XY]=transformScale*plotLeftTop+(touch0Now-transformScale*touch0Start)},pinch:function(e){var self=this,chart=self.chart,pinchDown=self.pinchDown,touches=e.touches,touchesLength=touches.length,lastValidTouch=self.lastValidTouch,hasZoom=self.hasZoom,selectionMarker=self.selectionMarker,transform={},fireClickEvent=touchesLength===1&&(self.inClass(e.target,PREFIX+"tracker")&&chart.runTrackerClick||self.runChartClick),clip={};if(touchesLength>1){self.initiated=true}if(hasZoom&&self.initiated&&!fireClickEvent){e.preventDefault()}map(touches,function(e){return self.normalize(e)});if(e.type==="touchstart"){each(touches,function(e,i){pinchDown[i]={chartX:e.chartX,chartY:e.chartY}});lastValidTouch.x=[pinchDown[0].chartX,pinchDown[1]&&pinchDown[1].chartX];lastValidTouch.y=[pinchDown[0].chartY,pinchDown[1]&&pinchDown[1].chartY];each(chart.axes,function(axis){if(axis.zoomEnabled){var bounds=chart.bounds[axis.horiz?"h":"v"],minPixelPadding=axis.minPixelPadding,min=axis.toPixels(pick(axis.options.min,axis.dataMin)),max=axis.toPixels(pick(axis.options.max,axis.dataMax)),absMin=mathMin(min,max),absMax=mathMax(min,max);bounds.min=mathMin(axis.pos,absMin-minPixelPadding);bounds.max=mathMax(axis.pos+axis.len,absMax+minPixelPadding)}});self.res=true}else if(pinchDown.length){if(!selectionMarker){self.selectionMarker=selectionMarker=extend({destroy:noop},chart.plotBox)}self.pinchTranslate(pinchDown,touches,transform,selectionMarker,clip,lastValidTouch);self.hasPinched=hasZoom;self.scaleGroups(transform,clip);if(!hasZoom&&self.followTouchMove&&touchesLength===1){this.runPointActions(self.normalize(e))}else if(self.res){self.res=false;this.reset(false,0)}}},touch:function(e,start){var chart=this.chart;hoverChartIndex=chart.index;if(e.touches.length===1){e=this.normalize(e);if(chart.isInsidePlot(e.chartX-chart.plotLeft,e.chartY-chart.plotTop)&&!chart.openMenu){if(start){this.runPointActions(e)}this.pinch(e)}else if(start){this.reset()}}else if(e.touches.length===2){this.pinch(e)}},onContainerTouchStart:function(e){this.touch(e,true)},onContainerTouchMove:function(e){this.touch(e)},onDocumentTouchEnd:function(e){if(charts[hoverChartIndex]){charts[hoverChartIndex].pointer.drop(e)}}});if(win.PointerEvent||win.MSPointerEvent){var touches={},hasPointerEvent=!!win.PointerEvent,getWebkitTouches=function(){var key,fake=[];fake.item=function(i){return this[i]};for(key in touches){if(touches.hasOwnProperty(key)){fake.push({pageX:touches[key].pageX,pageY:touches[key].pageY,target:touches[key].target})}}return fake},translateMSPointer=function(e,method,wktype,callback){var p;e=e.originalEvent||e;if((e.pointerType==="touch"||e.pointerType===e.MSPOINTER_TYPE_TOUCH)&&charts[hoverChartIndex]){callback(e);p=charts[hoverChartIndex].pointer;p[method]({type:wktype,target:e.currentTarget,preventDefault:noop,touches:getWebkitTouches()})}};extend(Pointer.prototype,{onContainerPointerDown:function(e){translateMSPointer(e,"onContainerTouchStart","touchstart",function(e){touches[e.pointerId]={pageX:e.pageX,pageY:e.pageY,target:e.currentTarget}})},onContainerPointerMove:function(e){translateMSPointer(e,"onContainerTouchMove","touchmove",function(e){touches[e.pointerId]={pageX:e.pageX,pageY:e.pageY};if(!touches[e.pointerId].target){touches[e.pointerId].target=e.currentTarget}})},onDocumentPointerUp:function(e){translateMSPointer(e,"onDocumentTouchEnd","touchend",function(e){delete touches[e.pointerId]})},batchMSEvents:function(fn){fn(this.chart.container,hasPointerEvent?"pointerdown":"MSPointerDown",this.onContainerPointerDown);fn(this.chart.container,hasPointerEvent?"pointermove":"MSPointerMove",this.onContainerPointerMove);fn(doc,hasPointerEvent?"pointerup":"MSPointerUp",this.onDocumentPointerUp)}});wrap(Pointer.prototype,"init",function(proceed,chart,options){proceed.call(this,chart,options);if(this.hasZoom){css(chart.container,{"-ms-touch-action":NONE,"touch-action":NONE})}});wrap(Pointer.prototype,"setDOMEvents",function(proceed){proceed.apply(this);if(this.hasZoom||this.followTouchMove){this.batchMSEvents(addEvent)}});wrap(Pointer.prototype,"destroy",function(proceed){this.batchMSEvents(removeEvent);proceed.call(this)})}var Legend=Highcharts.Legend=function(chart,options){this.init(chart,options)};Legend.prototype={init:function(chart,options){var legend=this,itemStyle=options.itemStyle,padding,itemMarginTop=options.itemMarginTop||0;this.options=options;if(!options.enabled){return}legend.itemStyle=itemStyle;legend.itemHiddenStyle=merge(itemStyle,options.itemHiddenStyle);legend.itemMarginTop=itemMarginTop;legend.padding=padding=pick(options.padding,8);legend.initialItemX=padding;legend.initialItemY=padding-5;legend.maxItemWidth=0;legend.chart=chart;legend.itemHeight=0;legend.symbolWidth=pick(options.symbolWidth,16);legend.pages=[];legend.render();addEvent(legend.chart,"endResize",function(){legend.positionCheckboxes()})},colorizeItem:function(item,visible){var legend=this,options=legend.options,legendItem=item.legendItem,legendLine=item.legendLine,legendSymbol=item.legendSymbol,hiddenColor=legend.itemHiddenStyle.color,textColor=visible?options.itemStyle.color:hiddenColor,symbolColor=visible?item.legendColor||item.color||"#CCC":hiddenColor,markerOptions=item.options&&item.options.marker,symbolAttr={fill:symbolColor},key,val;if(legendItem){legendItem.css({fill:textColor,color:textColor})}if(legendLine){legendLine.attr({stroke:symbolColor})}if(legendSymbol){if(markerOptions&&legendSymbol.isMarker){symbolAttr.stroke=symbolColor;markerOptions=item.convertAttribs(markerOptions);for(key in markerOptions){val=markerOptions[key];if(val!==UNDEFINED){symbolAttr[key]=val}}}legendSymbol.attr(symbolAttr)}},positionItem:function(item){var legend=this,options=legend.options,symbolPadding=options.symbolPadding,ltr=!options.rtl,legendItemPos=item._legendItemPos,itemX=legendItemPos[0],itemY=legendItemPos[1],checkbox=item.checkbox,legendGroup=item.legendGroup;if(legendGroup&&legendGroup.element){legendGroup.translate(ltr?itemX:legend.legendWidth-itemX-2*symbolPadding-4,itemY)}if(checkbox){checkbox.x=itemX;checkbox.y=itemY}},destroyItem:function(item){var checkbox=item.checkbox;each(["legendItem","legendLine","legendSymbol","legendGroup"],function(key){if(item[key]){item[key]=item[key].destroy()}});if(checkbox){discardElement(item.checkbox)}},destroy:function(){var legend=this,legendGroup=legend.group,box=legend.box;if(box){legend.box=box.destroy()}if(legendGroup){legend.group=legendGroup.destroy()}},positionCheckboxes:function(scrollOffset){var alignAttr=this.group.alignAttr,translateY,clipHeight=this.clipHeight||this.legendHeight;if(alignAttr){translateY=alignAttr.translateY;each(this.allItems,function(item){var checkbox=item.checkbox,top;if(checkbox){top=translateY+checkbox.y+(scrollOffset||0)+3;css(checkbox,{left:alignAttr.translateX+item.checkboxOffset+checkbox.x-20+PX,top:top+PX,display:top>translateY-6&&top<translateY+clipHeight-6?"":NONE})}})}},renderTitle:function(){var options=this.options,padding=this.padding,titleOptions=options.title,titleHeight=0,bBox;if(titleOptions.text){if(!this.title){this.title=this.chart.renderer.label(titleOptions.text,padding-3,padding-4,null,null,null,null,null,"legend-title").attr({zIndex:1}).css(titleOptions.style).add(this.group)}bBox=this.title.getBBox();titleHeight=bBox.height;this.offsetWidth=bBox.width;this.contentGroup.attr({translateY:titleHeight})}this.titleHeight=titleHeight},setText:function(item){var options=this.options;item.legendItem.attr({text:options.labelFormat?format(options.labelFormat,item):options.labelFormatter.call(item)})},renderItem:function(item){var legend=this,chart=legend.chart,renderer=chart.renderer,options=legend.options,horizontal=options.layout==="horizontal",symbolWidth=legend.symbolWidth,symbolPadding=options.symbolPadding,itemStyle=legend.itemStyle,itemHiddenStyle=legend.itemHiddenStyle,padding=legend.padding,itemDistance=horizontal?pick(options.itemDistance,20):0,ltr=!options.rtl,itemHeight,widthOption=options.width,itemMarginBottom=options.itemMarginBottom||0,itemMarginTop=legend.itemMarginTop,initialItemX=legend.initialItemX,bBox,itemWidth,li=item.legendItem,series=item.series&&item.series.drawLegendSymbol?item.series:item,seriesOptions=series.options,showCheckbox=legend.createCheckboxForItem&&seriesOptions&&seriesOptions.showCheckbox,useHTML=options.useHTML;if(!li){item.legendGroup=renderer.g("legend-item").attr({zIndex:1}).add(legend.scrollGroup);item.legendItem=li=renderer.text("",ltr?symbolWidth+symbolPadding:-symbolPadding,legend.baseline||0,useHTML).css(merge(item.visible?itemStyle:itemHiddenStyle)).attr({align:ltr?"left":"right",zIndex:2}).add(item.legendGroup);if(!legend.baseline){legend.fontMetrics=renderer.fontMetrics(itemStyle.fontSize,li);legend.baseline=legend.fontMetrics.f+3+itemMarginTop;li.attr("y",legend.baseline)}series.drawLegendSymbol(legend,item);if(legend.setItemEvents){legend.setItemEvents(item,li,useHTML,itemStyle,itemHiddenStyle)}legend.colorizeItem(item,item.visible);if(showCheckbox){legend.createCheckboxForItem(item)}}legend.setText(item);bBox=li.getBBox();itemWidth=item.checkboxOffset=options.itemWidth||item.legendItemWidth||symbolWidth+symbolPadding+bBox.width+itemDistance+(showCheckbox?20:0);legend.itemHeight=itemHeight=mathRound(item.legendItemHeight||bBox.height);if(horizontal&&legend.itemX-initialItemX+itemWidth>(widthOption||chart.chartWidth-2*padding-initialItemX-options.x)){legend.itemX=initialItemX;legend.itemY+=itemMarginTop+legend.lastLineHeight+itemMarginBottom;legend.lastLineHeight=0}legend.maxItemWidth=mathMax(legend.maxItemWidth,itemWidth);legend.lastItemY=itemMarginTop+legend.itemY+itemMarginBottom;legend.lastLineHeight=mathMax(itemHeight,legend.lastLineHeight);item._legendItemPos=[legend.itemX,legend.itemY];if(horizontal){legend.itemX+=itemWidth}else{legend.itemY+=itemMarginTop+itemHeight+itemMarginBottom;legend.lastLineHeight=itemHeight}legend.offsetWidth=widthOption||mathMax((horizontal?legend.itemX-initialItemX-itemDistance:itemWidth)+padding,legend.offsetWidth)},getAllItems:function(){var allItems=[];each(this.chart.series,function(series){var seriesOptions=series.options;if(!pick(seriesOptions.showInLegend,!defined(seriesOptions.linkedTo)?UNDEFINED:false,true)){return}allItems=allItems.concat(series.legendItems||(seriesOptions.legendType==="point"?series.data:series))});return allItems},adjustMargins:function(margin,spacing){var chart=this.chart,options=this.options,alignment=options.align[0]+options.verticalAlign[0]+options.layout[0];if(this.display&&!options.floating){each([/(lth|ct|rth)/,/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/],function(alignments,side){if(alignments.test(alignment)&&!defined(margin[side])){chart[marginNames[side]]=mathMax(chart[marginNames[side]],chart.legend[(side+1)%2?"legendHeight":"legendWidth"]+[1,-1,-1,1][side]*options[side%2?"x":"y"]+pick(options.margin,12)+spacing[side])}})}},render:function(){var legend=this,chart=legend.chart,renderer=chart.renderer,legendGroup=legend.group,allItems,display,legendWidth,legendHeight,box=legend.box,options=legend.options,padding=legend.padding,legendBorderWidth=options.borderWidth,legendBackgroundColor=options.backgroundColor;legend.itemX=legend.initialItemX;legend.itemY=legend.initialItemY;legend.offsetWidth=0;legend.lastItemY=0;if(!legendGroup){legend.group=legendGroup=renderer.g("legend").attr({zIndex:7}).add();legend.contentGroup=renderer.g().attr({zIndex:1}).add(legendGroup);legend.scrollGroup=renderer.g().add(legend.contentGroup)}legend.renderTitle();allItems=legend.getAllItems();stableSort(allItems,function(a,b){return(a.options&&a.options.legendIndex||0)-(b.options&&b.options.legendIndex||0)});if(options.reversed){allItems.reverse()}legend.allItems=allItems;legend.display=display=!!allItems.length;legend.lastLineHeight=0;each(allItems,function(item){legend.renderItem(item)});legendWidth=(options.width||legend.offsetWidth)+padding;legendHeight=legend.lastItemY+legend.lastLineHeight+legend.titleHeight;legendHeight=legend.handleOverflow(legendHeight);legendHeight+=padding;if(legendBorderWidth||legendBackgroundColor){if(!box){legend.box=box=renderer.rect(0,0,legendWidth,legendHeight,options.borderRadius,legendBorderWidth||0).attr({stroke:options.borderColor,"stroke-width":legendBorderWidth||0,fill:legendBackgroundColor||NONE}).add(legendGroup).shadow(options.shadow);box.isNew=true}else if(legendWidth>0&&legendHeight>0){box[box.isNew?"attr":"animate"](box.crisp({width:legendWidth,height:legendHeight}));box.isNew=false}box[display?"show":"hide"]()}legend.legendWidth=legendWidth;legend.legendHeight=legendHeight;each(allItems,function(item){legend.positionItem(item)});if(display){legendGroup.align(extend({width:legendWidth,height:legendHeight},options),true,"spacingBox")}if(!chart.isResizing){this.positionCheckboxes()}},handleOverflow:function(legendHeight){var legend=this,chart=this.chart,renderer=chart.renderer,options=this.options,optionsY=options.y,alignTop=options.verticalAlign==="top",spaceHeight=chart.spacingBox.height+(alignTop?-optionsY:optionsY)-this.padding,maxHeight=options.maxHeight,clipHeight,clipRect=this.clipRect,navOptions=options.navigation,animation=pick(navOptions.animation,true),arrowSize=navOptions.arrowSize||12,nav=this.nav,pages=this.pages,padding=this.padding,lastY,allItems=this.allItems,clipToHeight=function(height){
clipRect.attr({height:height});if(legend.contentGroup.div){legend.contentGroup.div.style.clip="rect("+padding+"px,9999px,"+(padding+height)+"px,0)"}};if(options.layout==="horizontal"){spaceHeight/=2}if(maxHeight){spaceHeight=mathMin(spaceHeight,maxHeight)}pages.length=0;if(legendHeight>spaceHeight){this.clipHeight=clipHeight=mathMax(spaceHeight-20-this.titleHeight-padding,0);this.currentPage=pick(this.currentPage,1);this.fullHeight=legendHeight;each(allItems,function(item,i){var y=item._legendItemPos[1],h=mathRound(item.legendItem.getBBox().height),len=pages.length;if(!len||y-pages[len-1]>clipHeight&&(lastY||y)!==pages[len-1]){pages.push(lastY||y);len++}if(i===allItems.length-1&&y+h-pages[len-1]>clipHeight){pages.push(y)}if(y!==lastY){lastY=y}});if(!clipRect){clipRect=legend.clipRect=renderer.clipRect(0,padding,9999,0);legend.contentGroup.clip(clipRect)}clipToHeight(clipHeight);if(!nav){this.nav=nav=renderer.g().attr({zIndex:1}).add(this.group);this.up=renderer.symbol("triangle",0,0,arrowSize,arrowSize).on("click",function(){legend.scroll(-1,animation)}).add(nav);this.pager=renderer.text("",15,10).css(navOptions.style).add(nav);this.down=renderer.symbol("triangle-down",0,0,arrowSize,arrowSize).on("click",function(){legend.scroll(1,animation)}).add(nav)}legend.scroll(0);legendHeight=spaceHeight}else if(nav){clipToHeight(chart.chartHeight);nav.hide();this.scrollGroup.attr({translateY:1});this.clipHeight=0}return legendHeight},scroll:function(scrollBy,animation){var pages=this.pages,pageCount=pages.length,currentPage=this.currentPage+scrollBy,clipHeight=this.clipHeight,navOptions=this.options.navigation,activeColor=navOptions.activeColor,inactiveColor=navOptions.inactiveColor,pager=this.pager,padding=this.padding,scrollOffset;if(currentPage>pageCount){currentPage=pageCount}if(currentPage>0){if(animation!==UNDEFINED){setAnimation(animation,this.chart)}this.nav.attr({translateX:padding,translateY:clipHeight+this.padding+7+this.titleHeight,visibility:VISIBLE});this.up.attr({fill:currentPage===1?inactiveColor:activeColor}).css({cursor:currentPage===1?"default":"pointer"});pager.attr({text:currentPage+"/"+pageCount});this.down.attr({x:18+this.pager.getBBox().width,fill:currentPage===pageCount?inactiveColor:activeColor}).css({cursor:currentPage===pageCount?"default":"pointer"});scrollOffset=-pages[currentPage-1]+this.initialItemY;this.scrollGroup.animate({translateY:scrollOffset});this.currentPage=currentPage;this.positionCheckboxes(scrollOffset)}}};var LegendSymbolMixin=Highcharts.LegendSymbolMixin={drawRectangle:function(legend,item){var symbolHeight=legend.options.symbolHeight||legend.fontMetrics.f;item.legendSymbol=this.chart.renderer.rect(0,legend.baseline-symbolHeight+1,legend.symbolWidth,symbolHeight,legend.options.symbolRadius||0).attr({zIndex:3}).add(item.legendGroup)},drawLineMarker:function(legend){var options=this.options,markerOptions=options.marker,radius,legendSymbol,symbolWidth=legend.symbolWidth,renderer=this.chart.renderer,legendItemGroup=this.legendGroup,verticalCenter=legend.baseline-mathRound(legend.fontMetrics.b*.3),attr;if(options.lineWidth){attr={"stroke-width":options.lineWidth};if(options.dashStyle){attr.dashstyle=options.dashStyle}this.legendLine=renderer.path([M,0,verticalCenter,L,symbolWidth,verticalCenter]).attr(attr).add(legendItemGroup)}if(markerOptions&&markerOptions.enabled!==false){radius=markerOptions.radius;this.legendSymbol=legendSymbol=renderer.symbol(this.symbol,symbolWidth/2-radius,verticalCenter-radius,2*radius,2*radius).add(legendItemGroup);legendSymbol.isMarker=true}}};if(/Trident\/7\.0/.test(userAgent)||isFirefox){wrap(Legend.prototype,"positionItem",function(proceed,item){var legend=this,runPositionItem=function(){if(item._legendItemPos){proceed.call(legend,item)}};runPositionItem();setTimeout(runPositionItem)})}var Chart=Highcharts.Chart=function(){this.init.apply(this,arguments)};Chart.prototype={callbacks:[],init:function(userOptions,callback){var options,seriesOptions=userOptions.series;userOptions.series=null;options=merge(defaultOptions,userOptions);options.series=userOptions.series=seriesOptions;this.userOptions=userOptions;var optionsChart=options.chart;this.margin=this.splashArray("margin",optionsChart);this.spacing=this.splashArray("spacing",optionsChart);var chartEvents=optionsChart.events;this.bounds={h:{},v:{}};this.callback=callback;this.isResizing=0;this.options=options;this.axes=[];this.series=[];this.hasCartesianSeries=optionsChart.showAxes;var chart=this,eventType;chart.index=charts.length;charts.push(chart);chartCount++;if(optionsChart.reflow!==false){addEvent(chart,"load",function(){chart.initReflow()})}if(chartEvents){for(eventType in chartEvents){addEvent(chart,eventType,chartEvents[eventType])}}chart.xAxis=[];chart.yAxis=[];chart.animation=useCanVG?false:pick(optionsChart.animation,true);chart.pointCount=chart.colorCounter=chart.symbolCounter=0;chart.firstRender()},initSeries:function(options){var chart=this,optionsChart=chart.options.chart,type=options.type||optionsChart.type||optionsChart.defaultSeriesType,series,constr=seriesTypes[type];if(!constr){error(17,true)}series=new constr;series.init(this,options);return series},isInsidePlot:function(plotX,plotY,inverted){var x=inverted?plotY:plotX,y=inverted?plotX:plotY;return x>=0&&x<=this.plotWidth&&y>=0&&y<=this.plotHeight},redraw:function(animation){var chart=this,axes=chart.axes,series=chart.series,pointer=chart.pointer,legend=chart.legend,redrawLegend=chart.isDirtyLegend,hasStackedSeries,hasDirtyStacks,hasCartesianSeries=chart.hasCartesianSeries,isDirtyBox=chart.isDirtyBox,seriesLength=series.length,i=seriesLength,serie,renderer=chart.renderer,isHiddenChart=renderer.isHidden(),afterRedraw=[];setAnimation(animation,chart);if(isHiddenChart){chart.cloneRenderTo()}chart.layOutTitles();while(i--){serie=series[i];if(serie.options.stacking){hasStackedSeries=true;if(serie.isDirty){hasDirtyStacks=true;break}}}if(hasDirtyStacks){i=seriesLength;while(i--){serie=series[i];if(serie.options.stacking){serie.isDirty=true}}}each(series,function(serie){if(serie.isDirty){if(serie.options.legendType==="point"){if(serie.updateTotals){serie.updateTotals()}redrawLegend=true}}});if(redrawLegend&&legend.options.enabled){legend.render();chart.isDirtyLegend=false}if(hasStackedSeries){chart.getStacks()}if(hasCartesianSeries){if(!chart.isResizing){chart.maxTicks=null;each(axes,function(axis){axis.setScale()})}}chart.getMargins();if(hasCartesianSeries){each(axes,function(axis){if(axis.isDirty){isDirtyBox=true}});each(axes,function(axis){if(axis.isDirtyExtremes){axis.isDirtyExtremes=false;afterRedraw.push(function(){fireEvent(axis,"afterSetExtremes",extend(axis.eventArgs,axis.getExtremes()));delete axis.eventArgs})}if(isDirtyBox||hasStackedSeries){axis.redraw()}})}if(isDirtyBox){chart.drawChartBox()}each(series,function(serie){if(serie.isDirty&&serie.visible&&(!serie.isCartesian||serie.xAxis)){serie.redraw()}});if(pointer){pointer.reset(true)}renderer.draw();fireEvent(chart,"redraw");if(isHiddenChart){chart.cloneRenderTo(true)}each(afterRedraw,function(callback){callback.call()})},get:function(id){var chart=this,axes=chart.axes,series=chart.series;var i,j,points;for(i=0;i<axes.length;i++){if(axes[i].options.id===id){return axes[i]}}for(i=0;i<series.length;i++){if(series[i].options.id===id){return series[i]}}for(i=0;i<series.length;i++){points=series[i].points||[];for(j=0;j<points.length;j++){if(points[j].id===id){return points[j]}}}return null},getAxes:function(){var chart=this,options=this.options,xAxisOptions=options.xAxis=splat(options.xAxis||{}),yAxisOptions=options.yAxis=splat(options.yAxis||{}),optionsArray,axis;each(xAxisOptions,function(axis,i){axis.index=i;axis.isX=true});each(yAxisOptions,function(axis,i){axis.index=i});optionsArray=xAxisOptions.concat(yAxisOptions);each(optionsArray,function(axisOptions){axis=new Axis(chart,axisOptions)})},getSelectedPoints:function(){var points=[];each(this.series,function(serie){points=points.concat(grep(serie.points||[],function(point){return point.selected}))});return points},getSelectedSeries:function(){return grep(this.series,function(serie){return serie.selected})},getStacks:function(){var chart=this;each(chart.yAxis,function(axis){if(axis.stacks&&axis.hasVisibleSeries){axis.oldStacks=axis.stacks}});each(chart.series,function(series){if(series.options.stacking&&(series.visible===true||chart.options.chart.ignoreHiddenSeries===false)){series.stackKey=series.type+pick(series.options.stack,"")}})},setTitle:function(titleOptions,subtitleOptions,redraw){var chart=this,options=chart.options,chartTitleOptions,chartSubtitleOptions;chartTitleOptions=options.title=merge(options.title,titleOptions);chartSubtitleOptions=options.subtitle=merge(options.subtitle,subtitleOptions);each([["title",titleOptions,chartTitleOptions],["subtitle",subtitleOptions,chartSubtitleOptions]],function(arr){var name=arr[0],title=chart[name],titleOptions=arr[1],chartTitleOptions=arr[2];if(title&&titleOptions){chart[name]=title=title.destroy()}if(chartTitleOptions&&chartTitleOptions.text&&!title){chart[name]=chart.renderer.text(chartTitleOptions.text,0,0,chartTitleOptions.useHTML).attr({align:chartTitleOptions.align,"class":PREFIX+name,zIndex:chartTitleOptions.zIndex||4}).css(chartTitleOptions.style).add()}});chart.layOutTitles(redraw)},layOutTitles:function(redraw){var titleOffset=0,title=this.title,subtitle=this.subtitle,options=this.options,titleOptions=options.title,subtitleOptions=options.subtitle,requiresDirtyBox,renderer=this.renderer,autoWidth=this.spacingBox.width-44;if(title){title.css({width:(titleOptions.width||autoWidth)+PX}).align(extend({y:renderer.fontMetrics(titleOptions.style.fontSize,title).b-3},titleOptions),false,"spacingBox");if(!titleOptions.floating&&!titleOptions.verticalAlign){titleOffset=title.getBBox().height}}if(subtitle){subtitle.css({width:(subtitleOptions.width||autoWidth)+PX}).align(extend({y:titleOffset+(titleOptions.margin-13)+renderer.fontMetrics(titleOptions.style.fontSize,subtitle).b},subtitleOptions),false,"spacingBox");if(!subtitleOptions.floating&&!subtitleOptions.verticalAlign){titleOffset=mathCeil(titleOffset+subtitle.getBBox().height)}}requiresDirtyBox=this.titleOffset!==titleOffset;this.titleOffset=titleOffset;if(!this.isDirtyBox&&requiresDirtyBox){this.isDirtyBox=requiresDirtyBox;if(this.hasRendered&&pick(redraw,true)&&this.isDirtyBox){this.redraw()}}},getChartSize:function(){var chart=this,optionsChart=chart.options.chart,widthOption=optionsChart.width,heightOption=optionsChart.height,renderTo=chart.renderToClone||chart.renderTo;if(!defined(widthOption)){chart.containerWidth=adapterRun(renderTo,"width")}if(!defined(heightOption)){chart.containerHeight=adapterRun(renderTo,"height")}chart.chartWidth=mathMax(0,widthOption||chart.containerWidth||600);chart.chartHeight=mathMax(0,pick(heightOption,chart.containerHeight>19?chart.containerHeight:400))},cloneRenderTo:function(revert){var clone=this.renderToClone,container=this.container;if(revert){if(clone){this.renderTo.appendChild(container);discardElement(clone);delete this.renderToClone}}else{if(container&&container.parentNode===this.renderTo){this.renderTo.removeChild(container)}this.renderToClone=clone=this.renderTo.cloneNode(0);css(clone,{position:ABSOLUTE,top:"-9999px",display:"block"});if(clone.style.setProperty){clone.style.setProperty("display","block","important")}doc.body.appendChild(clone);if(container){clone.appendChild(container)}}},getContainer:function(){var chart=this,container,optionsChart=chart.options.chart,chartWidth,chartHeight,renderTo,indexAttrName="data-highcharts-chart",oldChartIndex,containerId;chart.renderTo=renderTo=optionsChart.renderTo;containerId=PREFIX+idCounter++;if(isString(renderTo)){chart.renderTo=renderTo=doc.getElementById(renderTo)}if(!renderTo){error(13,true)}oldChartIndex=pInt(attr(renderTo,indexAttrName));if(!isNaN(oldChartIndex)&&charts[oldChartIndex]&&charts[oldChartIndex].hasRendered){charts[oldChartIndex].destroy()}attr(renderTo,indexAttrName,chart.index);renderTo.innerHTML="";if(!optionsChart.skipClone&&!renderTo.offsetWidth){chart.cloneRenderTo()}chart.getChartSize();chartWidth=chart.chartWidth;chartHeight=chart.chartHeight;chart.container=container=createElement(DIV,{className:PREFIX+"container"+(optionsChart.className?" "+optionsChart.className:""),id:containerId},extend({position:RELATIVE,overflow:HIDDEN,width:chartWidth+PX,height:chartHeight+PX,textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)"},optionsChart.style),chart.renderToClone||renderTo);chart._cursor=container.style.cursor;chart.renderer=optionsChart.forExport?new SVGRenderer(container,chartWidth,chartHeight,optionsChart.style,true):new Renderer(container,chartWidth,chartHeight,optionsChart.style);if(useCanVG){chart.renderer.create(chart,container,chartWidth,chartHeight)}chart.renderer.chartIndex=chart.index},getMargins:function(skipAxes){var chart=this,spacing=chart.spacing,margin=chart.margin,titleOffset=chart.titleOffset;chart.resetMargins();if(titleOffset&&!defined(margin[0])){chart.plotTop=mathMax(chart.plotTop,titleOffset+chart.options.title.margin+spacing[0])}chart.legend.adjustMargins(margin,spacing);if(chart.extraBottomMargin){chart.marginBottom+=chart.extraBottomMargin}if(chart.extraTopMargin){chart.plotTop+=chart.extraTopMargin}if(!skipAxes){this.getAxisMargins()}},getAxisMargins:function(){var chart=this,axisOffset=chart.axisOffset=[0,0,0,0],margin=chart.margin;if(chart.hasCartesianSeries){each(chart.axes,function(axis){axis.getOffset()})}each(marginNames,function(m,side){if(!defined(margin[side])){chart[m]+=axisOffset[side]}});chart.setChartSize()},reflow:function(e){var chart=this,optionsChart=chart.options.chart,renderTo=chart.renderTo,width=optionsChart.width||adapterRun(renderTo,"width"),height=optionsChart.height||adapterRun(renderTo,"height"),target=e?e.target:win,doReflow=function(){if(chart.container){chart.setSize(width,height,false);chart.hasUserSize=null}};if(!chart.hasUserSize&&!chart.isPrinting&&width&&height&&(target===win||target===doc)){if(width!==chart.containerWidth||height!==chart.containerHeight){clearTimeout(chart.reflowTimeout);if(e){chart.reflowTimeout=setTimeout(doReflow,100)}else{doReflow()}}chart.containerWidth=width;chart.containerHeight=height}},initReflow:function(){var chart=this,reflow=function(e){chart.reflow(e)};addEvent(win,"resize",reflow);addEvent(chart,"destroy",function(){removeEvent(win,"resize",reflow)})},setSize:function(width,height,animation){var chart=this,chartWidth,chartHeight,fireEndResize;chart.isResizing+=1;fireEndResize=function(){if(chart){fireEvent(chart,"endResize",null,function(){chart.isResizing-=1})}};setAnimation(animation,chart);chart.oldChartHeight=chart.chartHeight;chart.oldChartWidth=chart.chartWidth;if(defined(width)){chart.chartWidth=chartWidth=mathMax(0,mathRound(width));chart.hasUserSize=!!chartWidth}if(defined(height)){chart.chartHeight=chartHeight=mathMax(0,mathRound(height))}(globalAnimation?animate:css)(chart.container,{width:chartWidth+PX,height:chartHeight+PX},globalAnimation);chart.setChartSize(true);chart.renderer.setSize(chartWidth,chartHeight,animation);chart.maxTicks=null;each(chart.axes,function(axis){axis.isDirty=true;axis.setScale()});each(chart.series,function(serie){serie.isDirty=true});chart.isDirtyLegend=true;chart.isDirtyBox=true;chart.layOutTitles();chart.getMargins();chart.redraw(animation);chart.oldChartHeight=null;fireEvent(chart,"resize");if(globalAnimation===false){fireEndResize()}else{setTimeout(fireEndResize,globalAnimation&&globalAnimation.duration||500)}},setChartSize:function(skipAxes){var chart=this,inverted=chart.inverted,renderer=chart.renderer,chartWidth=chart.chartWidth,chartHeight=chart.chartHeight,optionsChart=chart.options.chart,spacing=chart.spacing,clipOffset=chart.clipOffset,clipX,clipY,plotLeft,plotTop,plotWidth,plotHeight,plotBorderWidth;chart.plotLeft=plotLeft=mathRound(chart.plotLeft);chart.plotTop=plotTop=mathRound(chart.plotTop);chart.plotWidth=plotWidth=mathMax(0,mathRound(chartWidth-plotLeft-chart.marginRight));chart.plotHeight=plotHeight=mathMax(0,mathRound(chartHeight-plotTop-chart.marginBottom));chart.plotSizeX=inverted?plotHeight:plotWidth;chart.plotSizeY=inverted?plotWidth:plotHeight;chart.plotBorderWidth=optionsChart.plotBorderWidth||0;chart.spacingBox=renderer.spacingBox={x:spacing[3],y:spacing[0],width:chartWidth-spacing[3]-spacing[1],height:chartHeight-spacing[0]-spacing[2]};chart.plotBox=renderer.plotBox={x:plotLeft,y:plotTop,width:plotWidth,height:plotHeight};plotBorderWidth=2*mathFloor(chart.plotBorderWidth/2);clipX=mathCeil(mathMax(plotBorderWidth,clipOffset[3])/2);clipY=mathCeil(mathMax(plotBorderWidth,clipOffset[0])/2);chart.clipBox={x:clipX,y:clipY,width:mathFloor(chart.plotSizeX-mathMax(plotBorderWidth,clipOffset[1])/2-clipX),height:mathMax(0,mathFloor(chart.plotSizeY-mathMax(plotBorderWidth,clipOffset[2])/2-clipY))};if(!skipAxes){each(chart.axes,function(axis){axis.setAxisSize();axis.setAxisTranslation()})}},resetMargins:function(){var chart=this;each(marginNames,function(m,side){chart[m]=pick(chart.margin[side],chart.spacing[side])});chart.axisOffset=[0,0,0,0];chart.clipOffset=[0,0,0,0]},drawChartBox:function(){var chart=this,optionsChart=chart.options.chart,renderer=chart.renderer,chartWidth=chart.chartWidth,chartHeight=chart.chartHeight,chartBackground=chart.chartBackground,plotBackground=chart.plotBackground,plotBorder=chart.plotBorder,plotBGImage=chart.plotBGImage,chartBorderWidth=optionsChart.borderWidth||0,chartBackgroundColor=optionsChart.backgroundColor,plotBackgroundColor=optionsChart.plotBackgroundColor,plotBackgroundImage=optionsChart.plotBackgroundImage,plotBorderWidth=optionsChart.plotBorderWidth||0,mgn,bgAttr,plotLeft=chart.plotLeft,plotTop=chart.plotTop,plotWidth=chart.plotWidth,plotHeight=chart.plotHeight,plotBox=chart.plotBox,clipRect=chart.clipRect,clipBox=chart.clipBox;mgn=chartBorderWidth+(optionsChart.shadow?8:0);if(chartBorderWidth||chartBackgroundColor){if(!chartBackground){bgAttr={fill:chartBackgroundColor||NONE};if(chartBorderWidth){bgAttr.stroke=optionsChart.borderColor;bgAttr["stroke-width"]=chartBorderWidth}chart.chartBackground=renderer.rect(mgn/2,mgn/2,chartWidth-mgn,chartHeight-mgn,optionsChart.borderRadius,chartBorderWidth).attr(bgAttr).addClass(PREFIX+"background").add().shadow(optionsChart.shadow)}else{chartBackground.animate(chartBackground.crisp({width:chartWidth-mgn,height:chartHeight-mgn}))}}if(plotBackgroundColor){if(!plotBackground){chart.plotBackground=renderer.rect(plotLeft,plotTop,plotWidth,plotHeight,0).attr({fill:plotBackgroundColor}).add().shadow(optionsChart.plotShadow)}else{plotBackground.animate(plotBox)}}if(plotBackgroundImage){if(!plotBGImage){chart.plotBGImage=renderer.image(plotBackgroundImage,plotLeft,plotTop,plotWidth,plotHeight).add()}else{plotBGImage.animate(plotBox)}}if(!clipRect){chart.clipRect=renderer.clipRect(clipBox)}else{clipRect.animate({width:clipBox.width,height:clipBox.height})}if(plotBorderWidth){if(!plotBorder){chart.plotBorder=renderer.rect(plotLeft,plotTop,plotWidth,plotHeight,0,-plotBorderWidth).attr({stroke:optionsChart.plotBorderColor,"stroke-width":plotBorderWidth,fill:NONE,zIndex:1}).add()}else{plotBorder.animate(plotBorder.crisp({x:plotLeft,y:plotTop,width:plotWidth,height:plotHeight,strokeWidth:-plotBorderWidth}))}}chart.isDirtyBox=false},propFromSeries:function(){var chart=this,optionsChart=chart.options.chart,klass,seriesOptions=chart.options.series,i,value;each(["inverted","angular","polar"],function(key){klass=seriesTypes[optionsChart.type||optionsChart.defaultSeriesType];value=chart[key]||optionsChart[key]||klass&&klass.prototype[key];i=seriesOptions&&seriesOptions.length;while(!value&&i--){klass=seriesTypes[seriesOptions[i].type];if(klass&&klass.prototype[key]){value=true}}chart[key]=value})},linkSeries:function(){var chart=this,chartSeries=chart.series;each(chartSeries,function(series){series.linkedSeries.length=0});each(chartSeries,function(series){var linkedTo=series.options.linkedTo;if(isString(linkedTo)){if(linkedTo===":previous"){linkedTo=chart.series[series.index-1]}else{linkedTo=chart.get(linkedTo)}if(linkedTo){linkedTo.linkedSeries.push(series);series.linkedParent=linkedTo}}})},renderSeries:function(){each(this.series,function(serie){serie.translate();serie.render()})},renderLabels:function(){var chart=this,labels=chart.options.labels;if(labels.items){each(labels.items,function(label){var style=extend(labels.style,label.style),x=pInt(style.left)+chart.plotLeft,y=pInt(style.top)+chart.plotTop+12;delete style.left;delete style.top;chart.renderer.text(label.html,x,y).attr({zIndex:2}).css(style).add()})}},render:function(){var chart=this,axes=chart.axes,renderer=chart.renderer,options=chart.options,tempWidth,tempHeight,redoHorizontal,redoVertical;chart.setTitle();chart.legend=new Legend(chart,options.legend);chart.getStacks();chart.getMargins(true);chart.setChartSize();tempWidth=chart.plotWidth;tempHeight=chart.plotHeight=chart.plotHeight-13;each(axes,function(axis){axis.setScale()});chart.getAxisMargins();redoHorizontal=tempWidth/chart.plotWidth>1.1;redoVertical=tempHeight/chart.plotHeight>1.1;if(redoHorizontal||redoVertical){chart.maxTicks=null;each(axes,function(axis){if(axis.horiz&&redoHorizontal||!axis.horiz&&redoVertical){axis.setTickInterval(true)}});chart.getMargins()}chart.drawChartBox();if(chart.hasCartesianSeries){each(axes,function(axis){axis.render()})}if(!chart.seriesGroup){chart.seriesGroup=renderer.g("series-group").attr({zIndex:3}).add()}chart.renderSeries();chart.renderLabels();chart.showCredits(options.credits);chart.hasRendered=true},showCredits:function(credits){if(credits.enabled&&!this.credits){this.credits=this.renderer.text(credits.text,0,0).on("click",function(){if(credits.href){location.href=credits.href}}).attr({align:credits.position.align,zIndex:8}).css(credits.style).add().align(credits.position)}},destroy:function(){var chart=this,axes=chart.axes,series=chart.series,container=chart.container,i,parentNode=container&&container.parentNode;fireEvent(chart,"destroy");charts[chart.index]=UNDEFINED;chartCount--;chart.renderTo.removeAttribute("data-highcharts-chart");removeEvent(chart);i=axes.length;while(i--){axes[i]=axes[i].destroy()}i=series.length;while(i--){series[i]=series[i].destroy()}each(["title","subtitle","chartBackground","plotBackground","plotBGImage","plotBorder","seriesGroup","clipRect","credits","pointer","scroller","rangeSelector","legend","resetZoomButton","tooltip","renderer"],function(name){var prop=chart[name];if(prop&&prop.destroy){chart[name]=prop.destroy()}});if(container){container.innerHTML="";removeEvent(container);if(parentNode){discardElement(container)}}for(i in chart){delete chart[i]}},isReadyToRender:function(){var chart=this;if(!hasSVG&&(win==win.top&&doc.readyState!=="complete")||useCanVG&&!win.canvg){if(useCanVG){CanVGController.push(function(){chart.firstRender()},chart.options.global.canvasToolsURL)}else{doc.attachEvent("onreadystatechange",function(){doc.detachEvent("onreadystatechange",chart.firstRender);if(doc.readyState==="complete"){chart.firstRender()}})}return false}return true},firstRender:function(){var chart=this,options=chart.options,callback=chart.callback;if(!chart.isReadyToRender()){return}chart.getContainer();fireEvent(chart,"init");chart.resetMargins();chart.setChartSize();chart.propFromSeries();chart.getAxes();each(options.series||[],function(serieOptions){chart.initSeries(serieOptions)});chart.linkSeries();fireEvent(chart,"beforeRender");if(Highcharts.Pointer){chart.pointer=new Pointer(chart,options)}chart.render();chart.renderer.draw();if(callback){callback.apply(chart,[chart])}each(chart.callbacks,function(fn){if(chart.index!==UNDEFINED){fn.apply(chart,[chart])}});fireEvent(chart,"load");chart.cloneRenderTo(true)},splashArray:function(target,options){var oVar=options[target],tArray=isObject(oVar)?oVar:[oVar,oVar,oVar,oVar];return[pick(options[target+"Top"],tArray[0]),pick(options[target+"Right"],tArray[1]),pick(options[target+"Bottom"],tArray[2]),pick(options[target+"Left"],tArray[3])]}};var CenteredSeriesMixin=Highcharts.CenteredSeriesMixin={getCenter:function(){var options=this.options,chart=this.chart,slicingRoom=2*(options.slicedOffset||0),handleSlicingRoom,plotWidth=chart.plotWidth-2*slicingRoom,plotHeight=chart.plotHeight-2*slicingRoom,centerOption=options.center,positions=[pick(centerOption[0],"50%"),pick(centerOption[1],"50%"),options.size||"100%",options.innerSize||0],smallestSize=mathMin(plotWidth,plotHeight),i,value;for(i=0;i<4;++i){value=positions[i];handleSlicingRoom=i<2||i===2&&/%$/.test(value);positions[i]=relativeLength(value,[plotWidth,plotHeight,smallestSize,positions[2]][i])+(handleSlicingRoom?slicingRoom:0)}return positions}};var Point=function(){};Point.prototype={init:function(series,options,x){var point=this,colors;point.series=series;point.color=series.color;point.applyOptions(options,x);point.pointAttr={};if(series.options.colorByPoint){colors=series.options.colors||series.chart.options.colors;point.color=point.color||colors[series.colorCounter++];if(series.colorCounter===colors.length){series.colorCounter=0}}series.chart.pointCount++;return point},applyOptions:function(options,x){var point=this,series=point.series,pointValKey=series.options.pointValKey||series.pointValKey;options=Point.prototype.optionsToObject.call(this,options);extend(point,options);point.options=point.options?extend(point.options,options):options;if(pointValKey){point.y=point[pointValKey]}if(point.x===UNDEFINED&&series){point.x=x===UNDEFINED?series.autoIncrement():x}return point},optionsToObject:function(options){var ret={},series=this.series,keys=series.options.keys,pointArrayMap=keys||series.pointArrayMap||["y"],valueCount=pointArrayMap.length,firstItemType,i=0,j=0;if(typeof options==="number"||options===null){ret[pointArrayMap[0]]=options}else if(isArray(options)){if(!keys&&options.length>valueCount){firstItemType=typeof options[0];if(firstItemType==="string"){ret.name=options[0]}else if(firstItemType==="number"){ret.x=options[0]}i++}while(j<valueCount){ret[pointArrayMap[j++]]=options[i++]}}else if(typeof options==="object"){ret=options;if(options.dataLabels){series._hasPointLabels=true}if(options.marker){series._hasPointMarkers=true}}return ret},destroy:function(){var point=this,series=point.series,chart=series.chart,hoverPoints=chart.hoverPoints,prop;chart.pointCount--;if(hoverPoints){point.setState();erase(hoverPoints,point);if(!hoverPoints.length){chart.hoverPoints=null}}if(point===chart.hoverPoint){point.onMouseOut()}if(point.graphic||point.dataLabel){removeEvent(point);point.destroyElements()}if(point.legendItem){chart.legend.destroyItem(point)}for(prop in point){point[prop]=null}},destroyElements:function(){var point=this,props=["graphic","dataLabel","dataLabelUpper","group","connector","shadowGroup"],prop,i=6;while(i--){prop=props[i];if(point[prop]){point[prop]=point[prop].destroy()}}},getLabelConfig:function(){var point=this;return{x:point.category,y:point.y,key:point.name||point.category,series:point.series,point:point,percentage:point.percentage,total:point.total||point.stackTotal}},tooltipFormatter:function(pointFormat){var series=this.series,seriesTooltipOptions=series.tooltipOptions,valueDecimals=pick(seriesTooltipOptions.valueDecimals,""),valuePrefix=seriesTooltipOptions.valuePrefix||"",valueSuffix=seriesTooltipOptions.valueSuffix||"";each(series.pointArrayMap||["y"],function(key){key="{point."+key;if(valuePrefix||valueSuffix){pointFormat=pointFormat.replace(key+"}",valuePrefix+key+"}"+valueSuffix)}pointFormat=pointFormat.replace(key+"}",key+":,."+valueDecimals+"f}")});return format(pointFormat,{point:this,series:this.series})},firePointEvent:function(eventType,eventArgs,defaultFunction){var point=this,series=this.series,seriesOptions=series.options;if(seriesOptions.point.events[eventType]||point.options&&point.options.events&&point.options.events[eventType]){this.importEvents()}if(eventType==="click"&&seriesOptions.allowPointSelect){defaultFunction=function(event){if(point.select){point.select(null,event.ctrlKey||event.metaKey||event.shiftKey)}}}fireEvent(this,eventType,eventArgs,defaultFunction)}};var Series=Highcharts.Series=function(){};Series.prototype={isCartesian:true,type:"line",pointClass:Point,sorted:true,requireSorting:true,pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor",r:"radius"},axisTypes:["xAxis","yAxis"],colorCounter:0,parallelArrays:["x","y"],init:function(chart,options){var series=this,eventType,events,chartSeries=chart.series,sortByIndex=function(a,b){return pick(a.options.index,a._i)-pick(b.options.index,b._i)};series.chart=chart;series.options=options=series.setOptions(options);series.linkedSeries=[];series.bindAxes();extend(series,{name:options.name,state:NORMAL_STATE,pointAttr:{},visible:options.visible!==false,selected:options.selected===true});if(useCanVG){options.animation=false}events=options.events;for(eventType in events){addEvent(series,eventType,events[eventType])}if(events&&events.click||options.point&&options.point.events&&options.point.events.click||options.allowPointSelect){chart.runTrackerClick=true}series.getColor();series.getSymbol();each(series.parallelArrays,function(key){series[key+"Data"]=[]});series.setData(options.data,false);if(series.isCartesian){chart.hasCartesianSeries=true}chartSeries.push(series);series._i=chartSeries.length-1;stableSort(chartSeries,sortByIndex);if(this.yAxis){stableSort(this.yAxis.series,sortByIndex)}each(chartSeries,function(series,i){series.index=i;series.name=series.name||"Series "+(i+1)})},bindAxes:function(){var series=this,seriesOptions=series.options,chart=series.chart,axisOptions;each(series.axisTypes||[],function(AXIS){each(chart[AXIS],function(axis){axisOptions=axis.options;if(seriesOptions[AXIS]===axisOptions.index||seriesOptions[AXIS]!==UNDEFINED&&seriesOptions[AXIS]===axisOptions.id||seriesOptions[AXIS]===UNDEFINED&&axisOptions.index===0){axis.series.push(series);series[AXIS]=axis;axis.isDirty=true}});if(!series[AXIS]&&series.optionalAxis!==AXIS){error(18,true)}})},updateParallelArrays:function(point,i){var series=point.series,args=arguments,fn=typeof i==="number"?function(key){var val=key==="y"&&series.toYData?series.toYData(point):point[key];series[key+"Data"][i]=val}:function(key){Array.prototype[i].apply(series[key+"Data"],Array.prototype.slice.call(args,2))};each(series.parallelArrays,fn)},autoIncrement:function(){var options=this.options,xIncrement=this.xIncrement,date,pointInterval,pointIntervalUnit=options.pointIntervalUnit;xIncrement=pick(xIncrement,options.pointStart,0);this.pointInterval=pointInterval=pick(this.pointInterval,options.pointInterval,1);if(pointIntervalUnit==="month"||pointIntervalUnit==="year"){date=new Date(xIncrement);date=pointIntervalUnit==="month"?+date[setMonth](date[getMonth]()+pointInterval):+date[setFullYear](date[getFullYear]()+pointInterval);pointInterval=date-xIncrement}this.xIncrement=xIncrement+pointInterval;return xIncrement},getSegments:function(){var series=this,lastNull=-1,segments=[],i,points=series.points,pointsLength=points.length;if(pointsLength){if(series.options.connectNulls){i=pointsLength;while(i--){if(points[i].y===null){points.splice(i,1)}}if(points.length){segments=[points]}}else{each(points,function(point,i){if(point.y===null){if(i>lastNull+1){segments.push(points.slice(lastNull+1,i))}lastNull=i}else if(i===pointsLength-1){segments.push(points.slice(lastNull+1,i+1))}})}}series.segments=segments},setOptions:function(itemOptions){var chart=this.chart,chartOptions=chart.options,plotOptions=chartOptions.plotOptions,userOptions=chart.userOptions||{},userPlotOptions=userOptions.plotOptions||{},typeOptions=plotOptions[this.type],options,zones;this.userOptions=itemOptions;options=merge(typeOptions,plotOptions.series,itemOptions);this.tooltipOptions=merge(defaultOptions.tooltip,defaultOptions.plotOptions[this.type].tooltip,userOptions.tooltip,userPlotOptions.series&&userPlotOptions.series.tooltip,userPlotOptions[this.type]&&userPlotOptions[this.type].tooltip,itemOptions.tooltip);
if(typeOptions.marker===null){delete options.marker}this.zoneAxis=options.zoneAxis;zones=this.zones=(options.zones||[]).slice();if((options.negativeColor||options.negativeFillColor)&&!options.zones){zones.push({value:options[this.zoneAxis+"Threshold"]||options.threshold||0,color:options.negativeColor,fillColor:options.negativeFillColor})}if(zones.length){if(defined(zones[zones.length-1].value)){zones.push({color:this.color,fillColor:this.fillColor})}}return options},getCyclic:function(prop,value,defaults){var i,userOptions=this.userOptions,indexName="_"+prop+"Index",counterName=prop+"Counter";if(!value){if(defined(userOptions[indexName])){i=userOptions[indexName]}else{userOptions[indexName]=i=this.chart[counterName]%defaults.length;this.chart[counterName]+=1}value=defaults[i]}this[prop]=value},getColor:function(){if(!this.options.colorByPoint){this.getCyclic("color",this.options.color||defaultPlotOptions[this.type].color,this.chart.options.colors)}},getSymbol:function(){var seriesMarkerOption=this.options.marker;this.getCyclic("symbol",seriesMarkerOption.symbol,this.chart.options.symbols);if(/^url/.test(this.symbol)){seriesMarkerOption.radius=0}},drawLegendSymbol:LegendSymbolMixin.drawLineMarker,setData:function(data,redraw,animation,updatePoints){var series=this,oldData=series.points,oldDataLength=oldData&&oldData.length||0,dataLength,options=series.options,chart=series.chart,firstPoint=null,xAxis=series.xAxis,hasCategories=xAxis&&!!xAxis.categories,i,turboThreshold=options.turboThreshold,pt,xData=this.xData,yData=this.yData,pointArrayMap=series.pointArrayMap,valueCount=pointArrayMap&&pointArrayMap.length;data=data||[];dataLength=data.length;redraw=pick(redraw,true);if(updatePoints!==false&&dataLength&&oldDataLength===dataLength&&!series.cropped&&!series.hasGroupedData&&series.visible){each(data,function(point,i){if(oldData[i].update){oldData[i].update(point,false,null,false)}})}else{series.xIncrement=null;series.pointRange=hasCategories?1:options.pointRange;series.colorCounter=0;each(this.parallelArrays,function(key){series[key+"Data"].length=0});if(turboThreshold&&dataLength>turboThreshold){i=0;while(firstPoint===null&&i<dataLength){firstPoint=data[i];i++}if(isNumber(firstPoint)){var x=pick(options.pointStart,0),pointInterval=pick(options.pointInterval,1);for(i=0;i<dataLength;i++){xData[i]=x;yData[i]=data[i];x+=pointInterval}series.xIncrement=x}else if(isArray(firstPoint)){if(valueCount){for(i=0;i<dataLength;i++){pt=data[i];xData[i]=pt[0];yData[i]=pt.slice(1,valueCount+1)}}else{for(i=0;i<dataLength;i++){pt=data[i];xData[i]=pt[0];yData[i]=pt[1]}}}else{error(12)}}else{for(i=0;i<dataLength;i++){if(data[i]!==UNDEFINED){pt={series:series};series.pointClass.prototype.applyOptions.apply(pt,[data[i]]);series.updateParallelArrays(pt,i);if(hasCategories&&pt.name){xAxis.names[pt.x]=pt.name}}}}if(isString(yData[0])){error(14,true)}series.data=[];series.options.data=data;i=oldDataLength;while(i--){if(oldData[i]&&oldData[i].destroy){oldData[i].destroy()}}if(xAxis){xAxis.minRange=xAxis.userMinRange}series.isDirty=series.isDirtyData=chart.isDirtyBox=true;animation=false}if(redraw){chart.redraw(animation)}},processData:function(force){var series=this,processedXData=series.xData,processedYData=series.yData,dataLength=processedXData.length,croppedData,cropStart=0,cropped,distance,closestPointRange,xAxis=series.xAxis,i,options=series.options,cropThreshold=options.cropThreshold,isCartesian=series.isCartesian,xExtremes,min,max;if(isCartesian&&!series.isDirty&&!xAxis.isDirty&&!series.yAxis.isDirty&&!force){return false}if(xAxis){xExtremes=xAxis.getExtremes();min=xExtremes.min;max=xExtremes.max}if(isCartesian&&series.sorted&&(!cropThreshold||dataLength>cropThreshold||series.forceCrop)){if(processedXData[dataLength-1]<min||processedXData[0]>max){processedXData=[];processedYData=[]}else if(processedXData[0]<min||processedXData[dataLength-1]>max){croppedData=this.cropData(series.xData,series.yData,min,max);processedXData=croppedData.xData;processedYData=croppedData.yData;cropStart=croppedData.start;cropped=true}}for(i=processedXData.length-1;i>=0;i--){distance=processedXData[i]-processedXData[i-1];if(distance>0&&(closestPointRange===UNDEFINED||distance<closestPointRange)){closestPointRange=distance}else if(distance<0&&series.requireSorting){error(15)}}series.cropped=cropped;series.cropStart=cropStart;series.processedXData=processedXData;series.processedYData=processedYData;if(options.pointRange===null){series.pointRange=closestPointRange||1}series.closestPointRange=closestPointRange},cropData:function(xData,yData,min,max){var dataLength=xData.length,cropStart=0,cropEnd=dataLength,cropShoulder=pick(this.cropShoulder,1),i;for(i=0;i<dataLength;i++){if(xData[i]>=min){cropStart=mathMax(0,i-cropShoulder);break}}for(;i<dataLength;i++){if(xData[i]>max){cropEnd=i+cropShoulder;break}}return{xData:xData.slice(cropStart,cropEnd),yData:yData.slice(cropStart,cropEnd),start:cropStart,end:cropEnd}},generatePoints:function(){var series=this,options=series.options,dataOptions=options.data,data=series.data,dataLength,processedXData=series.processedXData,processedYData=series.processedYData,pointClass=series.pointClass,processedDataLength=processedXData.length,cropStart=series.cropStart||0,cursor,hasGroupedData=series.hasGroupedData,point,points=[],i;if(!data&&!hasGroupedData){var arr=[];arr.length=dataOptions.length;data=series.data=arr}for(i=0;i<processedDataLength;i++){cursor=cropStart+i;if(!hasGroupedData){if(data[cursor]){point=data[cursor]}else if(dataOptions[cursor]!==UNDEFINED){data[cursor]=point=(new pointClass).init(series,dataOptions[cursor],processedXData[i])}points[i]=point}else{points[i]=(new pointClass).init(series,[processedXData[i]].concat(splat(processedYData[i])))}points[i].index=cursor}if(data&&(processedDataLength!==(dataLength=data.length)||hasGroupedData)){for(i=0;i<dataLength;i++){if(i===cropStart&&!hasGroupedData){i+=processedDataLength}if(data[i]){data[i].destroyElements();data[i].plotX=UNDEFINED}}}series.data=data;series.points=points},getExtremes:function(yData){var xAxis=this.xAxis,yAxis=this.yAxis,xData=this.processedXData,yDataLength,activeYData=[],activeCounter=0,xExtremes=xAxis.getExtremes(),xMin=xExtremes.min,xMax=xExtremes.max,validValue,withinRange,x,y,i,j;yData=yData||this.stackedYData||this.processedYData;yDataLength=yData.length;for(i=0;i<yDataLength;i++){x=xData[i];y=yData[i];validValue=y!==null&&y!==UNDEFINED&&(!yAxis.isLog||(y.length||y>0));withinRange=this.getExtremesFromAll||this.options.getExtremesFromAll||this.cropped||(xData[i+1]||x)>=xMin&&(xData[i-1]||x)<=xMax;if(validValue&&withinRange){j=y.length;if(j){while(j--){if(y[j]!==null){activeYData[activeCounter++]=y[j]}}}else{activeYData[activeCounter++]=y}}}this.dataMin=arrayMin(activeYData);this.dataMax=arrayMax(activeYData)},translate:function(){if(!this.processedXData){this.processData()}this.generatePoints();var series=this,options=series.options,stacking=options.stacking,xAxis=series.xAxis,categories=xAxis.categories,yAxis=series.yAxis,points=series.points,dataLength=points.length,hasModifyValue=!!series.modifyValue,i,pointPlacement=options.pointPlacement,dynamicallyPlaced=pointPlacement==="between"||isNumber(pointPlacement),threshold=options.threshold,stackThreshold=options.startFromThreshold?threshold:0,plotX,plotY,lastPlotX,closestPointRangePx=Number.MAX_VALUE;for(i=0;i<dataLength;i++){var point=points[i],xValue=point.x,yValue=point.y,yBottom=point.low,stack=stacking&&yAxis.stacks[(series.negStacks&&yValue<(stackThreshold?0:threshold)?"-":"")+series.stackKey],pointStack,stackValues;if(yAxis.isLog&&yValue!==null&&yValue<=0){point.y=yValue=null;error(10)}point.plotX=plotX=mathMin(mathMax(-1e5,xAxis.translate(xValue,0,0,0,1,pointPlacement,this.type==="flags")),1e5);if(stacking&&series.visible&&stack&&stack[xValue]){pointStack=stack[xValue];stackValues=pointStack.points[series.index+","+i];yBottom=stackValues[0];yValue=stackValues[1];if(yBottom===stackThreshold){yBottom=pick(threshold,yAxis.min)}if(yAxis.isLog&&yBottom<=0){yBottom=null}point.total=point.stackTotal=pointStack.total;point.percentage=pointStack.total&&point.y/pointStack.total*100;point.stackY=yValue;pointStack.setOffset(series.pointXOffset||0,series.barW||0)}point.yBottom=defined(yBottom)?yAxis.translate(yBottom,0,1,0,1):null;if(hasModifyValue){yValue=series.modifyValue(yValue,point)}point.plotY=plotY=typeof yValue==="number"&&yValue!==Infinity?mathMin(mathMax(-1e5,yAxis.translate(yValue,0,1,0,1)),1e5):UNDEFINED;point.isInside=plotY!==UNDEFINED&&plotY>=0&&plotY<=yAxis.len&&plotX>=0&&plotX<=xAxis.len;point.clientX=dynamicallyPlaced?xAxis.translate(xValue,0,0,0,1):plotX;point.negative=point.y<(threshold||0);point.category=categories&&categories[point.x]!==UNDEFINED?categories[point.x]:point.x;if(i){closestPointRangePx=mathMin(closestPointRangePx,mathAbs(plotX-lastPlotX))}lastPlotX=plotX}series.closestPointRangePx=closestPointRangePx;series.getSegments()},setClip:function(animation){var chart=this.chart,renderer=chart.renderer,inverted=chart.inverted,seriesClipBox=this.clipBox,clipBox=seriesClipBox||chart.clipBox,sharedClipKey=this.sharedClipKey||["_sharedClip",animation&&animation.duration,animation&&animation.easing,clipBox.height].join(","),clipRect=chart[sharedClipKey],markerClipRect=chart[sharedClipKey+"m"];if(!clipRect){if(animation){clipBox.width=0;chart[sharedClipKey+"m"]=markerClipRect=renderer.clipRect(-99,inverted?-chart.plotLeft:-chart.plotTop,99,inverted?chart.chartWidth:chart.chartHeight)}chart[sharedClipKey]=clipRect=renderer.clipRect(clipBox)}if(animation){clipRect.count+=1}if(this.options.clip!==false){this.group.clip(animation||seriesClipBox?clipRect:chart.clipRect);this.markerGroup.clip(markerClipRect);this.sharedClipKey=sharedClipKey}if(!animation){clipRect.count-=1;if(clipRect.count<=0&&sharedClipKey&&chart[sharedClipKey]){if(!seriesClipBox){chart[sharedClipKey]=chart[sharedClipKey].destroy()}if(chart[sharedClipKey+"m"]){chart[sharedClipKey+"m"]=chart[sharedClipKey+"m"].destroy()}}}},animate:function(init){var series=this,chart=series.chart,clipRect,animation=series.options.animation,sharedClipKey;if(animation&&!isObject(animation)){animation=defaultPlotOptions[series.type].animation}if(init){series.setClip(animation)}else{sharedClipKey=this.sharedClipKey;clipRect=chart[sharedClipKey];if(clipRect){clipRect.animate({width:chart.plotSizeX},animation)}if(chart[sharedClipKey+"m"]){chart[sharedClipKey+"m"].animate({width:chart.plotSizeX+99},animation)}series.animate=null}},afterAnimate:function(){this.setClip();fireEvent(this,"afterAnimate")},drawPoints:function(){var series=this,pointAttr,points=series.points,chart=series.chart,plotX,plotY,i,point,radius,symbol,isImage,graphic,options=series.options,seriesMarkerOptions=options.marker,seriesPointAttr=series.pointAttr[""],pointMarkerOptions,hasPointMarker,enabled,isInside,markerGroup=series.markerGroup,xAxis=series.xAxis,globallyEnabled=pick(seriesMarkerOptions.enabled,xAxis.isRadial,series.closestPointRangePx>2*seriesMarkerOptions.radius);if(seriesMarkerOptions.enabled!==false||series._hasPointMarkers){i=points.length;while(i--){point=points[i];plotX=mathFloor(point.plotX);plotY=point.plotY;graphic=point.graphic;pointMarkerOptions=point.marker||{};hasPointMarker=!!point.marker;enabled=globallyEnabled&&pointMarkerOptions.enabled===UNDEFINED||pointMarkerOptions.enabled;isInside=point.isInside;if(enabled&&plotY!==UNDEFINED&&!isNaN(plotY)&&point.y!==null){pointAttr=point.pointAttr[point.selected?SELECT_STATE:NORMAL_STATE]||seriesPointAttr;radius=pointAttr.r;symbol=pick(pointMarkerOptions.symbol,series.symbol);isImage=symbol.indexOf("url")===0;if(graphic){graphic[isInside?"show":"hide"](true).animate(extend({x:plotX-radius,y:plotY-radius},graphic.symbolName?{width:2*radius,height:2*radius}:{}))}else if(isInside&&(radius>0||isImage)){point.graphic=graphic=chart.renderer.symbol(symbol,plotX-radius,plotY-radius,2*radius,2*radius,hasPointMarker?pointMarkerOptions:seriesMarkerOptions).attr(pointAttr).add(markerGroup)}}else if(graphic){point.graphic=graphic.destroy()}}}},convertAttribs:function(options,base1,base2,base3){var conversion=this.pointAttrToOptions,attr,option,obj={};options=options||{};base1=base1||{};base2=base2||{};base3=base3||{};for(attr in conversion){option=conversion[attr];obj[attr]=pick(options[option],base1[attr],base2[attr],base3[attr])}return obj},getAttribs:function(){var series=this,seriesOptions=series.options,normalOptions=defaultPlotOptions[series.type].marker?seriesOptions.marker:seriesOptions,stateOptions=normalOptions.states,stateOptionsHover=stateOptions[HOVER_STATE],pointStateOptionsHover,seriesColor=series.color,seriesNegativeColor=series.options.negativeColor,normalDefaults={stroke:seriesColor,fill:seriesColor},points=series.points||[],i,point,seriesPointAttr=[],pointAttr,pointAttrToOptions=series.pointAttrToOptions,hasPointSpecificOptions=series.hasPointSpecificOptions,defaultLineColor=normalOptions.lineColor,defaultFillColor=normalOptions.fillColor,turboThreshold=seriesOptions.turboThreshold,zones=series.zones,zoneAxis=series.zoneAxis||"y",attr,key;if(seriesOptions.marker){stateOptionsHover.radius=stateOptionsHover.radius||normalOptions.radius+stateOptionsHover.radiusPlus;stateOptionsHover.lineWidth=stateOptionsHover.lineWidth||normalOptions.lineWidth+stateOptionsHover.lineWidthPlus}else{stateOptionsHover.color=stateOptionsHover.color||Color(stateOptionsHover.color||seriesColor).brighten(stateOptionsHover.brightness).get();stateOptionsHover.negativeColor=stateOptionsHover.negativeColor||Color(stateOptionsHover.negativeColor||seriesNegativeColor).brighten(stateOptionsHover.brightness).get()}seriesPointAttr[NORMAL_STATE]=series.convertAttribs(normalOptions,normalDefaults);each([HOVER_STATE,SELECT_STATE],function(state){seriesPointAttr[state]=series.convertAttribs(stateOptions[state],seriesPointAttr[NORMAL_STATE])});series.pointAttr=seriesPointAttr;i=points.length;if(!turboThreshold||i<turboThreshold||hasPointSpecificOptions){while(i--){point=points[i];normalOptions=point.options&&point.options.marker||point.options;if(normalOptions&&normalOptions.enabled===false){normalOptions.radius=0}if(zones.length){var j=0,threshold=zones[j];while(point[zoneAxis]>=threshold.value){threshold=zones[++j]}point.color=point.fillColor=threshold.color}hasPointSpecificOptions=seriesOptions.colorByPoint||point.color;if(point.options){for(key in pointAttrToOptions){if(defined(normalOptions[pointAttrToOptions[key]])){hasPointSpecificOptions=true}}}if(hasPointSpecificOptions){normalOptions=normalOptions||{};pointAttr=[];stateOptions=normalOptions.states||{};pointStateOptionsHover=stateOptions[HOVER_STATE]=stateOptions[HOVER_STATE]||{};if(!seriesOptions.marker){pointStateOptionsHover.color=pointStateOptionsHover.color||!point.options.color&&stateOptionsHover[point.negative&&seriesNegativeColor?"negativeColor":"color"]||Color(point.color).brighten(pointStateOptionsHover.brightness||stateOptionsHover.brightness).get()}attr={color:point.color};if(!defaultFillColor){attr.fillColor=point.color}if(!defaultLineColor){attr.lineColor=point.color}if(normalOptions.hasOwnProperty("color")&&!normalOptions.color){delete normalOptions.color}pointAttr[NORMAL_STATE]=series.convertAttribs(extend(attr,normalOptions),seriesPointAttr[NORMAL_STATE]);pointAttr[HOVER_STATE]=series.convertAttribs(stateOptions[HOVER_STATE],seriesPointAttr[HOVER_STATE],pointAttr[NORMAL_STATE]);pointAttr[SELECT_STATE]=series.convertAttribs(stateOptions[SELECT_STATE],seriesPointAttr[SELECT_STATE],pointAttr[NORMAL_STATE])}else{pointAttr=seriesPointAttr}point.pointAttr=pointAttr}}},destroy:function(){var series=this,chart=series.chart,issue134=/AppleWebKit\/533/.test(userAgent),destroy,i,data=series.data||[],point,prop,axis;fireEvent(series,"destroy");removeEvent(series);each(series.axisTypes||[],function(AXIS){axis=series[AXIS];if(axis){erase(axis.series,series);axis.isDirty=axis.forceRedraw=true}});if(series.legendItem){series.chart.legend.destroyItem(series)}i=data.length;while(i--){point=data[i];if(point&&point.destroy){point.destroy()}}series.points=null;clearTimeout(series.animationTimeout);for(prop in series){if(series[prop]instanceof SVGElement&&!series[prop].survive){destroy=issue134&&prop==="group"?"hide":"destroy";series[prop][destroy]()}}if(chart.hoverSeries===series){chart.hoverSeries=null}erase(chart.series,series);for(prop in series){delete series[prop]}},getSegmentPath:function(segment){var series=this,segmentPath=[],step=series.options.step;each(segment,function(point,i){var plotX=point.plotX,plotY=point.plotY,lastPoint;if(series.getPointSpline){segmentPath.push.apply(segmentPath,series.getPointSpline(segment,point,i))}else{segmentPath.push(i?L:M);if(step&&i){lastPoint=segment[i-1];if(step==="right"){segmentPath.push(lastPoint.plotX,plotY)}else if(step==="center"){segmentPath.push((lastPoint.plotX+plotX)/2,lastPoint.plotY,(lastPoint.plotX+plotX)/2,plotY)}else{segmentPath.push(plotX,lastPoint.plotY)}}segmentPath.push(point.plotX,point.plotY)}});return segmentPath},getGraphPath:function(){var series=this,graphPath=[],segmentPath,singlePoints=[];each(series.segments,function(segment){segmentPath=series.getSegmentPath(segment);if(segment.length>1){graphPath=graphPath.concat(segmentPath)}else{singlePoints.push(segment[0])}});series.singlePoints=singlePoints;series.graphPath=graphPath;return graphPath},drawGraph:function(){var series=this,options=this.options,props=[["graph",options.lineColor||this.color,options.dashStyle]],lineWidth=options.lineWidth,roundCap=options.linecap!=="square",graphPath=this.getGraphPath(),fillColor=this.fillGraph&&this.color||NONE,zones=this.zones;each(zones,function(threshold,i){props.push(["zoneGraph"+i,threshold.color||series.color,threshold.dashStyle||options.dashStyle])});each(props,function(prop,i){var graphKey=prop[0],graph=series[graphKey],attribs;if(graph){stop(graph);graph.animate({d:graphPath})}else if((lineWidth||fillColor)&&graphPath.length){attribs={stroke:prop[1],"stroke-width":lineWidth,fill:fillColor,zIndex:1};if(prop[2]){attribs.dashstyle=prop[2]}else if(roundCap){attribs["stroke-linecap"]=attribs["stroke-linejoin"]="round"}series[graphKey]=series.chart.renderer.path(graphPath).attr(attribs).add(series.group).shadow(i<2&&options.shadow)}})},applyZones:function(){var series=this,chart=this.chart,renderer=chart.renderer,zones=this.zones,translatedFrom,translatedTo,clips=this.clips||[],clipAttr,graph=this.graph,area=this.area,chartSizeMax=mathMax(chart.chartWidth,chart.chartHeight),zoneAxis=this.zoneAxis||"y",axis=this[zoneAxis+"Axis"],extremes,reversed=axis.reversed,inverted=chart.inverted,horiz=axis.horiz,pxRange,pxPosMin,pxPosMax,ignoreZones=false;if(zones.length&&(graph||area)){if(graph){graph.hide()}if(area){area.hide()}extremes=axis.getExtremes();each(zones,function(threshold,i){translatedFrom=reversed?horiz?chart.plotWidth:0:horiz?0:axis.toPixels(extremes.min);translatedFrom=mathMin(mathMax(pick(translatedTo,translatedFrom),0),chartSizeMax);translatedTo=mathMin(mathMax(mathRound(axis.toPixels(pick(threshold.value,extremes.max),true)),0),chartSizeMax);if(ignoreZones){translatedFrom=translatedTo=axis.toPixels(extremes.max)}pxRange=Math.abs(translatedFrom-translatedTo);pxPosMin=mathMin(translatedFrom,translatedTo);pxPosMax=mathMax(translatedFrom,translatedTo);if(axis.isXAxis){clipAttr={x:inverted?pxPosMax:pxPosMin,y:0,width:pxRange,height:chartSizeMax};if(!horiz){clipAttr.x=chart.plotHeight-clipAttr.x}}else{clipAttr={x:0,y:inverted?pxPosMax:pxPosMin,width:chartSizeMax,height:pxRange};if(horiz){clipAttr.y=chart.plotWidth-clipAttr.y}}if(chart.inverted&&renderer.isVML){if(axis.isXAxis){clipAttr={x:0,y:reversed?pxPosMin:pxPosMax,height:clipAttr.width,width:chart.chartWidth}}else{clipAttr={x:clipAttr.y-chart.plotLeft-chart.spacingBox.x,y:0,width:clipAttr.height,height:chart.chartHeight}}}if(clips[i]){clips[i].animate(clipAttr)}else{clips[i]=renderer.clipRect(clipAttr);if(graph){series["zoneGraph"+i].clip(clips[i])}if(area){series["zoneArea"+i].clip(clips[i])}}ignoreZones=threshold.value>extremes.max});this.clips=clips}},invertGroups:function(){var series=this,chart=series.chart;if(!series.xAxis){return}function setInvert(){var size={width:series.yAxis.len,height:series.xAxis.len};each(["group","markerGroup"],function(groupName){if(series[groupName]){series[groupName].attr(size).invert()}})}addEvent(chart,"resize",setInvert);addEvent(series,"destroy",function(){removeEvent(chart,"resize",setInvert)});setInvert();series.invertGroups=setInvert},plotGroup:function(prop,name,visibility,zIndex,parent){var group=this[prop],isNew=!group;if(isNew){this[prop]=group=this.chart.renderer.g(name).attr({visibility:visibility,zIndex:zIndex||.1}).add(parent)}group[isNew?"attr":"animate"](this.getPlotBox());return group},getPlotBox:function(){var chart=this.chart,xAxis=this.xAxis,yAxis=this.yAxis;if(chart.inverted){xAxis=yAxis;yAxis=this.xAxis}return{translateX:xAxis?xAxis.left:chart.plotLeft,translateY:yAxis?yAxis.top:chart.plotTop,scaleX:1,scaleY:1}},render:function(){var series=this,chart=series.chart,group,options=series.options,animation=options.animation,animDuration=animation&&!!series.animate&&chart.renderer.isSVG&&pick(animation.duration,500)||0,visibility=series.visible?VISIBLE:HIDDEN,zIndex=options.zIndex,hasRendered=series.hasRendered,chartSeriesGroup=chart.seriesGroup;group=series.plotGroup("group","series",visibility,zIndex,chartSeriesGroup);series.markerGroup=series.plotGroup("markerGroup","markers",visibility,zIndex,chartSeriesGroup);if(animDuration){series.animate(true)}series.getAttribs();group.inverted=series.isCartesian?chart.inverted:false;if(series.drawGraph){series.drawGraph();series.applyZones()}each(series.points,function(point){if(point.redraw){point.redraw()}});if(series.drawDataLabels){series.drawDataLabels()}if(series.visible){series.drawPoints()}if(series.drawTracker&&series.options.enableMouseTracking!==false){series.drawTracker()}if(chart.inverted){series.invertGroups()}if(options.clip!==false&&!series.sharedClipKey&&!hasRendered){group.clip(chart.clipRect)}if(animDuration){series.animate()}if(!hasRendered){if(animDuration){series.animationTimeout=setTimeout(function(){series.afterAnimate()},animDuration)}else{series.afterAnimate()}}series.isDirty=series.isDirtyData=false;series.hasRendered=true},redraw:function(){var series=this,chart=series.chart,wasDirtyData=series.isDirtyData,wasDirty=series.isDirty,group=series.group,xAxis=series.xAxis,yAxis=series.yAxis;if(group){if(chart.inverted){group.attr({width:chart.plotWidth,height:chart.plotHeight})}group.animate({translateX:pick(xAxis&&xAxis.left,chart.plotLeft),translateY:pick(yAxis&&yAxis.top,chart.plotTop)})}series.translate();series.render();if(wasDirtyData){fireEvent(series,"updatedData")}if(wasDirty||wasDirtyData){delete this.kdTree}},kdDimensions:1,kdAxisArray:["clientX","plotY"],searchPoint:function(e,compareX){var series=this,xAxis=series.xAxis,yAxis=series.yAxis,inverted=series.chart.inverted;return this.searchKDTree({clientX:inverted?xAxis.len-e.chartY+xAxis.pos:e.chartX-xAxis.pos,plotY:inverted?yAxis.len-e.chartX+yAxis.pos:e.chartY-yAxis.pos},compareX)},buildKDTree:function(){var series=this,dimensions=series.kdDimensions;function _kdtree(points,depth,dimensions){var axis,median,length=points&&points.length;if(length){axis=series.kdAxisArray[depth%dimensions];points.sort(function(a,b){return a[axis]-b[axis]});median=Math.floor(length/2);return{point:points[median],left:_kdtree(points.slice(0,median),depth+1,dimensions),right:_kdtree(points.slice(median+1),depth+1,dimensions)}}}function startRecursive(){var points=grep(series.points,function(point){return point.y!==null});series.kdTree=_kdtree(points,dimensions,dimensions)}delete series.kdTree;if(series.options.kdSync){startRecursive()}else{setTimeout(startRecursive)}},searchKDTree:function(point,compareX){var series=this,kdX=this.kdAxisArray[0],kdY=this.kdAxisArray[1],kdComparer=compareX?"distX":"dist";function setDistance(p1,p2){var x=defined(p1[kdX])&&defined(p2[kdX])?Math.pow(p1[kdX]-p2[kdX],2):null,y=defined(p1[kdY])&&defined(p2[kdY])?Math.pow(p1[kdY]-p2[kdY],2):null,r=(x||0)+(y||0);p2.dist=defined(r)?Math.sqrt(r):Number.MAX_VALUE;p2.distX=defined(x)?Math.sqrt(x):Number.MAX_VALUE}function _search(search,tree,depth,dimensions){var point=tree.point,axis=series.kdAxisArray[depth%dimensions],tdist,sideA,sideB,ret=point,nPoint1,nPoint2;setDistance(search,point);tdist=search[axis]-point[axis];sideA=tdist<0?"left":"right";sideB=tdist<0?"right":"left";if(tree[sideA]){nPoint1=_search(search,tree[sideA],depth+1,dimensions);ret=nPoint1[kdComparer]<ret[kdComparer]?nPoint1:point}if(tree[sideB]){if(Math.sqrt(tdist*tdist)<ret[kdComparer]){nPoint2=_search(search,tree[sideB],depth+1,dimensions);ret=nPoint2[kdComparer]<ret[kdComparer]?nPoint2:ret}}return ret}if(!this.kdTree){this.buildKDTree()}if(this.kdTree){return _search(point,this.kdTree,this.kdDimensions,this.kdDimensions)}}};function StackItem(axis,options,isNegative,x,stackOption){var inverted=axis.chart.inverted;this.axis=axis;this.isNegative=isNegative;this.options=options;this.x=x;this.total=null;this.points={};this.stack=stackOption;this.alignOptions={align:options.align||(inverted?isNegative?"left":"right":"center"),verticalAlign:options.verticalAlign||(inverted?"middle":isNegative?"bottom":"top"),y:pick(options.y,inverted?4:isNegative?14:-6),x:pick(options.x,inverted?isNegative?-6:6:0)};this.textAlign=options.textAlign||(inverted?isNegative?"right":"left":"center")}StackItem.prototype={destroy:function(){destroyObjectProperties(this,this.axis)},render:function(group){var options=this.options,formatOption=options.format,str=formatOption?format(formatOption,this):options.formatter.call(this);if(this.label){this.label.attr({text:str,visibility:HIDDEN})}else{this.label=this.axis.chart.renderer.text(str,null,null,options.useHTML).css(options.style).attr({align:this.textAlign,rotation:options.rotation,visibility:HIDDEN}).add(group)}},setOffset:function(xOffset,xWidth){var stackItem=this,axis=stackItem.axis,chart=axis.chart,inverted=chart.inverted,reversed=axis.reversed,neg=this.isNegative&&!reversed||!this.isNegative&&reversed,y=axis.translate(axis.usePercentage?100:this.total,0,0,0,1),yZero=axis.translate(0),h=mathAbs(y-yZero),x=chart.xAxis[0].translate(this.x)+xOffset,plotHeight=chart.plotHeight,stackBox={x:inverted?neg?y:y-h:x,y:inverted?plotHeight-x-xWidth:neg?plotHeight-y-h:plotHeight-y,width:inverted?h:xWidth,height:inverted?xWidth:h},label=this.label,alignAttr;if(label){label.align(this.alignOptions,null,stackBox);alignAttr=label.alignAttr;label[this.options.crop===false||chart.isInsidePlot(alignAttr.x,alignAttr.y)?"show":"hide"](true)}}};Axis.prototype.buildStacks=function(){var series=this.series,reversedStacks=pick(this.options.reversedStacks,true),i=series.length;if(!this.isXAxis){this.usePercentage=false;while(i--){series[reversedStacks?i:series.length-i-1].setStackedPoints()}if(this.usePercentage){for(i=0;i<series.length;i++){series[i].setPercentStacks()}}}};Axis.prototype.renderStackTotals=function(){var axis=this,chart=axis.chart,renderer=chart.renderer,stacks=axis.stacks,stackKey,oneStack,stackCategory,stackTotalGroup=axis.stackTotalGroup;if(!stackTotalGroup){axis.stackTotalGroup=stackTotalGroup=renderer.g("stack-labels").attr({visibility:VISIBLE,zIndex:6}).add()}stackTotalGroup.translate(chart.plotLeft,chart.plotTop);for(stackKey in stacks){oneStack=stacks[stackKey];for(stackCategory in oneStack){oneStack[stackCategory].render(stackTotalGroup)}}};Series.prototype.setStackedPoints=function(){if(!this.options.stacking||this.visible!==true&&this.chart.options.chart.ignoreHiddenSeries!==false){return}var series=this,xData=series.processedXData,yData=series.processedYData,stackedYData=[],yDataLength=yData.length,seriesOptions=series.options,threshold=seriesOptions.threshold,stackThreshold=seriesOptions.startFromThreshold?threshold:0,stackOption=seriesOptions.stack,stacking=seriesOptions.stacking,stackKey=series.stackKey,negKey="-"+stackKey,negStacks=series.negStacks,yAxis=series.yAxis,stacks=yAxis.stacks,oldStacks=yAxis.oldStacks,isNegative,stack,other,key,pointKey,i,x,y;for(i=0;i<yDataLength;i++){x=xData[i];y=yData[i];pointKey=series.index+","+i;isNegative=negStacks&&y<(stackThreshold?0:threshold);key=isNegative?negKey:stackKey;if(!stacks[key]){stacks[key]={}}if(!stacks[key][x]){if(oldStacks[key]&&oldStacks[key][x]){stacks[key][x]=oldStacks[key][x];stacks[key][x].total=null}else{stacks[key][x]=new StackItem(yAxis,yAxis.options.stackLabels,isNegative,x,stackOption)}}stack=stacks[key][x];stack.points[pointKey]=[pick(stack.cum,stackThreshold)];if(stacking==="percent"){other=isNegative?stackKey:negKey;if(negStacks&&stacks[other]&&stacks[other][x]){other=stacks[other][x];stack.total=other.total=mathMax(other.total,stack.total)+mathAbs(y)||0}else{stack.total=correctFloat(stack.total+(mathAbs(y)||0))}}else{stack.total=correctFloat(stack.total+(y||0))}stack.cum=pick(stack.cum,stackThreshold)+(y||0);stack.points[pointKey].push(stack.cum);stackedYData[i]=stack.cum}if(stacking==="percent"){yAxis.usePercentage=true}this.stackedYData=stackedYData;yAxis.oldStacks={}};Series.prototype.setPercentStacks=function(){var series=this,stackKey=series.stackKey,stacks=series.yAxis.stacks,processedXData=series.processedXData;each([stackKey,"-"+stackKey],function(key){var i=processedXData.length,x,stack,pointExtremes,totalFactor;while(i--){x=processedXData[i];stack=stacks[key]&&stacks[key][x];pointExtremes=stack&&stack.points[series.index+","+i];if(pointExtremes){totalFactor=stack.total?100/stack.total:0;pointExtremes[0]=correctFloat(pointExtremes[0]*totalFactor);pointExtremes[1]=correctFloat(pointExtremes[1]*totalFactor);series.stackedYData[i]=pointExtremes[1]}}})};extend(Chart.prototype,{addSeries:function(options,redraw,animation){var series,chart=this;if(options){redraw=pick(redraw,true);fireEvent(chart,"addSeries",{options:options},function(){series=chart.initSeries(options);chart.isDirtyLegend=true;chart.linkSeries();if(redraw){chart.redraw(animation)}})}return series},addAxis:function(options,isX,redraw,animation){var key=isX?"xAxis":"yAxis",chartOptions=this.options,axis;axis=new Axis(this,merge(options,{index:this[key].length,isX:isX}));chartOptions[key]=splat(chartOptions[key]||{});chartOptions[key].push(options);if(pick(redraw,true)){this.redraw(animation)}},showLoading:function(str){var chart=this,options=chart.options,loadingDiv=chart.loadingDiv,loadingOptions=options.loading,setLoadingSize=function(){if(loadingDiv){css(loadingDiv,{left:chart.plotLeft+PX,top:chart.plotTop+PX,width:chart.plotWidth+PX,height:chart.plotHeight+PX})}};if(!loadingDiv){chart.loadingDiv=loadingDiv=createElement(DIV,{className:PREFIX+"loading"},extend(loadingOptions.style,{zIndex:10,display:NONE}),chart.container);chart.loadingSpan=createElement("span",null,loadingOptions.labelStyle,loadingDiv);addEvent(chart,"redraw",setLoadingSize)}chart.loadingSpan.innerHTML=str||options.lang.loading;if(!chart.loadingShown){css(loadingDiv,{opacity:0,display:""});animate(loadingDiv,{opacity:loadingOptions.style.opacity},{duration:loadingOptions.showDuration||0});chart.loadingShown=true}setLoadingSize()},hideLoading:function(){var options=this.options,loadingDiv=this.loadingDiv;if(loadingDiv){animate(loadingDiv,{opacity:0},{duration:options.loading.hideDuration||100,complete:function(){css(loadingDiv,{display:NONE})}})}this.loadingShown=false}});extend(Point.prototype,{update:function(options,redraw,animation,runEvent){var point=this,series=point.series,graphic=point.graphic,i,chart=series.chart,seriesOptions=series.options,names=series.xAxis&&series.xAxis.names;redraw=pick(redraw,true);function update(){point.applyOptions(options);if(point.y===null&&graphic){point.graphic=graphic.destroy()}if(isObject(options)&&!isArray(options)){point.redraw=function(){if(graphic){if(options&&options.marker&&options.marker.symbol){point.graphic=graphic.destroy()}else{graphic.attr(point.pointAttr[point.state||""])[point.visible===false?"hide":"show"]();
}}if(options&&options.dataLabels&&point.dataLabel){point.dataLabel=point.dataLabel.destroy()}point.redraw=null}}i=point.index;series.updateParallelArrays(point,i);if(names&&point.name){names[point.x]=point.name}seriesOptions.data[i]=point.options;series.isDirty=series.isDirtyData=true;if(!series.fixedBox&&series.hasCartesianSeries){chart.isDirtyBox=true}if(seriesOptions.legendType==="point"){chart.isDirtyLegend=true}if(redraw){chart.redraw(animation)}}if(runEvent===false){update()}else{point.firePointEvent("update",{options:options},update)}},remove:function(redraw,animation){this.series.removePoint(inArray(this,this.series.data),redraw,animation)}});extend(Series.prototype,{addPoint:function(options,redraw,shift,animation){var series=this,seriesOptions=series.options,data=series.data,graph=series.graph,area=series.area,chart=series.chart,names=series.xAxis&&series.xAxis.names,currentShift=graph&&graph.shift||0,shiftShapes=["graph","area"],dataOptions=seriesOptions.data,point,isInTheMiddle,xData=series.xData,i,x;setAnimation(animation,chart);if(shift){i=series.zones.length;while(i--){shiftShapes.push("zoneGraph"+i,"zoneArea"+i)}each(shiftShapes,function(shape){if(series[shape]){series[shape].shift=currentShift+1}})}if(area){area.isArea=true}redraw=pick(redraw,true);point={series:series};series.pointClass.prototype.applyOptions.apply(point,[options]);x=point.x;i=xData.length;if(series.requireSorting&&x<xData[i-1]){isInTheMiddle=true;while(i&&xData[i-1]>x){i--}}series.updateParallelArrays(point,"splice",i,0,0);series.updateParallelArrays(point,i);if(names&&point.name){names[x]=point.name}dataOptions.splice(i,0,options);if(isInTheMiddle){series.data.splice(i,0,null);series.processData()}if(seriesOptions.legendType==="point"){series.generatePoints()}if(shift){if(data[0]&&data[0].remove){data[0].remove(false)}else{data.shift();series.updateParallelArrays(point,"shift");dataOptions.shift()}}series.isDirty=true;series.isDirtyData=true;if(redraw){series.getAttribs();chart.redraw()}},removePoint:function(i,redraw,animation){var series=this,data=series.data,point=data[i],points=series.points,chart=series.chart,remove=function(){if(data.length===points.length){points.splice(i,1)}data.splice(i,1);series.options.data.splice(i,1);series.updateParallelArrays(point||{series:series},"splice",i,1);if(point){point.destroy()}series.isDirty=true;series.isDirtyData=true;if(redraw){chart.redraw()}};setAnimation(animation,chart);redraw=pick(redraw,true);if(point){point.firePointEvent("remove",null,remove)}else{remove()}},remove:function(redraw,animation){var series=this,chart=series.chart;redraw=pick(redraw,true);if(!series.isRemoving){series.isRemoving=true;fireEvent(series,"remove",null,function(){series.destroy();chart.isDirtyLegend=chart.isDirtyBox=true;chart.linkSeries();if(redraw){chart.redraw(animation)}})}series.isRemoving=false},update:function(newOptions,redraw){var series=this,chart=this.chart,oldOptions=this.userOptions,oldType=this.type,proto=seriesTypes[oldType].prototype,preserve=["group","markerGroup","dataLabelsGroup"],n;if(newOptions.type&&newOptions.type!==oldType||newOptions.zIndex!==undefined){preserve.length=0}each(preserve,function(prop){preserve[prop]=series[prop];delete series[prop]});newOptions=merge(oldOptions,{animation:false,index:this.index,pointStart:this.xData[0]},{data:this.options.data},newOptions);this.remove(false);for(n in proto){this[n]=UNDEFINED}extend(this,seriesTypes[newOptions.type||oldType].prototype);each(preserve,function(prop){series[prop]=preserve[prop]});this.init(chart,newOptions);chart.linkSeries();if(pick(redraw,true)){chart.redraw(false)}}});extend(Axis.prototype,{update:function(newOptions,redraw){var chart=this.chart;newOptions=chart.options[this.coll][this.options.index]=merge(this.userOptions,newOptions);this.destroy(true);this._addedPlotLB=this.chart._labelPanes=UNDEFINED;this.init(chart,extend(newOptions,{events:UNDEFINED}));chart.isDirtyBox=true;if(pick(redraw,true)){chart.redraw()}},remove:function(redraw){var chart=this.chart,key=this.coll,axisSeries=this.series,i=axisSeries.length;while(i--){if(axisSeries[i]){axisSeries[i].remove(false)}}erase(chart.axes,this);erase(chart[key],this);chart.options[key].splice(this.options.index,1);each(chart[key],function(axis,i){axis.options.index=i});this.destroy();chart.isDirtyBox=true;if(pick(redraw,true)){chart.redraw()}},setTitle:function(newTitleOptions,redraw){this.update({title:newTitleOptions},redraw)},setCategories:function(categories,redraw){this.update({categories:categories},redraw)}});var LineSeries=extendClass(Series);seriesTypes.line=LineSeries;defaultPlotOptions.area=merge(defaultSeriesOptions,{threshold:0});var AreaSeries=extendClass(Series,{type:"area",getSegments:function(){var series=this,segments=[],segment=[],keys=[],xAxis=this.xAxis,yAxis=this.yAxis,stack=yAxis.stacks[this.stackKey],pointMap={},plotX,plotY,points=this.points,connectNulls=this.options.connectNulls,i,x;if(this.options.stacking&&!this.cropped){for(i=0;i<points.length;i++){pointMap[points[i].x]=points[i]}for(x in stack){if(stack[x].total!==null){keys.push(+x)}}keys.sort(function(a,b){return a-b});each(keys,function(x){var y=0,stackPoint;if(connectNulls&&(!pointMap[x]||pointMap[x].y===null)){return}else if(pointMap[x]){segment.push(pointMap[x])}else{for(i=series.index;i<=yAxis.series.length;i++){stackPoint=stack[x].points[i+","+x];if(stackPoint){y=stackPoint[1];break}}plotX=xAxis.translate(x);plotY=yAxis.toPixels(y,true);segment.push({y:null,plotX:plotX,clientX:plotX,plotY:plotY,yBottom:plotY,onMouseOver:noop})}});if(segment.length){segments.push(segment)}}else{Series.prototype.getSegments.call(this);segments=this.segments}this.segments=segments},getSegmentPath:function(segment){var segmentPath=Series.prototype.getSegmentPath.call(this,segment),areaSegmentPath=[].concat(segmentPath),i,options=this.options,segLength=segmentPath.length,translatedThreshold=this.yAxis.getThreshold(options.threshold),yBottom;if(segLength===3){areaSegmentPath.push(L,segmentPath[1],segmentPath[2])}if(options.stacking&&!this.closedStacks){for(i=segment.length-1;i>=0;i--){yBottom=pick(segment[i].yBottom,translatedThreshold);if(i<segment.length-1&&options.step){areaSegmentPath.push(segment[i+1].plotX,yBottom)}areaSegmentPath.push(segment[i].plotX,yBottom)}}else{this.closeSegment(areaSegmentPath,segment,translatedThreshold)}this.areaPath=this.areaPath.concat(areaSegmentPath);return segmentPath},closeSegment:function(path,segment,translatedThreshold){path.push(L,segment[segment.length-1].plotX,translatedThreshold,L,segment[0].plotX,translatedThreshold)},drawGraph:function(){this.areaPath=[];Series.prototype.drawGraph.apply(this);var series=this,areaPath=this.areaPath,options=this.options,zones=this.zones,props=[["area",this.color,options.fillColor]];each(zones,function(threshold,i){props.push(["zoneArea"+i,threshold.color||series.color,threshold.fillColor||options.fillColor])});each(props,function(prop){var areaKey=prop[0],area=series[areaKey];if(area){area.animate({d:areaPath})}else{series[areaKey]=series.chart.renderer.path(areaPath).attr({fill:pick(prop[2],Color(prop[1]).setOpacity(pick(options.fillOpacity,.75)).get()),zIndex:0}).add(series.group)}})},drawLegendSymbol:LegendSymbolMixin.drawRectangle});seriesTypes.area=AreaSeries;defaultPlotOptions.spline=merge(defaultSeriesOptions);var SplineSeries=extendClass(Series,{type:"spline",getPointSpline:function(segment,point,i){var smoothing=1.5,denom=smoothing+1,plotX=point.plotX,plotY=point.plotY,lastPoint=segment[i-1],nextPoint=segment[i+1],leftContX,leftContY,rightContX,rightContY,ret;if(lastPoint&&nextPoint){var lastX=lastPoint.plotX,lastY=lastPoint.plotY,nextX=nextPoint.plotX,nextY=nextPoint.plotY,correction;leftContX=(smoothing*plotX+lastX)/denom;leftContY=(smoothing*plotY+lastY)/denom;rightContX=(smoothing*plotX+nextX)/denom;rightContY=(smoothing*plotY+nextY)/denom;correction=(rightContY-leftContY)*(rightContX-plotX)/(rightContX-leftContX)+plotY-rightContY;leftContY+=correction;rightContY+=correction;if(leftContY>lastY&&leftContY>plotY){leftContY=mathMax(lastY,plotY);rightContY=2*plotY-leftContY}else if(leftContY<lastY&&leftContY<plotY){leftContY=mathMin(lastY,plotY);rightContY=2*plotY-leftContY}if(rightContY>nextY&&rightContY>plotY){rightContY=mathMax(nextY,plotY);leftContY=2*plotY-rightContY}else if(rightContY<nextY&&rightContY<plotY){rightContY=mathMin(nextY,plotY);leftContY=2*plotY-rightContY}point.rightContX=rightContX;point.rightContY=rightContY}if(!i){ret=[M,plotX,plotY]}else{ret=["C",lastPoint.rightContX||lastPoint.plotX,lastPoint.rightContY||lastPoint.plotY,leftContX||plotX,leftContY||plotY,plotX,plotY];lastPoint.rightContX=lastPoint.rightContY=null}return ret}});seriesTypes.spline=SplineSeries;defaultPlotOptions.areaspline=merge(defaultPlotOptions.area);var areaProto=AreaSeries.prototype,AreaSplineSeries=extendClass(SplineSeries,{type:"areaspline",closedStacks:true,getSegmentPath:areaProto.getSegmentPath,closeSegment:areaProto.closeSegment,drawGraph:areaProto.drawGraph,drawLegendSymbol:LegendSymbolMixin.drawRectangle});seriesTypes.areaspline=AreaSplineSeries;defaultPlotOptions.column=merge(defaultSeriesOptions,{borderColor:"#FFFFFF",borderRadius:0,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{brightness:.1,shadow:false,halo:false},select:{color:"#C0C0C0",borderColor:"#000000",shadow:false}},dataLabels:{align:null,verticalAlign:null,y:null},startFromThreshold:true,stickyTracking:false,tooltip:{distance:6},threshold:0});var ColumnSeries=extendClass(Series,{type:"column",pointAttrToOptions:{stroke:"borderColor",fill:"color",r:"borderRadius"},cropShoulder:0,directTouch:true,trackerGroups:["group","dataLabelsGroup"],negStacks:true,init:function(){Series.prototype.init.apply(this,arguments);var series=this,chart=series.chart;if(chart.hasRendered){each(chart.series,function(otherSeries){if(otherSeries.type===series.type){otherSeries.isDirty=true}})}},getColumnMetrics:function(){var series=this,options=series.options,xAxis=series.xAxis,yAxis=series.yAxis,reversedXAxis=xAxis.reversed,stackKey,stackGroups={},columnIndex,columnCount=0;if(options.grouping===false){columnCount=1}else{each(series.chart.series,function(otherSeries){var otherOptions=otherSeries.options,otherYAxis=otherSeries.yAxis;if(otherSeries.type===series.type&&otherSeries.visible&&yAxis.len===otherYAxis.len&&yAxis.pos===otherYAxis.pos){if(otherOptions.stacking){stackKey=otherSeries.stackKey;if(stackGroups[stackKey]===UNDEFINED){stackGroups[stackKey]=columnCount++}columnIndex=stackGroups[stackKey]}else if(otherOptions.grouping!==false){columnIndex=columnCount++}otherSeries.columnIndex=columnIndex}})}var categoryWidth=mathMin(mathAbs(xAxis.transA)*(xAxis.ordinalSlope||options.pointRange||xAxis.closestPointRange||xAxis.tickInterval||1),xAxis.len),groupPadding=categoryWidth*options.groupPadding,groupWidth=categoryWidth-2*groupPadding,pointOffsetWidth=groupWidth/columnCount,optionPointWidth=options.pointWidth,pointPadding=defined(optionPointWidth)?(pointOffsetWidth-optionPointWidth)/2:pointOffsetWidth*options.pointPadding,pointWidth=pick(optionPointWidth,pointOffsetWidth-2*pointPadding),colIndex=(reversedXAxis?columnCount-(series.columnIndex||0):series.columnIndex)||0,pointXOffset=pointPadding+(groupPadding+colIndex*pointOffsetWidth-categoryWidth/2)*(reversedXAxis?-1:1);return series.columnMetrics={width:pointWidth,offset:pointXOffset}},translate:function(){var series=this,chart=series.chart,options=series.options,borderWidth=series.borderWidth=pick(options.borderWidth,series.closestPointRange*series.xAxis.transA<2?0:1),yAxis=series.yAxis,threshold=options.threshold,translatedThreshold=series.translatedThreshold=yAxis.getThreshold(threshold),minPointLength=pick(options.minPointLength,5),metrics=series.getColumnMetrics(),pointWidth=metrics.width,seriesBarW=series.barW=mathMax(pointWidth,1+2*borderWidth),pointXOffset=series.pointXOffset=metrics.offset,xCrisp=-(borderWidth%2?.5:0),yCrisp=borderWidth%2?.5:1;if(chart.inverted){translatedThreshold-=.5;if(chart.renderer.isVML){yCrisp+=1}}if(options.pointPadding){seriesBarW=mathCeil(seriesBarW)}Series.prototype.translate.apply(series);each(series.points,function(point){var yBottom=pick(point.yBottom,translatedThreshold),safeDistance=999+mathAbs(yBottom),plotY=mathMin(mathMax(-safeDistance,point.plotY),yAxis.len+safeDistance),barX=point.plotX+pointXOffset,barW=seriesBarW,barY=mathMin(plotY,yBottom),right,bottom,fromTop,up,barH=mathMax(plotY,yBottom)-barY;if(mathAbs(barH)<minPointLength){if(minPointLength){barH=minPointLength;up=!yAxis.reversed&&!point.negative||yAxis.reversed&&point.negative;barY=mathRound(mathAbs(barY-translatedThreshold)>minPointLength?yBottom-minPointLength:translatedThreshold-(up?minPointLength:0))}}point.barX=barX;point.pointWidth=pointWidth;right=mathRound(barX+barW)+xCrisp;barX=mathRound(barX)+xCrisp;barW=right-barX;fromTop=mathAbs(barY)<.5;bottom=mathMin(mathRound(barY+barH)+yCrisp,9e4);barY=mathRound(barY)+yCrisp;barH=bottom-barY;if(fromTop){barY-=1;barH+=1}point.tooltipPos=chart.inverted?[yAxis.len+yAxis.pos-chart.plotLeft-plotY,series.xAxis.len-barX-barW/2,barH]:[barX+barW/2,plotY+yAxis.pos-chart.plotTop,barH];point.shapeType="rect";point.shapeArgs={x:barX,y:barY,width:barW,height:barH}})},getSymbol:noop,drawLegendSymbol:LegendSymbolMixin.drawRectangle,drawGraph:noop,drawPoints:function(){var series=this,chart=this.chart,options=series.options,renderer=chart.renderer,animationLimit=options.animationLimit||250,shapeArgs,pointAttr;each(series.points,function(point){var plotY=point.plotY,graphic=point.graphic,borderAttr;if(plotY!==UNDEFINED&&!isNaN(plotY)&&point.y!==null){shapeArgs=point.shapeArgs;borderAttr=defined(series.borderWidth)?{"stroke-width":series.borderWidth}:{};pointAttr=point.pointAttr[point.selected?SELECT_STATE:NORMAL_STATE]||series.pointAttr[NORMAL_STATE];if(graphic){stop(graphic);graphic.attr(borderAttr)[chart.pointCount<animationLimit?"animate":"attr"](merge(shapeArgs))}else{point.graphic=graphic=renderer[point.shapeType](shapeArgs).attr(borderAttr).attr(pointAttr).add(series.group).shadow(options.shadow,null,options.stacking&&!options.borderRadius)}}else if(graphic){point.graphic=graphic.destroy()}})},animate:function(init){var series=this,yAxis=this.yAxis,options=series.options,inverted=this.chart.inverted,attr={},translatedThreshold;if(hasSVG){if(init){attr.scaleY=.001;translatedThreshold=mathMin(yAxis.pos+yAxis.len,mathMax(yAxis.pos,yAxis.toPixels(options.threshold)));if(inverted){attr.translateX=translatedThreshold-yAxis.len}else{attr.translateY=translatedThreshold}series.group.attr(attr)}else{attr.scaleY=1;attr[inverted?"translateX":"translateY"]=yAxis.pos;series.group.animate(attr,series.options.animation);series.animate=null}}},remove:function(){var series=this,chart=series.chart;if(chart.hasRendered){each(chart.series,function(otherSeries){if(otherSeries.type===series.type){otherSeries.isDirty=true}})}Series.prototype.remove.apply(series,arguments)}});seriesTypes.column=ColumnSeries;defaultPlotOptions.bar=merge(defaultPlotOptions.column);var BarSeries=extendClass(ColumnSeries,{type:"bar",inverted:true});seriesTypes.bar=BarSeries;defaultPlotOptions.scatter=merge(defaultSeriesOptions,{lineWidth:0,marker:{enabled:true},tooltip:{headerFormat:'<span style="color:{series.color}"></span> <span style="font-size: 10px;"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}});var ScatterSeries=extendClass(Series,{type:"scatter",sorted:false,requireSorting:false,noSharedTooltip:true,trackerGroups:["group","markerGroup","dataLabelsGroup"],takeOrdinalPosition:false,kdDimensions:2,drawGraph:function(){if(this.options.lineWidth){Series.prototype.drawGraph.call(this)}}});seriesTypes.scatter=ScatterSeries;defaultPlotOptions.pie=merge(defaultSeriesOptions,{borderColor:"#FFFFFF",borderWidth:1,center:[null,null],clip:false,colorByPoint:true,dataLabels:{distance:30,enabled:true,formatter:function(){return this.point.name},x:0},ignoreHiddenPoint:true,legendType:"point",marker:null,size:null,showInLegend:false,slicedOffset:10,states:{hover:{brightness:.1,shadow:false}},stickyTracking:false,tooltip:{followPointer:true}});var PiePoint=extendClass(Point,{init:function(){Point.prototype.init.apply(this,arguments);var point=this,toggleSlice;extend(point,{visible:point.visible!==false,name:pick(point.name,"Slice")});toggleSlice=function(e){point.slice(e.type==="select")};addEvent(point,"select",toggleSlice);addEvent(point,"unselect",toggleSlice);return point},setVisible:function(vis,redraw){var point=this,series=point.series,chart=series.chart,ignoreHiddenPoint=series.options.ignoreHiddenPoint;redraw=pick(redraw,ignoreHiddenPoint);if(vis!==point.visible){point.visible=point.options.visible=vis=vis===UNDEFINED?!point.visible:vis;series.options.data[inArray(point,series.data)]=point.options;each(["graphic","dataLabel","connector","shadowGroup"],function(key){if(point[key]){point[key][vis?"show":"hide"](true)}});if(point.legendItem){chart.legend.colorizeItem(point,vis)}if(!vis&&point.state==="hover"){point.setState("")}if(ignoreHiddenPoint){series.isDirty=true}if(redraw){chart.redraw()}}},slice:function(sliced,redraw,animation){var point=this,series=point.series,chart=series.chart,translation;setAnimation(animation,chart);redraw=pick(redraw,true);point.sliced=point.options.sliced=sliced=defined(sliced)?sliced:!point.sliced;series.options.data[inArray(point,series.data)]=point.options;translation=sliced?point.slicedTranslation:{translateX:0,translateY:0};point.graphic.animate(translation);if(point.shadowGroup){point.shadowGroup.animate(translation)}},haloPath:function(size){var shapeArgs=this.shapeArgs,chart=this.series.chart;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(chart.plotLeft+shapeArgs.x,chart.plotTop+shapeArgs.y,shapeArgs.r+size,shapeArgs.r+size,{innerR:this.shapeArgs.r,start:shapeArgs.start,end:shapeArgs.end})}});var PieSeries={type:"pie",isCartesian:false,pointClass:PiePoint,requireSorting:false,directTouch:true,noSharedTooltip:true,trackerGroups:["group","dataLabelsGroup"],axisTypes:[],pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color"},getColor:noop,animate:function(init){var series=this,points=series.points,startAngleRad=series.startAngleRad;if(!init){each(points,function(point){var graphic=point.graphic,args=point.shapeArgs;if(graphic){graphic.attr({r:point.startR||series.center[3]/2,start:startAngleRad,end:startAngleRad});graphic.animate({r:args.r,start:args.start,end:args.end},series.options.animation)}});series.animate=null}},setData:function(data,redraw,animation,updatePoints){Series.prototype.setData.call(this,data,false,animation,updatePoints);this.processData();this.generatePoints();if(pick(redraw,true)){this.chart.redraw(animation)}},updateTotals:function(){var i,total=0,points=this.points,len=points.length,point,ignoreHiddenPoint=this.options.ignoreHiddenPoint;for(i=0;i<len;i++){point=points[i];total+=ignoreHiddenPoint&&!point.visible?0:point.y}this.total=total;for(i=0;i<len;i++){point=points[i];point.percentage=total>0&&(point.visible||!ignoreHiddenPoint)?point.y/total*100:0;point.total=total}},generatePoints:function(){Series.prototype.generatePoints.call(this);this.updateTotals()},translate:function(positions){this.generatePoints();var series=this,cumulative=0,precision=1e3,options=series.options,slicedOffset=options.slicedOffset,connectorOffset=slicedOffset+options.borderWidth,start,end,angle,startAngle=options.startAngle||0,startAngleRad=series.startAngleRad=mathPI/180*(startAngle-90),endAngleRad=series.endAngleRad=mathPI/180*(pick(options.endAngle,startAngle+360)-90),circ=endAngleRad-startAngleRad,points=series.points,radiusX,radiusY,labelDistance=options.dataLabels.distance,ignoreHiddenPoint=options.ignoreHiddenPoint,i,len=points.length,point;if(!positions){series.center=positions=series.getCenter()}series.getX=function(y,left){angle=math.asin(mathMin((y-positions[1])/(positions[2]/2+labelDistance),1));return positions[0]+(left?-1:1)*(mathCos(angle)*(positions[2]/2+labelDistance))};for(i=0;i<len;i++){point=points[i];start=startAngleRad+cumulative*circ;if(!ignoreHiddenPoint||point.visible){cumulative+=point.percentage/100}end=startAngleRad+cumulative*circ;point.shapeType="arc";point.shapeArgs={x:positions[0],y:positions[1],r:positions[2]/2,innerR:positions[3]/2,start:mathRound(start*precision)/precision,end:mathRound(end*precision)/precision};angle=(end+start)/2;if(angle>1.5*mathPI){angle-=2*mathPI}else if(angle<-mathPI/2){angle+=2*mathPI}point.slicedTranslation={translateX:mathRound(mathCos(angle)*slicedOffset),translateY:mathRound(mathSin(angle)*slicedOffset)};radiusX=mathCos(angle)*positions[2]/2;radiusY=mathSin(angle)*positions[2]/2;point.tooltipPos=[positions[0]+radiusX*.7,positions[1]+radiusY*.7];point.half=angle<-mathPI/2||angle>mathPI/2?1:0;point.angle=angle;connectorOffset=mathMin(connectorOffset,labelDistance/2);point.labelPos=[positions[0]+radiusX+mathCos(angle)*labelDistance,positions[1]+radiusY+mathSin(angle)*labelDistance,positions[0]+radiusX+mathCos(angle)*connectorOffset,positions[1]+radiusY+mathSin(angle)*connectorOffset,positions[0]+radiusX,positions[1]+radiusY,labelDistance<0?"center":point.half?"right":"left",angle]}},drawGraph:null,drawPoints:function(){var series=this,chart=series.chart,renderer=chart.renderer,groupTranslation,graphic,shadow=series.options.shadow,shadowGroup,shapeArgs,attr;if(shadow&&!series.shadowGroup){series.shadowGroup=renderer.g("shadow").add(series.group)}each(series.points,function(point){graphic=point.graphic;shapeArgs=point.shapeArgs;shadowGroup=point.shadowGroup;if(shadow&&!shadowGroup){shadowGroup=point.shadowGroup=renderer.g("shadow").add(series.shadowGroup)}groupTranslation=point.sliced?point.slicedTranslation:{translateX:0,translateY:0};if(shadowGroup){shadowGroup.attr(groupTranslation)}if(graphic){graphic.animate(extend(shapeArgs,groupTranslation))}else{attr={"stroke-linejoin":"round"};if(!point.visible){attr.visibility="hidden"}point.graphic=graphic=renderer[point.shapeType](shapeArgs).setRadialReference(series.center).attr(point.pointAttr[point.selected?SELECT_STATE:NORMAL_STATE]).attr(attr).attr(groupTranslation).add(series.group).shadow(shadow,shadowGroup)}})},searchPoint:noop,sortByAngle:function(points,sign){points.sort(function(a,b){return a.angle!==undefined&&(b.angle-a.angle)*sign})},drawLegendSymbol:LegendSymbolMixin.drawRectangle,getCenter:CenteredSeriesMixin.getCenter,getSymbol:noop};PieSeries=extendClass(Series,PieSeries);seriesTypes.pie=PieSeries;Series.prototype.drawDataLabels=function(){var series=this,seriesOptions=series.options,cursor=seriesOptions.cursor,options=seriesOptions.dataLabels,points=series.points,pointOptions,generalOptions,hasRendered=series.hasRendered||0,str,dataLabelsGroup,renderer=series.chart.renderer;if(options.enabled||series._hasPointLabels){if(series.dlProcessOptions){series.dlProcessOptions(options)}dataLabelsGroup=series.plotGroup("dataLabelsGroup","data-labels",options.defer?HIDDEN:VISIBLE,options.zIndex||6);if(pick(options.defer,true)){dataLabelsGroup.attr({opacity:+hasRendered});if(!hasRendered){addEvent(series,"afterAnimate",function(){if(series.visible){dataLabelsGroup.show()}dataLabelsGroup[seriesOptions.animation?"animate":"attr"]({opacity:1},{duration:200})})}}generalOptions=options;each(points,function(point){var enabled,dataLabel=point.dataLabel,labelConfig,attr,name,rotation,connector=point.connector,isNew=true,style,moreStyle={};pointOptions=point.dlOptions||point.options&&point.options.dataLabels;enabled=pick(pointOptions&&pointOptions.enabled,generalOptions.enabled);if(dataLabel&&!enabled){point.dataLabel=dataLabel.destroy()}else if(enabled){options=merge(generalOptions,pointOptions);style=options.style;rotation=options.rotation;labelConfig=point.getLabelConfig();str=options.format?format(options.format,labelConfig):options.formatter.call(labelConfig,options);style.color=pick(options.color,style.color,series.color,"black");if(dataLabel){if(defined(str)){dataLabel.attr({text:str});isNew=false}else{point.dataLabel=dataLabel=dataLabel.destroy();if(connector){point.connector=connector.destroy()}}}else if(defined(str)){attr={fill:options.backgroundColor,stroke:options.borderColor,"stroke-width":options.borderWidth,r:options.borderRadius||0,rotation:rotation,padding:options.padding,zIndex:1};if(style.color==="contrast"){moreStyle.color=options.inside||options.distance<0||!!seriesOptions.stacking?renderer.getContrast(point.color||series.color):"#000000"}if(cursor){moreStyle.cursor=cursor}for(name in attr){if(attr[name]===UNDEFINED){delete attr[name]}}dataLabel=point.dataLabel=renderer[rotation?"text":"label"](str,0,-999,options.shape,null,null,options.useHTML).attr(attr).css(extend(style,moreStyle)).add(dataLabelsGroup).shadow(options.shadow)}if(dataLabel){series.alignDataLabel(point,dataLabel,options,null,isNew)}}})}};Series.prototype.alignDataLabel=function(point,dataLabel,options,alignTo,isNew){var chart=this.chart,inverted=chart.inverted,plotX=pick(point.plotX,-999),plotY=pick(point.plotY,-999),bBox=dataLabel.getBBox(),baseline=chart.renderer.fontMetrics(options.style.fontSize).b,rotCorr,visible=this.visible&&(point.series.forceDL||chart.isInsidePlot(plotX,mathRound(plotY),inverted)||alignTo&&chart.isInsidePlot(plotX,inverted?alignTo.x+1:alignTo.y+alignTo.height-1,inverted)),alignAttr;if(visible){alignTo=extend({x:inverted?chart.plotWidth-plotY:plotX,y:mathRound(inverted?chart.plotHeight-plotX:plotY),width:0,height:0},alignTo);extend(options,{width:bBox.width,height:bBox.height});if(options.rotation){rotCorr=chart.renderer.rotCorr(baseline,options.rotation);dataLabel[isNew?"attr":"animate"]({x:alignTo.x+options.x+alignTo.width/2+rotCorr.x,y:alignTo.y+options.y+alignTo.height/2}).attr({align:options.align})}else{dataLabel.align(options,null,alignTo);alignAttr=dataLabel.alignAttr;if(pick(options.overflow,"justify")==="justify"){this.justifyDataLabel(dataLabel,options,alignAttr,bBox,alignTo,isNew)}else if(pick(options.crop,true)){visible=chart.isInsidePlot(alignAttr.x,alignAttr.y)&&chart.isInsidePlot(alignAttr.x+bBox.width,alignAttr.y+bBox.height)}if(options.shape){dataLabel.attr({anchorX:point.plotX,anchorY:point.plotY})}}}if(!visible){dataLabel.attr({y:-999});dataLabel.placed=false}};Series.prototype.justifyDataLabel=function(dataLabel,options,alignAttr,bBox,alignTo,isNew){var chart=this.chart,align=options.align,verticalAlign=options.verticalAlign,off,justified,padding=dataLabel.box?0:dataLabel.padding||0;off=alignAttr.x+padding;if(off<0){if(align==="right"){options.align="left"}else{options.x=-off}justified=true}off=alignAttr.x+bBox.width-padding;if(off>chart.plotWidth){if(align==="left"){options.align="right"}else{options.x=chart.plotWidth-off}justified=true}off=alignAttr.y+padding;if(off<0){if(verticalAlign==="bottom"){options.verticalAlign="top"}else{options.y=-off}justified=true}off=alignAttr.y+bBox.height-padding;if(off>chart.plotHeight){if(verticalAlign==="top"){options.verticalAlign="bottom"}else{options.y=chart.plotHeight-off}justified=true}if(justified){dataLabel.placed=!isNew;dataLabel.align(options,null,alignTo)}};if(seriesTypes.pie){seriesTypes.pie.prototype.drawDataLabels=function(){var series=this,data=series.data,point,chart=series.chart,options=series.options.dataLabels,connectorPadding=pick(options.connectorPadding,10),connectorWidth=pick(options.connectorWidth,1),plotWidth=chart.plotWidth,plotHeight=chart.plotHeight,connector,connectorPath,softConnector=pick(options.softConnector,true),distanceOption=options.distance,seriesCenter=series.center,radius=seriesCenter[2]/2,centerY=seriesCenter[1],outside=distanceOption>0,dataLabel,dataLabelWidth,labelPos,labelHeight,halves=[[],[]],x,y,visibility,rankArr,i,j,overflow=[0,0,0,0],sort=function(a,b){return b.y-a.y};if(!series.visible||!options.enabled&&!series._hasPointLabels){return}Series.prototype.drawDataLabels.apply(series);each(data,function(point){if(point.dataLabel&&point.visible){halves[point.half].push(point)}});i=2;while(i--){var slots=[],slotsLength,usedSlots=[],points=halves[i],pos,bottom,length=points.length,slotIndex;if(!length){continue}series.sortByAngle(points,i-.5);j=labelHeight=0;while(!labelHeight&&points[j]){labelHeight=points[j]&&points[j].dataLabel&&(points[j].dataLabel.getBBox().height||21);j++}if(distanceOption>0){bottom=mathMin(centerY+radius+distanceOption,chart.plotHeight);for(pos=mathMax(0,centerY-radius-distanceOption);pos<=bottom;pos+=labelHeight){slots.push(pos)}slotsLength=slots.length;if(length>slotsLength){rankArr=[].concat(points);rankArr.sort(sort);j=length;while(j--){rankArr[j].rank=j}j=length;while(j--){if(points[j].rank>=slotsLength){points.splice(j,1)}}length=points.length}for(j=0;j<length;j++){point=points[j];labelPos=point.labelPos;var closest=9999,distance,slotI;for(slotI=0;slotI<slotsLength;slotI++){distance=mathAbs(slots[slotI]-labelPos[1]);if(distance<closest){closest=distance;slotIndex=slotI}}if(slotIndex<j&&slots[j]!==null){slotIndex=j}else if(slotsLength<length-j+slotIndex&&slots[j]!==null){slotIndex=slotsLength-length+j;while(slots[slotIndex]===null){slotIndex++}}else{while(slots[slotIndex]===null){slotIndex++}}usedSlots.push({i:slotIndex,y:slots[slotIndex]});slots[slotIndex]=null}usedSlots.sort(sort)}for(j=0;j<length;j++){var slot,naturalY;point=points[j];labelPos=point.labelPos;dataLabel=point.dataLabel;visibility=point.visible===false?HIDDEN:"inherit";naturalY=labelPos[1];if(distanceOption>0){slot=usedSlots.pop();slotIndex=slot.i;y=slot.y;if(naturalY>y&&slots[slotIndex+1]!==null||naturalY<y&&slots[slotIndex-1]!==null){y=mathMin(mathMax(0,naturalY),chart.plotHeight)}}else{y=naturalY}x=options.justify?seriesCenter[0]+(i?-1:1)*(radius+distanceOption):series.getX(y===centerY-radius-distanceOption||y===centerY+radius+distanceOption?naturalY:y,i);dataLabel._attr={visibility:visibility,align:labelPos[6]};dataLabel._pos={x:x+options.x+({left:connectorPadding,right:-connectorPadding}[labelPos[6]]||0),y:y+options.y-10};dataLabel.connX=x;dataLabel.connY=y;if(this.options.size===null){dataLabelWidth=dataLabel.width;if(x-dataLabelWidth<connectorPadding){overflow[3]=mathMax(mathRound(dataLabelWidth-x+connectorPadding),overflow[3])}else if(x+dataLabelWidth>plotWidth-connectorPadding){overflow[1]=mathMax(mathRound(x+dataLabelWidth-plotWidth+connectorPadding),overflow[1])}if(y-labelHeight/2<0){overflow[0]=mathMax(mathRound(-y+labelHeight/2),overflow[0])}else if(y+labelHeight/2>plotHeight){overflow[2]=mathMax(mathRound(y+labelHeight/2-plotHeight),overflow[2])}}}}if(arrayMax(overflow)===0||this.verifyDataLabelOverflow(overflow)){this.placeDataLabels();if(outside&&connectorWidth){each(this.points,function(point){connector=point.connector;labelPos=point.labelPos;dataLabel=point.dataLabel;if(dataLabel&&dataLabel._pos&&point.visible){visibility=dataLabel._attr.visibility;x=dataLabel.connX;y=dataLabel.connY;connectorPath=softConnector?[M,x+(labelPos[6]==="left"?5:-5),y,"C",x,y,2*labelPos[2]-labelPos[4],2*labelPos[3]-labelPos[5],labelPos[2],labelPos[3],L,labelPos[4],labelPos[5]]:[M,x+(labelPos[6]==="left"?5:-5),y,L,labelPos[2],labelPos[3],L,labelPos[4],labelPos[5]];if(connector){connector.animate({d:connectorPath});connector.attr("visibility",visibility)}else{point.connector=connector=series.chart.renderer.path(connectorPath).attr({"stroke-width":connectorWidth,stroke:options.connectorColor||point.color||"#606060",visibility:visibility}).add(series.dataLabelsGroup)}}else if(connector){point.connector=connector.destroy()}})}}};seriesTypes.pie.prototype.placeDataLabels=function(){each(this.points,function(point){var dataLabel=point.dataLabel,_pos;if(dataLabel&&point.visible){_pos=dataLabel._pos;if(_pos){dataLabel.attr(dataLabel._attr);dataLabel[dataLabel.moved?"animate":"attr"](_pos);dataLabel.moved=true}else if(dataLabel){dataLabel.attr({y:-999})}}})};seriesTypes.pie.prototype.alignDataLabel=noop;
seriesTypes.pie.prototype.verifyDataLabelOverflow=function(overflow){var center=this.center,options=this.options,centerOption=options.center,minSize=options.minSize||80,newSize=minSize,ret;if(centerOption[0]!==null){newSize=mathMax(center[2]-mathMax(overflow[1],overflow[3]),minSize)}else{newSize=mathMax(center[2]-overflow[1]-overflow[3],minSize);center[0]+=(overflow[3]-overflow[1])/2}if(centerOption[1]!==null){newSize=mathMax(mathMin(newSize,center[2]-mathMax(overflow[0],overflow[2])),minSize)}else{newSize=mathMax(mathMin(newSize,center[2]-overflow[0]-overflow[2]),minSize);center[1]+=(overflow[0]-overflow[2])/2}if(newSize<center[2]){center[2]=newSize;center[3]=relativeLength(options.innerSize||0,newSize);this.translate(center);each(this.points,function(point){if(point.dataLabel){point.dataLabel._pos=null}});if(this.drawDataLabels){this.drawDataLabels()}}else{ret=true}return ret}}if(seriesTypes.column){seriesTypes.column.prototype.alignDataLabel=function(point,dataLabel,options,alignTo,isNew){var inverted=this.chart.inverted,series=point.series,dlBox=point.dlBox||point.shapeArgs,below=pick(point.below,point.plotY>pick(this.translatedThreshold,series.yAxis.len)),inside=pick(options.inside,!!this.options.stacking);if(dlBox){alignTo=merge(dlBox);if(inverted){alignTo={x:series.yAxis.len-alignTo.y-alignTo.height,y:series.xAxis.len-alignTo.x-alignTo.width,width:alignTo.height,height:alignTo.width}}if(!inside){if(inverted){alignTo.x+=below?0:alignTo.width;alignTo.width=0}else{alignTo.y+=below?alignTo.height:0;alignTo.height=0}}}options.align=pick(options.align,!inverted||inside?"center":below?"right":"left");options.verticalAlign=pick(options.verticalAlign,inverted||inside?"middle":below?"top":"bottom");Series.prototype.alignDataLabel.call(this,point,dataLabel,options,alignTo,isNew)}}(function(H){var Chart=H.Chart,each=H.each,pick=H.pick,addEvent=HighchartsAdapter.addEvent;Chart.prototype.callbacks.push(function(chart){function collectAndHide(){var labels=[];each(chart.series,function(series){var dlOptions=series.options.dataLabels;if((dlOptions.enabled||series._hasPointLabels)&&!dlOptions.allowOverlap&&series.visible){each(series.points,function(point){if(point.dataLabel){point.dataLabel.labelrank=pick(point.labelrank,point.shapeArgs&&point.shapeArgs.height);labels.push(point.dataLabel)}})}});chart.hideOverlappingLabels(labels)}collectAndHide();addEvent(chart,"redraw",collectAndHide)});Chart.prototype.hideOverlappingLabels=function(labels){var len=labels.length,label,i,j,label1,label2,intersectRect=function(pos1,pos2,size1,size2){return!(pos2.x>pos1.x+size1.width||pos2.x+size2.width<pos1.x||pos2.y>pos1.y+size1.height||pos2.y+size2.height<pos1.y)};for(i=0;i<len;i++){label=labels[i];if(label){label.oldOpacity=label.opacity;label.newOpacity=1}}labels.sort(function(a,b){return b.labelrank-a.labelrank});for(i=0;i<len;i++){label1=labels[i];for(j=i+1;j<len;++j){label2=labels[j];if(label1&&label2&&label1.placed&&label2.placed&&label1.newOpacity!==0&&label2.newOpacity!==0&&intersectRect(label1.alignAttr,label2.alignAttr,label1,label2)){(label1.labelrank<label2.labelrank?label1:label2).newOpacity=0}}}for(i=0;i<len;i++){label=labels[i];if(label){if(label.oldOpacity!==label.newOpacity&&label.placed){label.alignAttr.opacity=label.newOpacity;label[label.isOld&&label.newOpacity?"animate":"attr"](label.alignAttr)}label.isOld=true}}}})(Highcharts);var TrackerMixin=Highcharts.TrackerMixin={drawTrackerPoint:function(){var series=this,chart=series.chart,pointer=chart.pointer,cursor=series.options.cursor,css=cursor&&{cursor:cursor},onMouseOver=function(e){var target=e.target,point;while(target&&!point){point=target.point;target=target.parentNode}if(point!==UNDEFINED&&point!==chart.hoverPoint){point.onMouseOver(e)}};each(series.points,function(point){if(point.graphic){point.graphic.element.point=point}if(point.dataLabel){point.dataLabel.element.point=point}});if(!series._hasTracking){each(series.trackerGroups,function(key){if(series[key]){series[key].addClass(PREFIX+"tracker").on("mouseover",onMouseOver).on("mouseout",function(e){pointer.onTrackerMouseOut(e)}).css(css);if(hasTouch){series[key].on("touchstart",onMouseOver)}}});series._hasTracking=true}},drawTrackerGraph:function(){var series=this,options=series.options,trackByArea=options.trackByArea,trackerPath=[].concat(trackByArea?series.areaPath:series.graphPath),trackerPathLength=trackerPath.length,chart=series.chart,pointer=chart.pointer,renderer=chart.renderer,snap=chart.options.tooltip.snap,tracker=series.tracker,cursor=options.cursor,css=cursor&&{cursor:cursor},singlePoints=series.singlePoints,singlePoint,i,onMouseOver=function(){if(chart.hoverSeries!==series){series.onMouseOver()}},TRACKER_FILL="rgba(192,192,192,"+(hasSVG?1e-4:.002)+")";if(trackerPathLength&&!trackByArea){i=trackerPathLength+1;while(i--){if(trackerPath[i]===M){trackerPath.splice(i+1,0,trackerPath[i+1]-snap,trackerPath[i+2],L)}if(i&&trackerPath[i]===M||i===trackerPathLength){trackerPath.splice(i,0,L,trackerPath[i-2]+snap,trackerPath[i-1])}}}for(i=0;i<singlePoints.length;i++){singlePoint=singlePoints[i];trackerPath.push(M,singlePoint.plotX-snap,singlePoint.plotY,L,singlePoint.plotX+snap,singlePoint.plotY)}if(tracker){tracker.attr({d:trackerPath})}else{series.tracker=renderer.path(trackerPath).attr({"stroke-linejoin":"round",visibility:series.visible?VISIBLE:HIDDEN,stroke:TRACKER_FILL,fill:trackByArea?TRACKER_FILL:NONE,"stroke-width":options.lineWidth+(trackByArea?0:2*snap),zIndex:2}).add(series.group);each([series.tracker,series.markerGroup],function(tracker){tracker.addClass(PREFIX+"tracker").on("mouseover",onMouseOver).on("mouseout",function(e){pointer.onTrackerMouseOut(e)}).css(css);if(hasTouch){tracker.on("touchstart",onMouseOver)}})}}};if(seriesTypes.column){ColumnSeries.prototype.drawTracker=TrackerMixin.drawTrackerPoint}if(seriesTypes.pie){seriesTypes.pie.prototype.drawTracker=TrackerMixin.drawTrackerPoint}if(seriesTypes.scatter){ScatterSeries.prototype.drawTracker=TrackerMixin.drawTrackerPoint}extend(Legend.prototype,{setItemEvents:function(item,legendItem,useHTML,itemStyle,itemHiddenStyle){var legend=this;(useHTML?legendItem:item.legendGroup).on("mouseover",function(){item.setState(HOVER_STATE);legendItem.css(legend.options.itemHoverStyle)}).on("mouseout",function(){legendItem.css(item.visible?itemStyle:itemHiddenStyle);item.setState()}).on("click",function(event){var strLegendItemClick="legendItemClick",fnLegendItemClick=function(){item.setVisible()};event={browserEvent:event};if(item.firePointEvent){item.firePointEvent(strLegendItemClick,event,fnLegendItemClick)}else{fireEvent(item,strLegendItemClick,event,fnLegendItemClick)}})},createCheckboxForItem:function(item){var legend=this;item.checkbox=createElement("input",{type:"checkbox",checked:item.selected,defaultChecked:item.selected},legend.options.itemCheckboxStyle,legend.chart.container);addEvent(item.checkbox,"click",function(event){var target=event.target;fireEvent(item.series||item,"checkboxClick",{checked:target.checked,item:item},function(){item.select()})})}});defaultOptions.legend.itemStyle.cursor="pointer";extend(Chart.prototype,{showResetZoom:function(){var chart=this,lang=defaultOptions.lang,btnOptions=chart.options.chart.resetZoomButton,theme=btnOptions.theme,states=theme.states,alignTo=btnOptions.relativeTo==="chart"?null:"plotBox";this.resetZoomButton=chart.renderer.button(lang.resetZoom,null,null,function(){chart.zoomOut()},theme,states&&states.hover).attr({align:btnOptions.position.align,title:lang.resetZoomTitle}).add().align(btnOptions.position,false,alignTo)},zoomOut:function(){var chart=this;fireEvent(chart,"selection",{resetSelection:true},function(){chart.zoom()})},zoom:function(event){var chart=this,hasZoomed,pointer=chart.pointer,displayButton=false,resetZoomButton;if(!event||event.resetSelection){each(chart.axes,function(axis){hasZoomed=axis.zoom()})}else{each(event.xAxis.concat(event.yAxis),function(axisData){var axis=axisData.axis,isXAxis=axis.isXAxis;if(pointer[isXAxis?"zoomX":"zoomY"]||pointer[isXAxis?"pinchX":"pinchY"]){hasZoomed=axis.zoom(axisData.min,axisData.max);if(axis.displayBtn){displayButton=true}}})}resetZoomButton=chart.resetZoomButton;if(displayButton&&!resetZoomButton){chart.showResetZoom()}else if(!displayButton&&isObject(resetZoomButton)){chart.resetZoomButton=resetZoomButton.destroy()}if(hasZoomed){chart.redraw(pick(chart.options.chart.animation,event&&event.animation,chart.pointCount<100))}},pan:function(e,panning){var chart=this,hoverPoints=chart.hoverPoints,doRedraw;if(hoverPoints){each(hoverPoints,function(point){point.setState()})}each(panning==="xy"?[1,0]:[1],function(isX){var mousePos=e[isX?"chartX":"chartY"],axis=chart[isX?"xAxis":"yAxis"][0],startPos=chart[isX?"mouseDownX":"mouseDownY"],halfPointRange=(axis.pointRange||0)/2,extremes=axis.getExtremes(),newMin=axis.toValue(startPos-mousePos,true)+halfPointRange,newMax=axis.toValue(startPos+chart[isX?"plotWidth":"plotHeight"]-mousePos,true)-halfPointRange,goingLeft=startPos>mousePos;if(axis.series.length&&(goingLeft||newMin>mathMin(extremes.dataMin,extremes.min))&&(!goingLeft||newMax<mathMax(extremes.dataMax,extremes.max))){axis.setExtremes(newMin,newMax,false,false,{trigger:"pan"});doRedraw=true}chart[isX?"mouseDownX":"mouseDownY"]=mousePos});if(doRedraw){chart.redraw(false)}css(chart.container,{cursor:"move"})}});extend(Point.prototype,{select:function(selected,accumulate){var point=this,series=point.series,chart=series.chart;selected=pick(selected,!point.selected);point.firePointEvent(selected?"select":"unselect",{accumulate:accumulate},function(){point.selected=point.options.selected=selected;series.options.data[inArray(point,series.data)]=point.options;point.setState(selected&&SELECT_STATE);if(!accumulate){each(chart.getSelectedPoints(),function(loopPoint){if(loopPoint.selected&&loopPoint!==point){loopPoint.selected=loopPoint.options.selected=false;series.options.data[inArray(loopPoint,series.data)]=loopPoint.options;loopPoint.setState(NORMAL_STATE);loopPoint.firePointEvent("unselect")}})}})},onMouseOver:function(e){var point=this,series=point.series,chart=series.chart,tooltip=chart.tooltip,hoverPoint=chart.hoverPoint;if(chart.hoverSeries!==series){series.onMouseOver()}if(hoverPoint&&hoverPoint!==point){hoverPoint.onMouseOut()}if(point.series){point.firePointEvent("mouseOver");if(tooltip&&(!tooltip.shared||series.noSharedTooltip)){tooltip.refresh(point,e)}point.setState(HOVER_STATE);chart.hoverPoint=point}},onMouseOut:function(){var chart=this.series.chart,hoverPoints=chart.hoverPoints;this.firePointEvent("mouseOut");if(!hoverPoints||inArray(this,hoverPoints)===-1){this.setState();chart.hoverPoint=null}},importEvents:function(){if(!this.hasImportedEvents){var point=this,options=merge(point.series.options.point,point.options),events=options.events,eventType;point.events=events;for(eventType in events){addEvent(point,eventType,events[eventType])}this.hasImportedEvents=true}},setState:function(state,move){var point=this,plotX=point.plotX,plotY=point.plotY,series=point.series,stateOptions=series.options.states,markerOptions=defaultPlotOptions[series.type].marker&&series.options.marker,normalDisabled=markerOptions&&!markerOptions.enabled,markerStateOptions=markerOptions&&markerOptions.states[state],stateDisabled=markerStateOptions&&markerStateOptions.enabled===false,stateMarkerGraphic=series.stateMarkerGraphic,pointMarker=point.marker||{},chart=series.chart,radius,halo=series.halo,haloOptions,newSymbol,pointAttr;state=state||NORMAL_STATE;pointAttr=point.pointAttr[state]||series.pointAttr[state];if(state===point.state&&!move||point.selected&&state!==SELECT_STATE||stateOptions[state]&&stateOptions[state].enabled===false||state&&(stateDisabled||normalDisabled&&markerStateOptions.enabled===false)||state&&pointMarker.states&&pointMarker.states[state]&&pointMarker.states[state].enabled===false){return}if(point.graphic){radius=markerOptions&&point.graphic.symbolName&&pointAttr.r;point.graphic.attr(merge(pointAttr,radius?{x:plotX-radius,y:plotY-radius,width:2*radius,height:2*radius}:{}));if(stateMarkerGraphic){stateMarkerGraphic.hide()}}else{if(state&&markerStateOptions){radius=markerStateOptions.radius;newSymbol=pointMarker.symbol||series.symbol;if(stateMarkerGraphic&&stateMarkerGraphic.currentSymbol!==newSymbol){stateMarkerGraphic=stateMarkerGraphic.destroy()}if(!stateMarkerGraphic){if(newSymbol){series.stateMarkerGraphic=stateMarkerGraphic=chart.renderer.symbol(newSymbol,plotX-radius,plotY-radius,2*radius,2*radius).attr(pointAttr).add(series.markerGroup);stateMarkerGraphic.currentSymbol=newSymbol}}else{stateMarkerGraphic[move?"animate":"attr"]({x:plotX-radius,y:plotY-radius})}}if(stateMarkerGraphic){stateMarkerGraphic[state&&chart.isInsidePlot(plotX,plotY,chart.inverted)?"show":"hide"]();stateMarkerGraphic.element.point=point}}haloOptions=stateOptions[state]&&stateOptions[state].halo;if(haloOptions&&haloOptions.size){if(!halo){series.halo=halo=chart.renderer.path().add(chart.seriesGroup)}halo.attr(extend({fill:Color(point.color||series.color).setOpacity(haloOptions.opacity).get()},haloOptions.attributes))[move?"animate":"attr"]({d:point.haloPath(haloOptions.size)})}else if(halo){halo.attr({d:[]})}point.state=state},haloPath:function(size){var series=this.series,chart=series.chart,plotBox=series.getPlotBox(),inverted=chart.inverted;return chart.renderer.symbols.circle(plotBox.translateX+(inverted?series.yAxis.len-this.plotY:this.plotX)-size,plotBox.translateY+(inverted?series.xAxis.len-this.plotX:this.plotY)-size,size*2,size*2)}});extend(Series.prototype,{onMouseOver:function(){var series=this,chart=series.chart,hoverSeries=chart.hoverSeries;if(hoverSeries&&hoverSeries!==series){hoverSeries.onMouseOut()}if(series.options.events.mouseOver){fireEvent(series,"mouseOver")}series.setState(HOVER_STATE);chart.hoverSeries=series},onMouseOut:function(){var series=this,options=series.options,chart=series.chart,tooltip=chart.tooltip,hoverPoint=chart.hoverPoint;chart.hoverSeries=null;if(hoverPoint){hoverPoint.onMouseOut()}if(series&&options.events.mouseOut){fireEvent(series,"mouseOut")}if(tooltip&&!options.stickyTracking&&(!tooltip.shared||series.noSharedTooltip)){tooltip.hide()}series.setState()},setState:function(state){var series=this,options=series.options,graph=series.graph,stateOptions=options.states,lineWidth=options.lineWidth,attribs,i=0;state=state||NORMAL_STATE;if(series.state!==state){series.state=state;if(stateOptions[state]&&stateOptions[state].enabled===false){return}if(state){lineWidth=stateOptions[state].lineWidth||lineWidth+(stateOptions[state].lineWidthPlus||0)}if(graph&&!graph.dashstyle){attribs={"stroke-width":lineWidth};graph.attr(attribs);while(series["zoneGraph"+i]){series["zoneGraph"+i].attr(attribs);i=i+1}}}},setVisible:function(vis,redraw){var series=this,chart=series.chart,legendItem=series.legendItem,showOrHide,ignoreHiddenSeries=chart.options.chart.ignoreHiddenSeries,oldVisibility=series.visible;series.visible=vis=series.userOptions.visible=vis===UNDEFINED?!oldVisibility:vis;showOrHide=vis?"show":"hide";each(["group","dataLabelsGroup","markerGroup","tracker"],function(key){if(series[key]){series[key][showOrHide]()}});if(chart.hoverSeries===series||(chart.hoverPoint&&chart.hoverPoint.series)===series){series.onMouseOut()}if(legendItem){chart.legend.colorizeItem(series,vis)}series.isDirty=true;if(series.options.stacking){each(chart.series,function(otherSeries){if(otherSeries.options.stacking&&otherSeries.visible){otherSeries.isDirty=true}})}each(series.linkedSeries,function(otherSeries){otherSeries.setVisible(vis,false)});if(ignoreHiddenSeries){chart.isDirtyBox=true}if(redraw!==false){chart.redraw()}fireEvent(series,showOrHide)},show:function(){this.setVisible(true)},hide:function(){this.setVisible(false)},select:function(selected){var series=this;series.selected=selected=selected===UNDEFINED?!series.selected:selected;if(series.checkbox){series.checkbox.checked=selected}fireEvent(series,selected?"select":"unselect")},drawTracker:TrackerMixin.drawTrackerGraph});wrap(Series.prototype,"init",function(proceed){var series=this,xAxis;proceed.apply(this,Array.prototype.slice.call(arguments,1));xAxis=series.xAxis;if(xAxis&&xAxis.options.ordinal){addEvent(series,"updatedData",function(){delete xAxis.ordinalIndex})}});wrap(Axis.prototype,"getTimeTicks",function(proceed,normalizedInterval,min,max,startOfWeek,positions,closestDistance,findHigherRanks){var start=0,end=0,segmentPositions,higherRanks={},hasCrossedHigherRank,info,posLength,outsideMax,groupPositions=[],lastGroupPosition=-Number.MAX_VALUE,tickPixelIntervalOption=this.options.tickPixelInterval;if(!this.options.ordinal&&!this.options.breaks||!positions||positions.length<3||min===UNDEFINED){return proceed.call(this,normalizedInterval,min,max,startOfWeek)}posLength=positions.length;for(;end<posLength;end++){outsideMax=end&&positions[end-1]>max;if(positions[end]<min){start=end}if(end===posLength-1||positions[end+1]-positions[end]>closestDistance*5||outsideMax){if(positions[end]>lastGroupPosition){segmentPositions=proceed.call(this,normalizedInterval,positions[start],positions[end],startOfWeek);while(segmentPositions.length&&segmentPositions[0]<=lastGroupPosition){segmentPositions.shift()}if(segmentPositions.length){lastGroupPosition=segmentPositions[segmentPositions.length-1]}groupPositions=groupPositions.concat(segmentPositions)}start=end+1}if(outsideMax){break}}info=segmentPositions.info;if(findHigherRanks&&info.unitRange<=timeUnits.hour){end=groupPositions.length-1;for(start=1;start<end;start++){if(dateFormat("%d",groupPositions[start])!==dateFormat("%d",groupPositions[start-1])){higherRanks[groupPositions[start]]="day";hasCrossedHigherRank=true}}if(hasCrossedHigherRank){higherRanks[groupPositions[0]]="day"}info.higherRanks=higherRanks}groupPositions.info=info;if(findHigherRanks&&defined(tickPixelIntervalOption)){var length=groupPositions.length,i=length,itemToRemove,translated,translatedArr=[],lastTranslated,medianDistance,distance,distances=[];while(i--){translated=this.translate(groupPositions[i]);if(lastTranslated){distances[i]=lastTranslated-translated}translatedArr[i]=lastTranslated=translated}distances.sort();medianDistance=distances[mathFloor(distances.length/2)];if(medianDistance<tickPixelIntervalOption*.6){medianDistance=null}i=groupPositions[length-1]>max?length-1:length;lastTranslated=undefined;while(i--){translated=translatedArr[i];distance=lastTranslated-translated;if(lastTranslated&&distance<tickPixelIntervalOption*.8&&(medianDistance===null||distance<medianDistance*.8)){if(higherRanks[groupPositions[i]]&&!higherRanks[groupPositions[i+1]]){itemToRemove=i+1;lastTranslated=translated}else{itemToRemove=i}groupPositions.splice(itemToRemove,1)}else{lastTranslated=translated}}}return groupPositions});extend(Axis.prototype,{beforeSetTickPositions:function(){var axis=this,len,ordinalPositions=[],useOrdinal=false,dist,extremes=axis.getExtremes(),min=extremes.min,max=extremes.max,minIndex,maxIndex,slope,hasBreaks=axis.isXAxis&&!!axis.options.breaks,isOrdinal=axis.options.ordinal,i;if(isOrdinal||hasBreaks){each(axis.series,function(series,i){if(series.visible!==false&&(series.takeOrdinalPosition!==false||hasBreaks)){ordinalPositions=ordinalPositions.concat(series.processedXData);len=ordinalPositions.length;ordinalPositions.sort(function(a,b){return a-b});if(len){i=len-1;while(i--){if(ordinalPositions[i]===ordinalPositions[i+1]){ordinalPositions.splice(i,1)}}}}});len=ordinalPositions.length;if(len>2){dist=ordinalPositions[1]-ordinalPositions[0];i=len-1;while(i--&&!useOrdinal){if(ordinalPositions[i+1]-ordinalPositions[i]!==dist){useOrdinal=true}}if(!axis.options.keepOrdinalPadding&&(ordinalPositions[0]-min>dist||max-ordinalPositions[ordinalPositions.length-1]>dist)){useOrdinal=true}}if(useOrdinal){axis.ordinalPositions=ordinalPositions;minIndex=axis.val2lin(mathMax(min,ordinalPositions[0]),true);maxIndex=mathMax(axis.val2lin(mathMin(max,ordinalPositions[ordinalPositions.length-1]),true),1);axis.ordinalSlope=slope=(max-min)/(maxIndex-minIndex);axis.ordinalOffset=min-minIndex*slope}else{axis.ordinalPositions=axis.ordinalSlope=axis.ordinalOffset=UNDEFINED}}axis.doPostTranslate=isOrdinal&&useOrdinal||hasBreaks;axis.groupIntervalFactor=null},val2lin:function(val,toIndex){var axis=this,ordinalPositions=axis.ordinalPositions;if(!ordinalPositions){return val}else{var ordinalLength=ordinalPositions.length,i,distance,ordinalIndex;i=ordinalLength;while(i--){if(ordinalPositions[i]===val){ordinalIndex=i;break}}i=ordinalLength-1;while(i--){if(val>ordinalPositions[i]||i===0){distance=(val-ordinalPositions[i])/(ordinalPositions[i+1]-ordinalPositions[i]);ordinalIndex=i+distance;break}}return toIndex?ordinalIndex:axis.ordinalSlope*(ordinalIndex||0)+axis.ordinalOffset}},lin2val:function(val,fromIndex){var axis=this,ordinalPositions=axis.ordinalPositions;if(!ordinalPositions){return val}else{var ordinalSlope=axis.ordinalSlope,ordinalOffset=axis.ordinalOffset,i=ordinalPositions.length-1,linearEquivalentLeft,linearEquivalentRight,distance;if(fromIndex){if(val<0){val=ordinalPositions[0]}else if(val>i){val=ordinalPositions[i]}else{i=mathFloor(val);distance=val-i}}else{while(i--){linearEquivalentLeft=ordinalSlope*i+ordinalOffset;if(val>=linearEquivalentLeft){linearEquivalentRight=ordinalSlope*(i+1)+ordinalOffset;distance=(val-linearEquivalentLeft)/(linearEquivalentRight-linearEquivalentLeft);break}}}return distance!==UNDEFINED&&ordinalPositions[i]!==UNDEFINED?ordinalPositions[i]+(distance?distance*(ordinalPositions[i+1]-ordinalPositions[i]):0):val}},getExtendedPositions:function(){var axis=this,chart=axis.chart,grouping=axis.series[0].currentDataGrouping,ordinalIndex=axis.ordinalIndex,key=grouping?grouping.count+grouping.unitName:"raw",extremes=axis.getExtremes(),fakeAxis,fakeSeries;if(!ordinalIndex){ordinalIndex=axis.ordinalIndex={}}if(!ordinalIndex[key]){fakeAxis={series:[],getExtremes:function(){return{min:extremes.dataMin,max:extremes.dataMax}},options:{ordinal:true},val2lin:Axis.prototype.val2lin};each(axis.series,function(series){fakeSeries={xAxis:fakeAxis,xData:series.xData,chart:chart,destroyGroupedData:noop};fakeSeries.options={dataGrouping:grouping?{enabled:true,forced:true,approximation:"open",units:[[grouping.unitName,[grouping.count]]]}:{enabled:false}};series.processData.apply(fakeSeries);fakeAxis.series.push(fakeSeries)});axis.beforeSetTickPositions.apply(fakeAxis);ordinalIndex[key]=fakeAxis.ordinalPositions}return ordinalIndex[key]},getGroupIntervalFactor:function(xMin,xMax,series){var i=0,processedXData=series.processedXData,len=processedXData.length,distances=[],median,groupIntervalFactor=this.groupIntervalFactor;if(!groupIntervalFactor){for(;i<len-1;i++){distances[i]=processedXData[i+1]-processedXData[i]}distances.sort(function(a,b){return a-b});median=distances[mathFloor(len/2)];xMin=mathMax(xMin,processedXData[0]);xMax=mathMin(xMax,processedXData[len-1]);this.groupIntervalFactor=groupIntervalFactor=len*median/(xMax-xMin)}return groupIntervalFactor},postProcessTickInterval:function(tickInterval){var ordinalSlope=this.ordinalSlope;if(ordinalSlope){if(!this.options.breaks){return tickInterval/(ordinalSlope/this.closestPointRange)}else{return this.closestPointRange}}else{return tickInterval}}});wrap(Chart.prototype,"pan",function(proceed,e){var chart=this,xAxis=chart.xAxis[0],chartX=e.chartX,runBase=false;if(xAxis.options.ordinal&&xAxis.series.length){var mouseDownX=chart.mouseDownX,extremes=xAxis.getExtremes(),dataMax=extremes.dataMax,min=extremes.min,max=extremes.max,trimmedRange,hoverPoints=chart.hoverPoints,closestPointRange=xAxis.closestPointRange,pointPixelWidth=xAxis.translationSlope*(xAxis.ordinalSlope||closestPointRange),movedUnits=(mouseDownX-chartX)/pointPixelWidth,extendedAxis={ordinalPositions:xAxis.getExtendedPositions()},ordinalPositions,searchAxisLeft,lin2val=xAxis.lin2val,val2lin=xAxis.val2lin,searchAxisRight;if(!extendedAxis.ordinalPositions){runBase=true}else if(mathAbs(movedUnits)>1){if(hoverPoints){each(hoverPoints,function(point){point.setState()})}if(movedUnits<0){searchAxisLeft=extendedAxis;searchAxisRight=xAxis.ordinalPositions?xAxis:extendedAxis}else{searchAxisLeft=xAxis.ordinalPositions?xAxis:extendedAxis;searchAxisRight=extendedAxis}ordinalPositions=searchAxisRight.ordinalPositions;if(dataMax>ordinalPositions[ordinalPositions.length-1]){ordinalPositions.push(dataMax)}chart.fixedRange=max-min;trimmedRange=xAxis.toFixedRange(null,null,lin2val.apply(searchAxisLeft,[val2lin.apply(searchAxisLeft,[min,true])+movedUnits,true]),lin2val.apply(searchAxisRight,[val2lin.apply(searchAxisRight,[max,true])+movedUnits,true]));if(trimmedRange.min>=mathMin(extremes.dataMin,min)&&trimmedRange.max<=mathMax(dataMax,max)){xAxis.setExtremes(trimmedRange.min,trimmedRange.max,true,false,{trigger:"pan"})}chart.mouseDownX=chartX;css(chart.container,{cursor:"move"})}}else{runBase=true}if(runBase){proceed.apply(this,Array.prototype.slice.call(arguments,1))}});wrap(Series.prototype,"getSegments",function(proceed){var series=this,segments,gapSize=series.options.gapSize,xAxis=series.xAxis;proceed.apply(this,Array.prototype.slice.call(arguments,1));if(gapSize){segments=series.segments;each(segments,function(segment,no){var i=segment.length-1;while(i--){if(segment[i].x<xAxis.min&&segment[i+1].x>xAxis.max){segments.length=0;break}else if(segment[i+1].x-segment[i].x>xAxis.closestPointRange*gapSize){segments.splice(no+1,0,segment.splice(i+1,segment.length-i))}}})}});(function(H){"use strict";var pick=H.pick,wrap=H.wrap,extend=H.extend,fireEvent=HighchartsAdapter.fireEvent,Axis=H.Axis,Series=H.Series;function stripArguments(){return Array.prototype.slice.call(arguments,1)}extend(Axis.prototype,{isInBreak:function(brk,val){var repeat=brk.repeat||Infinity,from=brk.from,length=brk.to-brk.from,test=val>=from?(val-from)%repeat:repeat-(from-val)%repeat;if(!brk.inclusive){return test<length&&test!==0}else{return test<=length}},isInAnyBreak:function(val,testKeep){var breaks=this.options.breaks,i=breaks&&breaks.length,inbrk,keep,ret;if(i){while(i--){if(this.isInBreak(breaks[i],val)){inbrk=true;if(!keep){keep=pick(breaks[i].showPoints,this.isXAxis?false:true)}}}if(inbrk&&testKeep){ret=inbrk&&!keep}else{ret=inbrk}}return ret}});wrap(Axis.prototype,"setTickPositions",function(proceed){proceed.apply(this,Array.prototype.slice.call(arguments,1));if(this.options.breaks){var axis=this,tickPositions=this.tickPositions,info=this.tickPositions.info,newPositions=[],i;if(info&&info.totalRange>=axis.closestPointRange){return}for(i=0;i<tickPositions.length;i++){if(!axis.isInAnyBreak(tickPositions[i])){newPositions.push(tickPositions[i])}}this.tickPositions=newPositions;this.tickPositions.info=info}});wrap(Axis.prototype,"init",function(proceed,chart,userOptions){if(userOptions.breaks&&userOptions.breaks.length){userOptions.ordinal=false}proceed.call(this,chart,userOptions);if(this.options.breaks){var axis=this;axis.doPostTranslate=true;this.val2lin=function(val){var nval=val,brk,i;for(i=0;i<axis.breakArray.length;i++){brk=axis.breakArray[i];if(brk.to<=val){nval-=brk.len}else if(brk.from>=val){break}else if(axis.isInBreak(brk,val)){nval-=val-brk.from;break}}return nval};this.lin2val=function(val){var nval=val,brk,i;for(i=0;i<axis.breakArray.length;i++){brk=axis.breakArray[i];if(brk.from>=nval){break}else if(brk.to<nval){nval+=brk.len}else if(axis.isInBreak(brk,nval)){nval+=brk.len}}return nval};this.setExtremes=function(newMin,newMax,redraw,animation,eventArguments){while(this.isInAnyBreak(newMin)){newMin-=this.closestPointRange}while(this.isInAnyBreak(newMax)){newMax-=this.closestPointRange}Axis.prototype.setExtremes.call(this,newMin,newMax,redraw,animation,eventArguments)};this.setAxisTranslation=function(saveOld){Axis.prototype.setAxisTranslation.call(this,saveOld);var breaks=axis.options.breaks,breakArrayT=[],breakArray=[],length=0,inBrk,repeat,brk,min=axis.userMin||axis.min,max=axis.userMax||axis.max,start,i,j;for(i in breaks){brk=breaks[i];repeat=brk.repeat||Infinity;if(axis.isInBreak(brk,min)){min+=brk.to%repeat-min%repeat}if(axis.isInBreak(brk,max)){max-=max%repeat-brk.from%repeat}}for(i in breaks){brk=breaks[i];start=brk.from;repeat=brk.repeat||Infinity;while(start-repeat>min){start-=repeat}while(start<min){start+=repeat}for(j=start;j<max;j+=repeat){breakArrayT.push({value:j,move:"in"});breakArrayT.push({value:j+(brk.to-brk.from),move:"out",size:brk.breakSize})}}breakArrayT.sort(function(a,b){if(a.value===b.value){return(a.move==="in"?0:1)-(b.move==="in"?0:1)}else{return a.value-b.value}});inBrk=0;start=min;for(i in breakArrayT){brk=breakArrayT[i];inBrk+=brk.move==="in"?1:-1;if(inBrk===1&&brk.move==="in"){start=brk.value}if(inBrk===0){breakArray.push({from:start,to:brk.value,len:brk.value-start-(brk.size||0)});length+=brk.value-start-(brk.size||0)}}axis.breakArray=breakArray;fireEvent(axis,"afterBreaks");axis.transA*=(max-axis.min)/(max-min-length);axis.min=min;axis.max=max}}});wrap(Series.prototype,"generatePoints",function(proceed){proceed.apply(this,stripArguments(arguments));var series=this,xAxis=series.xAxis,yAxis=series.yAxis,points=series.points,point,i=points.length,connectNulls=series.options.connectNulls,nullGap;if(xAxis&&yAxis&&(xAxis.options.breaks||yAxis.options.breaks)){while(i--){point=points[i];nullGap=point.y===null&&connectNulls===false;if(!nullGap&&(xAxis.isInAnyBreak(point.x,true)||yAxis.isInAnyBreak(point.y,true))){points.splice(i,1);if(this.data[i]){this.data[i].destroyElements()}}}}});wrap(H.seriesTypes.column.prototype,"drawPoints",function(proceed){proceed.apply(this);var series=this,points=series.points,yAxis=series.yAxis,breaks=yAxis.breakArray||[],point,brk,i,j,y;for(i=0;i<points.length;i++){point=points[i];y=point.stackY||point.y;for(j=0;j<breaks.length;j++){brk=breaks[j];if(y<brk.from){break}else if(y>brk.to){fireEvent(yAxis,"pointBreak",{point:point,brk:brk})}else{fireEvent(yAxis,"pointInBreak",{point:point,brk:brk})}}}})})(Highcharts);var DATA_GROUPING="dataGrouping",seriesProto=Series.prototype,tooltipProto=Tooltip.prototype,baseProcessData=seriesProto.processData,baseGeneratePoints=seriesProto.generatePoints,baseDestroy=seriesProto.destroy,baseTooltipFooterHeaderFormatter=tooltipProto.tooltipFooterHeaderFormatter,NUMBER="number",commonOptions={approximation:"average",groupPixelWidth:2,dateTimeLabelFormats:{millisecond:["%A, %b %e, %H:%M:%S.%L","%A, %b %e, %H:%M:%S.%L","-%H:%M:%S.%L"],second:["%A, %b %e, %H:%M:%S","%A, %b %e, %H:%M:%S","-%H:%M:%S"],minute:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],hour:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],day:["%A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],week:["Week from %A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],month:["%B %Y","%B","-%B %Y"],year:["%Y","%Y","-%Y"]}},specificOptions={line:{},spline:{},area:{},areaspline:{},column:{approximation:"sum",groupPixelWidth:10},arearange:{approximation:"range"},areasplinerange:{approximation:"range"},columnrange:{approximation:"range",groupPixelWidth:10},candlestick:{approximation:"ohlc",groupPixelWidth:10},ohlc:{approximation:"ohlc",groupPixelWidth:5}},defaultDataGroupingUnits=[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1]],["week",[1]],["month",[1,3,6]],["year",null]],approximations={sum:function(arr){var len=arr.length,ret;if(!len&&arr.hasNulls){ret=null}else if(len){ret=0;while(len--){ret+=arr[len]}}return ret},average:function(arr){var len=arr.length,ret=approximations.sum(arr);if(typeof ret===NUMBER&&len){ret=ret/len}return ret},open:function(arr){return arr.length?arr[0]:arr.hasNulls?null:UNDEFINED},high:function(arr){return arr.length?arrayMax(arr):arr.hasNulls?null:UNDEFINED},low:function(arr){return arr.length?arrayMin(arr):arr.hasNulls?null:UNDEFINED},close:function(arr){return arr.length?arr[arr.length-1]:arr.hasNulls?null:UNDEFINED},ohlc:function(open,high,low,close){open=approximations.open(open);high=approximations.high(high);low=approximations.low(low);close=approximations.close(close);
if(typeof open===NUMBER||typeof high===NUMBER||typeof low===NUMBER||typeof close===NUMBER){return[open,high,low,close]}},range:function(low,high){low=approximations.low(low);high=approximations.high(high);if(typeof low===NUMBER||typeof high===NUMBER){return[low,high]}}};seriesProto.groupData=function(xData,yData,groupPositions,approximation){var series=this,data=series.data,dataOptions=series.options.data,groupedXData=[],groupedYData=[],dataLength=xData.length,pointX,pointY,groupedY,handleYData=!!yData,values=[[],[],[],[]],approximationFn=typeof approximation==="function"?approximation:approximations[approximation],pointArrayMap=series.pointArrayMap,pointArrayMapLength=pointArrayMap&&pointArrayMap.length,i;for(i=0;i<=dataLength;i++){if(xData[i]>=groupPositions[0]){break}}for(;i<=dataLength;i++){while(groupPositions[1]!==UNDEFINED&&xData[i]>=groupPositions[1]||i===dataLength){pointX=groupPositions.shift();groupedY=approximationFn.apply(0,values);if(groupedY!==UNDEFINED){groupedXData.push(pointX);groupedYData.push(groupedY)}values[0]=[];values[1]=[];values[2]=[];values[3]=[];if(i===dataLength){break}}if(i===dataLength){break}if(pointArrayMap){var index=series.cropStart+i,point=data&&data[index]||series.pointClass.prototype.applyOptions.apply({series:series},[dataOptions[index]]),j,val;for(j=0;j<pointArrayMapLength;j++){val=point[pointArrayMap[j]];if(typeof val===NUMBER){values[j].push(val)}else if(val===null){values[j].hasNulls=true}}}else{pointY=handleYData?yData[i]:null;if(typeof pointY===NUMBER){values[0].push(pointY)}else if(pointY===null){values[0].hasNulls=true}}}return[groupedXData,groupedYData]};seriesProto.processData=function(){var series=this,chart=series.chart,options=series.options,dataGroupingOptions=options[DATA_GROUPING],groupingEnabled=series.allowDG!==false&&dataGroupingOptions&&pick(dataGroupingOptions.enabled,chart.options._stock),hasGroupedData;series.forceCrop=groupingEnabled;series.groupPixelWidth=null;series.hasProcessed=true;if(baseProcessData.apply(series,arguments)===false||!groupingEnabled){return}else{series.destroyGroupedData()}var i,processedXData=series.processedXData,processedYData=series.processedYData,plotSizeX=chart.plotSizeX,xAxis=series.xAxis,ordinal=xAxis.options.ordinal,groupPixelWidth=series.groupPixelWidth=xAxis.getGroupPixelWidth&&xAxis.getGroupPixelWidth(),nonGroupedPointRange=series.pointRange;if(groupPixelWidth){hasGroupedData=true;series.points=null;var extremes=xAxis.getExtremes(),xMin=extremes.min,xMax=extremes.max,groupIntervalFactor=ordinal&&xAxis.getGroupIntervalFactor(xMin,xMax,series)||1,interval=groupPixelWidth*(xMax-xMin)/plotSizeX*groupIntervalFactor,groupPositions=xAxis.getTimeTicks(xAxis.normalizeTimeTickInterval(interval,dataGroupingOptions.units||defaultDataGroupingUnits),xMin,xMax,xAxis.options.startOfWeek,processedXData,series.closestPointRange),groupedXandY=seriesProto.groupData.apply(series,[processedXData,processedYData,groupPositions,dataGroupingOptions.approximation]),groupedXData=groupedXandY[0],groupedYData=groupedXandY[1];if(dataGroupingOptions.smoothed){i=groupedXData.length-1;groupedXData[i]=xMax;while(i--&&i>0){groupedXData[i]+=interval/2}groupedXData[0]=xMin}series.currentDataGrouping=groupPositions.info;if(options.pointRange===null){series.pointRange=groupPositions.info.totalRange}series.closestPointRange=groupPositions.info.totalRange;if(defined(groupedXData[0])&&groupedXData[0]<xAxis.dataMin){if(xAxis.min===xAxis.dataMin){xAxis.min=groupedXData[0]}xAxis.dataMin=groupedXData[0]}series.processedXData=groupedXData;series.processedYData=groupedYData}else{series.currentDataGrouping=null;series.pointRange=nonGroupedPointRange}series.hasGroupedData=hasGroupedData};seriesProto.destroyGroupedData=function(){var groupedData=this.groupedData;each(groupedData||[],function(point,i){if(point){groupedData[i]=point.destroy?point.destroy():null}});this.groupedData=null};seriesProto.generatePoints=function(){baseGeneratePoints.apply(this);this.destroyGroupedData();this.groupedData=this.hasGroupedData?this.points:null};tooltipProto.tooltipFooterHeaderFormatter=function(point,isFooter){var tooltip=this,series=point.series,options=series.options,tooltipOptions=series.tooltipOptions,dataGroupingOptions=options.dataGrouping,xDateFormat=tooltipOptions.xDateFormat,xDateFormatEnd,xAxis=series.xAxis,currentDataGrouping,dateTimeLabelFormats,labelFormats,formattedKey,ret;if(xAxis&&xAxis.options.type==="datetime"&&dataGroupingOptions&&isNumber(point.key)){currentDataGrouping=series.currentDataGrouping;dateTimeLabelFormats=dataGroupingOptions.dateTimeLabelFormats;if(currentDataGrouping){labelFormats=dateTimeLabelFormats[currentDataGrouping.unitName];if(currentDataGrouping.count===1){xDateFormat=labelFormats[0]}else{xDateFormat=labelFormats[1];xDateFormatEnd=labelFormats[2]}}else if(!xDateFormat&&dateTimeLabelFormats){xDateFormat=tooltip.getXDateFormat(point,tooltipOptions,xAxis)}formattedKey=dateFormat(xDateFormat,point.key);if(xDateFormatEnd){formattedKey+=dateFormat(xDateFormatEnd,point.key+currentDataGrouping.totalRange-1)}ret=tooltipOptions[(isFooter?"footer":"header")+"Format"].replace("{point.key}",formattedKey)}else{ret=baseTooltipFooterHeaderFormatter.call(tooltip,point,isFooter)}return ret};seriesProto.destroy=function(){var series=this,groupedData=series.groupedData||[],i=groupedData.length;while(i--){if(groupedData[i]){groupedData[i].destroy()}}baseDestroy.apply(series)};wrap(seriesProto,"setOptions",function(proceed,itemOptions){var options=proceed.call(this,itemOptions),type=this.type,plotOptions=this.chart.options.plotOptions,defaultOptions=defaultPlotOptions[type].dataGrouping;if(specificOptions[type]){if(!defaultOptions){defaultOptions=merge(commonOptions,specificOptions[type])}options.dataGrouping=merge(defaultOptions,plotOptions.series&&plotOptions.series.dataGrouping,plotOptions[type].dataGrouping,itemOptions.dataGrouping)}if(this.chart.options._stock){this.requireSorting=true}return options});wrap(Axis.prototype,"setScale",function(proceed){proceed.call(this);each(this.series,function(series){series.hasProcessed=false})});Axis.prototype.getGroupPixelWidth=function(){var series=this.series,len=series.length,i,groupPixelWidth=0,doGrouping=false,dataLength,dgOptions;i=len;while(i--){dgOptions=series[i].options.dataGrouping;if(dgOptions){groupPixelWidth=mathMax(groupPixelWidth,dgOptions.groupPixelWidth)}}i=len;while(i--){dgOptions=series[i].options.dataGrouping;if(dgOptions&&series[i].hasProcessed){dataLength=(series[i].processedXData||series[i].data).length;if(series[i].groupPixelWidth||dataLength>this.chart.plotSizeX/groupPixelWidth||dataLength&&dgOptions.forced){doGrouping=true}}}return doGrouping?groupPixelWidth:0};Axis.prototype.setDataGrouping=function(dataGrouping,redraw){redraw=pick(redraw,true);if(!dataGrouping){dataGrouping={forced:false,units:null}}if(this instanceof Axis){each(this.series,function(series){series.update({dataGrouping:dataGrouping},false)})}else{each(this.chart.options.series,function(seriesOptions){seriesOptions.dataGrouping=dataGrouping})}};defaultPlotOptions.ohlc=merge(defaultPlotOptions.column,{lineWidth:1,tooltip:{pointFormat:'<span style="color:{point.color}"></span> <b> {series.name}</b><br/>'+"Open: {point.open}<br/>"+"High: {point.high}<br/>"+"Low: {point.low}<br/>"+"Close: {point.close}<br/>"},states:{hover:{lineWidth:3}},threshold:null});var OHLCSeries=extendClass(seriesTypes.column,{type:"ohlc",pointArrayMap:["open","high","low","close"],toYData:function(point){return[point.open,point.high,point.low,point.close]},pointValKey:"high",pointAttrToOptions:{stroke:"color","stroke-width":"lineWidth"},upColorProp:"stroke",getAttribs:function(){seriesTypes.column.prototype.getAttribs.apply(this,arguments);var series=this,options=series.options,stateOptions=options.states,upColor=options.upColor||series.color,seriesDownPointAttr=merge(series.pointAttr),upColorProp=series.upColorProp;seriesDownPointAttr[""][upColorProp]=upColor;seriesDownPointAttr.hover[upColorProp]=stateOptions.hover.upColor||upColor;seriesDownPointAttr.select[upColorProp]=stateOptions.select.upColor||upColor;each(series.points,function(point){if(point.open<point.close&&!point.options.color){point.pointAttr=seriesDownPointAttr}})},translate:function(){var series=this,yAxis=series.yAxis;seriesTypes.column.prototype.translate.apply(series);each(series.points,function(point){if(point.open!==null){point.plotOpen=yAxis.translate(point.open,0,1,0,1)}if(point.close!==null){point.plotClose=yAxis.translate(point.close,0,1,0,1)}})},drawPoints:function(){var series=this,points=series.points,chart=series.chart,pointAttr,plotOpen,plotClose,crispCorr,halfWidth,path,graphic,crispX;each(points,function(point){if(point.plotY!==UNDEFINED){graphic=point.graphic;pointAttr=point.pointAttr[point.selected?"selected":""]||series.pointAttr[NORMAL_STATE];crispCorr=pointAttr["stroke-width"]%2/2;crispX=mathRound(point.plotX)-crispCorr;halfWidth=mathRound(point.shapeArgs.width/2);path=["M",crispX,mathRound(point.yBottom),"L",crispX,mathRound(point.plotY)];if(point.open!==null){plotOpen=mathRound(point.plotOpen)+crispCorr;path.push("M",crispX,plotOpen,"L",crispX-halfWidth,plotOpen)}if(point.close!==null){plotClose=mathRound(point.plotClose)+crispCorr;path.push("M",crispX,plotClose,"L",crispX+halfWidth,plotClose)}if(graphic){graphic.attr(pointAttr).animate({d:path})}else{point.graphic=chart.renderer.path(path).attr(pointAttr).add(series.group)}}})},animate:null});seriesTypes.ohlc=OHLCSeries;defaultPlotOptions.candlestick=merge(defaultPlotOptions.column,{lineColor:"black",lineWidth:1,states:{hover:{lineWidth:2}},tooltip:defaultPlotOptions.ohlc.tooltip,threshold:null,upColor:"white"});var CandlestickSeries=extendClass(OHLCSeries,{type:"candlestick",pointAttrToOptions:{fill:"color",stroke:"lineColor","stroke-width":"lineWidth"},upColorProp:"fill",getAttribs:function(){seriesTypes.ohlc.prototype.getAttribs.apply(this,arguments);var series=this,options=series.options,stateOptions=options.states,upLineColor=options.upLineColor||options.lineColor,hoverStroke=stateOptions.hover.upLineColor||upLineColor,selectStroke=stateOptions.select.upLineColor||upLineColor;each(series.points,function(point){if(point.open<point.close){if(point.lineColor){point.pointAttr=merge(point.pointAttr);upLineColor=point.lineColor}point.pointAttr[""].stroke=upLineColor;point.pointAttr.hover.stroke=hoverStroke;point.pointAttr.select.stroke=selectStroke}})},drawPoints:function(){var series=this,points=series.points,chart=series.chart,pointAttr,seriesPointAttr=series.pointAttr[""],plotOpen,plotClose,topBox,bottomBox,hasTopWhisker,hasBottomWhisker,crispCorr,crispX,graphic,path,halfWidth;each(points,function(point){graphic=point.graphic;if(point.plotY!==UNDEFINED){pointAttr=point.pointAttr[point.selected?"selected":""]||seriesPointAttr;crispCorr=pointAttr["stroke-width"]%2/2;crispX=mathRound(point.plotX)-crispCorr;plotOpen=point.plotOpen;plotClose=point.plotClose;topBox=math.min(plotOpen,plotClose);bottomBox=math.max(plotOpen,plotClose);halfWidth=mathRound(point.shapeArgs.width/2);hasTopWhisker=mathRound(topBox)!==mathRound(point.plotY);hasBottomWhisker=bottomBox!==point.yBottom;topBox=mathRound(topBox)+crispCorr;bottomBox=mathRound(bottomBox)+crispCorr;path=["M",crispX-halfWidth,bottomBox,"L",crispX-halfWidth,topBox,"L",crispX+halfWidth,topBox,"L",crispX+halfWidth,bottomBox,"Z","M",crispX,topBox,"L",crispX,hasTopWhisker?mathRound(point.plotY):topBox,"M",crispX,bottomBox,"L",crispX,hasBottomWhisker?mathRound(point.yBottom):bottomBox];if(graphic){graphic.attr(pointAttr).animate({d:path})}else{point.graphic=chart.renderer.path(path).attr(pointAttr).add(series.group).shadow(series.options.shadow)}}})}});seriesTypes.candlestick=CandlestickSeries;var symbols=SVGRenderer.prototype.symbols;defaultPlotOptions.flags=merge(defaultPlotOptions.column,{fillColor:"white",lineWidth:1,pointRange:0,shape:"flag",stackDistance:12,states:{hover:{lineColor:"black",fillColor:"#FCFFC5"}},style:{fontSize:"11px",fontWeight:"bold",textAlign:"center"},tooltip:{pointFormat:"{point.text}<br/>"},threshold:null,y:-30});seriesTypes.flags=extendClass(seriesTypes.column,{type:"flags",sorted:false,noSharedTooltip:true,allowDG:false,takeOrdinalPosition:false,trackerGroups:["markerGroup"],forceCrop:true,init:Series.prototype.init,pointAttrToOptions:{fill:"fillColor",stroke:"color","stroke-width":"lineWidth",r:"radius"},translate:function(){seriesTypes.column.prototype.translate.apply(this);var series=this,options=series.options,chart=series.chart,points=series.points,cursor=points.length-1,point,lastPoint,optionsOnSeries=options.onSeries,onSeries=optionsOnSeries&&chart.get(optionsOnSeries),step=onSeries&&onSeries.options.step,onData=onSeries&&onSeries.points,i=onData&&onData.length,xAxis=series.xAxis,xAxisExt=xAxis.getExtremes(),leftPoint,lastX,rightPoint,currentDataGrouping;if(onSeries&&onSeries.visible&&i){currentDataGrouping=onSeries.currentDataGrouping;lastX=onData[i-1].x+(currentDataGrouping?currentDataGrouping.totalRange:0);points.sort(function(a,b){return a.x-b.x});while(i--&&points[cursor]){point=points[cursor];leftPoint=onData[i];if(leftPoint.x<=point.x&&leftPoint.plotY!==UNDEFINED){if(point.x<=lastX){point.plotY=leftPoint.plotY;if(leftPoint.x<point.x&&!step){rightPoint=onData[i+1];if(rightPoint&&rightPoint.plotY!==UNDEFINED){point.plotY+=(point.x-leftPoint.x)/(rightPoint.x-leftPoint.x)*(rightPoint.plotY-leftPoint.plotY)}}}cursor--;i++;if(cursor<0){break}}}}each(points,function(point,i){var stackIndex;if(point.plotY===UNDEFINED){if(point.x>=xAxisExt.min&&point.x<=xAxisExt.max){point.plotY=chart.chartHeight-xAxis.bottom-(xAxis.opposite?xAxis.height:0)+xAxis.offset-chart.plotTop}else{point.shapeArgs={}}}lastPoint=points[i-1];if(lastPoint&&lastPoint.plotX===point.plotX){if(lastPoint.stackIndex===UNDEFINED){lastPoint.stackIndex=0}stackIndex=lastPoint.stackIndex+1}point.stackIndex=stackIndex})},drawPoints:function(){var series=this,pointAttr,seriesPointAttr=series.pointAttr[""],points=series.points,chart=series.chart,renderer=chart.renderer,plotX,plotY,options=series.options,optionsY=options.y,shape,i,point,graphic,stackIndex,anchorX,anchorY,outsideRight;i=points.length;while(i--){point=points[i];outsideRight=point.plotX>series.xAxis.len;plotX=point.plotX-pick(point.lineWidth,options.lineWidth)%2;stackIndex=point.stackIndex;shape=point.options.shape||options.shape;plotY=point.plotY;if(plotY!==UNDEFINED){plotY=point.plotY+optionsY-(stackIndex!==UNDEFINED&&stackIndex*options.stackDistance)}anchorX=stackIndex?UNDEFINED:point.plotX;anchorY=stackIndex?UNDEFINED:point.plotY;graphic=point.graphic;if(plotY!==UNDEFINED&&plotX>=0&&!outsideRight){pointAttr=point.pointAttr[point.selected?"select":""]||seriesPointAttr;if(graphic){graphic.attr({x:plotX,y:plotY,r:pointAttr.r,anchorX:anchorX,anchorY:anchorY})}else{graphic=point.graphic=renderer.label(point.options.title||options.title||"A",plotX,plotY,shape,anchorX,anchorY,options.useHTML).css(merge(options.style,point.style)).attr(pointAttr).attr({align:shape==="flag"?"left":"center",width:options.width,height:options.height}).add(series.markerGroup).shadow(options.shadow)}point.tooltipPos=[plotX,plotY]}else if(graphic){point.graphic=graphic.destroy()}}},drawTracker:function(){var series=this,points=series.points;TrackerMixin.drawTrackerPoint.apply(this);each(points,function(point){var graphic=point.graphic;if(graphic){addEvent(graphic.element,"mouseover",function(){if(point.stackIndex>0&&!point.raised){point._y=graphic.y;graphic.attr({y:point._y-8});point.raised=true}each(points,function(otherPoint){if(otherPoint!==point&&otherPoint.raised&&otherPoint.graphic){otherPoint.graphic.attr({y:otherPoint._y});otherPoint.raised=false}})})}})},animate:noop,buildKDTree:noop,setClip:noop});symbols.flag=function(x,y,w,h,options){var anchorX=options&&options.anchorX||x,anchorY=options&&options.anchorY||y;return["M",anchorX,anchorY,"L",x,y+h,x,y,x+w,y,x+w,y+h,x,y+h,"Z"]};each(["circle","square"],function(shape){symbols[shape+"pin"]=function(x,y,w,h,options){var anchorX=options&&options.anchorX,anchorY=options&&options.anchorY,path,labelTopOrBottomY;if(shape==="circle"&&h>w){x-=mathRound((h-w)/2);w=h}path=symbols[shape](x,y,w,h);if(anchorX&&anchorY){labelTopOrBottomY=y>anchorY?y:y+h;path.push("M",anchorX,labelTopOrBottomY,"L",anchorX,anchorY)}return path}});if(Renderer===Highcharts.VMLRenderer){each(["flag","circlepin","squarepin"],function(shape){VMLRenderer.prototype.symbols[shape]=symbols[shape]})}var units=[].concat(defaultDataGroupingUnits),defaultSeriesType,numExt=function(extreme){var numbers=grep(arguments,function(n){return typeof n==="number"});if(numbers.length){return Math[extreme].apply(0,numbers)}};units[4]=["day",[1,2,3,4]];units[5]=["week",[1,2,3]];defaultSeriesType=seriesTypes.areaspline===UNDEFINED?"line":"areaspline";extend(defaultOptions,{navigator:{handles:{backgroundColor:"#ebe7e8",borderColor:"#b2b1b6"},height:40,margin:25,maskFill:"rgba(128,179,236,0.3)",maskInside:true,outlineColor:"#b2b1b6",outlineWidth:1,series:{type:defaultSeriesType,color:"#4572A7",compare:null,fillOpacity:.05,dataGrouping:{approximation:"average",enabled:true,groupPixelWidth:2,smoothed:true,units:units},dataLabels:{enabled:false,zIndex:2},id:PREFIX+"navigator-series",lineColor:"#4572A7",lineWidth:1,marker:{enabled:false},pointRange:0,shadow:false,threshold:null},xAxis:{tickWidth:0,lineWidth:0,gridLineColor:"#EEE",gridLineWidth:1,tickPixelInterval:200,labels:{align:"left",style:{color:"#888"},x:3,y:-4},crosshair:false},yAxis:{gridLineWidth:0,startOnTick:false,endOnTick:false,minPadding:.1,maxPadding:.1,labels:{enabled:false},crosshair:false,title:{text:null},tickWidth:0}},scrollbar:{height:isTouchDevice?20:14,barBackgroundColor:"#bfc8d1",barBorderRadius:0,barBorderWidth:1,barBorderColor:"#bfc8d1",buttonArrowColor:"#666",buttonBackgroundColor:"#ebe7e8",buttonBorderColor:"#bbb",buttonBorderRadius:0,buttonBorderWidth:1,minWidth:6,rifleColor:"#666",trackBackgroundColor:"#eeeeee",trackBorderColor:"#eeeeee",trackBorderWidth:1,liveRedraw:hasSVG&&!isTouchDevice}});function Scroller(chart){var chartOptions=chart.options,navigatorOptions=chartOptions.navigator,navigatorEnabled=navigatorOptions.enabled,scrollbarOptions=chartOptions.scrollbar,scrollbarEnabled=scrollbarOptions.enabled,height=navigatorEnabled?navigatorOptions.height:0,scrollbarHeight=scrollbarEnabled?scrollbarOptions.height:0;this.handles=[];this.scrollbarButtons=[];this.elementsToDestroy=[];this.chart=chart;this.setBaseSeries();this.height=height;this.scrollbarHeight=scrollbarHeight;this.scrollbarEnabled=scrollbarEnabled;this.navigatorEnabled=navigatorEnabled;this.navigatorOptions=navigatorOptions;this.scrollbarOptions=scrollbarOptions;this.outlineHeight=height+scrollbarHeight;this.init()}Scroller.prototype={drawHandle:function(x,index){var scroller=this,chart=scroller.chart,renderer=chart.renderer,elementsToDestroy=scroller.elementsToDestroy,handles=scroller.handles,handlesOptions=scroller.navigatorOptions.handles,attr={fill:handlesOptions.backgroundColor,stroke:handlesOptions.borderColor,"stroke-width":1},tempElem;if(!scroller.rendered){handles[index]=renderer.g("navigator-handle-"+["left","right"][index]).css({cursor:"ew-resize"}).attr({zIndex:4-index}).add();tempElem=renderer.rect(-4.5,0,9,16,0,1).attr(attr).add(handles[index]);elementsToDestroy.push(tempElem);tempElem=renderer.path(["M",-1.5,4,"L",-1.5,12,"M",.5,4,"L",.5,12]).attr(attr).add(handles[index]);elementsToDestroy.push(tempElem)}handles[index][chart.isResizing?"animate":"attr"]({translateX:scroller.scrollerLeft+scroller.scrollbarHeight+parseInt(x,10),translateY:scroller.top+scroller.height/2-8})},drawScrollbarButton:function(index){var scroller=this,chart=scroller.chart,renderer=chart.renderer,elementsToDestroy=scroller.elementsToDestroy,scrollbarButtons=scroller.scrollbarButtons,scrollbarHeight=scroller.scrollbarHeight,scrollbarOptions=scroller.scrollbarOptions,tempElem;if(!scroller.rendered){scrollbarButtons[index]=renderer.g().add(scroller.scrollbarGroup);tempElem=renderer.rect(-.5,-.5,scrollbarHeight+1,scrollbarHeight+1,scrollbarOptions.buttonBorderRadius,scrollbarOptions.buttonBorderWidth).attr({stroke:scrollbarOptions.buttonBorderColor,"stroke-width":scrollbarOptions.buttonBorderWidth,fill:scrollbarOptions.buttonBackgroundColor}).add(scrollbarButtons[index]);elementsToDestroy.push(tempElem);tempElem=renderer.path(["M",scrollbarHeight/2+(index?-1:1),scrollbarHeight/2-3,"L",scrollbarHeight/2+(index?-1:1),scrollbarHeight/2+3,scrollbarHeight/2+(index?2:-2),scrollbarHeight/2]).attr({fill:scrollbarOptions.buttonArrowColor}).add(scrollbarButtons[index]);elementsToDestroy.push(tempElem)}if(index){scrollbarButtons[index].attr({translateX:scroller.scrollerWidth-scrollbarHeight})}},render:function(min,max,pxMin,pxMax){var scroller=this,chart=scroller.chart,renderer=chart.renderer,navigatorLeft,navigatorWidth,scrollerLeft,scrollerWidth,scrollbarGroup=scroller.scrollbarGroup,navigatorGroup=scroller.navigatorGroup,scrollbar=scroller.scrollbar,xAxis=scroller.xAxis,scrollbarTrack=scroller.scrollbarTrack,scrollbarHeight=scroller.scrollbarHeight,scrollbarEnabled=scroller.scrollbarEnabled,navigatorOptions=scroller.navigatorOptions,scrollbarOptions=scroller.scrollbarOptions,scrollbarMinWidth=scrollbarOptions.minWidth,height=scroller.height,top=scroller.top,navigatorEnabled=scroller.navigatorEnabled,outlineWidth=navigatorOptions.outlineWidth,halfOutline=outlineWidth/2,zoomedMin,zoomedMax,range,scrX,scrWidth,scrollbarPad=0,outlineHeight=scroller.outlineHeight,barBorderRadius=scrollbarOptions.barBorderRadius,strokeWidth,scrollbarStrokeWidth=scrollbarOptions.barBorderWidth,centerBarX,outlineTop=top+halfOutline,verb,unionExtremes;if(!defined(min)||isNaN(min)){return}scroller.navigatorLeft=navigatorLeft=pick(xAxis.left,chart.plotLeft+scrollbarHeight);scroller.navigatorWidth=navigatorWidth=pick(xAxis.len,chart.plotWidth-2*scrollbarHeight);scroller.scrollerLeft=scrollerLeft=navigatorLeft-scrollbarHeight;scroller.scrollerWidth=scrollerWidth=scrollerWidth=navigatorWidth+2*scrollbarHeight;if(xAxis.getExtremes){unionExtremes=scroller.getUnionExtremes(true);if(unionExtremes&&(unionExtremes.dataMin!==xAxis.min||unionExtremes.dataMax!==xAxis.max)){xAxis.setExtremes(unionExtremes.dataMin,unionExtremes.dataMax,true,false)}}pxMin=pick(pxMin,xAxis.translate(min));pxMax=pick(pxMax,xAxis.translate(max));if(isNaN(pxMin)||mathAbs(pxMin)===Infinity){pxMin=0;pxMax=scrollerWidth}if(xAxis.translate(pxMax,true)-xAxis.translate(pxMin,true)<chart.xAxis[0].minRange){return}scroller.zoomedMax=mathMin(mathMax(pxMin,pxMax),navigatorWidth);scroller.zoomedMin=mathMax(scroller.fixedWidth?scroller.zoomedMax-scroller.fixedWidth:mathMin(pxMin,pxMax),0);scroller.range=scroller.zoomedMax-scroller.zoomedMin;zoomedMax=mathRound(scroller.zoomedMax);zoomedMin=mathRound(scroller.zoomedMin);range=zoomedMax-zoomedMin;if(!scroller.rendered){if(navigatorEnabled){scroller.navigatorGroup=navigatorGroup=renderer.g("navigator").attr({zIndex:3}).add();scroller.leftShade=renderer.rect().attr({fill:navigatorOptions.maskFill}).add(navigatorGroup);if(navigatorOptions.maskInside){scroller.leftShade.css({cursor:"ew-resize "})}else{scroller.rightShade=renderer.rect().attr({fill:navigatorOptions.maskFill}).add(navigatorGroup)}scroller.outline=renderer.path().attr({"stroke-width":outlineWidth,stroke:navigatorOptions.outlineColor}).add(navigatorGroup)}if(scrollbarEnabled){scroller.scrollbarGroup=scrollbarGroup=renderer.g("scrollbar").add();strokeWidth=scrollbarOptions.trackBorderWidth;scroller.scrollbarTrack=scrollbarTrack=renderer.rect().attr({x:0,y:-strokeWidth%2/2,fill:scrollbarOptions.trackBackgroundColor,stroke:scrollbarOptions.trackBorderColor,"stroke-width":strokeWidth,r:scrollbarOptions.trackBorderRadius||0,height:scrollbarHeight}).add(scrollbarGroup);scroller.scrollbar=scrollbar=renderer.rect().attr({y:-scrollbarStrokeWidth%2/2,height:scrollbarHeight,fill:scrollbarOptions.barBackgroundColor,stroke:scrollbarOptions.barBorderColor,"stroke-width":scrollbarStrokeWidth,r:barBorderRadius}).add(scrollbarGroup);scroller.scrollbarRifles=renderer.path().attr({stroke:scrollbarOptions.rifleColor,"stroke-width":1}).add(scrollbarGroup)}}verb=chart.isResizing?"animate":"attr";if(navigatorEnabled){scroller.leftShade[verb](navigatorOptions.maskInside?{x:navigatorLeft+zoomedMin,y:top,width:zoomedMax-zoomedMin,height:height}:{x:navigatorLeft,y:top,width:zoomedMin,height:height});if(scroller.rightShade){scroller.rightShade[verb]({x:navigatorLeft+zoomedMax,y:top,width:navigatorWidth-zoomedMax,height:height})}scroller.outline[verb]({d:[M,scrollerLeft,outlineTop,L,navigatorLeft+zoomedMin-halfOutline,outlineTop,navigatorLeft+zoomedMin-halfOutline,outlineTop+outlineHeight,L,navigatorLeft+zoomedMax-halfOutline,outlineTop+outlineHeight,L,navigatorLeft+zoomedMax-halfOutline,outlineTop,scrollerLeft+scrollerWidth,outlineTop].concat(navigatorOptions.maskInside?[M,navigatorLeft+zoomedMin+halfOutline,outlineTop,L,navigatorLeft+zoomedMax-halfOutline,outlineTop]:[])});scroller.drawHandle(zoomedMin+halfOutline,0);scroller.drawHandle(zoomedMax+halfOutline,1)}if(scrollbarEnabled&&scrollbarGroup){scroller.drawScrollbarButton(0);scroller.drawScrollbarButton(1);scrollbarGroup[verb]({translateX:scrollerLeft,translateY:mathRound(outlineTop+height)});scrollbarTrack[verb]({width:scrollerWidth});scrX=scrollbarHeight+zoomedMin;scrWidth=range-scrollbarStrokeWidth;if(scrWidth<scrollbarMinWidth){scrollbarPad=(scrollbarMinWidth-scrWidth)/2;scrWidth=scrollbarMinWidth;scrX-=scrollbarPad}scroller.scrollbarPad=scrollbarPad;scrollbar[verb]({x:mathFloor(scrX)+scrollbarStrokeWidth%2/2,width:scrWidth});centerBarX=scrollbarHeight+zoomedMin+range/2-.5;scroller.scrollbarRifles.attr({visibility:range>12?VISIBLE:HIDDEN})[verb]({d:[M,centerBarX-3,scrollbarHeight/4,L,centerBarX-3,2*scrollbarHeight/3,M,centerBarX,scrollbarHeight/4,L,centerBarX,2*scrollbarHeight/3,M,centerBarX+3,scrollbarHeight/4,L,centerBarX+3,2*scrollbarHeight/3]})}scroller.scrollbarPad=scrollbarPad;scroller.rendered=true},addEvents:function(){var container=this.chart.container,mouseDownHandler=this.mouseDownHandler,mouseMoveHandler=this.mouseMoveHandler,mouseUpHandler=this.mouseUpHandler,_events;_events=[[container,"mousedown",mouseDownHandler],[container,"mousemove",mouseMoveHandler],[document,"mouseup",mouseUpHandler]];if(hasTouch){_events.push([container,"touchstart",mouseDownHandler],[container,"touchmove",mouseMoveHandler],[document,"touchend",mouseUpHandler])}each(_events,function(args){addEvent.apply(null,args)});this._events=_events},removeEvents:function(){each(this._events,function(args){removeEvent.apply(null,args)});this._events=UNDEFINED;if(this.navigatorEnabled&&this.baseSeries){removeEvent(this.baseSeries,"updatedData",this.updatedDataHandler)}},init:function(){var scroller=this,chart=scroller.chart,xAxis,yAxis,scrollbarHeight=scroller.scrollbarHeight,navigatorOptions=scroller.navigatorOptions,height=scroller.height,top=scroller.top,dragOffset,hasDragged,baseSeries=scroller.baseSeries;scroller.mouseDownHandler=function(e){e=chart.pointer.normalize(e);var zoomedMin=scroller.zoomedMin,zoomedMax=scroller.zoomedMax,top=scroller.top,scrollbarHeight=scroller.scrollbarHeight,scrollerLeft=scroller.scrollerLeft,scrollerWidth=scroller.scrollerWidth,navigatorLeft=scroller.navigatorLeft,navigatorWidth=scroller.navigatorWidth,scrollbarPad=scroller.scrollbarPad,range=scroller.range,chartX=e.chartX,chartY=e.chartY,baseXAxis=chart.xAxis[0],fixedMax,ext,handleSensitivity=isTouchDevice?10:7,left,isOnNavigator;if(chartY>top&&chartY<top+height+scrollbarHeight){isOnNavigator=!scroller.scrollbarEnabled||chartY<top+height;if(isOnNavigator&&math.abs(chartX-zoomedMin-navigatorLeft)<handleSensitivity){scroller.grabbedLeft=true;scroller.otherHandlePos=zoomedMax;scroller.fixedExtreme=baseXAxis.max;chart.fixedRange=null}else if(isOnNavigator&&math.abs(chartX-zoomedMax-navigatorLeft)<handleSensitivity){scroller.grabbedRight=true;scroller.otherHandlePos=zoomedMin;scroller.fixedExtreme=baseXAxis.min;chart.fixedRange=null}else if(chartX>navigatorLeft+zoomedMin-scrollbarPad&&chartX<navigatorLeft+zoomedMax+scrollbarPad){scroller.grabbedCenter=chartX;scroller.fixedWidth=range;dragOffset=chartX-zoomedMin}else if(chartX>scrollerLeft&&chartX<scrollerLeft+scrollerWidth){if(isOnNavigator){left=chartX-navigatorLeft-range/2}else{if(chartX<navigatorLeft){left=zoomedMin-range*.2}else if(chartX>scrollerLeft+scrollerWidth-scrollbarHeight){left=zoomedMin+range*.2}else{left=chartX<navigatorLeft+zoomedMin?zoomedMin-range:zoomedMax}}if(left<0){left=0}else if(left+range>=navigatorWidth){left=navigatorWidth-range;fixedMax=scroller.getUnionExtremes().dataMax}if(left!==zoomedMin){scroller.fixedWidth=range;ext=xAxis.toFixedRange(left,left+range,null,fixedMax);baseXAxis.setExtremes(ext.min,ext.max,true,false,{trigger:"navigator"})}}}};scroller.mouseMoveHandler=function(e){var scrollbarHeight=scroller.scrollbarHeight,navigatorLeft=scroller.navigatorLeft,navigatorWidth=scroller.navigatorWidth,scrollerLeft=scroller.scrollerLeft,scrollerWidth=scroller.scrollerWidth,range=scroller.range,chartX;if(e.pageX!==0){e=chart.pointer.normalize(e);chartX=e.chartX;if(chartX<navigatorLeft){chartX=navigatorLeft}else if(chartX>scrollerLeft+scrollerWidth-scrollbarHeight){chartX=scrollerLeft+scrollerWidth-scrollbarHeight}if(scroller.grabbedLeft){hasDragged=true;scroller.render(0,0,chartX-navigatorLeft,scroller.otherHandlePos)}else if(scroller.grabbedRight){hasDragged=true;scroller.render(0,0,scroller.otherHandlePos,chartX-navigatorLeft)}else if(scroller.grabbedCenter){hasDragged=true;if(chartX<dragOffset){chartX=dragOffset}else if(chartX>navigatorWidth+dragOffset-range){chartX=navigatorWidth+dragOffset-range}scroller.render(0,0,chartX-dragOffset,chartX-dragOffset+range)}if(hasDragged&&scroller.scrollbarOptions.liveRedraw){setTimeout(function(){scroller.mouseUpHandler(e)},0)}}};scroller.mouseUpHandler=function(e){var ext,fixedMin,fixedMax;if(hasDragged){if(scroller.zoomedMin===scroller.otherHandlePos){fixedMin=scroller.fixedExtreme}else if(scroller.zoomedMax===scroller.otherHandlePos){fixedMax=scroller.fixedExtreme}ext=xAxis.toFixedRange(scroller.zoomedMin,scroller.zoomedMax,fixedMin,fixedMax);chart.xAxis[0].setExtremes(ext.min,ext.max,true,false,{trigger:"navigator",triggerOp:"navigator-drag",DOMEvent:e})}if(e.type!=="mousemove"){scroller.grabbedLeft=scroller.grabbedRight=scroller.grabbedCenter=scroller.fixedWidth=scroller.fixedExtreme=scroller.otherHandlePos=hasDragged=dragOffset=null}};var xAxisIndex=chart.xAxis.length,yAxisIndex=chart.yAxis.length;chart.extraBottomMargin=scroller.outlineHeight+navigatorOptions.margin;if(scroller.navigatorEnabled){scroller.xAxis=xAxis=new Axis(chart,merge({breaks:baseSeries&&baseSeries.xAxis.options.breaks,ordinal:baseSeries&&baseSeries.xAxis.options.ordinal},navigatorOptions.xAxis,{id:"navigator-x-axis",isX:true,type:"datetime",index:xAxisIndex,height:height,offset:0,offsetLeft:scrollbarHeight,offsetRight:-scrollbarHeight,keepOrdinalPadding:true,startOnTick:false,endOnTick:false,minPadding:0,maxPadding:0,zoomEnabled:false}));scroller.yAxis=yAxis=new Axis(chart,merge(navigatorOptions.yAxis,{id:"navigator-y-axis",alignTicks:false,height:height,offset:0,index:yAxisIndex,zoomEnabled:false}));if(baseSeries||navigatorOptions.series.data){scroller.addBaseSeries()}else if(chart.series.length===0){wrap(chart,"redraw",function(proceed,animation){if(chart.series.length>0&&!scroller.series){scroller.setBaseSeries();chart.redraw=proceed}proceed.call(chart,animation)})}}else{scroller.xAxis=xAxis={translate:function(value,reverse){var axis=chart.xAxis[0],ext=axis.getExtremes(),scrollTrackWidth=chart.plotWidth-2*scrollbarHeight,min=numExt("min",axis.options.min,ext.dataMin),valueRange=numExt("max",axis.options.max,ext.dataMax)-min;return reverse?value*valueRange/scrollTrackWidth+min:scrollTrackWidth*(value-min)/valueRange},toFixedRange:Axis.prototype.toFixedRange}}wrap(chart,"getMargins",function(proceed){
var legend=this.legend,legendOptions=legend.options;proceed.apply(this,[].slice.call(arguments,1));scroller.top=top=scroller.navigatorOptions.top||this.chartHeight-scroller.height-scroller.scrollbarHeight-this.spacing[2]-(legendOptions.verticalAlign==="bottom"&&legendOptions.enabled&&!legendOptions.floating?legend.legendHeight+pick(legendOptions.margin,10):0);if(xAxis&&yAxis){xAxis.options.top=yAxis.options.top=top;xAxis.setAxisSize();yAxis.setAxisSize()}});scroller.addEvents()},getUnionExtremes:function(returnFalseOnNoBaseSeries){var baseAxis=this.chart.xAxis[0],navAxis=this.xAxis,navAxisOptions=navAxis.options,baseAxisOptions=baseAxis.options,ret;if(!returnFalseOnNoBaseSeries||baseAxis.dataMin!==null){ret={dataMin:pick(navAxisOptions&&navAxisOptions.min,numExt("min",baseAxisOptions.min,baseAxis.dataMin,navAxis.dataMin)),dataMax:pick(navAxisOptions&&navAxisOptions.max,numExt("max",baseAxisOptions.max,baseAxis.dataMax,navAxis.dataMax))}}return ret},setBaseSeries:function(baseSeriesOption){var chart=this.chart;baseSeriesOption=baseSeriesOption||chart.options.navigator.baseSeries;if(this.series){this.series.remove()}this.baseSeries=chart.series[baseSeriesOption]||typeof baseSeriesOption==="string"&&chart.get(baseSeriesOption)||chart.series[0];if(this.xAxis){this.addBaseSeries()}},addBaseSeries:function(){var baseSeries=this.baseSeries,baseOptions=baseSeries?baseSeries.options:{},baseData=baseOptions.data,mergedNavSeriesOptions,navigatorSeriesOptions=this.navigatorOptions.series,navigatorData;navigatorData=navigatorSeriesOptions.data;this.hasNavigatorData=!!navigatorData;mergedNavSeriesOptions=merge(baseOptions,navigatorSeriesOptions,{enableMouseTracking:false,group:"nav",padXAxis:false,xAxis:"navigator-x-axis",yAxis:"navigator-y-axis",name:"Navigator",showInLegend:false,isInternal:true,visible:true});mergedNavSeriesOptions.data=navigatorData||baseData;this.series=this.chart.initSeries(mergedNavSeriesOptions);if(baseSeries&&this.navigatorOptions.adaptToUpdatedData!==false){addEvent(baseSeries,"updatedData",this.updatedDataHandler);baseSeries.userOptions.events=extend(baseSeries.userOptions.event,{updatedData:this.updatedDataHandler})}},updatedDataHandler:function(){var scroller=this.chart.scroller,baseSeries=scroller.baseSeries,baseXAxis=baseSeries.xAxis,baseExtremes=baseXAxis.getExtremes(),baseMin=baseExtremes.min,baseMax=baseExtremes.max,baseDataMin=baseExtremes.dataMin,baseDataMax=baseExtremes.dataMax,range=baseMax-baseMin,stickToMin,stickToMax,newMax,newMin,doRedraw,navigatorSeries=scroller.series,navXData=navigatorSeries.xData,hasSetExtremes=!!baseXAxis.setExtremes;stickToMax=baseMax>=navXData[navXData.length-1]-(this.closestPointRange||0);stickToMin=baseMin<=baseDataMin;if(!scroller.hasNavigatorData){navigatorSeries.options.pointStart=baseSeries.xData[0];navigatorSeries.setData(baseSeries.options.data,false);doRedraw=true}if(stickToMin){newMin=baseDataMin;newMax=newMin+range}if(stickToMax){newMax=baseDataMax;if(!stickToMin){newMin=mathMax(newMax-range,navigatorSeries.xData[0])}}if(hasSetExtremes&&(stickToMin||stickToMax)){if(!isNaN(newMin)){baseXAxis.setExtremes(newMin,newMax,true,false,{trigger:"updatedData"})}}else{if(doRedraw){this.chart.redraw(false)}scroller.render(mathMax(baseMin,baseDataMin),mathMin(baseMax,baseDataMax))}},destroy:function(){var scroller=this;scroller.removeEvents();each([scroller.xAxis,scroller.yAxis,scroller.leftShade,scroller.rightShade,scroller.outline,scroller.scrollbarTrack,scroller.scrollbarRifles,scroller.scrollbarGroup,scroller.scrollbar],function(prop){if(prop&&prop.destroy){prop.destroy()}});scroller.xAxis=scroller.yAxis=scroller.leftShade=scroller.rightShade=scroller.outline=scroller.scrollbarTrack=scroller.scrollbarRifles=scroller.scrollbarGroup=scroller.scrollbar=null;each([scroller.scrollbarButtons,scroller.handles,scroller.elementsToDestroy],function(coll){destroyObjectProperties(coll)})}};Highcharts.Scroller=Scroller;wrap(Axis.prototype,"zoom",function(proceed,newMin,newMax){var chart=this.chart,chartOptions=chart.options,zoomType=chartOptions.chart.zoomType,previousZoom,navigator=chartOptions.navigator,rangeSelector=chartOptions.rangeSelector,ret;if(this.isXAxis&&(navigator&&navigator.enabled||rangeSelector&&rangeSelector.enabled)){if(zoomType==="x"){chart.resetZoomButton="blocked"}else if(zoomType==="y"){ret=false}else if(zoomType==="xy"){previousZoom=this.previousZoom;if(defined(newMin)){this.previousZoom=[this.min,this.max]}else if(previousZoom){newMin=previousZoom[0];newMax=previousZoom[1];delete this.previousZoom}}}return ret!==UNDEFINED?ret:proceed.call(this,newMin,newMax)});wrap(Chart.prototype,"init",function(proceed,options,callback){addEvent(this,"beforeRender",function(){var options=this.options;if(options.navigator.enabled||options.scrollbar.enabled){this.scroller=new Scroller(this)}});proceed.call(this,options,callback)});wrap(Series.prototype,"addPoint",function(proceed,options,redraw,shift,animation){var turboThreshold=this.options.turboThreshold;if(turboThreshold&&this.xData.length>turboThreshold&&isObject(options)&&!isArray(options)&&this.chart.scroller){error(20,true)}proceed.call(this,options,redraw,shift,animation)});extend(defaultOptions,{rangeSelector:{buttonTheme:{width:28,height:18,fill:"#f7f7f7",padding:2,r:0,"stroke-width":0,style:{color:"#444",cursor:"pointer",fontWeight:"normal"},zIndex:7,states:{hover:{fill:"#e7e7e7"},select:{fill:"#e7f0f9",style:{color:"black",fontWeight:"bold"}}}},inputPosition:{align:"right"},labelStyle:{color:"#666"}}});defaultOptions.lang=merge(defaultOptions.lang,{rangeSelectorZoom:"Zoom",rangeSelectorFrom:"From",rangeSelectorTo:"To"});function RangeSelector(chart){this.init(chart)}RangeSelector.prototype={clickButton:function(i,redraw){var rangeSelector=this,selected=rangeSelector.selected,chart=rangeSelector.chart,buttons=rangeSelector.buttons,rangeOptions=rangeSelector.buttonOptions[i],baseAxis=chart.xAxis[0],unionExtremes=chart.scroller&&chart.scroller.getUnionExtremes()||baseAxis||{},dataMin=unionExtremes.dataMin,dataMax=unionExtremes.dataMax,newMin,newMax=baseAxis&&mathRound(mathMin(baseAxis.max,pick(dataMax,baseAxis.max))),now,date=new Date(newMax),type=rangeOptions.type,count=rangeOptions.count,baseXAxisOptions,range=rangeOptions._range,rangeMin,year,timeName,minSetting,rangeSetting,dataGrouping=rangeOptions.dataGrouping;if(dataMin===null||dataMax===null||i===rangeSelector.selected){return}if(dataGrouping){this.forcedDataGrouping=true;Axis.prototype.setDataGrouping.call(baseAxis||{chart:this.chart},dataGrouping,false)}if(type==="month"||type==="year"){timeName={month:"Month",year:"FullYear"}[type];date["set"+timeName](date["get"+timeName]()-count);newMin=date.getTime();dataMin=pick(dataMin,Number.MIN_VALUE);if(isNaN(newMin)||newMin<dataMin){newMin=dataMin;newMax=mathMin(newMin+range,dataMax)}else{range=newMax-newMin}}else if(range){newMin=mathMax(newMax-range,dataMin);newMax=mathMin(newMin+range,dataMax)}else if(type==="ytd"){if(baseAxis){if(dataMax===UNDEFINED){dataMin=Number.MAX_VALUE;dataMax=Number.MIN_VALUE;each(chart.series,function(series){var xData=series.xData;dataMin=mathMin(xData[0],dataMin);dataMax=mathMax(xData[xData.length-1],dataMax)});redraw=false}now=new Date(dataMax);year=now.getFullYear();newMin=rangeMin=mathMax(dataMin||0,Date.UTC(year,0,1));now=now.getTime();newMax=mathMin(dataMax||now,now)}else{addEvent(chart,"beforeRender",function(){rangeSelector.clickButton(i)});return}}else if(type==="all"&&baseAxis){newMin=dataMin;newMax=dataMax}if(buttons[selected]){buttons[selected].setState(0)}if(buttons[i]){buttons[i].setState(2)}chart.fixedRange=range;if(!baseAxis){baseXAxisOptions=chart.options.xAxis[0];rangeSetting=baseXAxisOptions.range;baseXAxisOptions.range=range;minSetting=baseXAxisOptions.min;baseXAxisOptions.min=rangeMin;rangeSelector.setSelected(i);addEvent(chart,"load",function resetMinAndRange(){baseXAxisOptions.range=rangeSetting;baseXAxisOptions.min=minSetting})}else{baseAxis.setExtremes(newMin,newMax,pick(redraw,1),0,{trigger:"rangeSelectorButton",rangeSelectorButton:rangeOptions});rangeSelector.setSelected(i)}},setSelected:function(selected){this.selected=this.options.selected=selected},defaultButtons:[{type:"month",count:1,text:"1m"},{type:"month",count:3,text:"3m"},{type:"month",count:6,text:"6m"},{type:"ytd",text:"YTD"},{type:"year",count:1,text:"1y"},{type:"all",text:"All"}],init:function(chart){var rangeSelector=this,options=chart.options.rangeSelector,buttonOptions=options.buttons||[].concat(rangeSelector.defaultButtons),selectedOption=options.selected,blurInputs=rangeSelector.blurInputs=function(){var minInput=rangeSelector.minInput,maxInput=rangeSelector.maxInput;if(minInput&&minInput.blur){fireEvent(minInput,"blur")}if(maxInput&&maxInput.blur){fireEvent(maxInput,"blur")}};rangeSelector.chart=chart;rangeSelector.options=options;rangeSelector.buttons=[];chart.extraTopMargin=35;rangeSelector.buttonOptions=buttonOptions;addEvent(chart.container,"mousedown",blurInputs);addEvent(chart,"resize",blurInputs);each(buttonOptions,rangeSelector.computeButtonRange);if(selectedOption!==UNDEFINED&&buttonOptions[selectedOption]){this.clickButton(selectedOption,false)}addEvent(chart,"load",function(){addEvent(chart.xAxis[0],"setExtremes",function(e){if(this.max-this.min!==chart.fixedRange&&e.trigger!=="rangeSelectorButton"&&e.trigger!=="updatedData"&&rangeSelector.forcedDataGrouping){this.setDataGrouping(false,false)}});addEvent(chart.xAxis[0],"afterSetExtremes",function(){rangeSelector.updateButtonStates(true)})})},updateButtonStates:function(updating){var rangeSelector=this,chart=this.chart,baseAxis=chart.xAxis[0],unionExtremes=chart.scroller&&chart.scroller.getUnionExtremes()||baseAxis,dataMin=unionExtremes.dataMin,dataMax=unionExtremes.dataMax,selected=rangeSelector.selected,allButtonsEnabled=rangeSelector.options.allButtonsEnabled,buttons=rangeSelector.buttons;if(updating&&chart.fixedRange!==mathRound(baseAxis.max-baseAxis.min)){if(buttons[selected]){buttons[selected].setState(0)}rangeSelector.setSelected(null)}each(rangeSelector.buttonOptions,function(rangeOptions,i){var range=rangeOptions._range,isTooGreatRange=range>dataMax-dataMin,isTooSmallRange=range<baseAxis.minRange,isAllButAlreadyShowingAll=rangeOptions.type==="all"&&baseAxis.max-baseAxis.min>=dataMax-dataMin&&buttons[i].state!==2,isYTDButNotAvailable=rangeOptions.type==="ytd"&&dateFormat("%Y",dataMin)===dateFormat("%Y",dataMax);if(range===mathRound(baseAxis.max-baseAxis.min)&&i!==selected){rangeSelector.setSelected(i);buttons[i].setState(2)}else if(!allButtonsEnabled&&(isTooGreatRange||isTooSmallRange||isAllButAlreadyShowingAll||isYTDButNotAvailable)){buttons[i].setState(3)}else if(buttons[i].state===3){buttons[i].setState(0)}})},computeButtonRange:function(rangeOptions){var type=rangeOptions.type,count=rangeOptions.count||1,fixedTimes={millisecond:1,second:1e3,minute:60*1e3,hour:3600*1e3,day:24*3600*1e3,week:7*24*3600*1e3};if(fixedTimes[type]){rangeOptions._range=fixedTimes[type]*count}else if(type==="month"||type==="year"){rangeOptions._range={month:30,year:365}[type]*24*36e5*count}},setInputValue:function(name,time){var options=this.chart.options.rangeSelector;if(defined(time)){this[name+"Input"].HCTime=time}this[name+"Input"].value=dateFormat(options.inputEditDateFormat||"%Y-%m-%d",this[name+"Input"].HCTime);this[name+"DateBox"].attr({text:dateFormat(options.inputDateFormat||"%b %e, %Y",this[name+"Input"].HCTime)})},showInput:function(name){var inputGroup=this.inputGroup,dateBox=this[name+"DateBox"];css(this[name+"Input"],{left:inputGroup.translateX+dateBox.x+PX,top:inputGroup.translateY+PX,width:dateBox.width-2+PX,height:dateBox.height-2+PX,border:"2px solid silver"})},hideInput:function(name){if(document.activeElement===this[name+"Input"]){css(this[name+"Input"],{border:0,width:"1px",height:"1px"});this.setInputValue(name)}},drawInput:function(name){var rangeSelector=this,chart=rangeSelector.chart,chartStyle=chart.renderer.style,renderer=chart.renderer,options=chart.options.rangeSelector,lang=defaultOptions.lang,div=rangeSelector.div,isMin=name==="min",input,label,dateBox,inputGroup=this.inputGroup;this[name+"Label"]=label=renderer.label(lang[isMin?"rangeSelectorFrom":"rangeSelectorTo"],this.inputGroup.offset).attr({padding:2}).css(merge(chartStyle,options.labelStyle)).add(inputGroup);inputGroup.offset+=label.width+5;this[name+"DateBox"]=dateBox=renderer.label("",inputGroup.offset).attr({padding:2,width:options.inputBoxWidth||90,height:options.inputBoxHeight||17,stroke:options.inputBoxBorderColor||"silver","stroke-width":1}).css(merge({textAlign:"center",color:"#444"},chartStyle,options.inputStyle)).on("click",function(){rangeSelector.showInput(name);rangeSelector[name+"Input"].focus()}).add(inputGroup);inputGroup.offset+=dateBox.width+(isMin?10:0);this[name+"Input"]=input=createElement("input",{name:name,className:PREFIX+"range-selector",type:"text"},extend({position:ABSOLUTE,border:0,width:"1px",height:"1px",padding:0,textAlign:"center",fontSize:chartStyle.fontSize,fontFamily:chartStyle.fontFamily,top:chart.plotTop+PX},options.inputStyle),div);input.onfocus=function(){rangeSelector.showInput(name)};input.onblur=function(){rangeSelector.hideInput(name)};input.onchange=function(){var inputValue=input.value,value=(options.inputDateParser||Date.parse)(inputValue),xAxis=chart.xAxis[0],dataMin=xAxis.dataMin,dataMax=xAxis.dataMax;if(isNaN(value)){value=inputValue.split("-");value=Date.UTC(pInt(value[0]),pInt(value[1])-1,pInt(value[2]))}if(!isNaN(value)){if(!defaultOptions.global.useUTC){value=value+(new Date).getTimezoneOffset()*60*1e3}if(isMin){if(value>rangeSelector.maxInput.HCTime){value=UNDEFINED}else if(value<dataMin){value=dataMin}}else{if(value<rangeSelector.minInput.HCTime){value=UNDEFINED}else if(value>dataMax){value=dataMax}}if(value!==UNDEFINED){chart.xAxis[0].setExtremes(isMin?value:xAxis.min,isMin?xAxis.max:value,UNDEFINED,UNDEFINED,{trigger:"rangeSelectorInput"})}}}},getPosition:function(){var chart=this.chart,options=chart.options.rangeSelector,buttonTop=pick((options.buttonPosition||{}).y,chart.plotTop-chart.axisOffset[0]-35);return{buttonTop:buttonTop,inputTop:buttonTop-10}},render:function(min,max){var rangeSelector=this,chart=rangeSelector.chart,renderer=chart.renderer,container=chart.container,chartOptions=chart.options,navButtonOptions=chartOptions.exporting&&chartOptions.navigation&&chartOptions.navigation.buttonOptions,options=chartOptions.rangeSelector,buttons=rangeSelector.buttons,lang=defaultOptions.lang,div=rangeSelector.div,inputGroup=rangeSelector.inputGroup,buttonTheme=options.buttonTheme,buttonPosition=options.buttonPosition||{},inputEnabled=options.inputEnabled,states=buttonTheme&&buttonTheme.states,plotLeft=chart.plotLeft,buttonLeft,pos=this.getPosition(),buttonGroup=rangeSelector.group,buttonBBox;if(!rangeSelector.rendered){rangeSelector.group=buttonGroup=renderer.g("range-selector-buttons").add();rangeSelector.zoomText=renderer.text(lang.rangeSelectorZoom,pick(buttonPosition.x,plotLeft),pos.buttonTop+15).css(options.labelStyle).add(buttonGroup);buttonLeft=pick(buttonPosition.x,plotLeft)+rangeSelector.zoomText.getBBox().width+5;each(rangeSelector.buttonOptions,function(rangeOptions,i){buttons[i]=renderer.button(rangeOptions.text,buttonLeft,pos.buttonTop,function(){rangeSelector.clickButton(i);rangeSelector.isActive=true},buttonTheme,states&&states.hover,states&&states.select,states&&states.disabled).css({textAlign:"center"}).add(buttonGroup);buttonLeft+=buttons[i].width+pick(options.buttonSpacing,5);if(rangeSelector.selected===i){buttons[i].setState(2)}});rangeSelector.updateButtonStates();if(inputEnabled!==false){rangeSelector.div=div=createElement("div",null,{position:"relative",height:0,zIndex:1});container.parentNode.insertBefore(div,container);rangeSelector.inputGroup=inputGroup=renderer.g("input-group").add();inputGroup.offset=0;rangeSelector.drawInput("min");rangeSelector.drawInput("max")}}if(inputEnabled!==false){inputGroup.align(extend({y:pos.inputTop,width:inputGroup.offset,x:navButtonOptions&&pos.inputTop<(navButtonOptions.y||0)+navButtonOptions.height-chart.spacing[0]?-40:0},options.inputPosition),true,chart.spacingBox);if(!defined(inputEnabled)){buttonBBox=buttonGroup.getBBox();inputGroup[inputGroup.translateX<buttonBBox.x+buttonBBox.width+10?"hide":"show"]()}rangeSelector.setInputValue("min",min);rangeSelector.setInputValue("max",max)}rangeSelector.rendered=true},destroy:function(){var minInput=this.minInput,maxInput=this.maxInput,chart=this.chart,blurInputs=this.blurInputs,key;removeEvent(chart.container,"mousedown",blurInputs);removeEvent(chart,"resize",blurInputs);destroyObjectProperties(this.buttons);if(minInput){minInput.onfocus=minInput.onblur=minInput.onchange=null}if(maxInput){maxInput.onfocus=maxInput.onblur=maxInput.onchange=null}for(key in this){if(this[key]&&key!=="chart"){if(this[key].destroy){this[key].destroy()}else if(this[key].nodeType){discardElement(this[key])}}this[key]=null}}};Axis.prototype.toFixedRange=function(pxMin,pxMax,fixedMin,fixedMax){var fixedRange=this.chart&&this.chart.fixedRange,newMin=pick(fixedMin,this.translate(pxMin,true)),newMax=pick(fixedMax,this.translate(pxMax,true)),changeRatio=fixedRange&&(newMax-newMin)/fixedRange;if(changeRatio>.7&&changeRatio<1.3){if(fixedMax){newMin=newMax-fixedRange}else{newMax=newMin+fixedRange}}return{min:newMin,max:newMax}};wrap(Chart.prototype,"init",function(proceed,options,callback){addEvent(this,"init",function(){if(this.options.rangeSelector.enabled){this.rangeSelector=new RangeSelector(this)}});proceed.call(this,options,callback)});Highcharts.RangeSelector=RangeSelector;Chart.prototype.callbacks.push(function(chart){var extremes,scroller=chart.scroller,rangeSelector=chart.rangeSelector;function renderScroller(){extremes=chart.xAxis[0].getExtremes();scroller.render(extremes.min,extremes.max)}function renderRangeSelector(){extremes=chart.xAxis[0].getExtremes();if(!isNaN(extremes.min)){rangeSelector.render(extremes.min,extremes.max)}}function afterSetExtremesHandlerScroller(e){if(e.triggerOp!=="navigator-drag"){scroller.render(e.min,e.max)}}function afterSetExtremesHandlerRangeSelector(e){rangeSelector.render(e.min,e.max)}function destroyEvents(){if(scroller){removeEvent(chart.xAxis[0],"afterSetExtremes",afterSetExtremesHandlerScroller)}if(rangeSelector){removeEvent(chart,"resize",renderRangeSelector);removeEvent(chart.xAxis[0],"afterSetExtremes",afterSetExtremesHandlerRangeSelector)}}if(scroller){addEvent(chart.xAxis[0],"afterSetExtremes",afterSetExtremesHandlerScroller);wrap(chart,"drawChartBox",function(proceed){var isDirtyBox=this.isDirtyBox;proceed.call(this);if(isDirtyBox){renderScroller()}});renderScroller()}if(rangeSelector){addEvent(chart.xAxis[0],"afterSetExtremes",afterSetExtremesHandlerRangeSelector);addEvent(chart,"resize",renderRangeSelector);renderRangeSelector()}addEvent(chart,"destroy",destroyEvents)});Highcharts.StockChart=function(options,callback){var seriesOptions=options.series,opposite,navigatorEnabled=pick(options.navigator&&options.navigator.enabled,true),disableStartOnTick=navigatorEnabled?{startOnTick:false,endOnTick:false}:null,lineOptions={marker:{enabled:false,radius:2}},columnOptions={shadow:false,borderWidth:0};options.xAxis=map(splat(options.xAxis||{}),function(xAxisOptions){return merge({minPadding:0,maxPadding:0,ordinal:true,title:{text:null},labels:{overflow:"justify"},showLastLabel:true},xAxisOptions,{type:"datetime",categories:null},disableStartOnTick)});options.yAxis=map(splat(options.yAxis||{}),function(yAxisOptions){opposite=pick(yAxisOptions.opposite,true);return merge({labels:{y:-2},opposite:opposite,showLastLabel:false,title:{text:null}},yAxisOptions)});options.series=null;options=merge({chart:{panning:true,pinchType:"x"},navigator:{enabled:true},scrollbar:{enabled:true},rangeSelector:{enabled:true},title:{text:null,style:{fontSize:"16px"}},tooltip:{shared:true,crosshairs:true},legend:{enabled:false},plotOptions:{line:lineOptions,spline:lineOptions,area:lineOptions,areaspline:lineOptions,arearange:lineOptions,areasplinerange:lineOptions,column:columnOptions,columnrange:columnOptions,candlestick:columnOptions,ohlc:columnOptions}},options,{_stock:true,chart:{inverted:false}});options.series=seriesOptions;return new Chart(options,callback)};wrap(Pointer.prototype,"init",function(proceed,chart,options){var pinchType=options.chart.pinchType||"";proceed.call(this,chart,options);this.pinchX=this.pinchHor=pinchType.indexOf("x")!==-1;this.pinchY=this.pinchVert=pinchType.indexOf("y")!==-1;this.hasZoom=this.hasZoom||this.pinchHor||this.pinchVert});wrap(Axis.prototype,"autoLabelAlign",function(proceed){var chart=this.chart,options=this.options,panes=chart._labelPanes=chart._labelPanes||{},key,labelOptions=this.options.labels;if(this.chart.options._stock&&this.coll==="yAxis"){key=options.top+","+options.height;if(!panes[key]&&labelOptions.enabled){if(labelOptions.x===15){labelOptions.x=0}if(labelOptions.align===undefined){labelOptions.align="right"}panes[key]=1;return"right"}}return proceed.call(this,[].slice.call(arguments,1))});wrap(Axis.prototype,"getPlotLinePath",function(proceed,value,lineWidth,old,force,translatedValue){var axis=this,series=this.isLinked&&!this.series?this.linkedParent.series:this.series,chart=axis.chart,renderer=chart.renderer,axisLeft=axis.left,axisTop=axis.top,x1,y1,x2,y2,result=[],axes=[],axes2,uniqueAxes;if(axis.coll==="colorAxis"){return proceed.apply(this,[].slice.call(arguments,1))}axes=axis.isXAxis?defined(axis.options.yAxis)?[chart.yAxis[axis.options.yAxis]]:map(series,function(S){return S.yAxis}):defined(axis.options.xAxis)?[chart.xAxis[axis.options.xAxis]]:map(series,function(S){return S.xAxis});axes2=axis.isXAxis?chart.yAxis:chart.xAxis;each(axes2,function(A){if(defined(A.options.id)?A.options.id.indexOf("navigator")===-1:true){var a=A.isXAxis?"yAxis":"xAxis",rax=defined(A.options[a])?chart[a][A.options[a]]:chart[a][0];if(axis===rax){axes.push(A)}}});uniqueAxes=axes.length?[]:[axis.isXAxis?chart.yAxis[0]:chart.xAxis[0]];each(axes,function(axis2){if(inArray(axis2,uniqueAxes)===-1){uniqueAxes.push(axis2)}});translatedValue=pick(translatedValue,axis.translate(value,null,null,old));if(!isNaN(translatedValue)){if(axis.horiz){each(uniqueAxes,function(axis2){var skip;y1=axis2.pos;y2=y1+axis2.len;x1=x2=mathRound(translatedValue+axis.transB);if(x1<axisLeft||x1>axisLeft+axis.width){if(force){x1=x2=mathMin(mathMax(axisLeft,x1),axisLeft+axis.width)}else{skip=true}}if(!skip){result.push("M",x1,y1,"L",x2,y2)}})}else{each(uniqueAxes,function(axis2){var skip;x1=axis2.pos;x2=x1+axis2.len;y1=y2=mathRound(axisTop+axis.height-translatedValue);if(y1<axisTop||y1>axisTop+axis.height){if(force){y1=y2=mathMin(mathMax(axisTop,y1),axis.top+axis.height)}else{skip=true}}if(!skip){result.push("M",x1,y1,"L",x2,y2)}})}}if(result.length>0){return renderer.crispPolyLine(result,lineWidth||1)}else{return null}});Axis.prototype.getPlotBandPath=function(from,to){var toPath=this.getPlotLinePath(to,null,null,true),path=this.getPlotLinePath(from,null,null,true),result=[],i;if(path&&toPath&&path.toString()!==toPath.toString()){for(i=0;i<path.length;i+=6){result.push("M",path[i+1],path[i+2],"L",path[i+4],path[i+5],toPath[i+4],toPath[i+5],toPath[i+1],toPath[i+2])}}else{result=null}return result};SVGRenderer.prototype.crispPolyLine=function(points,width){var i;for(i=0;i<points.length;i=i+6){if(points[i+1]===points[i+4]){points[i+1]=points[i+4]=mathRound(points[i+1])-width%2/2}if(points[i+2]===points[i+5]){points[i+2]=points[i+5]=mathRound(points[i+2])+width%2/2}}return points};if(Renderer===Highcharts.VMLRenderer){VMLRenderer.prototype.crispPolyLine=SVGRenderer.prototype.crispPolyLine}wrap(Axis.prototype,"hideCrosshair",function(proceed,i){proceed.call(this,i);if(!defined(this.crossLabelArray)){return}if(defined(i)){if(this.crossLabelArray[i]){this.crossLabelArray[i].hide()}}else{each(this.crossLabelArray,function(crosslabel){crosslabel.hide()})}});wrap(Axis.prototype,"drawCrosshair",function(proceed,e,point){proceed.call(this,e,point);if(!defined(this.crosshair.label)||!this.crosshair.label.enabled||!defined(point)){return}var chart=this.chart,options=this.options.crosshair.label,axis=this.isXAxis?"x":"y",horiz=this.horiz,opposite=this.opposite,left=this.left,top=this.top,crossLabel=this.crossLabel,posx,posy,crossBox,formatOption=options.format,formatFormat="",limit;if(!crossLabel){crossLabel=this.crossLabel=chart.renderer.label().attr({align:options.align||(horiz?"center":opposite?this.labelAlign==="right"?"right":"left":this.labelAlign==="left"?"left":"center"),zIndex:12,height:horiz?16:UNDEFINED,fill:options.backgroundColor||this.series[0]&&this.series[0].color||"gray",padding:pick(options.padding,2),stroke:options.borderColor||null,"stroke-width":options.borderWidth||0}).css(extend({color:"white",fontWeight:"normal",fontSize:"11px",textAlign:"center"},options.style)).add()}if(horiz){posx=point.plotX+left;posy=top+(opposite?0:this.height)}else{posx=opposite?this.width+left:0;posy=point.plotY+top}if(posy<top||posy>top+this.height){this.hideCrosshair();return}if(!formatOption&&!options.formatter){if(this.isDatetimeAxis){formatFormat="%b %d, %Y"}formatOption="{value"+(formatFormat?":"+formatFormat:"")+"}"}crossLabel.attr({text:formatOption?format(formatOption,{value:point[axis]}):options.formatter.call(this,point[axis]),x:posx,y:posy,visibility:VISIBLE});crossBox=crossLabel.getBBox();if(horiz){if(this.options.tickPosition==="inside"&&!opposite||this.options.tickPosition!=="inside"&&opposite){posy=crossLabel.y-crossBox.height}}else{posy=crossLabel.y-crossBox.height/2}if(horiz){limit={left:left-crossBox.x,right:left+this.width-crossBox.x}}else{limit={left:this.labelAlign==="left"?left:0,right:this.labelAlign==="right"?left+this.width:chart.chartWidth}}if(crossLabel.translateX<limit.left){posx+=limit.left-crossLabel.translateX}if(crossLabel.translateX+crossBox.width>=limit.right){posx-=crossLabel.translateX+crossBox.width-limit.right}crossLabel.attr({x:posx,y:posy,visibility:VISIBLE})});var seriesInit=seriesProto.init,seriesProcessData=seriesProto.processData,pointTooltipFormatter=Point.prototype.tooltipFormatter;seriesProto.init=function(){seriesInit.apply(this,arguments);this.setCompare(this.options.compare)};seriesProto.setCompare=function(compare){this.modifyValue=compare==="value"||compare==="percent"?function(value,point){var compareValue=this.compareValue;if(value!==UNDEFINED){value=compare==="value"?value-compareValue:value=100*(value/compareValue)-100;if(point){point.change=value}}return value}:null;if(this.chart.hasRendered){this.isDirty=true}};seriesProto.processData=function(){var series=this,i=0,processedXData,processedYData,length;seriesProcessData.apply(this,arguments);if(series.xAxis&&series.processedYData){processedXData=series.processedXData;processedYData=series.processedYData;length=processedYData.length;for(;i<length;i++){if(typeof processedYData[i]===NUMBER&&processedXData[i]>=series.xAxis.min){series.compareValue=processedYData[i];break}}}};wrap(seriesProto,"getExtremes",function(proceed){proceed.apply(this,[].slice.call(arguments,1));if(this.modifyValue){this.dataMax=this.modifyValue(this.dataMax);this.dataMin=this.modifyValue(this.dataMin)}});Axis.prototype.setCompare=function(compare,redraw){if(!this.isXAxis){each(this.series,function(series){series.setCompare(compare)});if(pick(redraw,true)){this.chart.redraw()}}};Point.prototype.tooltipFormatter=function(pointFormat){var point=this;pointFormat=pointFormat.replace("{point.change}",(point.change>0?"+":"")+Highcharts.numberFormat(point.change,pick(point.series.tooltipOptions.changeDecimals,2)));return pointTooltipFormatter.apply(this,[pointFormat])};wrap(Series.prototype,"render",function(proceed){if(this.chart.options._stock){if(!this.clipBox&&this.animate){this.clipBox=merge(this.chart.clipBox);this.clipBox.width=this.xAxis.len;this.clipBox.height=this.yAxis.len}else if(this.chart[this.sharedClipKey]){stop(this.chart[this.sharedClipKey]);this.chart[this.sharedClipKey].attr({width:this.xAxis.len,height:this.yAxis.len})}}proceed.call(this)});extend(Highcharts,{Color:Color,Point:Point,Tick:Tick,Renderer:Renderer,SVGElement:SVGElement,SVGRenderer:SVGRenderer,arrayMin:arrayMin,arrayMax:arrayMax,charts:charts,dateFormat:dateFormat,error:error,format:format,pathAnim:pathAnim,getOptions:getOptions,hasBidiBug:hasBidiBug,isTouchDevice:isTouchDevice,setOptions:setOptions,addEvent:addEvent,removeEvent:removeEvent,createElement:createElement,discardElement:discardElement,css:css,each:each,map:map,merge:merge,splat:splat,extendClass:extendClass,pInt:pInt,svg:hasSVG,canvas:useCanVG,vml:!hasSVG&&!useCanVG,product:PRODUCT,version:VERSION});return Highcharts}()},{}],12:[function(require,module,exports){(function(global){var $=require("jquery");require("jstree");global.jqxBaseFramework=window.jQuery=$;$=window.jQuery;module.exports=$}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{jquery:50,jstree:51}],13:[function(require,module,exports){var Backbone=require("./backbone");$=require("./jquery");var util=require("./util.js");Backbone.$=$;Models={};Collections={};var _=require("underscore");var simpleModel=Backbone.Model.extend({urlRoot:function(){var base=this._url||_.result(this.collection,"_url")||_.result(this.collection,"url")||urlError();if(base.indexOf("?")>0){return base.substring(0,base.indexOf("?"))}else{return base}},initialize:function(attrs,options){this._url=(options||{})._url},parse:function(response){return response},toString:function(){var toReturn="";for(var i in this.attributes){if(i!="id"&&i!="createdAt"&&i!="updatedAt"){toReturn+=this.attributes[i]}}return toReturn}});var syncModel=simpleModel.extend({initialize:function(attrs,options){options=options||{};this._url=options._url;delete options["_url"];Backbone.Model.prototype.initialize.apply(this,arguments);this.on("change",function(model,options){if(options&&options.save===false)return;var prevAttr=model._previousAttributes;model.save(model.changed,{patch:true,error:function(model,response){model.set(prevAttr,{save:false});util.handleRequestError(response)},save:false})})},parse:function(response){return response}});var simpleCollection=Backbone.Collection.extend({model:simpleModel,param:{},url:function(){var toReturn=this._url;var param="";console.log(this.param);for(var key in this.param){if(this.param.hasOwnProperty(key)&&this.param[key]!=null){param+=key+"="+this.param[key]+"&"}}if(param){toReturn+="?"+param}return toReturn},initialize:function(models,options){options=options||{};this.name=options.name;this._url=options.url;delete options.name;delete options.url},setGetParameter:function(options){this.param=options}});var syncCollection=simpleCollection.extend({model:syncModel});Models={simpleModel:simpleModel,syncModel:syncModel};Collections={SimpleCollection:simpleCollection,SimpleSyncCollection:syncCollection,SimplePageCollection:Backbone.PageableCollection.extend({model:syncModel,param:{},url:function(){var toReturn=this._url;var param="";for(var key in this.param){if(this.param.hasOwnProperty(key)&&this.param[key]!=null){param+=key+"="+this.param[key]+"&"}}if(param){toReturn+="?"+param}return toReturn},initialize:function(models,options){this.mode="client";this.state={pageSize:20};options=options||{};this.name=options.name;this._url=options.url;delete options.name;delete options.url},setGetParameter:function(options){this.param=options}})};module.exports={Models:Models,Collections:Collections}},{"./backbone":10,"./jquery":12,"./util.js":57,underscore:52}],14:[function(require,module,exports){(function(global){(function(factory){var root=typeof self=="object"&&self.self==self&&self||typeof global=="object"&&global.global==global&&global;if(typeof define==="function"&&define.amd){define(["underscore","jquery","exports"],function(_,$,exports){root.Backbone=factory(root,exports,_,$)})}else if(typeof exports!=="undefined"){var _=require("underscore"),$;
try{$=require("jquery")}catch(e){}factory(root,exports,_,$)}else{root.Backbone=factory(root,{},root._,root.jQuery||root.Zepto||root.ender||root.$)}})(function(root,Backbone,_,$){var previousBackbone=root.Backbone;var slice=[].slice;Backbone.VERSION="1.2.1";Backbone.$=$;Backbone.noConflict=function(){root.Backbone=previousBackbone;return this};Backbone.emulateHTTP=false;Backbone.emulateJSON=false;var addMethod=function(length,method,attribute){switch(length){case 1:return function(){return _[method](this[attribute])};case 2:return function(value){return _[method](this[attribute],value)};case 3:return function(iteratee,context){return _[method](this[attribute],iteratee,context)};case 4:return function(iteratee,defaultVal,context){return _[method](this[attribute],iteratee,defaultVal,context)};default:return function(){var args=slice.call(arguments);args.unshift(this[attribute]);return _[method].apply(_,args)}}};var addUnderscoreMethods=function(Class,methods,attribute){_.each(methods,function(length,method){if(_[method])Class.prototype[method]=addMethod(length,method,attribute)})};var Events=Backbone.Events={};var eventSplitter=/\s+/;var eventsApi=function(iteratee,memo,name,callback,opts){var i=0,names;if(name&&typeof name==="object"){if(callback!==void 0&&"context"in opts&&opts.context===void 0)opts.context=callback;for(names=_.keys(name);i<names.length;i++){memo=iteratee(memo,names[i],name[names[i]],opts)}}else if(name&&eventSplitter.test(name)){for(names=name.split(eventSplitter);i<names.length;i++){memo=iteratee(memo,names[i],callback,opts)}}else{memo=iteratee(memo,name,callback,opts)}return memo};Events.on=function(name,callback,context){return internalOn(this,name,callback,context)};var internalOn=function(obj,name,callback,context,listening){obj._events=eventsApi(onApi,obj._events||{},name,callback,{context:context,ctx:obj,listening:listening});if(listening){var listeners=obj._listeners||(obj._listeners={});listeners[listening.id]=listening}return obj};Events.listenTo=function(obj,name,callback){if(!obj)return this;var id=obj._listenId||(obj._listenId=_.uniqueId("l"));var listeningTo=this._listeningTo||(this._listeningTo={});var listening=listeningTo[id];if(!listening){var thisId=this._listenId||(this._listenId=_.uniqueId("l"));listening=listeningTo[id]={obj:obj,objId:id,id:thisId,listeningTo:listeningTo,count:0}}internalOn(obj,name,callback,this,listening);return this};var onApi=function(events,name,callback,options){if(callback){var handlers=events[name]||(events[name]=[]);var context=options.context,ctx=options.ctx,listening=options.listening;if(listening)listening.count++;handlers.push({callback:callback,context:context,ctx:context||ctx,listening:listening})}return events};Events.off=function(name,callback,context){if(!this._events)return this;this._events=eventsApi(offApi,this._events,name,callback,{context:context,listeners:this._listeners});return this};Events.stopListening=function(obj,name,callback){var listeningTo=this._listeningTo;if(!listeningTo)return this;var ids=obj?[obj._listenId]:_.keys(listeningTo);for(var i=0;i<ids.length;i++){var listening=listeningTo[ids[i]];if(!listening)break;listening.obj.off(name,callback,this)}if(_.isEmpty(listeningTo))this._listeningTo=void 0;return this};var offApi=function(events,name,callback,options){if(!events)return;var i=0,listening;var context=options.context,listeners=options.listeners;if(!name&&!callback&&!context){var ids=_.keys(listeners);for(;i<ids.length;i++){listening=listeners[ids[i]];delete listeners[listening.id];delete listening.listeningTo[listening.objId]}return}var names=name?[name]:_.keys(events);for(;i<names.length;i++){name=names[i];var handlers=events[name];if(!handlers)break;var remaining=[];for(var j=0;j<handlers.length;j++){var handler=handlers[j];if(callback&&callback!==handler.callback&&callback!==handler.callback._callback||context&&context!==handler.context){remaining.push(handler)}else{listening=handler.listening;if(listening&&--listening.count===0){delete listeners[listening.id];delete listening.listeningTo[listening.objId]}}}if(remaining.length){events[name]=remaining}else{delete events[name]}}if(_.size(events))return events};Events.once=function(name,callback,context){var events=eventsApi(onceMap,{},name,callback,_.bind(this.off,this));return this.on(events,void 0,context)};Events.listenToOnce=function(obj,name,callback){var events=eventsApi(onceMap,{},name,callback,_.bind(this.stopListening,this,obj));return this.listenTo(obj,events)};var onceMap=function(map,name,callback,offer){if(callback){var once=map[name]=_.once(function(){offer(name,once);callback.apply(this,arguments)});once._callback=callback}return map};Events.trigger=function(name){if(!this._events)return this;var length=Math.max(0,arguments.length-1);var args=Array(length);for(var i=0;i<length;i++)args[i]=arguments[i+1];eventsApi(triggerApi,this._events,name,void 0,args);return this};var triggerApi=function(objEvents,name,cb,args){if(objEvents){var events=objEvents[name];var allEvents=objEvents.all;if(events&&allEvents)allEvents=allEvents.slice();if(events)triggerEvents(events,args);if(allEvents)triggerEvents(allEvents,[name].concat(args))}return objEvents};var triggerEvents=function(events,args){var ev,i=-1,l=events.length,a1=args[0],a2=args[1],a3=args[2];switch(args.length){case 0:while(++i<l)(ev=events[i]).callback.call(ev.ctx);return;case 1:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1);return;case 2:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1,a2);return;case 3:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1,a2,a3);return;default:while(++i<l)(ev=events[i]).callback.apply(ev.ctx,args);return}};Events.bind=Events.on;Events.unbind=Events.off;_.extend(Backbone,Events);var Model=Backbone.Model=function(attributes,options){var attrs=attributes||{};options||(options={});this.cid=_.uniqueId(this.cidPrefix);this.attributes={};if(options.collection)this.collection=options.collection;if(options.parse)attrs=this.parse(attrs,options)||{};attrs=_.defaults({},attrs,_.result(this,"defaults"));this.set(attrs,options);this.changed={};this.initialize.apply(this,arguments)};_.extend(Model.prototype,Events,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(options){return _.clone(this.attributes)},sync:function(){return Backbone.sync.apply(this,arguments)},get:function(attr){return this.attributes[attr]},escape:function(attr){return _.escape(this.get(attr))},has:function(attr){return this.get(attr)!=null},matches:function(attrs){return!!_.iteratee(attrs,this)(this.attributes)},set:function(key,val,options){if(key==null)return this;var attrs;if(typeof key==="object"){attrs=key;options=val}else{(attrs={})[key]=val}options||(options={});if(!this._validate(attrs,options))return false;var unset=options.unset;var silent=options.silent;var changes=[];var changing=this._changing;this._changing=true;if(!changing){this._previousAttributes=_.clone(this.attributes);this.changed={}}var current=this.attributes;var changed=this.changed;var prev=this._previousAttributes;if(this.idAttribute in attrs)this.id=attrs[this.idAttribute];for(var attr in attrs){val=attrs[attr];if(!_.isEqual(current[attr],val))changes.push(attr);if(!_.isEqual(prev[attr],val)){changed[attr]=val}else{delete changed[attr]}unset?delete current[attr]:current[attr]=val}if(!silent){if(changes.length)this._pending=options;for(var i=0;i<changes.length;i++){this.trigger("change:"+changes[i],this,current[changes[i]],options)}}if(changing)return this;if(!silent){while(this._pending){options=this._pending;this._pending=false;this.trigger("change",this,options)}}this._pending=false;this._changing=false;return this},unset:function(attr,options){return this.set(attr,void 0,_.extend({},options,{unset:true}))},clear:function(options){var attrs={};for(var key in this.attributes)attrs[key]=void 0;return this.set(attrs,_.extend({},options,{unset:true}))},hasChanged:function(attr){if(attr==null)return!_.isEmpty(this.changed);return _.has(this.changed,attr)},changedAttributes:function(diff){if(!diff)return this.hasChanged()?_.clone(this.changed):false;var old=this._changing?this._previousAttributes:this.attributes;var changed={};for(var attr in diff){var val=diff[attr];if(_.isEqual(old[attr],val))continue;changed[attr]=val}return _.size(changed)?changed:false},previous:function(attr){if(attr==null||!this._previousAttributes)return null;return this._previousAttributes[attr]},previousAttributes:function(){return _.clone(this._previousAttributes)},fetch:function(options){options=_.extend({parse:true},options);var model=this;var success=options.success;options.success=function(resp){var serverAttrs=options.parse?model.parse(resp,options):resp;if(!model.set(serverAttrs,options))return false;if(success)success.call(options.context,model,resp,options);model.trigger("sync",model,resp,options)};wrapError(this,options);return this.sync("read",this,options)},save:function(key,val,options){var attrs;if(key==null||typeof key==="object"){attrs=key;options=val}else{(attrs={})[key]=val}options=_.extend({validate:true,parse:true},options);var wait=options.wait;if(attrs&&!wait){if(!this.set(attrs,options))return false}else{if(!this._validate(attrs,options))return false}var model=this;var success=options.success;var attributes=this.attributes;options.success=function(resp){model.attributes=attributes;var serverAttrs=options.parse?model.parse(resp,options):resp;if(wait)serverAttrs=_.extend({},attrs,serverAttrs);if(serverAttrs&&!model.set(serverAttrs,options))return false;if(success)success.call(options.context,model,resp,options);model.trigger("sync",model,resp,options)};wrapError(this,options);if(attrs&&wait)this.attributes=_.extend({},attributes,attrs);var method=this.isNew()?"create":options.patch?"patch":"update";if(method==="patch"&&!options.attrs)options.attrs=attrs;var xhr=this.sync(method,this,options);this.attributes=attributes;return xhr},destroy:function(options){options=options?_.clone(options):{};var model=this;var success=options.success;var wait=options.wait;var destroy=function(){model.stopListening();model.trigger("destroy",model,model.collection,options)};options.success=function(resp){if(wait)destroy();if(success)success.call(options.context,model,resp,options);if(!model.isNew())model.trigger("sync",model,resp,options)};var xhr=false;if(this.isNew()){_.defer(options.success)}else{wrapError(this,options);xhr=this.sync("delete",this,options)}if(!wait)destroy();return xhr},url:function(){var base=_.result(this,"urlRoot")||_.result(this.collection,"url")||urlError();if(this.isNew())return base;var id=this.get(this.idAttribute);return base.replace(/[^\/]$/,"$&/")+encodeURIComponent(id)},parse:function(resp,options){return resp},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(options){return this._validate({},_.defaults({validate:true},options))},_validate:function(attrs,options){if(!options.validate||!this.validate)return true;attrs=_.extend({},this.attributes,attrs);var error=this.validationError=this.validate(attrs,options)||null;if(!error)return true;this.trigger("invalid",this,error,_.extend(options,{validationError:error}));return false}});var modelMethods={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};addUnderscoreMethods(Model,modelMethods,"attributes");var Collection=Backbone.Collection=function(models,options){options||(options={});if(options.model)this.model=options.model;if(options.comparator!==void 0)this.comparator=options.comparator;this._reset();this.initialize.apply(this,arguments);if(models)this.reset(models,_.extend({silent:true},options))};var setOptions={add:true,remove:true,merge:true};var addOptions={add:true,remove:false};_.extend(Collection.prototype,Events,{model:Model,initialize:function(){},toJSON:function(options){return this.map(function(model){return model.toJSON(options)})},sync:function(){return Backbone.sync.apply(this,arguments)},add:function(models,options){return this.set(models,_.extend({merge:false},options,addOptions))},remove:function(models,options){options=_.extend({},options);var singular=!_.isArray(models);models=singular?[models]:_.clone(models);var removed=this._removeModels(models,options);if(!options.silent&&removed)this.trigger("update",this,options);return singular?removed[0]:removed},set:function(models,options){options=_.defaults({},options,setOptions);if(options.parse&&!this._isModel(models))models=this.parse(models,options);var singular=!_.isArray(models);models=singular?models?[models]:[]:models.slice();var id,model,attrs,existing,sort;var at=options.at;if(at!=null)at=+at;if(at<0)at+=this.length+1;var sortable=this.comparator&&at==null&&options.sort!==false;var sortAttr=_.isString(this.comparator)?this.comparator:null;var toAdd=[],toRemove=[],modelMap={};var add=options.add,merge=options.merge,remove=options.remove;var order=!sortable&&add&&remove?[]:false;var orderChanged=false;for(var i=0;i<models.length;i++){attrs=models[i];if(existing=this.get(attrs)){if(remove)modelMap[existing.cid]=true;if(merge&&attrs!==existing){attrs=this._isModel(attrs)?attrs.attributes:attrs;if(options.parse)attrs=existing.parse(attrs,options);existing.set(attrs,options);if(sortable&&!sort&&existing.hasChanged(sortAttr))sort=true}models[i]=existing}else if(add){model=models[i]=this._prepareModel(attrs,options);if(!model)continue;toAdd.push(model);this._addReference(model,options)}model=existing||model;if(!model)continue;id=this.modelId(model.attributes);if(order&&(model.isNew()||!modelMap[id])){order.push(model);orderChanged=orderChanged||!this.models[i]||model.cid!==this.models[i].cid}modelMap[id]=true}if(remove){for(var i=0;i<this.length;i++){if(!modelMap[(model=this.models[i]).cid])toRemove.push(model)}if(toRemove.length)this._removeModels(toRemove,options)}if(toAdd.length||orderChanged){if(sortable)sort=true;this.length+=toAdd.length;if(at!=null){for(var i=0;i<toAdd.length;i++){this.models.splice(at+i,0,toAdd[i])}}else{if(order)this.models.length=0;var orderedModels=order||toAdd;for(var i=0;i<orderedModels.length;i++){this.models.push(orderedModels[i])}}}if(sort)this.sort({silent:true});if(!options.silent){var addOpts=at!=null?_.clone(options):options;for(var i=0;i<toAdd.length;i++){if(at!=null)addOpts.index=at+i;(model=toAdd[i]).trigger("add",model,this,addOpts)}if(sort||orderChanged)this.trigger("sort",this,options);if(toAdd.length||toRemove.length)this.trigger("update",this,options)}return singular?models[0]:models},reset:function(models,options){options=options?_.clone(options):{};for(var i=0;i<this.models.length;i++){this._removeReference(this.models[i],options)}options.previousModels=this.models;this._reset();models=this.add(models,_.extend({silent:true},options));if(!options.silent)this.trigger("reset",this,options);return models},push:function(model,options){return this.add(model,_.extend({at:this.length},options))},pop:function(options){var model=this.at(this.length-1);return this.remove(model,options)},unshift:function(model,options){return this.add(model,_.extend({at:0},options))},shift:function(options){var model=this.at(0);return this.remove(model,options)},slice:function(){return slice.apply(this.models,arguments)},get:function(obj){if(obj==null)return void 0;var id=this.modelId(this._isModel(obj)?obj.attributes:obj);return this._byId[obj]||this._byId[id]||this._byId[obj.cid]},at:function(index){if(index<0)index+=this.length;return this.models[index]},where:function(attrs,first){var matches=_.matches(attrs);return this[first?"find":"filter"](function(model){return matches(model.attributes)})},findWhere:function(attrs){return this.where(attrs,true)},sort:function(options){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");options||(options={});if(_.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(_.bind(this.comparator,this))}if(!options.silent)this.trigger("sort",this,options);return this},pluck:function(attr){return _.invoke(this.models,"get",attr)},fetch:function(options){options=_.extend({parse:true},options);var success=options.success;var collection=this;options.success=function(resp){var method=options.reset?"reset":"set";collection[method](resp,options);if(success)success.call(options.context,collection,resp,options);collection.trigger("sync",collection,resp,options)};wrapError(this,options);return this.sync("read",this,options)},create:function(model,options){options=options?_.clone(options):{};var wait=options.wait;model=this._prepareModel(model,options);if(!model)return false;if(!wait)this.add(model,options);var collection=this;var success=options.success;options.success=function(model,resp,callbackOpts){if(wait)collection.add(model,callbackOpts);if(success)success.call(callbackOpts.context,model,resp,callbackOpts)};model.save(null,options);return model},parse:function(resp,options){return resp},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(attrs){return attrs[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(attrs,options){if(this._isModel(attrs)){if(!attrs.collection)attrs.collection=this;return attrs}options=options?_.clone(options):{};options.collection=this;var model=new this.model(attrs,options);if(!model.validationError)return model;this.trigger("invalid",this,model.validationError,options);return false},_removeModels:function(models,options){var removed=[];for(var i=0;i<models.length;i++){var model=this.get(models[i]);if(!model)continue;var index=this.indexOf(model);this.models.splice(index,1);this.length--;if(!options.silent){options.index=index;model.trigger("remove",model,this,options)}removed.push(model);this._removeReference(model,options)}return removed.length?removed:false},_isModel:function(model){return model instanceof Model},_addReference:function(model,options){this._byId[model.cid]=model;var id=this.modelId(model.attributes);if(id!=null)this._byId[id]=model;model.on("all",this._onModelEvent,this)},_removeReference:function(model,options){delete this._byId[model.cid];var id=this.modelId(model.attributes);if(id!=null)delete this._byId[id];if(this===model.collection)delete model.collection;model.off("all",this._onModelEvent,this)},_onModelEvent:function(event,model,collection,options){if((event==="add"||event==="remove")&&collection!==this)return;if(event==="destroy")this.remove(model,options);if(event==="change"){var prevId=this.modelId(model.previousAttributes());var id=this.modelId(model.attributes);if(prevId!==id){if(prevId!=null)delete this._byId[prevId];if(id!=null)this._byId[id]=model}}this.trigger.apply(this,arguments)}});var collectionMethods={forEach:3,each:3,map:3,collect:3,reduce:4,foldl:4,inject:4,reduceRight:4,foldr:4,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:2,contains:2,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3};addUnderscoreMethods(Collection,collectionMethods,"models");var attributeMethods=["groupBy","countBy","sortBy","indexBy"];_.each(attributeMethods,function(method){if(!_[method])return;Collection.prototype[method]=function(value,context){var iterator=_.isFunction(value)?value:function(model){return model.get(value)};return _[method](this.models,iterator,context)}});var View=Backbone.View=function(options){this.cid=_.uniqueId("view");_.extend(this,_.pick(options,viewOptions));this._ensureElement();this.initialize.apply(this,arguments)};var delegateEventSplitter=/^(\S+)\s*(.*)$/;var viewOptions=["model","collection","el","id","attributes","className","tagName","events"];_.extend(View.prototype,Events,{tagName:"div",$:function(selector){return this.$el.find(selector)},initialize:function(){},render:function(){return this},remove:function(){this._removeElement();this.stopListening();return this},_removeElement:function(){this.$el.remove()},setElement:function(element){this.undelegateEvents();this._setElement(element);this.delegateEvents();return this},_setElement:function(el){this.$el=el instanceof Backbone.$?el:Backbone.$(el);this.el=this.$el[0]},delegateEvents:function(events){events||(events=_.result(this,"events"));if(!events)return this;this.undelegateEvents();for(var key in events){var method=events[key];if(!_.isFunction(method))method=this[method];if(!method)continue;var match=key.match(delegateEventSplitter);this.delegate(match[1],match[2],_.bind(method,this))}return this},delegate:function(eventName,selector,listener){this.$el.on(eventName+".delegateEvents"+this.cid,selector,listener);return this},undelegateEvents:function(){if(this.$el)this.$el.off(".delegateEvents"+this.cid);return this},undelegate:function(eventName,selector,listener){this.$el.off(eventName+".delegateEvents"+this.cid,selector,listener);return this},_createElement:function(tagName){return document.createElement(tagName)},_ensureElement:function(){if(!this.el){var attrs=_.extend({},_.result(this,"attributes"));if(this.id)attrs.id=_.result(this,"id");if(this.className)attrs["class"]=_.result(this,"className");this.setElement(this._createElement(_.result(this,"tagName")));this._setAttributes(attrs)}else{this.setElement(_.result(this,"el"))}},_setAttributes:function(attributes){this.$el.attr(attributes)}});Backbone.sync=function(method,model,options){var type=methodMap[method];_.defaults(options||(options={}),{emulateHTTP:Backbone.emulateHTTP,emulateJSON:Backbone.emulateJSON});var params={type:type,dataType:"json"};if(!options.url){params.url=_.result(model,"url")||urlError()}if(options.data==null&&model&&(method==="create"||method==="update"||method==="patch")){params.contentType="application/json";params.data=JSON.stringify(options.attrs||model.toJSON(options))}if(options.emulateJSON){params.contentType="application/x-www-form-urlencoded";params.data=params.data?{model:params.data}:{}}if(options.emulateHTTP&&(type==="PUT"||type==="DELETE"||type==="PATCH")){params.type="POST";if(options.emulateJSON)params.data._method=type;var beforeSend=options.beforeSend;options.beforeSend=function(xhr){xhr.setRequestHeader("X-HTTP-Method-Override",type);if(beforeSend)return beforeSend.apply(this,arguments)}}if(params.type!=="GET"&&!options.emulateJSON){params.processData=false}var error=options.error;options.error=function(xhr,textStatus,errorThrown){options.textStatus=textStatus;options.errorThrown=errorThrown;if(error)error.call(options.context,xhr,textStatus,errorThrown)};var xhr=options.xhr=Backbone.ajax(_.extend(params,options));model.trigger("request",model,xhr,options);return xhr};var methodMap={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};Backbone.ajax=function(){return Backbone.$.ajax.apply(Backbone.$,arguments)};var Router=Backbone.Router=function(options){options||(options={});if(options.routes)this.routes=options.routes;this._bindRoutes();this.initialize.apply(this,arguments)};var optionalParam=/\((.*?)\)/g;var namedParam=/(\(\?)?:\w+/g;var splatParam=/\*\w+/g;var escapeRegExp=/[\-{}\[\]+?.,\\\^$|#\s]/g;_.extend(Router.prototype,Events,{initialize:function(){},route:function(route,name,callback){if(!_.isRegExp(route))route=this._routeToRegExp(route);if(_.isFunction(name)){callback=name;name=""}if(!callback)callback=this[name];var router=this;Backbone.history.route(route,function(fragment){var args=router._extractParameters(route,fragment);if(router.execute(callback,args,name)!==false){router.trigger.apply(router,["route:"+name].concat(args));router.trigger("route",name,args);Backbone.history.trigger("route",router,name,args)}});return this},execute:function(callback,args,name){if(callback)callback.apply(this,args)},navigate:function(fragment,options){Backbone.history.navigate(fragment,options);return this},_bindRoutes:function(){if(!this.routes)return;this.routes=_.result(this,"routes");var route,routes=_.keys(this.routes);while((route=routes.pop())!=null){this.route(route,this.routes[route])}},_routeToRegExp:function(route){route=route.replace(escapeRegExp,"\\$&").replace(optionalParam,"(?:$1)?").replace(namedParam,function(match,optional){return optional?match:"([^/?]+)"}).replace(splatParam,"([^?]*?)");return new RegExp("^"+route+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(route,fragment){var params=route.exec(fragment).slice(1);return _.map(params,function(param,i){if(i===params.length-1)return param||null;return param?decodeURIComponent(param):null})}});var History=Backbone.History=function(){this.handlers=[];_.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history}};var routeStripper=/^[#\/]|\s+$/g;var rootStripper=/^\/+|\/+$/g;var pathStripper=/#.*$/;History.started=false;_.extend(History.prototype,Events,{interval:50,atRoot:function(){var path=this.location.pathname.replace(/[^\/]$/,"$&/");return path===this.root&&!this.getSearch()},matchRoot:function(){var path=this.decodeFragment(this.location.pathname);var root=path.slice(0,this.root.length-1)+"/";return root===this.root},decodeFragment:function(fragment){return decodeURI(fragment.replace(/%25/g,"%2525"))},getSearch:function(){var match=this.location.href.replace(/#.*/,"").match(/\?.+/);return match?match[0]:""},getHash:function(window){var match=(window||this).location.href.match(/#(.*)$/);return match?match[1]:""},getPath:function(){var path=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return path.charAt(0)==="/"?path.slice(1):path},getFragment:function(fragment){if(fragment==null){if(this._usePushState||!this._wantsHashChange){fragment=this.getPath()}else{fragment=this.getHash()}}return fragment.replace(routeStripper,"")},start:function(options){if(History.started)throw new Error("Backbone.history has already been started");History.started=true;this.options=_.extend({root:"/"},this.options,options);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._hasHashChange="onhashchange"in window;this._useHashChange=this._wantsHashChange&&this._hasHashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.history&&this.history.pushState);this._usePushState=this._wantsPushState&&this._hasPushState;this.fragment=this.getFragment();this.root=("/"+this.root+"/").replace(rootStripper,"/");if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var root=this.root.slice(0,-1)||"/";this.location.replace(root+"#"+this.getPath());return true}else if(this._hasPushState&&this.atRoot()){this.navigate(this.getHash(),{replace:true})}}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe");this.iframe.src="javascript:0";this.iframe.style.display="none";this.iframe.tabIndex=-1;var body=document.body;var iWindow=body.insertBefore(this.iframe,body.firstChild).contentWindow;iWindow.document.open();iWindow.document.close();iWindow.location.hash="#"+this.fragment}var addEventListener=window.addEventListener||function(eventName,listener){return attachEvent("on"+eventName,listener)};if(this._usePushState){addEventListener("popstate",this.checkUrl,false)}else if(this._useHashChange&&!this.iframe){addEventListener("hashchange",this.checkUrl,false)}else if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}if(!this.options.silent)return this.loadUrl()},stop:function(){var removeEventListener=window.removeEventListener||function(eventName,listener){return detachEvent("on"+eventName,listener)};if(this._usePushState){removeEventListener("popstate",this.checkUrl,false)}else if(this._useHashChange&&!this.iframe){removeEventListener("hashchange",this.checkUrl,false)}if(this.iframe){document.body.removeChild(this.iframe);this.iframe=null}if(this._checkUrlInterval)clearInterval(this._checkUrlInterval);History.started=false},route:function(route,callback){this.handlers.unshift({route:route,callback:callback})},checkUrl:function(e){var current=this.getFragment();if(current===this.fragment&&this.iframe){current=this.getHash(this.iframe.contentWindow)}if(current===this.fragment)return false;if(this.iframe)this.navigate(current);this.loadUrl()},loadUrl:function(fragment){if(!this.matchRoot())return false;fragment=this.fragment=this.getFragment(fragment);return _.any(this.handlers,function(handler){if(handler.route.test(fragment)){handler.callback(fragment);return true}})},navigate:function(fragment,options){if(!History.started)return false;if(!options||options===true)options={trigger:!!options};fragment=this.getFragment(fragment||"");var root=this.root;if(fragment===""||fragment.charAt(0)==="?"){root=root.slice(0,-1)||"/"}var url=root+fragment;fragment=this.decodeFragment(fragment.replace(pathStripper,""));if(this.fragment===fragment)return;this.fragment=fragment;if(this._usePushState){this.history[options.replace?"replaceState":"pushState"]({},document.title,url)}else if(this._wantsHashChange){this._updateHash(this.location,fragment,options.replace);if(this.iframe&&fragment!==this.getHash(this.iframe.contentWindow)){var iWindow=this.iframe.contentWindow;if(!options.replace){iWindow.document.open();iWindow.document.close()}this._updateHash(iWindow.location,fragment,options.replace)}}else{return this.location.assign(url)}if(options.trigger)return this.loadUrl(fragment)},_updateHash:function(location,fragment,replace){if(replace){var href=location.href.replace(/(javascript:|#).*$/,"");location.replace(href+"#"+fragment)}else{location.hash="#"+fragment}}});Backbone.history=new History;var extend=function(protoProps,staticProps){var parent=this;var child;if(protoProps&&_.has(protoProps,"constructor")){child=protoProps.constructor}else{child=function(){return parent.apply(this,arguments)}}_.extend(child,parent,staticProps);var Surrogate=function(){this.constructor=child};Surrogate.prototype=parent.prototype;child.prototype=new Surrogate;if(protoProps)_.extend(child.prototype,protoProps);child.__super__=parent.prototype;return child};Model.extend=Collection.extend=Router.extend=View.extend=History.extend=extend;var urlError=function(){throw new Error('A "url" property or function must be specified')};var wrapError=function(model,options){var error=options.error;options.error=function(resp){if(error)error.call(options.context,model,resp,options);model.trigger("error",model,resp,options)}};return Backbone})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{jquery:50,underscore:52}],15:[function(require,module,exports){(function(process,global){!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.Promise=e()}}(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof _dereq_=="function"&&_dereq_;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof _dereq_=="function"&&_dereq_;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise){var SomePromiseArray=Promise._SomePromiseArray;function any(promises){var ret=new SomePromiseArray(promises);var promise=ret.promise();ret.setHowMany(1);ret.setUnwrap();ret.init();return promise}Promise.any=function(promises){return any(promises)};Promise.prototype.any=function(){return any(this);
}}},{}],2:[function(_dereq_,module,exports){"use strict";var firstLineError;try{throw new Error}catch(e){firstLineError=e}var schedule=_dereq_("./schedule.js");var Queue=_dereq_("./queue.js");var util=_dereq_("./util.js");function Async(){this._isTickUsed=false;this._lateQueue=new Queue(16);this._normalQueue=new Queue(16);this._trampolineEnabled=true;var self=this;this.drainQueues=function(){self._drainQueues()};this._schedule=schedule.isStatic?schedule(this.drainQueues):schedule}Async.prototype.disableTrampolineIfNecessary=function(){if(util.hasDevTools){this._trampolineEnabled=false}};Async.prototype.enableTrampoline=function(){if(!this._trampolineEnabled){this._trampolineEnabled=true;this._schedule=function(fn){setTimeout(fn,0)}}};Async.prototype.haveItemsQueued=function(){return this._normalQueue.length()>0};Async.prototype.throwLater=function(fn,arg){if(arguments.length===1){arg=fn;fn=function(){throw arg}}if(typeof setTimeout!=="undefined"){setTimeout(function(){fn(arg)},0)}else try{this._schedule(function(){fn(arg)})}catch(e){throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")}};function AsyncInvokeLater(fn,receiver,arg){this._lateQueue.push(fn,receiver,arg);this._queueTick()}function AsyncInvoke(fn,receiver,arg){this._normalQueue.push(fn,receiver,arg);this._queueTick()}function AsyncSettlePromises(promise){this._normalQueue._pushOne(promise);this._queueTick()}if(!util.hasDevTools){Async.prototype.invokeLater=AsyncInvokeLater;Async.prototype.invoke=AsyncInvoke;Async.prototype.settlePromises=AsyncSettlePromises}else{if(schedule.isStatic){schedule=function(fn){setTimeout(fn,0)}}Async.prototype.invokeLater=function(fn,receiver,arg){if(this._trampolineEnabled){AsyncInvokeLater.call(this,fn,receiver,arg)}else{this._schedule(function(){setTimeout(function(){fn.call(receiver,arg)},100)})}};Async.prototype.invoke=function(fn,receiver,arg){if(this._trampolineEnabled){AsyncInvoke.call(this,fn,receiver,arg)}else{this._schedule(function(){fn.call(receiver,arg)})}};Async.prototype.settlePromises=function(promise){if(this._trampolineEnabled){AsyncSettlePromises.call(this,promise)}else{this._schedule(function(){promise._settlePromises()})}}}Async.prototype.invokeFirst=function(fn,receiver,arg){this._normalQueue.unshift(fn,receiver,arg);this._queueTick()};Async.prototype._drainQueue=function(queue){while(queue.length()>0){var fn=queue.shift();if(typeof fn!=="function"){fn._settlePromises();continue}var receiver=queue.shift();var arg=queue.shift();fn.call(receiver,arg)}};Async.prototype._drainQueues=function(){this._drainQueue(this._normalQueue);this._reset();this._drainQueue(this._lateQueue)};Async.prototype._queueTick=function(){if(!this._isTickUsed){this._isTickUsed=true;this._schedule(this.drainQueues)}};Async.prototype._reset=function(){this._isTickUsed=false};module.exports=new Async;module.exports.firstLineError=firstLineError},{"./queue.js":28,"./schedule.js":31,"./util.js":38}],3:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL,tryConvertToPromise){var rejectThis=function(_,e){this._reject(e)};var targetRejected=function(e,context){context.promiseRejectionQueued=true;context.bindingPromise._then(rejectThis,rejectThis,null,this,e)};var bindingResolved=function(thisArg,context){if(this._isPending()){this._resolveCallback(context.target)}};var bindingRejected=function(e,context){if(!context.promiseRejectionQueued)this._reject(e)};Promise.prototype.bind=function(thisArg){var maybePromise=tryConvertToPromise(thisArg);var ret=new Promise(INTERNAL);ret._propagateFrom(this,1);var target=this._target();ret._setBoundTo(maybePromise);if(maybePromise instanceof Promise){var context={promiseRejectionQueued:false,promise:ret,target:target,bindingPromise:maybePromise};target._then(INTERNAL,targetRejected,ret._progress,ret,context);maybePromise._then(bindingResolved,bindingRejected,ret._progress,ret,context)}else{ret._resolveCallback(target)}return ret};Promise.prototype._setBoundTo=function(obj){if(obj!==undefined){this._bitField=this._bitField|131072;this._boundTo=obj}else{this._bitField=this._bitField&~131072}};Promise.prototype._isBound=function(){return(this._bitField&131072)===131072};Promise.bind=function(thisArg,value){var maybePromise=tryConvertToPromise(thisArg);var ret=new Promise(INTERNAL);ret._setBoundTo(maybePromise);if(maybePromise instanceof Promise){maybePromise._then(function(){ret._resolveCallback(value)},ret._reject,ret._progress,ret,null)}else{ret._resolveCallback(value)}return ret}}},{}],4:[function(_dereq_,module,exports){"use strict";var old;if(typeof Promise!=="undefined")old=Promise;function noConflict(){try{if(Promise===bluebird)Promise=old}catch(e){}return bluebird}var bluebird=_dereq_("./promise.js")();bluebird.noConflict=noConflict;module.exports=bluebird},{"./promise.js":23}],5:[function(_dereq_,module,exports){"use strict";var cr=Object.create;if(cr){var callerCache=cr(null);var getterCache=cr(null);callerCache[" size"]=getterCache[" size"]=0}module.exports=function(Promise){var util=_dereq_("./util.js");var canEvaluate=util.canEvaluate;var isIdentifier=util.isIdentifier;var getMethodCaller;var getGetter;if(!true){var makeMethodCaller=function(methodName){return new Function("ensureMethod","                                    \n        return function(obj) {                                               \n            'use strict'                                                     \n            var len = this.length;                                           \n            ensureMethod(obj, 'methodName');                                 \n            switch(len) {                                                    \n                case 1: return obj.methodName(this[0]);                      \n                case 2: return obj.methodName(this[0], this[1]);             \n                case 3: return obj.methodName(this[0], this[1], this[2]);    \n                case 0: return obj.methodName();                             \n                default:                                                     \n                    return obj.methodName.apply(obj, this);                  \n            }                                                                \n        };                                                                   \n        ".replace(/methodName/g,methodName))(ensureMethod)};var makeGetter=function(propertyName){return new Function("obj","                                             \n        'use strict';                                                        \n        return obj.propertyName;                                             \n        ".replace("propertyName",propertyName))};var getCompiled=function(name,compiler,cache){var ret=cache[name];if(typeof ret!=="function"){if(!isIdentifier(name)){return null}ret=compiler(name);cache[name]=ret;cache[" size"]++;if(cache[" size"]>512){var keys=Object.keys(cache);for(var i=0;i<256;++i)delete cache[keys[i]];cache[" size"]=keys.length-256}}return ret};getMethodCaller=function(name){return getCompiled(name,makeMethodCaller,callerCache)};getGetter=function(name){return getCompiled(name,makeGetter,getterCache)}}function ensureMethod(obj,methodName){var fn;if(obj!=null)fn=obj[methodName];if(typeof fn!=="function"){var message="Object "+util.classString(obj)+" has no method '"+util.toString(methodName)+"'";throw new Promise.TypeError(message)}return fn}function caller(obj){var methodName=this.pop();var fn=ensureMethod(obj,methodName);return fn.apply(obj,this)}Promise.prototype.call=function(methodName){var $_len=arguments.length;var args=new Array($_len-1);for(var $_i=1;$_i<$_len;++$_i){args[$_i-1]=arguments[$_i]}if(!true){if(canEvaluate){var maybeCaller=getMethodCaller(methodName);if(maybeCaller!==null){return this._then(maybeCaller,undefined,undefined,args,undefined)}}}args.push(methodName);return this._then(caller,undefined,undefined,args,undefined)};function namedGetter(obj){return obj[this]}function indexedGetter(obj){var index=+this;if(index<0)index=Math.max(0,index+obj.length);return obj[index]}Promise.prototype.get=function(propertyName){var isIndex=typeof propertyName==="number";var getter;if(!isIndex){if(canEvaluate){var maybeGetter=getGetter(propertyName);getter=maybeGetter!==null?maybeGetter:namedGetter}else{getter=namedGetter}}else{getter=indexedGetter}return this._then(getter,undefined,undefined,propertyName,undefined)}}},{"./util.js":38}],6:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise){var errors=_dereq_("./errors.js");var async=_dereq_("./async.js");var CancellationError=errors.CancellationError;Promise.prototype._cancel=function(reason){if(!this.isCancellable())return this;var parent;var promiseToReject=this;while((parent=promiseToReject._cancellationParent)!==undefined&&parent.isCancellable()){promiseToReject=parent}this._unsetCancellable();promiseToReject._target()._rejectCallback(reason,false,true)};Promise.prototype.cancel=function(reason){if(!this.isCancellable())return this;if(reason===undefined)reason=new CancellationError;async.invokeLater(this._cancel,this,reason);return this};Promise.prototype.cancellable=function(){if(this._cancellable())return this;async.enableTrampoline();this._setCancellable();this._cancellationParent=undefined;return this};Promise.prototype.uncancellable=function(){var ret=this.then();ret._unsetCancellable();return ret};Promise.prototype.fork=function(didFulfill,didReject,didProgress){var ret=this._then(didFulfill,didReject,didProgress,undefined,undefined);ret._setCancellable();ret._cancellationParent=undefined;return ret}}},{"./async.js":2,"./errors.js":13}],7:[function(_dereq_,module,exports){"use strict";module.exports=function(){var async=_dereq_("./async.js");var util=_dereq_("./util.js");var bluebirdFramePattern=/[\\\/]bluebird[\\\/]js[\\\/](main|debug|zalgo|instrumented)/;var stackFramePattern=null;var formatStack=null;var indentStackFrames=false;var warn;function CapturedTrace(parent){this._parent=parent;var length=this._length=1+(parent===undefined?0:parent._length);captureStackTrace(this,CapturedTrace);if(length>32)this.uncycle()}util.inherits(CapturedTrace,Error);CapturedTrace.prototype.uncycle=function(){var length=this._length;if(length<2)return;var nodes=[];var stackToIndex={};for(var i=0,node=this;node!==undefined;++i){nodes.push(node);node=node._parent}length=this._length=i;for(var i=length-1;i>=0;--i){var stack=nodes[i].stack;if(stackToIndex[stack]===undefined){stackToIndex[stack]=i}}for(var i=0;i<length;++i){var currentStack=nodes[i].stack;var index=stackToIndex[currentStack];if(index!==undefined&&index!==i){if(index>0){nodes[index-1]._parent=undefined;nodes[index-1]._length=1}nodes[i]._parent=undefined;nodes[i]._length=1;var cycleEdgeNode=i>0?nodes[i-1]:this;if(index<length-1){cycleEdgeNode._parent=nodes[index+1];cycleEdgeNode._parent.uncycle();cycleEdgeNode._length=cycleEdgeNode._parent._length+1}else{cycleEdgeNode._parent=undefined;cycleEdgeNode._length=1}var currentChildLength=cycleEdgeNode._length+1;for(var j=i-2;j>=0;--j){nodes[j]._length=currentChildLength;currentChildLength++}return}}};CapturedTrace.prototype.parent=function(){return this._parent};CapturedTrace.prototype.hasParent=function(){return this._parent!==undefined};CapturedTrace.prototype.attachExtraTrace=function(error){if(error.__stackCleaned__)return;this.uncycle();var parsed=CapturedTrace.parseStackAndMessage(error);var message=parsed.message;var stacks=[parsed.stack];var trace=this;while(trace!==undefined){stacks.push(cleanStack(trace.stack.split("\n")));trace=trace._parent}removeCommonRoots(stacks);removeDuplicateOrEmptyJumps(stacks);util.notEnumerableProp(error,"stack",reconstructStack(message,stacks));util.notEnumerableProp(error,"__stackCleaned__",true)};function reconstructStack(message,stacks){for(var i=0;i<stacks.length-1;++i){stacks[i].push("From previous event:");stacks[i]=stacks[i].join("\n")}if(i<stacks.length){stacks[i]=stacks[i].join("\n")}return message+"\n"+stacks.join("\n")}function removeDuplicateOrEmptyJumps(stacks){for(var i=0;i<stacks.length;++i){if(stacks[i].length===0||i+1<stacks.length&&stacks[i][0]===stacks[i+1][0]){stacks.splice(i,1);i--}}}function removeCommonRoots(stacks){var current=stacks[0];for(var i=1;i<stacks.length;++i){var prev=stacks[i];var currentLastIndex=current.length-1;var currentLastLine=current[currentLastIndex];var commonRootMeetPoint=-1;for(var j=prev.length-1;j>=0;--j){if(prev[j]===currentLastLine){commonRootMeetPoint=j;break}}for(var j=commonRootMeetPoint;j>=0;--j){var line=prev[j];if(current[currentLastIndex]===line){current.pop();currentLastIndex--}else{break}}current=prev}}function cleanStack(stack){var ret=[];for(var i=0;i<stack.length;++i){var line=stack[i];var isTraceLine=stackFramePattern.test(line)||"    (No stack trace)"===line;var isInternalFrame=isTraceLine&&shouldIgnore(line);if(isTraceLine&&!isInternalFrame){if(indentStackFrames&&line.charAt(0)!==" "){line="    "+line}ret.push(line)}}return ret}function stackFramesAsArray(error){var stack=error.stack.replace(/\s+$/g,"").split("\n");for(var i=0;i<stack.length;++i){var line=stack[i];if("    (No stack trace)"===line||stackFramePattern.test(line)){break}}if(i>0){stack=stack.slice(i)}return stack}CapturedTrace.parseStackAndMessage=function(error){var stack=error.stack;var message=error.toString();stack=typeof stack==="string"&&stack.length>0?stackFramesAsArray(error):["    (No stack trace)"];return{message:message,stack:cleanStack(stack)}};CapturedTrace.formatAndLogError=function(error,title){if(typeof console!=="undefined"){var message;if(typeof error==="object"||typeof error==="function"){var stack=error.stack;message=title+formatStack(stack,error)}else{message=title+String(error)}if(typeof warn==="function"){warn(message)}else if(typeof console.log==="function"||typeof console.log==="object"){console.log(message)}}};CapturedTrace.unhandledRejection=function(reason){CapturedTrace.formatAndLogError(reason,"^--- With additional stack trace: ")};CapturedTrace.isSupported=function(){return typeof captureStackTrace==="function"};CapturedTrace.fireRejectionEvent=function(name,localHandler,reason,promise){var localEventFired=false;try{if(typeof localHandler==="function"){localEventFired=true;if(name==="rejectionHandled"){localHandler(promise)}else{localHandler(reason,promise)}}}catch(e){async.throwLater(e)}var globalEventFired=false;try{globalEventFired=fireGlobalEvent(name,reason,promise)}catch(e){globalEventFired=true;async.throwLater(e)}var domEventFired=false;if(fireDomEvent){try{domEventFired=fireDomEvent(name.toLowerCase(),{reason:reason,promise:promise})}catch(e){domEventFired=true;async.throwLater(e)}}if(!globalEventFired&&!localEventFired&&!domEventFired&&name==="unhandledRejection"){CapturedTrace.formatAndLogError(reason,"Unhandled rejection ")}};function formatNonError(obj){var str;if(typeof obj==="function"){str="[function "+(obj.name||"anonymous")+"]"}else{str=obj.toString();var ruselessToString=/\[object [a-zA-Z0-9$_]+\]/;if(ruselessToString.test(str)){try{var newStr=JSON.stringify(obj);str=newStr}catch(e){}}if(str.length===0){str="(empty array)"}}return"(<"+snip(str)+">, no stack trace)"}function snip(str){var maxChars=41;if(str.length<maxChars){return str}return str.substr(0,maxChars-3)+"..."}var shouldIgnore=function(){return false};var parseLineInfoRegex=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function parseLineInfo(line){var matches=line.match(parseLineInfoRegex);if(matches){return{fileName:matches[1],line:parseInt(matches[2],10)}}}CapturedTrace.setBounds=function(firstLineError,lastLineError){if(!CapturedTrace.isSupported())return;var firstStackLines=firstLineError.stack.split("\n");var lastStackLines=lastLineError.stack.split("\n");var firstIndex=-1;var lastIndex=-1;var firstFileName;var lastFileName;for(var i=0;i<firstStackLines.length;++i){var result=parseLineInfo(firstStackLines[i]);if(result){firstFileName=result.fileName;firstIndex=result.line;break}}for(var i=0;i<lastStackLines.length;++i){var result=parseLineInfo(lastStackLines[i]);if(result){lastFileName=result.fileName;lastIndex=result.line;break}}if(firstIndex<0||lastIndex<0||!firstFileName||!lastFileName||firstFileName!==lastFileName||firstIndex>=lastIndex){return}shouldIgnore=function(line){if(bluebirdFramePattern.test(line))return true;var info=parseLineInfo(line);if(info){if(info.fileName===firstFileName&&(firstIndex<=info.line&&info.line<=lastIndex)){return true}}return false}};var captureStackTrace=function stackDetection(){var v8stackFramePattern=/^\s*at\s*/;var v8stackFormatter=function(stack,error){if(typeof stack==="string")return stack;if(error.name!==undefined&&error.message!==undefined){return error.toString()}return formatNonError(error)};if(typeof Error.stackTraceLimit==="number"&&typeof Error.captureStackTrace==="function"){Error.stackTraceLimit=Error.stackTraceLimit+6;stackFramePattern=v8stackFramePattern;formatStack=v8stackFormatter;var captureStackTrace=Error.captureStackTrace;shouldIgnore=function(line){return bluebirdFramePattern.test(line)};return function(receiver,ignoreUntil){Error.stackTraceLimit=Error.stackTraceLimit+6;captureStackTrace(receiver,ignoreUntil);Error.stackTraceLimit=Error.stackTraceLimit-6}}var err=new Error;if(typeof err.stack==="string"&&err.stack.split("\n")[0].indexOf("stackDetection@")>=0){stackFramePattern=/@/;formatStack=v8stackFormatter;indentStackFrames=true;return function captureStackTrace(o){o.stack=(new Error).stack}}var hasStackAfterThrow;try{throw new Error}catch(e){hasStackAfterThrow="stack"in e}if(!("stack"in err)&&hasStackAfterThrow&&typeof Error.stackTraceLimit==="number"){stackFramePattern=v8stackFramePattern;formatStack=v8stackFormatter;return function captureStackTrace(o){Error.stackTraceLimit=Error.stackTraceLimit+6;try{throw new Error}catch(e){o.stack=e.stack}Error.stackTraceLimit=Error.stackTraceLimit-6}}formatStack=function(stack,error){if(typeof stack==="string")return stack;if((typeof error==="object"||typeof error==="function")&&error.name!==undefined&&error.message!==undefined){return error.toString()}return formatNonError(error)};return null}([]);var fireDomEvent;var fireGlobalEvent=function(){if(util.isNode){return function(name,reason,promise){if(name==="rejectionHandled"){return process.emit(name,promise)}else{return process.emit(name,reason,promise)}}}else{var customEventWorks=false;var anyEventWorks=true;try{var ev=new self.CustomEvent("test");customEventWorks=ev instanceof CustomEvent}catch(e){}if(!customEventWorks){try{var event=document.createEvent("CustomEvent");event.initCustomEvent("testingtheevent",false,true,{});self.dispatchEvent(event)}catch(e){anyEventWorks=false}}if(anyEventWorks){fireDomEvent=function(type,detail){var event;if(customEventWorks){event=new self.CustomEvent(type,{detail:detail,bubbles:false,cancelable:true})}else if(self.dispatchEvent){event=document.createEvent("CustomEvent");event.initCustomEvent(type,false,true,detail)}return event?!self.dispatchEvent(event):false}}var toWindowMethodNameMap={};toWindowMethodNameMap["unhandledRejection"]=("on"+"unhandledRejection").toLowerCase();toWindowMethodNameMap["rejectionHandled"]=("on"+"rejectionHandled").toLowerCase();return function(name,reason,promise){var methodName=toWindowMethodNameMap[name];var method=self[methodName];if(!method)return false;if(name==="rejectionHandled"){method.call(self,promise)}else{method.call(self,reason,promise)}return true}}}();if(typeof console!=="undefined"&&typeof console.warn!=="undefined"){warn=function(message){console.warn(message)};if(util.isNode&&process.stderr.isTTY){warn=function(message){process.stderr.write("[31m"+message+"[39m\n")}}else if(!util.isNode&&typeof(new Error).stack==="string"){warn=function(message){console.warn("%c"+message,"color: red")}}}return CapturedTrace}},{"./async.js":2,"./util.js":38}],8:[function(_dereq_,module,exports){"use strict";module.exports=function(NEXT_FILTER){var util=_dereq_("./util.js");var errors=_dereq_("./errors.js");var tryCatch=util.tryCatch;var errorObj=util.errorObj;var keys=_dereq_("./es5.js").keys;var TypeError=errors.TypeError;function CatchFilter(instances,callback,promise){this._instances=instances;this._callback=callback;this._promise=promise}function safePredicate(predicate,e){var safeObject={};var retfilter=tryCatch(predicate).call(safeObject,e);if(retfilter===errorObj)return retfilter;var safeKeys=keys(safeObject);if(safeKeys.length){errorObj.e=new TypeError("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n");return errorObj}return retfilter}CatchFilter.prototype.doFilter=function(e){var cb=this._callback;var promise=this._promise;var boundTo=promise._boundValue();for(var i=0,len=this._instances.length;i<len;++i){var item=this._instances[i];var itemIsErrorType=item===Error||item!=null&&item.prototype instanceof Error;if(itemIsErrorType&&e instanceof item){var ret=tryCatch(cb).call(boundTo,e);if(ret===errorObj){NEXT_FILTER.e=ret.e;return NEXT_FILTER}return ret}else if(typeof item==="function"&&!itemIsErrorType){var shouldHandle=safePredicate(item,e);if(shouldHandle===errorObj){e=errorObj.e;break}else if(shouldHandle){var ret=tryCatch(cb).call(boundTo,e);if(ret===errorObj){NEXT_FILTER.e=ret.e;return NEXT_FILTER}return ret}}}NEXT_FILTER.e=e;return NEXT_FILTER};return CatchFilter}},{"./errors.js":13,"./es5.js":14,"./util.js":38}],9:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,CapturedTrace,isDebugging){var contextStack=[];function Context(){this._trace=new CapturedTrace(peekContext())}Context.prototype._pushContext=function(){if(!isDebugging())return;if(this._trace!==undefined){contextStack.push(this._trace)}};Context.prototype._popContext=function(){if(!isDebugging())return;if(this._trace!==undefined){contextStack.pop()}};function createContext(){if(isDebugging())return new Context}function peekContext(){var lastIndex=contextStack.length-1;if(lastIndex>=0){return contextStack[lastIndex]}return undefined}Promise.prototype._peekContext=peekContext;Promise.prototype._pushContext=Context.prototype._pushContext;Promise.prototype._popContext=Context.prototype._popContext;return createContext}},{}],10:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,CapturedTrace){var getDomain=Promise._getDomain;var async=_dereq_("./async.js");var Warning=_dereq_("./errors.js").Warning;var util=_dereq_("./util.js");var canAttachTrace=util.canAttachTrace;var unhandledRejectionHandled;var possiblyUnhandledRejection;var debugging=false||util.isNode&&(!!process.env["BLUEBIRD_DEBUG"]||process.env["NODE_ENV"]==="development");if(debugging){async.disableTrampolineIfNecessary()}Promise.prototype._ignoreRejections=function(){this._unsetRejectionIsUnhandled();this._bitField=this._bitField|16777216};Promise.prototype._ensurePossibleRejectionHandled=function(){if((this._bitField&16777216)!==0)return;this._setRejectionIsUnhandled();async.invokeLater(this._notifyUnhandledRejection,this,undefined)};Promise.prototype._notifyUnhandledRejectionIsHandled=function(){CapturedTrace.fireRejectionEvent("rejectionHandled",unhandledRejectionHandled,undefined,this)};Promise.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var reason=this._getCarriedStackTrace()||this._settledValue;this._setUnhandledRejectionIsNotified();CapturedTrace.fireRejectionEvent("unhandledRejection",possiblyUnhandledRejection,reason,this)}};Promise.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=this._bitField|524288};Promise.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=this._bitField&~524288};Promise.prototype._isUnhandledRejectionNotified=function(){return(this._bitField&524288)>0};Promise.prototype._setRejectionIsUnhandled=function(){this._bitField=this._bitField|2097152};Promise.prototype._unsetRejectionIsUnhandled=function(){this._bitField=this._bitField&~2097152;if(this._isUnhandledRejectionNotified()){this._unsetUnhandledRejectionIsNotified();this._notifyUnhandledRejectionIsHandled()}};Promise.prototype._isRejectionUnhandled=function(){return(this._bitField&2097152)>0};Promise.prototype._setCarriedStackTrace=function(capturedTrace){this._bitField=this._bitField|1048576;this._fulfillmentHandler0=capturedTrace};Promise.prototype._isCarryingStackTrace=function(){return(this._bitField&1048576)>0};Promise.prototype._getCarriedStackTrace=function(){return this._isCarryingStackTrace()?this._fulfillmentHandler0:undefined};Promise.prototype._captureStackTrace=function(){if(debugging){this._trace=new CapturedTrace(this._peekContext())}return this};Promise.prototype._attachExtraTrace=function(error,ignoreSelf){if(debugging&&canAttachTrace(error)){var trace=this._trace;if(trace!==undefined){if(ignoreSelf)trace=trace._parent}if(trace!==undefined){trace.attachExtraTrace(error)}else if(!error.__stackCleaned__){var parsed=CapturedTrace.parseStackAndMessage(error);util.notEnumerableProp(error,"stack",parsed.message+"\n"+parsed.stack.join("\n"));util.notEnumerableProp(error,"__stackCleaned__",true)}}};Promise.prototype._warn=function(message){var warning=new Warning(message);var ctx=this._peekContext();if(ctx){ctx.attachExtraTrace(warning)}else{var parsed=CapturedTrace.parseStackAndMessage(warning);warning.stack=parsed.message+"\n"+parsed.stack.join("\n")}CapturedTrace.formatAndLogError(warning,"")};Promise.onPossiblyUnhandledRejection=function(fn){var domain=getDomain();possiblyUnhandledRejection=typeof fn==="function"?domain===null?fn:domain.bind(fn):undefined};Promise.onUnhandledRejectionHandled=function(fn){var domain=getDomain();unhandledRejectionHandled=typeof fn==="function"?domain===null?fn:domain.bind(fn):undefined};Promise.longStackTraces=function(){if(async.haveItemsQueued()&&debugging===false){throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/DT1qyG\n")}debugging=CapturedTrace.isSupported();if(debugging){async.disableTrampolineIfNecessary()}};Promise.hasLongStackTraces=function(){return debugging&&CapturedTrace.isSupported()};if(!CapturedTrace.isSupported()){Promise.longStackTraces=function(){};debugging=false}return function(){return debugging}}},{"./async.js":2,"./errors.js":13,"./util.js":38}],11:[function(_dereq_,module,exports){"use strict";var util=_dereq_("./util.js");var isPrimitive=util.isPrimitive;module.exports=function(Promise){var returner=function(){return this};var thrower=function(){throw this};var returnUndefined=function(){};var throwUndefined=function(){throw undefined};var wrapper=function(value,action){if(action===1){return function(){throw value}}else if(action===2){return function(){return value}}};Promise.prototype["return"]=Promise.prototype.thenReturn=function(value){if(value===undefined)return this.then(returnUndefined);if(isPrimitive(value)){return this._then(wrapper(value,2),undefined,undefined,undefined,undefined)}return this._then(returner,undefined,undefined,value,undefined)};Promise.prototype["throw"]=Promise.prototype.thenThrow=function(reason){if(reason===undefined)return this.then(throwUndefined);if(isPrimitive(reason)){return this._then(wrapper(reason,1),undefined,undefined,undefined,undefined)}return this._then(thrower,undefined,undefined,reason,undefined)}}},{"./util.js":38}],12:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL){var PromiseReduce=Promise.reduce;Promise.prototype.each=function(fn){return PromiseReduce(this,fn,null,INTERNAL)};Promise.each=function(promises,fn){return PromiseReduce(promises,fn,null,INTERNAL)}}},{}],13:[function(_dereq_,module,exports){"use strict";var es5=_dereq_("./es5.js");var Objectfreeze=es5.freeze;var util=_dereq_("./util.js");var inherits=util.inherits;var notEnumerableProp=util.notEnumerableProp;function subError(nameProperty,defaultMessage){function SubError(message){if(!(this instanceof SubError))return new SubError(message);notEnumerableProp(this,"message",typeof message==="string"?message:defaultMessage);notEnumerableProp(this,"name",nameProperty);if(Error.captureStackTrace){Error.captureStackTrace(this,this.constructor)}else{Error.call(this)}}inherits(SubError,Error);return SubError}var _TypeError,_RangeError;var Warning=subError("Warning","warning");var CancellationError=subError("CancellationError","cancellation error");var TimeoutError=subError("TimeoutError","timeout error");var AggregateError=subError("AggregateError","aggregate error");try{_TypeError=TypeError;_RangeError=RangeError}catch(e){_TypeError=subError("TypeError","type error");_RangeError=subError("RangeError","range error")}var methods=("join pop push shift unshift slice filter forEach some "+"every map indexOf lastIndexOf reduce reduceRight sort reverse").split(" ");for(var i=0;i<methods.length;++i){if(typeof Array.prototype[methods[i]]==="function"){AggregateError.prototype[methods[i]]=Array.prototype[methods[i]]}}es5.defineProperty(AggregateError.prototype,"length",{value:0,configurable:false,writable:true,enumerable:true});AggregateError.prototype["isOperational"]=true;var level=0;AggregateError.prototype.toString=function(){var indent=Array(level*4+1).join(" ");var ret="\n"+indent+"AggregateError of:"+"\n";level++;indent=Array(level*4+1).join(" ");for(var i=0;i<this.length;++i){var str=this[i]===this?"[Circular AggregateError]":this[i]+"";var lines=str.split("\n");for(var j=0;j<lines.length;++j){lines[j]=indent+lines[j]}str=lines.join("\n");ret+=str+"\n"}level--;return ret};function OperationalError(message){if(!(this instanceof OperationalError))return new OperationalError(message);notEnumerableProp(this,"name","OperationalError");notEnumerableProp(this,"message",message);this.cause=message;this["isOperational"]=true;if(message instanceof Error){notEnumerableProp(this,"message",message.message);notEnumerableProp(this,"stack",message.stack)}else if(Error.captureStackTrace){Error.captureStackTrace(this,this.constructor)}}inherits(OperationalError,Error);var errorTypes=Error["__BluebirdErrorTypes__"];if(!errorTypes){errorTypes=Objectfreeze({CancellationError:CancellationError,TimeoutError:TimeoutError,OperationalError:OperationalError,RejectionError:OperationalError,AggregateError:AggregateError});notEnumerableProp(Error,"__BluebirdErrorTypes__",errorTypes)}module.exports={Error:Error,TypeError:_TypeError,RangeError:_RangeError,CancellationError:errorTypes.CancellationError,OperationalError:errorTypes.OperationalError,TimeoutError:errorTypes.TimeoutError,AggregateError:errorTypes.AggregateError,Warning:Warning}},{"./es5.js":14,"./util.js":38}],14:[function(_dereq_,module,exports){var isES5=function(){"use strict";return this===undefined}();if(isES5){module.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:isES5,propertyIsWritable:function(obj,prop){var descriptor=Object.getOwnPropertyDescriptor(obj,prop);return!!(!descriptor||descriptor.writable||descriptor.set)}}}else{var has={}.hasOwnProperty;var str={}.toString;var proto={}.constructor.prototype;var ObjectKeys=function(o){var ret=[];for(var key in o){if(has.call(o,key)){ret.push(key)}}return ret};var ObjectGetDescriptor=function(o,key){return{value:o[key]}};var ObjectDefineProperty=function(o,key,desc){o[key]=desc.value;return o};var ObjectFreeze=function(obj){return obj};var ObjectGetPrototypeOf=function(obj){try{return Object(obj).constructor.prototype}catch(e){return proto}};var ArrayIsArray=function(obj){try{return str.call(obj)==="[object Array]"}catch(e){return false}};module.exports={isArray:ArrayIsArray,keys:ObjectKeys,names:ObjectKeys,defineProperty:ObjectDefineProperty,getDescriptor:ObjectGetDescriptor,freeze:ObjectFreeze,getPrototypeOf:ObjectGetPrototypeOf,isES5:isES5,propertyIsWritable:function(){return true}}}},{}],15:[function(_dereq_,module,exports){
"use strict";module.exports=function(Promise,INTERNAL){var PromiseMap=Promise.map;Promise.prototype.filter=function(fn,options){return PromiseMap(this,fn,options,INTERNAL)};Promise.filter=function(promises,fn,options){return PromiseMap(promises,fn,options,INTERNAL)}}},{}],16:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,NEXT_FILTER,tryConvertToPromise){var util=_dereq_("./util.js");var isPrimitive=util.isPrimitive;var thrower=util.thrower;function returnThis(){return this}function throwThis(){throw this}function return$(r){return function(){return r}}function throw$(r){return function(){throw r}}function promisedFinally(ret,reasonOrValue,isFulfilled){var then;if(isPrimitive(reasonOrValue)){then=isFulfilled?return$(reasonOrValue):throw$(reasonOrValue)}else{then=isFulfilled?returnThis:throwThis}return ret._then(then,thrower,undefined,reasonOrValue,undefined)}function finallyHandler(reasonOrValue){var promise=this.promise;var handler=this.handler;var ret=promise._isBound()?handler.call(promise._boundValue()):handler();if(ret!==undefined){var maybePromise=tryConvertToPromise(ret,promise);if(maybePromise instanceof Promise){maybePromise=maybePromise._target();return promisedFinally(maybePromise,reasonOrValue,promise.isFulfilled())}}if(promise.isRejected()){NEXT_FILTER.e=reasonOrValue;return NEXT_FILTER}else{return reasonOrValue}}function tapHandler(value){var promise=this.promise;var handler=this.handler;var ret=promise._isBound()?handler.call(promise._boundValue(),value):handler(value);if(ret!==undefined){var maybePromise=tryConvertToPromise(ret,promise);if(maybePromise instanceof Promise){maybePromise=maybePromise._target();return promisedFinally(maybePromise,value,true)}}return value}Promise.prototype._passThroughHandler=function(handler,isFinally){if(typeof handler!=="function")return this.then();var promiseAndHandler={promise:this,handler:handler};return this._then(isFinally?finallyHandler:tapHandler,isFinally?finallyHandler:undefined,undefined,promiseAndHandler,undefined)};Promise.prototype.lastly=Promise.prototype["finally"]=function(handler){return this._passThroughHandler(handler,true)};Promise.prototype.tap=function(handler){return this._passThroughHandler(handler,false)}}},{"./util.js":38}],17:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,apiRejection,INTERNAL,tryConvertToPromise){var errors=_dereq_("./errors.js");var TypeError=errors.TypeError;var util=_dereq_("./util.js");var errorObj=util.errorObj;var tryCatch=util.tryCatch;var yieldHandlers=[];function promiseFromYieldHandler(value,yieldHandlers,traceParent){for(var i=0;i<yieldHandlers.length;++i){traceParent._pushContext();var result=tryCatch(yieldHandlers[i])(value);traceParent._popContext();if(result===errorObj){traceParent._pushContext();var ret=Promise.reject(errorObj.e);traceParent._popContext();return ret}var maybePromise=tryConvertToPromise(result,traceParent);if(maybePromise instanceof Promise)return maybePromise}return null}function PromiseSpawn(generatorFunction,receiver,yieldHandler,stack){var promise=this._promise=new Promise(INTERNAL);promise._captureStackTrace();this._stack=stack;this._generatorFunction=generatorFunction;this._receiver=receiver;this._generator=undefined;this._yieldHandlers=typeof yieldHandler==="function"?[yieldHandler].concat(yieldHandlers):yieldHandlers}PromiseSpawn.prototype.promise=function(){return this._promise};PromiseSpawn.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver);this._receiver=this._generatorFunction=undefined;this._next(undefined)};PromiseSpawn.prototype._continue=function(result){if(result===errorObj){return this._promise._rejectCallback(result.e,false,true)}var value=result.value;if(result.done===true){this._promise._resolveCallback(value)}else{var maybePromise=tryConvertToPromise(value,this._promise);if(!(maybePromise instanceof Promise)){maybePromise=promiseFromYieldHandler(maybePromise,this._yieldHandlers,this._promise);if(maybePromise===null){this._throw(new TypeError("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/4Y4pDk\n\n".replace("%s",value)+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));return}}maybePromise._then(this._next,this._throw,undefined,this,null)}};PromiseSpawn.prototype._throw=function(reason){this._promise._attachExtraTrace(reason);this._promise._pushContext();var result=tryCatch(this._generator["throw"]).call(this._generator,reason);this._promise._popContext();this._continue(result)};PromiseSpawn.prototype._next=function(value){this._promise._pushContext();var result=tryCatch(this._generator.next).call(this._generator,value);this._promise._popContext();this._continue(result)};Promise.coroutine=function(generatorFunction,options){if(typeof generatorFunction!=="function"){throw new TypeError("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n")}var yieldHandler=Object(options).yieldHandler;var PromiseSpawn$=PromiseSpawn;var stack=(new Error).stack;return function(){var generator=generatorFunction.apply(this,arguments);var spawn=new PromiseSpawn$(undefined,undefined,yieldHandler,stack);spawn._generator=generator;spawn._next(undefined);return spawn.promise()}};Promise.coroutine.addYieldHandler=function(fn){if(typeof fn!=="function")throw new TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n");yieldHandlers.push(fn)};Promise.spawn=function(generatorFunction){if(typeof generatorFunction!=="function"){return apiRejection("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n")}var spawn=new PromiseSpawn(generatorFunction,this);var ret=spawn.promise();spawn._run(Promise.spawn);return ret}}},{"./errors.js":13,"./util.js":38}],18:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray,tryConvertToPromise,INTERNAL){var util=_dereq_("./util.js");var canEvaluate=util.canEvaluate;var tryCatch=util.tryCatch;var errorObj=util.errorObj;var reject;if(!true){if(canEvaluate){var thenCallback=function(i){return new Function("value","holder","                             \n            'use strict';                                                    \n            holder.pIndex = value;                                           \n            holder.checkFulfillment(this);                                   \n            ".replace(/Index/g,i))};var caller=function(count){var values=[];for(var i=1;i<=count;++i)values.push("holder.p"+i);return new Function("holder","                                      \n            'use strict';                                                    \n            var callback = holder.fn;                                        \n            return callback(values);                                         \n            ".replace(/values/g,values.join(", ")))};var thenCallbacks=[];var callers=[undefined];for(var i=1;i<=5;++i){thenCallbacks.push(thenCallback(i));callers.push(caller(i))}var Holder=function(total,fn){this.p1=this.p2=this.p3=this.p4=this.p5=null;this.fn=fn;this.total=total;this.now=0};Holder.prototype.callers=callers;Holder.prototype.checkFulfillment=function(promise){var now=this.now;now++;var total=this.total;if(now>=total){var handler=this.callers[total];promise._pushContext();var ret=tryCatch(handler)(this);promise._popContext();if(ret===errorObj){promise._rejectCallback(ret.e,false,true)}else{promise._resolveCallback(ret)}}else{this.now=now}};var reject=function(reason){this._reject(reason)}}}Promise.join=function(){var last=arguments.length-1;var fn;if(last>0&&typeof arguments[last]==="function"){fn=arguments[last];if(!true){if(last<6&&canEvaluate){var ret=new Promise(INTERNAL);ret._captureStackTrace();var holder=new Holder(last,fn);var callbacks=thenCallbacks;for(var i=0;i<last;++i){var maybePromise=tryConvertToPromise(arguments[i],ret);if(maybePromise instanceof Promise){maybePromise=maybePromise._target();if(maybePromise._isPending()){maybePromise._then(callbacks[i],reject,undefined,ret,holder)}else if(maybePromise._isFulfilled()){callbacks[i].call(ret,maybePromise._value(),holder)}else{ret._reject(maybePromise._reason())}}else{callbacks[i].call(ret,maybePromise,holder)}}return ret}}}var $_len=arguments.length;var args=new Array($_len);for(var $_i=0;$_i<$_len;++$_i){args[$_i]=arguments[$_i]}if(fn)args.pop();var ret=new PromiseArray(args).promise();return fn!==undefined?ret.spread(fn):ret}}},{"./util.js":38}],19:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray,apiRejection,tryConvertToPromise,INTERNAL){var getDomain=Promise._getDomain;var async=_dereq_("./async.js");var util=_dereq_("./util.js");var tryCatch=util.tryCatch;var errorObj=util.errorObj;var PENDING={};var EMPTY_ARRAY=[];function MappingPromiseArray(promises,fn,limit,_filter){this.constructor$(promises);this._promise._captureStackTrace();var domain=getDomain();this._callback=domain===null?fn:domain.bind(fn);this._preservedValues=_filter===INTERNAL?new Array(this.length()):null;this._limit=limit;this._inFlight=0;this._queue=limit>=1?[]:EMPTY_ARRAY;async.invoke(init,this,undefined)}util.inherits(MappingPromiseArray,PromiseArray);function init(){this._init$(undefined,-2)}MappingPromiseArray.prototype._init=function(){};MappingPromiseArray.prototype._promiseFulfilled=function(value,index){var values=this._values;var length=this.length();var preservedValues=this._preservedValues;var limit=this._limit;if(values[index]===PENDING){values[index]=value;if(limit>=1){this._inFlight--;this._drainQueue();if(this._isResolved())return}}else{if(limit>=1&&this._inFlight>=limit){values[index]=value;this._queue.push(index);return}if(preservedValues!==null)preservedValues[index]=value;var callback=this._callback;var receiver=this._promise._boundValue();this._promise._pushContext();var ret=tryCatch(callback).call(receiver,value,index,length);this._promise._popContext();if(ret===errorObj)return this._reject(ret.e);var maybePromise=tryConvertToPromise(ret,this._promise);if(maybePromise instanceof Promise){maybePromise=maybePromise._target();if(maybePromise._isPending()){if(limit>=1)this._inFlight++;values[index]=PENDING;return maybePromise._proxyPromiseArray(this,index)}else if(maybePromise._isFulfilled()){ret=maybePromise._value()}else{return this._reject(maybePromise._reason())}}values[index]=ret}var totalResolved=++this._totalResolved;if(totalResolved>=length){if(preservedValues!==null){this._filter(values,preservedValues)}else{this._resolve(values)}}};MappingPromiseArray.prototype._drainQueue=function(){var queue=this._queue;var limit=this._limit;var values=this._values;while(queue.length>0&&this._inFlight<limit){if(this._isResolved())return;var index=queue.pop();this._promiseFulfilled(values[index],index)}};MappingPromiseArray.prototype._filter=function(booleans,values){var len=values.length;var ret=new Array(len);var j=0;for(var i=0;i<len;++i){if(booleans[i])ret[j++]=values[i]}ret.length=j;this._resolve(ret)};MappingPromiseArray.prototype.preservedValues=function(){return this._preservedValues};function map(promises,fn,options,_filter){var limit=typeof options==="object"&&options!==null?options.concurrency:0;limit=typeof limit==="number"&&isFinite(limit)&&limit>=1?limit:0;return new MappingPromiseArray(promises,fn,limit,_filter)}Promise.prototype.map=function(fn,options){if(typeof fn!=="function")return apiRejection("fn must be a function\n\n    See http://goo.gl/916lJJ\n");return map(this,fn,options,null).promise()};Promise.map=function(promises,fn,options,_filter){if(typeof fn!=="function")return apiRejection("fn must be a function\n\n    See http://goo.gl/916lJJ\n");return map(promises,fn,options,_filter).promise()}}},{"./async.js":2,"./util.js":38}],20:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL,tryConvertToPromise,apiRejection){var util=_dereq_("./util.js");var tryCatch=util.tryCatch;Promise.method=function(fn){if(typeof fn!=="function"){throw new Promise.TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n")}return function(){var ret=new Promise(INTERNAL);ret._captureStackTrace();ret._pushContext();var value=tryCatch(fn).apply(this,arguments);ret._popContext();ret._resolveFromSyncValue(value);return ret}};Promise.attempt=Promise["try"]=function(fn,args,ctx){if(typeof fn!=="function"){return apiRejection("fn must be a function\n\n    See http://goo.gl/916lJJ\n")}var ret=new Promise(INTERNAL);ret._captureStackTrace();ret._pushContext();var value=util.isArray(args)?tryCatch(fn).apply(ctx,args):tryCatch(fn).call(ctx,args);ret._popContext();ret._resolveFromSyncValue(value);return ret};Promise.prototype._resolveFromSyncValue=function(value){if(value===util.errorObj){this._rejectCallback(value.e,false,true)}else{this._resolveCallback(value,true)}}}},{"./util.js":38}],21:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise){var util=_dereq_("./util.js");var async=_dereq_("./async.js");var tryCatch=util.tryCatch;var errorObj=util.errorObj;function spreadAdapter(val,nodeback){var promise=this;if(!util.isArray(val))return successAdapter.call(promise,val,nodeback);var ret=tryCatch(nodeback).apply(promise._boundValue(),[null].concat(val));if(ret===errorObj){async.throwLater(ret.e)}}function successAdapter(val,nodeback){var promise=this;var receiver=promise._boundValue();var ret=val===undefined?tryCatch(nodeback).call(receiver,null):tryCatch(nodeback).call(receiver,null,val);if(ret===errorObj){async.throwLater(ret.e)}}function errorAdapter(reason,nodeback){var promise=this;if(!reason){var target=promise._target();var newReason=target._getCarriedStackTrace();newReason.cause=reason;reason=newReason}var ret=tryCatch(nodeback).call(promise._boundValue(),reason);if(ret===errorObj){async.throwLater(ret.e)}}Promise.prototype.asCallback=Promise.prototype.nodeify=function(nodeback,options){if(typeof nodeback=="function"){var adapter=successAdapter;if(options!==undefined&&Object(options).spread){adapter=spreadAdapter}this._then(adapter,errorAdapter,undefined,this,nodeback)}return this}}},{"./async.js":2,"./util.js":38}],22:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray){var util=_dereq_("./util.js");var async=_dereq_("./async.js");var tryCatch=util.tryCatch;var errorObj=util.errorObj;Promise.prototype.progressed=function(handler){return this._then(undefined,undefined,handler,undefined,undefined)};Promise.prototype._progress=function(progressValue){if(this._isFollowingOrFulfilledOrRejected())return;this._target()._progressUnchecked(progressValue)};Promise.prototype._progressHandlerAt=function(index){return index===0?this._progressHandler0:this[(index<<2)+index-5+2]};Promise.prototype._doProgressWith=function(progression){var progressValue=progression.value;var handler=progression.handler;var promise=progression.promise;var receiver=progression.receiver;var ret=tryCatch(handler).call(receiver,progressValue);if(ret===errorObj){if(ret.e!=null&&ret.e.name!=="StopProgressPropagation"){var trace=util.canAttachTrace(ret.e)?ret.e:new Error(util.toString(ret.e));promise._attachExtraTrace(trace);promise._progress(ret.e)}}else if(ret instanceof Promise){ret._then(promise._progress,null,null,promise,undefined)}else{promise._progress(ret)}};Promise.prototype._progressUnchecked=function(progressValue){var len=this._length();var progress=this._progress;for(var i=0;i<len;i++){var handler=this._progressHandlerAt(i);var promise=this._promiseAt(i);if(!(promise instanceof Promise)){var receiver=this._receiverAt(i);if(typeof handler==="function"){handler.call(receiver,progressValue,promise)}else if(receiver instanceof PromiseArray&&!receiver._isResolved()){receiver._promiseProgressed(progressValue,promise)}continue}if(typeof handler==="function"){async.invoke(this._doProgressWith,this,{handler:handler,promise:promise,receiver:this._receiverAt(i),value:progressValue})}else{async.invoke(progress,promise,progressValue)}}}}},{"./async.js":2,"./util.js":38}],23:[function(_dereq_,module,exports){"use strict";module.exports=function(){var makeSelfResolutionError=function(){return new TypeError("circular promise resolution chain\n\n    See http://goo.gl/LhFpo0\n")};var reflect=function(){return new Promise.PromiseInspection(this._target())};var apiRejection=function(msg){return Promise.reject(new TypeError(msg))};var util=_dereq_("./util.js");var getDomain;if(util.isNode){getDomain=function(){var ret=process.domain;if(ret===undefined)ret=null;return ret}}else{getDomain=function(){return null}}util.notEnumerableProp(Promise,"_getDomain",getDomain);var async=_dereq_("./async.js");var errors=_dereq_("./errors.js");var TypeError=Promise.TypeError=errors.TypeError;Promise.RangeError=errors.RangeError;Promise.CancellationError=errors.CancellationError;Promise.TimeoutError=errors.TimeoutError;Promise.OperationalError=errors.OperationalError;Promise.RejectionError=errors.OperationalError;Promise.AggregateError=errors.AggregateError;var INTERNAL=function(){};var APPLY={};var NEXT_FILTER={e:null};var tryConvertToPromise=_dereq_("./thenables.js")(Promise,INTERNAL);var PromiseArray=_dereq_("./promise_array.js")(Promise,INTERNAL,tryConvertToPromise,apiRejection);var CapturedTrace=_dereq_("./captured_trace.js")();var isDebugging=_dereq_("./debuggability.js")(Promise,CapturedTrace);var createContext=_dereq_("./context.js")(Promise,CapturedTrace,isDebugging);var CatchFilter=_dereq_("./catch_filter.js")(NEXT_FILTER);var PromiseResolver=_dereq_("./promise_resolver.js");var nodebackForPromise=PromiseResolver._nodebackForPromise;var errorObj=util.errorObj;var tryCatch=util.tryCatch;function Promise(resolver){if(typeof resolver!=="function"){throw new TypeError("the promise constructor requires a resolver function\n\n    See http://goo.gl/EC22Yn\n")}if(this.constructor!==Promise){throw new TypeError("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/KsIlge\n")}this._bitField=0;this._fulfillmentHandler0=undefined;this._rejectionHandler0=undefined;this._progressHandler0=undefined;this._promise0=undefined;this._receiver0=undefined;this._settledValue=undefined;if(resolver!==INTERNAL)this._resolveFromResolver(resolver)}Promise.prototype.toString=function(){return"[object Promise]"};Promise.prototype.caught=Promise.prototype["catch"]=function(fn){var len=arguments.length;if(len>1){var catchInstances=new Array(len-1),j=0,i;for(i=0;i<len-1;++i){var item=arguments[i];if(typeof item==="function"){catchInstances[j++]=item}else{return Promise.reject(new TypeError("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"))}}catchInstances.length=j;fn=arguments[i];var catchFilter=new CatchFilter(catchInstances,fn,this);return this._then(undefined,catchFilter.doFilter,undefined,catchFilter,undefined)}return this._then(undefined,fn,undefined,undefined,undefined)};Promise.prototype.reflect=function(){return this._then(reflect,reflect,undefined,this,undefined)};Promise.prototype.then=function(didFulfill,didReject,didProgress){if(isDebugging()&&arguments.length>0&&typeof didFulfill!=="function"&&typeof didReject!=="function"){var msg=".then() only accepts functions but was passed: "+util.classString(didFulfill);if(arguments.length>1){msg+=", "+util.classString(didReject)}this._warn(msg)}return this._then(didFulfill,didReject,didProgress,undefined,undefined)};Promise.prototype.done=function(didFulfill,didReject,didProgress){var promise=this._then(didFulfill,didReject,didProgress,undefined,undefined);promise._setIsFinal()};Promise.prototype.spread=function(didFulfill,didReject){return this.all()._then(didFulfill,didReject,undefined,APPLY,undefined)};Promise.prototype.isCancellable=function(){return!this.isResolved()&&this._cancellable()};Promise.prototype.toJSON=function(){var ret={isFulfilled:false,isRejected:false,fulfillmentValue:undefined,rejectionReason:undefined};if(this.isFulfilled()){ret.fulfillmentValue=this.value();ret.isFulfilled=true}else if(this.isRejected()){ret.rejectionReason=this.reason();ret.isRejected=true}return ret};Promise.prototype.all=function(){return new PromiseArray(this).promise()};Promise.prototype.error=function(fn){return this.caught(util.originatesFromRejection,fn)};Promise.is=function(val){return val instanceof Promise};Promise.fromNode=function(fn){var ret=new Promise(INTERNAL);var result=tryCatch(fn)(nodebackForPromise(ret));if(result===errorObj){ret._rejectCallback(result.e,true,true)}return ret};Promise.all=function(promises){return new PromiseArray(promises).promise()};Promise.defer=Promise.pending=function(){var promise=new Promise(INTERNAL);return new PromiseResolver(promise)};Promise.cast=function(obj){var ret=tryConvertToPromise(obj);if(!(ret instanceof Promise)){var val=ret;ret=new Promise(INTERNAL);ret._fulfillUnchecked(val)}return ret};Promise.resolve=Promise.fulfilled=Promise.cast;Promise.reject=Promise.rejected=function(reason){var ret=new Promise(INTERNAL);ret._captureStackTrace();ret._rejectCallback(reason,true);return ret};Promise.setScheduler=function(fn){if(typeof fn!=="function")throw new TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var prev=async._schedule;async._schedule=fn;return prev};Promise.prototype._then=function(didFulfill,didReject,didProgress,receiver,internalData){var haveInternalData=internalData!==undefined;var ret=haveInternalData?internalData:new Promise(INTERNAL);if(!haveInternalData){ret._propagateFrom(this,4|1);ret._captureStackTrace()}var target=this._target();if(target!==this){if(receiver===undefined)receiver=this._boundTo;if(!haveInternalData)ret._setIsMigrated()}var callbackIndex=target._addCallbacks(didFulfill,didReject,didProgress,ret,receiver,getDomain());if(target._isResolved()&&!target._isSettlePromisesQueued()){async.invoke(target._settlePromiseAtPostResolution,target,callbackIndex)}return ret};Promise.prototype._settlePromiseAtPostResolution=function(index){if(this._isRejectionUnhandled())this._unsetRejectionIsUnhandled();this._settlePromiseAt(index)};Promise.prototype._length=function(){return this._bitField&131071};Promise.prototype._isFollowingOrFulfilledOrRejected=function(){return(this._bitField&939524096)>0};Promise.prototype._isFollowing=function(){return(this._bitField&536870912)===536870912};Promise.prototype._setLength=function(len){this._bitField=this._bitField&-131072|len&131071};Promise.prototype._setFulfilled=function(){this._bitField=this._bitField|268435456};Promise.prototype._setRejected=function(){this._bitField=this._bitField|134217728};Promise.prototype._setFollowing=function(){this._bitField=this._bitField|536870912};Promise.prototype._setIsFinal=function(){this._bitField=this._bitField|33554432};Promise.prototype._isFinal=function(){return(this._bitField&33554432)>0};Promise.prototype._cancellable=function(){return(this._bitField&67108864)>0};Promise.prototype._setCancellable=function(){this._bitField=this._bitField|67108864};Promise.prototype._unsetCancellable=function(){this._bitField=this._bitField&~67108864};Promise.prototype._setIsMigrated=function(){this._bitField=this._bitField|4194304};Promise.prototype._unsetIsMigrated=function(){this._bitField=this._bitField&~4194304};Promise.prototype._isMigrated=function(){return(this._bitField&4194304)>0};Promise.prototype._receiverAt=function(index){var ret=index===0?this._receiver0:this[index*5-5+4];if(ret===undefined&&this._isBound()){return this._boundValue()}return ret};Promise.prototype._promiseAt=function(index){return index===0?this._promise0:this[index*5-5+3]};Promise.prototype._fulfillmentHandlerAt=function(index){return index===0?this._fulfillmentHandler0:this[index*5-5+0]};Promise.prototype._rejectionHandlerAt=function(index){return index===0?this._rejectionHandler0:this[index*5-5+1]};Promise.prototype._boundValue=function(){var ret=this._boundTo;if(ret!==undefined){if(ret instanceof Promise){if(ret.isFulfilled()){return ret.value()}else{return undefined}}}return ret};Promise.prototype._migrateCallbacks=function(follower,index){var fulfill=follower._fulfillmentHandlerAt(index);var reject=follower._rejectionHandlerAt(index);var progress=follower._progressHandlerAt(index);var promise=follower._promiseAt(index);var receiver=follower._receiverAt(index);if(promise instanceof Promise)promise._setIsMigrated();this._addCallbacks(fulfill,reject,progress,promise,receiver,null)};Promise.prototype._addCallbacks=function(fulfill,reject,progress,promise,receiver,domain){var index=this._length();if(index>=131071-5){index=0;this._setLength(0)}if(index===0){this._promise0=promise;if(receiver!==undefined)this._receiver0=receiver;if(typeof fulfill==="function"&&!this._isCarryingStackTrace()){this._fulfillmentHandler0=domain===null?fulfill:domain.bind(fulfill)}if(typeof reject==="function"){this._rejectionHandler0=domain===null?reject:domain.bind(reject)}if(typeof progress==="function"){this._progressHandler0=domain===null?progress:domain.bind(progress)}}else{var base=index*5-5;this[base+3]=promise;this[base+4]=receiver;if(typeof fulfill==="function"){this[base+0]=domain===null?fulfill:domain.bind(fulfill)}if(typeof reject==="function"){this[base+1]=domain===null?reject:domain.bind(reject)}if(typeof progress==="function"){this[base+2]=domain===null?progress:domain.bind(progress)}}this._setLength(index+1);return index};Promise.prototype._setProxyHandlers=function(receiver,promiseSlotValue){var index=this._length();if(index>=131071-5){index=0;this._setLength(0)}if(index===0){this._promise0=promiseSlotValue;this._receiver0=receiver}else{var base=index*5-5;this[base+3]=promiseSlotValue;this[base+4]=receiver}this._setLength(index+1)};Promise.prototype._proxyPromiseArray=function(promiseArray,index){this._setProxyHandlers(promiseArray,index)};Promise.prototype._resolveCallback=function(value,shouldBind){if(this._isFollowingOrFulfilledOrRejected())return;if(value===this)return this._rejectCallback(makeSelfResolutionError(),false,true);var maybePromise=tryConvertToPromise(value,this);if(!(maybePromise instanceof Promise))return this._fulfill(value);var propagationFlags=1|(shouldBind?4:0);this._propagateFrom(maybePromise,propagationFlags);var promise=maybePromise._target();if(promise._isPending()){var len=this._length();for(var i=0;i<len;++i){promise._migrateCallbacks(this,i)}this._setFollowing();this._setLength(0);this._setFollowee(promise)}else if(promise._isFulfilled()){this._fulfillUnchecked(promise._value())}else{this._rejectUnchecked(promise._reason(),promise._getCarriedStackTrace())}};Promise.prototype._rejectCallback=function(reason,synchronous,shouldNotMarkOriginatingFromRejection){if(!shouldNotMarkOriginatingFromRejection){util.markAsOriginatingFromRejection(reason)}var trace=util.ensureErrorObject(reason);var hasStack=trace===reason;this._attachExtraTrace(trace,synchronous?hasStack:false);this._reject(reason,hasStack?undefined:trace)};Promise.prototype._resolveFromResolver=function(resolver){var promise=this;this._captureStackTrace();this._pushContext();var synchronous=true;var r=tryCatch(resolver)(function(value){if(promise===null)return;promise._resolveCallback(value);promise=null},function(reason){if(promise===null)return;promise._rejectCallback(reason,synchronous);promise=null});synchronous=false;this._popContext();if(r!==undefined&&r===errorObj&&promise!==null){promise._rejectCallback(r.e,true,true);promise=null}};Promise.prototype._settlePromiseFromHandler=function(handler,receiver,value,promise){if(promise._isRejected())return;promise._pushContext();var x;if(receiver===APPLY&&!this._isRejected()){x=tryCatch(handler).apply(this._boundValue(),value)}else{x=tryCatch(handler).call(receiver,value)}promise._popContext();if(x===errorObj||x===promise||x===NEXT_FILTER){var err=x===promise?makeSelfResolutionError():x.e;promise._rejectCallback(err,false,true)}else{promise._resolveCallback(x)}};Promise.prototype._target=function(){var ret=this;while(ret._isFollowing())ret=ret._followee();return ret};Promise.prototype._followee=function(){return this._rejectionHandler0};Promise.prototype._setFollowee=function(promise){this._rejectionHandler0=promise};Promise.prototype._cleanValues=function(){if(this._cancellable()){this._cancellationParent=undefined}};Promise.prototype._propagateFrom=function(parent,flags){if((flags&1)>0&&parent._cancellable()){this._setCancellable();this._cancellationParent=parent}if((flags&4)>0&&parent._isBound()){this._setBoundTo(parent._boundTo)}};Promise.prototype._fulfill=function(value){if(this._isFollowingOrFulfilledOrRejected())return;this._fulfillUnchecked(value)};Promise.prototype._reject=function(reason,carriedStackTrace){if(this._isFollowingOrFulfilledOrRejected())return;this._rejectUnchecked(reason,carriedStackTrace)};Promise.prototype._settlePromiseAt=function(index){var promise=this._promiseAt(index);var isPromise=promise instanceof Promise;if(isPromise&&promise._isMigrated()){promise._unsetIsMigrated();return async.invoke(this._settlePromiseAt,this,index)}var handler=this._isFulfilled()?this._fulfillmentHandlerAt(index):this._rejectionHandlerAt(index);var carriedStackTrace=this._isCarryingStackTrace()?this._getCarriedStackTrace():undefined;var value=this._settledValue;var receiver=this._receiverAt(index);this._clearCallbackDataAtIndex(index);if(typeof handler==="function"){if(!isPromise){handler.call(receiver,value,promise)}else{this._settlePromiseFromHandler(handler,receiver,value,promise)}}else if(receiver instanceof PromiseArray){if(!receiver._isResolved()){if(this._isFulfilled()){receiver._promiseFulfilled(value,promise)}else{receiver._promiseRejected(value,promise)}}}else if(isPromise){if(this._isFulfilled()){promise._fulfill(value)}else{promise._reject(value,carriedStackTrace)}}if(index>=4&&(index&31)===4)async.invokeLater(this._setLength,this,0)};Promise.prototype._clearCallbackDataAtIndex=function(index){if(index===0){if(!this._isCarryingStackTrace()){this._fulfillmentHandler0=undefined}this._rejectionHandler0=this._progressHandler0=this._receiver0=this._promise0=undefined}else{var base=index*5-5;this[base+3]=this[base+4]=this[base+0]=this[base+1]=this[base+2]=undefined}};Promise.prototype._isSettlePromisesQueued=function(){return(this._bitField&-1073741824)===-1073741824};Promise.prototype._setSettlePromisesQueued=function(){this._bitField=this._bitField|-1073741824};Promise.prototype._unsetSettlePromisesQueued=function(){this._bitField=this._bitField&~-1073741824};Promise.prototype._queueSettlePromises=function(){async.settlePromises(this);this._setSettlePromisesQueued()};Promise.prototype._fulfillUnchecked=function(value){if(value===this){var err=makeSelfResolutionError();this._attachExtraTrace(err);return this._rejectUnchecked(err,undefined)}this._setFulfilled();this._settledValue=value;this._cleanValues();if(this._length()>0){this._queueSettlePromises()}};Promise.prototype._rejectUncheckedCheckError=function(reason){var trace=util.ensureErrorObject(reason);this._rejectUnchecked(reason,trace===reason?undefined:trace)};Promise.prototype._rejectUnchecked=function(reason,trace){if(reason===this){var err=makeSelfResolutionError();this._attachExtraTrace(err);return this._rejectUnchecked(err)}this._setRejected();this._settledValue=reason;this._cleanValues();if(this._isFinal()){async.throwLater(function(e){if("stack"in e){async.invokeFirst(CapturedTrace.unhandledRejection,undefined,e)}throw e},trace===undefined?reason:trace);return}if(trace!==undefined&&trace!==reason){this._setCarriedStackTrace(trace)}if(this._length()>0){this._queueSettlePromises()}else{this._ensurePossibleRejectionHandled()}};Promise.prototype._settlePromises=function(){this._unsetSettlePromisesQueued();var len=this._length();for(var i=0;i<len;i++){this._settlePromiseAt(i)}};util.notEnumerableProp(Promise,"_makeSelfResolutionError",makeSelfResolutionError);_dereq_("./progress.js")(Promise,PromiseArray);_dereq_("./method.js")(Promise,INTERNAL,tryConvertToPromise,apiRejection);_dereq_("./bind.js")(Promise,INTERNAL,tryConvertToPromise);
_dereq_("./finally.js")(Promise,NEXT_FILTER,tryConvertToPromise);_dereq_("./direct_resolve.js")(Promise);_dereq_("./synchronous_inspection.js")(Promise);_dereq_("./join.js")(Promise,PromiseArray,tryConvertToPromise,INTERNAL);Promise.Promise=Promise;_dereq_("./map.js")(Promise,PromiseArray,apiRejection,tryConvertToPromise,INTERNAL);_dereq_("./cancel.js")(Promise);_dereq_("./using.js")(Promise,apiRejection,tryConvertToPromise,createContext);_dereq_("./generators.js")(Promise,apiRejection,INTERNAL,tryConvertToPromise);_dereq_("./nodeify.js")(Promise);_dereq_("./call_get.js")(Promise);_dereq_("./props.js")(Promise,PromiseArray,tryConvertToPromise,apiRejection);_dereq_("./race.js")(Promise,INTERNAL,tryConvertToPromise,apiRejection);_dereq_("./reduce.js")(Promise,PromiseArray,apiRejection,tryConvertToPromise,INTERNAL);_dereq_("./settle.js")(Promise,PromiseArray);_dereq_("./some.js")(Promise,PromiseArray,apiRejection);_dereq_("./promisify.js")(Promise,INTERNAL);_dereq_("./any.js")(Promise);_dereq_("./each.js")(Promise,INTERNAL);_dereq_("./timers.js")(Promise,INTERNAL);_dereq_("./filter.js")(Promise,INTERNAL);util.toFastProperties(Promise);util.toFastProperties(Promise.prototype);function fillTypes(value){var p=new Promise(INTERNAL);p._fulfillmentHandler0=value;p._rejectionHandler0=value;p._progressHandler0=value;p._promise0=value;p._receiver0=value;p._settledValue=value}fillTypes({a:1});fillTypes({b:2});fillTypes({c:3});fillTypes(1);fillTypes(function(){});fillTypes(undefined);fillTypes(false);fillTypes(new Promise(INTERNAL));CapturedTrace.setBounds(async.firstLineError,util.lastLineError);return Promise}},{"./any.js":1,"./async.js":2,"./bind.js":3,"./call_get.js":5,"./cancel.js":6,"./captured_trace.js":7,"./catch_filter.js":8,"./context.js":9,"./debuggability.js":10,"./direct_resolve.js":11,"./each.js":12,"./errors.js":13,"./filter.js":15,"./finally.js":16,"./generators.js":17,"./join.js":18,"./map.js":19,"./method.js":20,"./nodeify.js":21,"./progress.js":22,"./promise_array.js":24,"./promise_resolver.js":25,"./promisify.js":26,"./props.js":27,"./race.js":29,"./reduce.js":30,"./settle.js":32,"./some.js":33,"./synchronous_inspection.js":34,"./thenables.js":35,"./timers.js":36,"./using.js":37,"./util.js":38}],24:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL,tryConvertToPromise,apiRejection){var util=_dereq_("./util.js");var isArray=util.isArray;function toResolutionValue(val){switch(val){case-2:return[];case-3:return{}}}function PromiseArray(values){var promise=this._promise=new Promise(INTERNAL);var parent;if(values instanceof Promise){parent=values;promise._propagateFrom(parent,1|4)}this._values=values;this._length=0;this._totalResolved=0;this._init(undefined,-2)}PromiseArray.prototype.length=function(){return this._length};PromiseArray.prototype.promise=function(){return this._promise};PromiseArray.prototype._init=function init(_,resolveValueIfEmpty){var values=tryConvertToPromise(this._values,this._promise);if(values instanceof Promise){values=values._target();this._values=values;if(values._isFulfilled()){values=values._value();if(!isArray(values)){var err=new Promise.TypeError("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");this.__hardReject__(err);return}}else if(values._isPending()){values._then(init,this._reject,undefined,this,resolveValueIfEmpty);return}else{this._reject(values._reason());return}}else if(!isArray(values)){this._promise._reject(apiRejection("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n")._reason());return}if(values.length===0){if(resolveValueIfEmpty===-5){this._resolveEmptyArray()}else{this._resolve(toResolutionValue(resolveValueIfEmpty))}return}var len=this.getActualLength(values.length);this._length=len;this._values=this.shouldCopyValues()?new Array(len):this._values;var promise=this._promise;for(var i=0;i<len;++i){var isResolved=this._isResolved();var maybePromise=tryConvertToPromise(values[i],promise);if(maybePromise instanceof Promise){maybePromise=maybePromise._target();if(isResolved){maybePromise._ignoreRejections()}else if(maybePromise._isPending()){maybePromise._proxyPromiseArray(this,i)}else if(maybePromise._isFulfilled()){this._promiseFulfilled(maybePromise._value(),i)}else{this._promiseRejected(maybePromise._reason(),i)}}else if(!isResolved){this._promiseFulfilled(maybePromise,i)}}};PromiseArray.prototype._isResolved=function(){return this._values===null};PromiseArray.prototype._resolve=function(value){this._values=null;this._promise._fulfill(value)};PromiseArray.prototype.__hardReject__=PromiseArray.prototype._reject=function(reason){this._values=null;this._promise._rejectCallback(reason,false,true)};PromiseArray.prototype._promiseProgressed=function(progressValue,index){this._promise._progress({index:index,value:progressValue})};PromiseArray.prototype._promiseFulfilled=function(value,index){this._values[index]=value;var totalResolved=++this._totalResolved;if(totalResolved>=this._length){this._resolve(this._values)}};PromiseArray.prototype._promiseRejected=function(reason,index){this._totalResolved++;this._reject(reason)};PromiseArray.prototype.shouldCopyValues=function(){return true};PromiseArray.prototype.getActualLength=function(len){return len};return PromiseArray}},{"./util.js":38}],25:[function(_dereq_,module,exports){"use strict";var util=_dereq_("./util.js");var maybeWrapAsError=util.maybeWrapAsError;var errors=_dereq_("./errors.js");var TimeoutError=errors.TimeoutError;var OperationalError=errors.OperationalError;var haveGetters=util.haveGetters;var es5=_dereq_("./es5.js");function isUntypedError(obj){return obj instanceof Error&&es5.getPrototypeOf(obj)===Error.prototype}var rErrorKey=/^(?:name|message|stack|cause)$/;function wrapAsOperationalError(obj){var ret;if(isUntypedError(obj)){ret=new OperationalError(obj);ret.name=obj.name;ret.message=obj.message;ret.stack=obj.stack;var keys=es5.keys(obj);for(var i=0;i<keys.length;++i){var key=keys[i];if(!rErrorKey.test(key)){ret[key]=obj[key]}}return ret}util.markAsOriginatingFromRejection(obj);return obj}function nodebackForPromise(promise){return function(err,value){if(promise===null)return;if(err){var wrapped=wrapAsOperationalError(maybeWrapAsError(err));promise._attachExtraTrace(wrapped);promise._reject(wrapped)}else if(arguments.length>2){var $_len=arguments.length;var args=new Array($_len-1);for(var $_i=1;$_i<$_len;++$_i){args[$_i-1]=arguments[$_i]}promise._fulfill(args)}else{promise._fulfill(value)}promise=null}}var PromiseResolver;if(!haveGetters){PromiseResolver=function(promise){this.promise=promise;this.asCallback=nodebackForPromise(promise);this.callback=this.asCallback}}else{PromiseResolver=function(promise){this.promise=promise}}if(haveGetters){var prop={get:function(){return nodebackForPromise(this.promise)}};es5.defineProperty(PromiseResolver.prototype,"asCallback",prop);es5.defineProperty(PromiseResolver.prototype,"callback",prop)}PromiseResolver._nodebackForPromise=nodebackForPromise;PromiseResolver.prototype.toString=function(){return"[object PromiseResolver]"};PromiseResolver.prototype.resolve=PromiseResolver.prototype.fulfill=function(value){if(!(this instanceof PromiseResolver)){throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n")}this.promise._resolveCallback(value)};PromiseResolver.prototype.reject=function(reason){if(!(this instanceof PromiseResolver)){throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n")}this.promise._rejectCallback(reason)};PromiseResolver.prototype.progress=function(value){if(!(this instanceof PromiseResolver)){throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n")}this.promise._progress(value)};PromiseResolver.prototype.cancel=function(err){this.promise.cancel(err)};PromiseResolver.prototype.timeout=function(){this.reject(new TimeoutError("timeout"))};PromiseResolver.prototype.isResolved=function(){return this.promise.isResolved()};PromiseResolver.prototype.toJSON=function(){return this.promise.toJSON()};module.exports=PromiseResolver},{"./errors.js":13,"./es5.js":14,"./util.js":38}],26:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL){var THIS={};var util=_dereq_("./util.js");var nodebackForPromise=_dereq_("./promise_resolver.js")._nodebackForPromise;var withAppended=util.withAppended;var maybeWrapAsError=util.maybeWrapAsError;var canEvaluate=util.canEvaluate;var TypeError=_dereq_("./errors").TypeError;var defaultSuffix="Async";var defaultPromisified={__isPromisified__:true};var noCopyProps=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"];var noCopyPropsPattern=new RegExp("^(?:"+noCopyProps.join("|")+")$");var defaultFilter=function(name){return util.isIdentifier(name)&&name.charAt(0)!=="_"&&name!=="constructor"};function propsFilter(key){return!noCopyPropsPattern.test(key)}function isPromisified(fn){try{return fn.__isPromisified__===true}catch(e){return false}}function hasPromisified(obj,key,suffix){var val=util.getDataPropertyOrDefault(obj,key+suffix,defaultPromisified);return val?isPromisified(val):false}function checkValid(ret,suffix,suffixRegexp){for(var i=0;i<ret.length;i+=2){var key=ret[i];if(suffixRegexp.test(key)){var keyWithoutAsyncSuffix=key.replace(suffixRegexp,"");for(var j=0;j<ret.length;j+=2){if(ret[j]===keyWithoutAsyncSuffix){throw new TypeError("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/iWrZbw\n".replace("%s",suffix))}}}}}function promisifiableMethods(obj,suffix,suffixRegexp,filter){var keys=util.inheritedDataKeys(obj);var ret=[];for(var i=0;i<keys.length;++i){var key=keys[i];var value=obj[key];var passesDefaultFilter=filter===defaultFilter?true:defaultFilter(key,value,obj);if(typeof value==="function"&&!isPromisified(value)&&!hasPromisified(obj,key,suffix)&&filter(key,value,obj,passesDefaultFilter)){ret.push(key,value)}}checkValid(ret,suffix,suffixRegexp);return ret}var escapeIdentRegex=function(str){return str.replace(/([$])/,"\\$")};var makeNodePromisifiedEval;if(!true){var switchCaseArgumentOrder=function(likelyArgumentCount){var ret=[likelyArgumentCount];var min=Math.max(0,likelyArgumentCount-1-3);for(var i=likelyArgumentCount-1;i>=min;--i){ret.push(i)}for(var i=likelyArgumentCount+1;i<=3;++i){ret.push(i)}return ret};var argumentSequence=function(argumentCount){return util.filledRange(argumentCount,"_arg","")};var parameterDeclaration=function(parameterCount){return util.filledRange(Math.max(parameterCount,3),"_arg","")};var parameterCount=function(fn){if(typeof fn.length==="number"){return Math.max(Math.min(fn.length,1023+1),0)}return 0};makeNodePromisifiedEval=function(callback,receiver,originalName,fn){var newParameterCount=Math.max(0,parameterCount(fn)-1);var argumentOrder=switchCaseArgumentOrder(newParameterCount);var shouldProxyThis=typeof callback==="string"||receiver===THIS;function generateCallForArgumentCount(count){var args=argumentSequence(count).join(", ");var comma=count>0?", ":"";var ret;if(shouldProxyThis){ret="ret = callback.call(this, {{args}}, nodeback); break;\n"}else{ret=receiver===undefined?"ret = callback({{args}}, nodeback); break;\n":"ret = callback.call(receiver, {{args}}, nodeback); break;\n"}return ret.replace("{{args}}",args).replace(", ",comma)}function generateArgumentSwitchCase(){var ret="";for(var i=0;i<argumentOrder.length;++i){ret+="case "+argumentOrder[i]+":"+generateCallForArgumentCount(argumentOrder[i])}ret+="                                                             \n        default:                                                             \n            var args = new Array(len + 1);                                   \n            var i = 0;                                                       \n            for (var i = 0; i < len; ++i) {                                  \n               args[i] = arguments[i];                                       \n            }                                                                \n            args[i] = nodeback;                                              \n            [CodeForCall]                                                    \n            break;                                                           \n        ".replace("[CodeForCall]",shouldProxyThis?"ret = callback.apply(this, args);\n":"ret = callback.apply(receiver, args);\n");return ret}var getFunctionCode=typeof callback==="string"?"this != null ? this['"+callback+"'] : fn":"fn";return new Function("Promise","fn","receiver","withAppended","maybeWrapAsError","nodebackForPromise","tryCatch","errorObj","notEnumerableProp","INTERNAL","'use strict';                            \n        var ret = function (Parameters) {                                    \n            'use strict';                                                    \n            var len = arguments.length;                                      \n            var promise = new Promise(INTERNAL);                             \n            promise._captureStackTrace();                                    \n            var nodeback = nodebackForPromise(promise);                      \n            var ret;                                                         \n            var callback = tryCatch([GetFunctionCode]);                      \n            switch(len) {                                                    \n                [CodeForSwitchCase]                                          \n            }                                                                \n            if (ret === errorObj) {                                          \n                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);\n            }                                                                \n            return promise;                                                  \n        };                                                                   \n        notEnumerableProp(ret, '__isPromisified__', true);                   \n        return ret;                                                          \n        ".replace("Parameters",parameterDeclaration(newParameterCount)).replace("[CodeForSwitchCase]",generateArgumentSwitchCase()).replace("[GetFunctionCode]",getFunctionCode))(Promise,fn,receiver,withAppended,maybeWrapAsError,nodebackForPromise,util.tryCatch,util.errorObj,util.notEnumerableProp,INTERNAL)}}function makeNodePromisifiedClosure(callback,receiver,_,fn){var defaultThis=function(){return this}();var method=callback;if(typeof method==="string"){callback=fn}function promisified(){var _receiver=receiver;if(receiver===THIS)_receiver=this;var promise=new Promise(INTERNAL);promise._captureStackTrace();var cb=typeof method==="string"&&this!==defaultThis?this[method]:callback;var fn=nodebackForPromise(promise);try{cb.apply(_receiver,withAppended(arguments,fn))}catch(e){promise._rejectCallback(maybeWrapAsError(e),true,true)}return promise}util.notEnumerableProp(promisified,"__isPromisified__",true);return promisified}var makeNodePromisified=canEvaluate?makeNodePromisifiedEval:makeNodePromisifiedClosure;function promisifyAll(obj,suffix,filter,promisifier){var suffixRegexp=new RegExp(escapeIdentRegex(suffix)+"$");var methods=promisifiableMethods(obj,suffix,suffixRegexp,filter);for(var i=0,len=methods.length;i<len;i+=2){var key=methods[i];var fn=methods[i+1];var promisifiedKey=key+suffix;obj[promisifiedKey]=promisifier===makeNodePromisified?makeNodePromisified(key,THIS,key,fn,suffix):promisifier(fn,function(){return makeNodePromisified(key,THIS,key,fn,suffix)})}util.toFastProperties(obj);return obj}function promisify(callback,receiver){return makeNodePromisified(callback,receiver,undefined,callback)}Promise.promisify=function(fn,receiver){if(typeof fn!=="function"){throw new TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n")}if(isPromisified(fn)){return fn}var ret=promisify(fn,arguments.length<2?THIS:receiver);util.copyDescriptors(fn,ret,propsFilter);return ret};Promise.promisifyAll=function(target,options){if(typeof target!=="function"&&typeof target!=="object"){throw new TypeError("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/9ITlV0\n")}options=Object(options);var suffix=options.suffix;if(typeof suffix!=="string")suffix=defaultSuffix;var filter=options.filter;if(typeof filter!=="function")filter=defaultFilter;var promisifier=options.promisifier;if(typeof promisifier!=="function")promisifier=makeNodePromisified;if(!util.isIdentifier(suffix)){throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/8FZo5V\n")}var keys=util.inheritedDataKeys(target);for(var i=0;i<keys.length;++i){var value=target[keys[i]];if(keys[i]!=="constructor"&&util.isClass(value)){promisifyAll(value.prototype,suffix,filter,promisifier);promisifyAll(value,suffix,filter,promisifier)}}return promisifyAll(target,suffix,filter,promisifier)}}},{"./errors":13,"./promise_resolver.js":25,"./util.js":38}],27:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray,tryConvertToPromise,apiRejection){var util=_dereq_("./util.js");var isObject=util.isObject;var es5=_dereq_("./es5.js");function PropertiesPromiseArray(obj){var keys=es5.keys(obj);var len=keys.length;var values=new Array(len*2);for(var i=0;i<len;++i){var key=keys[i];values[i]=obj[key];values[i+len]=key}this.constructor$(values)}util.inherits(PropertiesPromiseArray,PromiseArray);PropertiesPromiseArray.prototype._init=function(){this._init$(undefined,-3)};PropertiesPromiseArray.prototype._promiseFulfilled=function(value,index){this._values[index]=value;var totalResolved=++this._totalResolved;if(totalResolved>=this._length){var val={};var keyOffset=this.length();for(var i=0,len=this.length();i<len;++i){val[this._values[i+keyOffset]]=this._values[i]}this._resolve(val)}};PropertiesPromiseArray.prototype._promiseProgressed=function(value,index){this._promise._progress({key:this._values[index+this.length()],value:value})};PropertiesPromiseArray.prototype.shouldCopyValues=function(){return false};PropertiesPromiseArray.prototype.getActualLength=function(len){return len>>1};function props(promises){var ret;var castValue=tryConvertToPromise(promises);if(!isObject(castValue)){return apiRejection("cannot await properties of a non-object\n\n    See http://goo.gl/OsFKC8\n")}else if(castValue instanceof Promise){ret=castValue._then(Promise.props,undefined,undefined,undefined,undefined)}else{ret=new PropertiesPromiseArray(castValue).promise()}if(castValue instanceof Promise){ret._propagateFrom(castValue,4)}return ret}Promise.prototype.props=function(){return props(this)};Promise.props=function(promises){return props(promises)}}},{"./es5.js":14,"./util.js":38}],28:[function(_dereq_,module,exports){"use strict";function arrayMove(src,srcIndex,dst,dstIndex,len){for(var j=0;j<len;++j){dst[j+dstIndex]=src[j+srcIndex];src[j+srcIndex]=void 0}}function Queue(capacity){this._capacity=capacity;this._length=0;this._front=0}Queue.prototype._willBeOverCapacity=function(size){return this._capacity<size};Queue.prototype._pushOne=function(arg){var length=this.length();this._checkCapacity(length+1);var i=this._front+length&this._capacity-1;this[i]=arg;this._length=length+1};Queue.prototype._unshiftOne=function(value){var capacity=this._capacity;this._checkCapacity(this.length()+1);var front=this._front;var i=(front-1&capacity-1^capacity)-capacity;this[i]=value;this._front=i;this._length=this.length()+1};Queue.prototype.unshift=function(fn,receiver,arg){this._unshiftOne(arg);this._unshiftOne(receiver);this._unshiftOne(fn)};Queue.prototype.push=function(fn,receiver,arg){var length=this.length()+3;if(this._willBeOverCapacity(length)){this._pushOne(fn);this._pushOne(receiver);this._pushOne(arg);return}var j=this._front+length-3;this._checkCapacity(length);var wrapMask=this._capacity-1;this[j+0&wrapMask]=fn;this[j+1&wrapMask]=receiver;this[j+2&wrapMask]=arg;this._length=length};Queue.prototype.shift=function(){var front=this._front,ret=this[front];this[front]=undefined;this._front=front+1&this._capacity-1;this._length--;return ret};Queue.prototype.length=function(){return this._length};Queue.prototype._checkCapacity=function(size){if(this._capacity<size){this._resizeTo(this._capacity<<1)}};Queue.prototype._resizeTo=function(capacity){var oldCapacity=this._capacity;this._capacity=capacity;var front=this._front;var length=this._length;var moveItemsCount=front+length&oldCapacity-1;arrayMove(this,0,this,oldCapacity,moveItemsCount)};module.exports=Queue},{}],29:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL,tryConvertToPromise,apiRejection){var isArray=_dereq_("./util.js").isArray;var raceLater=function(promise){return promise.then(function(array){return race(array,promise)})};function race(promises,parent){var maybePromise=tryConvertToPromise(promises);if(maybePromise instanceof Promise){return raceLater(maybePromise)}else if(!isArray(promises)){return apiRejection("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n")}var ret=new Promise(INTERNAL);if(parent!==undefined){ret._propagateFrom(parent,4|1)}var fulfill=ret._fulfill;var reject=ret._reject;for(var i=0,len=promises.length;i<len;++i){var val=promises[i];if(val===undefined&&!(i in promises)){continue}Promise.cast(val)._then(fulfill,reject,undefined,ret,null)}return ret}Promise.race=function(promises){return race(promises,undefined)};Promise.prototype.race=function(){return race(this,undefined)}}},{"./util.js":38}],30:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray,apiRejection,tryConvertToPromise,INTERNAL){var getDomain=Promise._getDomain;var async=_dereq_("./async.js");var util=_dereq_("./util.js");var tryCatch=util.tryCatch;var errorObj=util.errorObj;function ReductionPromiseArray(promises,fn,accum,_each){this.constructor$(promises);this._promise._captureStackTrace();this._preservedValues=_each===INTERNAL?[]:null;this._zerothIsAccum=accum===undefined;this._gotAccum=false;this._reducingIndex=this._zerothIsAccum?1:0;this._valuesPhase=undefined;var maybePromise=tryConvertToPromise(accum,this._promise);var rejected=false;var isPromise=maybePromise instanceof Promise;if(isPromise){maybePromise=maybePromise._target();if(maybePromise._isPending()){maybePromise._proxyPromiseArray(this,-1)}else if(maybePromise._isFulfilled()){accum=maybePromise._value();this._gotAccum=true}else{this._reject(maybePromise._reason());rejected=true}}if(!(isPromise||this._zerothIsAccum))this._gotAccum=true;var domain=getDomain();this._callback=domain===null?fn:domain.bind(fn);this._accum=accum;if(!rejected)async.invoke(init,this,undefined)}function init(){this._init$(undefined,-5)}util.inherits(ReductionPromiseArray,PromiseArray);ReductionPromiseArray.prototype._init=function(){};ReductionPromiseArray.prototype._resolveEmptyArray=function(){if(this._gotAccum||this._zerothIsAccum){this._resolve(this._preservedValues!==null?[]:this._accum)}};ReductionPromiseArray.prototype._promiseFulfilled=function(value,index){var values=this._values;values[index]=value;var length=this.length();var preservedValues=this._preservedValues;var isEach=preservedValues!==null;var gotAccum=this._gotAccum;var valuesPhase=this._valuesPhase;var valuesPhaseIndex;if(!valuesPhase){valuesPhase=this._valuesPhase=new Array(length);for(valuesPhaseIndex=0;valuesPhaseIndex<length;++valuesPhaseIndex){valuesPhase[valuesPhaseIndex]=0}}valuesPhaseIndex=valuesPhase[index];if(index===0&&this._zerothIsAccum){this._accum=value;this._gotAccum=gotAccum=true;valuesPhase[index]=valuesPhaseIndex===0?1:2}else if(index===-1){this._accum=value;this._gotAccum=gotAccum=true}else{if(valuesPhaseIndex===0){valuesPhase[index]=1}else{valuesPhase[index]=2;this._accum=value}}if(!gotAccum)return;var callback=this._callback;var receiver=this._promise._boundValue();var ret;for(var i=this._reducingIndex;i<length;++i){valuesPhaseIndex=valuesPhase[i];if(valuesPhaseIndex===2){this._reducingIndex=i+1;continue}if(valuesPhaseIndex!==1)return;value=values[i];this._promise._pushContext();if(isEach){preservedValues.push(value);ret=tryCatch(callback).call(receiver,value,i,length)}else{ret=tryCatch(callback).call(receiver,this._accum,value,i,length)}this._promise._popContext();if(ret===errorObj)return this._reject(ret.e);var maybePromise=tryConvertToPromise(ret,this._promise);if(maybePromise instanceof Promise){maybePromise=maybePromise._target();if(maybePromise._isPending()){valuesPhase[i]=4;return maybePromise._proxyPromiseArray(this,i)}else if(maybePromise._isFulfilled()){ret=maybePromise._value()}else{return this._reject(maybePromise._reason())}}this._reducingIndex=i+1;this._accum=ret}this._resolve(isEach?preservedValues:this._accum)};function reduce(promises,fn,initialValue,_each){if(typeof fn!=="function")return apiRejection("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var array=new ReductionPromiseArray(promises,fn,initialValue,_each);return array.promise()}Promise.prototype.reduce=function(fn,initialValue){return reduce(this,fn,initialValue,null)};Promise.reduce=function(promises,fn,initialValue,_each){return reduce(promises,fn,initialValue,_each)}}},{"./async.js":2,"./util.js":38}],31:[function(_dereq_,module,exports){"use strict";var schedule;var util=_dereq_("./util");var noAsyncScheduler=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")};if(util.isNode&&typeof MutationObserver==="undefined"){var GlobalSetImmediate=global.setImmediate;var ProcessNextTick=process.nextTick;schedule=util.isRecentNode?function(fn){GlobalSetImmediate.call(global,fn)}:function(fn){ProcessNextTick.call(process,fn)}}else if(typeof MutationObserver!=="undefined"&&!(typeof window!=="undefined"&&window.navigator&&window.navigator.standalone)){schedule=function(fn){var div=document.createElement("div");var observer=new MutationObserver(fn);observer.observe(div,{attributes:true});return function(){div.classList.toggle("foo")}};schedule.isStatic=true}else if(typeof setImmediate!=="undefined"){schedule=function(fn){setImmediate(fn)}}else if(typeof setTimeout!=="undefined"){schedule=function(fn){setTimeout(fn,0)}}else{schedule=noAsyncScheduler}module.exports=schedule},{"./util":38}],32:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray){var PromiseInspection=Promise.PromiseInspection;var util=_dereq_("./util.js");function SettledPromiseArray(values){this.constructor$(values)}util.inherits(SettledPromiseArray,PromiseArray);SettledPromiseArray.prototype._promiseResolved=function(index,inspection){this._values[index]=inspection;var totalResolved=++this._totalResolved;if(totalResolved>=this._length){this._resolve(this._values)}};SettledPromiseArray.prototype._promiseFulfilled=function(value,index){var ret=new PromiseInspection;ret._bitField=268435456;ret._settledValue=value;this._promiseResolved(index,ret)};SettledPromiseArray.prototype._promiseRejected=function(reason,index){var ret=new PromiseInspection;ret._bitField=134217728;ret._settledValue=reason;this._promiseResolved(index,ret)};Promise.settle=function(promises){return new SettledPromiseArray(promises).promise()};Promise.prototype.settle=function(){return new SettledPromiseArray(this).promise()}}},{"./util.js":38}],33:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray,apiRejection){var util=_dereq_("./util.js");var RangeError=_dereq_("./errors.js").RangeError;var AggregateError=_dereq_("./errors.js").AggregateError;var isArray=util.isArray;function SomePromiseArray(values){this.constructor$(values);this._howMany=0;this._unwrap=false;this._initialized=false}util.inherits(SomePromiseArray,PromiseArray);SomePromiseArray.prototype._init=function(){if(!this._initialized){return}if(this._howMany===0){this._resolve([]);return}this._init$(undefined,-5);var isArrayResolved=isArray(this._values);if(!this._isResolved()&&isArrayResolved&&this._howMany>this._canPossiblyFulfill()){this._reject(this._getRangeError(this.length()))}};SomePromiseArray.prototype.init=function(){this._initialized=true;this._init()};SomePromiseArray.prototype.setUnwrap=function(){this._unwrap=true};SomePromiseArray.prototype.howMany=function(){return this._howMany};SomePromiseArray.prototype.setHowMany=function(count){this._howMany=count};SomePromiseArray.prototype._promiseFulfilled=function(value){this._addFulfilled(value);if(this._fulfilled()===this.howMany()){this._values.length=this.howMany();if(this.howMany()===1&&this._unwrap){this._resolve(this._values[0])}else{this._resolve(this._values)}}};SomePromiseArray.prototype._promiseRejected=function(reason){this._addRejected(reason);if(this.howMany()>this._canPossiblyFulfill()){var e=new AggregateError;for(var i=this.length();i<this._values.length;++i){e.push(this._values[i])}this._reject(e)}};SomePromiseArray.prototype._fulfilled=function(){return this._totalResolved};SomePromiseArray.prototype._rejected=function(){return this._values.length-this.length()};SomePromiseArray.prototype._addRejected=function(reason){this._values.push(reason)};SomePromiseArray.prototype._addFulfilled=function(value){this._values[this._totalResolved++]=value};SomePromiseArray.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()};SomePromiseArray.prototype._getRangeError=function(count){var message="Input array must contain at least "+this._howMany+" items but contains only "+count+" items";return new RangeError(message)};SomePromiseArray.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))};function some(promises,howMany){if((howMany|0)!==howMany||howMany<0){return apiRejection("expecting a positive integer\n\n    See http://goo.gl/1wAmHx\n")}var ret=new SomePromiseArray(promises);var promise=ret.promise();ret.setHowMany(howMany);ret.init();return promise}Promise.some=function(promises,howMany){return some(promises,howMany)};Promise.prototype.some=function(howMany){return some(this,howMany)};Promise._SomePromiseArray=SomePromiseArray}},{"./errors.js":13,"./util.js":38}],34:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise){function PromiseInspection(promise){if(promise!==undefined){promise=promise._target();this._bitField=promise._bitField;this._settledValue=promise._settledValue}else{this._bitField=0;this._settledValue=undefined}}PromiseInspection.prototype.value=function(){if(!this.isFulfilled()){throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n")}return this._settledValue};PromiseInspection.prototype.error=PromiseInspection.prototype.reason=function(){if(!this.isRejected()){throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n")}return this._settledValue};PromiseInspection.prototype.isFulfilled=Promise.prototype._isFulfilled=function(){return(this._bitField&268435456)>0};PromiseInspection.prototype.isRejected=Promise.prototype._isRejected=function(){return(this._bitField&134217728)>0};PromiseInspection.prototype.isPending=Promise.prototype._isPending=function(){return(this._bitField&402653184)===0};PromiseInspection.prototype.isResolved=Promise.prototype._isResolved=function(){return(this._bitField&402653184)>0};Promise.prototype.isPending=function(){return this._target()._isPending()};Promise.prototype.isRejected=function(){return this._target()._isRejected()};Promise.prototype.isFulfilled=function(){return this._target()._isFulfilled()};Promise.prototype.isResolved=function(){
return this._target()._isResolved()};Promise.prototype._value=function(){return this._settledValue};Promise.prototype._reason=function(){this._unsetRejectionIsUnhandled();return this._settledValue};Promise.prototype.value=function(){var target=this._target();if(!target.isFulfilled()){throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n")}return target._settledValue};Promise.prototype.reason=function(){var target=this._target();if(!target.isRejected()){throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n")}target._unsetRejectionIsUnhandled();return target._settledValue};Promise.PromiseInspection=PromiseInspection}},{}],35:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL){var util=_dereq_("./util.js");var errorObj=util.errorObj;var isObject=util.isObject;function tryConvertToPromise(obj,context){if(isObject(obj)){if(obj instanceof Promise){return obj}else if(isAnyBluebirdPromise(obj)){var ret=new Promise(INTERNAL);obj._then(ret._fulfillUnchecked,ret._rejectUncheckedCheckError,ret._progressUnchecked,ret,null);return ret}var then=util.tryCatch(getThen)(obj);if(then===errorObj){if(context)context._pushContext();var ret=Promise.reject(then.e);if(context)context._popContext();return ret}else if(typeof then==="function"){return doThenable(obj,then,context)}}return obj}function getThen(obj){return obj.then}var hasProp={}.hasOwnProperty;function isAnyBluebirdPromise(obj){return hasProp.call(obj,"_promise0")}function doThenable(x,then,context){var promise=new Promise(INTERNAL);var ret=promise;if(context)context._pushContext();promise._captureStackTrace();if(context)context._popContext();var synchronous=true;var result=util.tryCatch(then).call(x,resolveFromThenable,rejectFromThenable,progressFromThenable);synchronous=false;if(promise&&result===errorObj){promise._rejectCallback(result.e,true,true);promise=null}function resolveFromThenable(value){if(!promise)return;promise._resolveCallback(value);promise=null}function rejectFromThenable(reason){if(!promise)return;promise._rejectCallback(reason,synchronous,true);promise=null}function progressFromThenable(value){if(!promise)return;if(typeof promise._progress==="function"){promise._progress(value)}}return ret}return tryConvertToPromise}},{"./util.js":38}],36:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL){var util=_dereq_("./util.js");var TimeoutError=Promise.TimeoutError;var afterTimeout=function(promise,message){if(!promise.isPending())return;if(typeof message!=="string"){message="operation timed out"}var err=new TimeoutError(message);util.markAsOriginatingFromRejection(err);promise._attachExtraTrace(err);promise._cancel(err)};var afterValue=function(value){return delay(+this).thenReturn(value)};var delay=Promise.delay=function(value,ms){if(ms===undefined){ms=value;value=undefined;var ret=new Promise(INTERNAL);setTimeout(function(){ret._fulfill()},ms);return ret}ms=+ms;return Promise.resolve(value)._then(afterValue,null,null,ms,undefined)};Promise.prototype.delay=function(ms){return delay(this,ms)};function successClear(value){var handle=this;if(handle instanceof Number)handle=+handle;clearTimeout(handle);return value}function failureClear(reason){var handle=this;if(handle instanceof Number)handle=+handle;clearTimeout(handle);throw reason}Promise.prototype.timeout=function(ms,message){ms=+ms;var ret=this.then().cancellable();ret._cancellationParent=this;var handle=setTimeout(function timeoutTimeout(){afterTimeout(ret,message)},ms);return ret._then(successClear,failureClear,undefined,handle,undefined)}}},{"./util.js":38}],37:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,apiRejection,tryConvertToPromise,createContext){var TypeError=_dereq_("./errors.js").TypeError;var inherits=_dereq_("./util.js").inherits;var PromiseInspection=Promise.PromiseInspection;function inspectionMapper(inspections){var len=inspections.length;for(var i=0;i<len;++i){var inspection=inspections[i];if(inspection.isRejected()){return Promise.reject(inspection.error())}inspections[i]=inspection._settledValue}return inspections}function thrower(e){setTimeout(function(){throw e},0)}function castPreservingDisposable(thenable){var maybePromise=tryConvertToPromise(thenable);if(maybePromise!==thenable&&typeof thenable._isDisposable==="function"&&typeof thenable._getDisposer==="function"&&thenable._isDisposable()){maybePromise._setDisposable(thenable._getDisposer())}return maybePromise}function dispose(resources,inspection){var i=0;var len=resources.length;var ret=Promise.defer();function iterator(){if(i>=len)return ret.resolve();var maybePromise=castPreservingDisposable(resources[i++]);if(maybePromise instanceof Promise&&maybePromise._isDisposable()){try{maybePromise=tryConvertToPromise(maybePromise._getDisposer().tryDispose(inspection),resources.promise)}catch(e){return thrower(e)}if(maybePromise instanceof Promise){return maybePromise._then(iterator,thrower,null,null,null)}}iterator()}iterator();return ret.promise}function disposerSuccess(value){var inspection=new PromiseInspection;inspection._settledValue=value;inspection._bitField=268435456;return dispose(this,inspection).thenReturn(value)}function disposerFail(reason){var inspection=new PromiseInspection;inspection._settledValue=reason;inspection._bitField=134217728;return dispose(this,inspection).thenThrow(reason)}function Disposer(data,promise,context){this._data=data;this._promise=promise;this._context=context}Disposer.prototype.data=function(){return this._data};Disposer.prototype.promise=function(){return this._promise};Disposer.prototype.resource=function(){if(this.promise().isFulfilled()){return this.promise().value()}return null};Disposer.prototype.tryDispose=function(inspection){var resource=this.resource();var context=this._context;if(context!==undefined)context._pushContext();var ret=resource!==null?this.doDispose(resource,inspection):null;if(context!==undefined)context._popContext();this._promise._unsetDisposable();this._data=null;return ret};Disposer.isDisposer=function(d){return d!=null&&typeof d.resource==="function"&&typeof d.tryDispose==="function"};function FunctionDisposer(fn,promise,context){this.constructor$(fn,promise,context)}inherits(FunctionDisposer,Disposer);FunctionDisposer.prototype.doDispose=function(resource,inspection){var fn=this.data();return fn.call(resource,resource,inspection)};function maybeUnwrapDisposer(value){if(Disposer.isDisposer(value)){this.resources[this.index]._setDisposable(value);return value.promise()}return value}Promise.using=function(){var len=arguments.length;if(len<2)return apiRejection("you must pass at least 2 arguments to Promise.using");var fn=arguments[len-1];if(typeof fn!=="function")return apiRejection("fn must be a function\n\n    See http://goo.gl/916lJJ\n");len--;var resources=new Array(len);for(var i=0;i<len;++i){var resource=arguments[i];if(Disposer.isDisposer(resource)){var disposer=resource;resource=resource.promise();resource._setDisposable(disposer)}else{var maybePromise=tryConvertToPromise(resource);if(maybePromise instanceof Promise){resource=maybePromise._then(maybeUnwrapDisposer,null,null,{resources:resources,index:i},undefined)}}resources[i]=resource}var promise=Promise.settle(resources).then(inspectionMapper).then(function(vals){promise._pushContext();var ret;try{ret=fn.apply(undefined,vals)}finally{promise._popContext()}return ret})._then(disposerSuccess,disposerFail,undefined,resources,undefined);resources.promise=promise;return promise};Promise.prototype._setDisposable=function(disposer){this._bitField=this._bitField|262144;this._disposer=disposer};Promise.prototype._isDisposable=function(){return(this._bitField&262144)>0};Promise.prototype._getDisposer=function(){return this._disposer};Promise.prototype._unsetDisposable=function(){this._bitField=this._bitField&~262144;this._disposer=undefined};Promise.prototype.disposer=function(fn){if(typeof fn==="function"){return new FunctionDisposer(fn,this,createContext())}throw new TypeError}}},{"./errors.js":13,"./util.js":38}],38:[function(_dereq_,module,exports){"use strict";var es5=_dereq_("./es5.js");var canEvaluate=typeof navigator=="undefined";var haveGetters=function(){try{var o={};es5.defineProperty(o,"f",{get:function(){return 3}});return o.f===3}catch(e){return false}}();var errorObj={e:{}};var tryCatchTarget;function tryCatcher(){try{var target=tryCatchTarget;tryCatchTarget=null;return target.apply(this,arguments)}catch(e){errorObj.e=e;return errorObj}}function tryCatch(fn){tryCatchTarget=fn;return tryCatcher}var inherits=function(Child,Parent){var hasProp={}.hasOwnProperty;function T(){this.constructor=Child;this.constructor$=Parent;for(var propertyName in Parent.prototype){if(hasProp.call(Parent.prototype,propertyName)&&propertyName.charAt(propertyName.length-1)!=="$"){this[propertyName+"$"]=Parent.prototype[propertyName]}}}T.prototype=Parent.prototype;Child.prototype=new T;return Child.prototype};function isPrimitive(val){return val==null||val===true||val===false||typeof val==="string"||typeof val==="number"}function isObject(value){return!isPrimitive(value)}function maybeWrapAsError(maybeError){if(!isPrimitive(maybeError))return maybeError;return new Error(safeToString(maybeError))}function withAppended(target,appendee){var len=target.length;var ret=new Array(len+1);var i;for(i=0;i<len;++i){ret[i]=target[i]}ret[i]=appendee;return ret}function getDataPropertyOrDefault(obj,key,defaultValue){if(es5.isES5){var desc=Object.getOwnPropertyDescriptor(obj,key);if(desc!=null){return desc.get==null&&desc.set==null?desc.value:defaultValue}}else{return{}.hasOwnProperty.call(obj,key)?obj[key]:undefined}}function notEnumerableProp(obj,name,value){if(isPrimitive(obj))return obj;var descriptor={value:value,configurable:true,enumerable:false,writable:true};es5.defineProperty(obj,name,descriptor);return obj}function thrower(r){throw r}var inheritedDataKeys=function(){var excludedPrototypes=[Array.prototype,Object.prototype,Function.prototype];var isExcludedProto=function(val){for(var i=0;i<excludedPrototypes.length;++i){if(excludedPrototypes[i]===val){return true}}return false};if(es5.isES5){var getKeys=Object.getOwnPropertyNames;return function(obj){var ret=[];var visitedKeys=Object.create(null);while(obj!=null&&!isExcludedProto(obj)){var keys;try{keys=getKeys(obj)}catch(e){return ret}for(var i=0;i<keys.length;++i){var key=keys[i];if(visitedKeys[key])continue;visitedKeys[key]=true;var desc=Object.getOwnPropertyDescriptor(obj,key);if(desc!=null&&desc.get==null&&desc.set==null){ret.push(key)}}obj=es5.getPrototypeOf(obj)}return ret}}else{var hasProp={}.hasOwnProperty;return function(obj){if(isExcludedProto(obj))return[];var ret=[];enumeration:for(var key in obj){if(hasProp.call(obj,key)){ret.push(key)}else{for(var i=0;i<excludedPrototypes.length;++i){if(hasProp.call(excludedPrototypes[i],key)){continue enumeration}}ret.push(key)}}return ret}}}();var thisAssignmentPattern=/this\s*\.\s*\S+\s*=/;function isClass(fn){try{if(typeof fn==="function"){var keys=es5.names(fn.prototype);var hasMethods=es5.isES5&&keys.length>1;var hasMethodsOtherThanConstructor=keys.length>0&&!(keys.length===1&&keys[0]==="constructor");var hasThisAssignmentAndStaticMethods=thisAssignmentPattern.test(fn+"")&&es5.names(fn).length>0;if(hasMethods||hasMethodsOtherThanConstructor||hasThisAssignmentAndStaticMethods){return true}}return false}catch(e){return false}}function toFastProperties(obj){function f(){}f.prototype=obj;var l=8;while(l--)new f;return obj;eval(obj)}var rident=/^[a-z$_][a-z$_0-9]*$/i;function isIdentifier(str){return rident.test(str)}function filledRange(count,prefix,suffix){var ret=new Array(count);for(var i=0;i<count;++i){ret[i]=prefix+i+suffix}return ret}function safeToString(obj){try{return obj+""}catch(e){return"[no string representation]"}}function markAsOriginatingFromRejection(e){try{notEnumerableProp(e,"isOperational",true)}catch(ignore){}}function originatesFromRejection(e){if(e==null)return false;return e instanceof Error["__BluebirdErrorTypes__"].OperationalError||e["isOperational"]===true}function canAttachTrace(obj){return obj instanceof Error&&es5.propertyIsWritable(obj,"stack")}var ensureErrorObject=function(){if(!("stack"in new Error)){return function(value){if(canAttachTrace(value))return value;try{throw new Error(safeToString(value))}catch(err){return err}}}else{return function(value){if(canAttachTrace(value))return value;return new Error(safeToString(value))}}}();function classString(obj){return{}.toString.call(obj)}function copyDescriptors(from,to,filter){var keys=es5.names(from);for(var i=0;i<keys.length;++i){var key=keys[i];if(filter(key)){try{es5.defineProperty(to,key,es5.getDescriptor(from,key))}catch(ignore){}}}}var ret={isClass:isClass,isIdentifier:isIdentifier,inheritedDataKeys:inheritedDataKeys,getDataPropertyOrDefault:getDataPropertyOrDefault,thrower:thrower,isArray:es5.isArray,haveGetters:haveGetters,notEnumerableProp:notEnumerableProp,isPrimitive:isPrimitive,isObject:isObject,canEvaluate:canEvaluate,errorObj:errorObj,tryCatch:tryCatch,inherits:inherits,withAppended:withAppended,maybeWrapAsError:maybeWrapAsError,toFastProperties:toFastProperties,filledRange:filledRange,toString:safeToString,canAttachTrace:canAttachTrace,ensureErrorObject:ensureErrorObject,originatesFromRejection:originatesFromRejection,markAsOriginatingFromRejection:markAsOriginatingFromRejection,classString:classString,copyDescriptors:copyDescriptors,hasDevTools:typeof chrome!=="undefined"&&chrome&&typeof chrome.loadTimes==="function",isNode:typeof process!=="undefined"&&classString(process).toLowerCase()==="[object process]"};ret.isRecentNode=ret.isNode&&function(){var version=process.versions.node.split(".").map(Number);return version[0]===0&&version[1]>10||version[0]>0}();if(ret.isNode)ret.toFastProperties(process);try{throw new Error}catch(e){ret.lastLineError=e}module.exports=ret},{"./es5.js":14}]},{},[4])(4)});if(typeof window!=="undefined"&&window!==null){window.P=window.Promise}else if(typeof self!=="undefined"&&self!==null){self.P=self.Promise}}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{_process:3}],16:[function(require,module,exports){(function(Math){var C=CryptoJS;var C_lib=C.lib;var WordArray=C_lib.WordArray;var Hasher=C_lib.Hasher;var C_algo=C.algo;var T=[];(function(){for(var i=0;i<64;i++){T[i]=Math.abs(Math.sin(i+1))*4294967296|0}})();var MD5=C_algo.MD5=Hasher.extend({_doReset:function(){this._hash=new WordArray.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(M,offset){for(var i=0;i<16;i++){var offset_i=offset+i;var M_offset_i=M[offset_i];M[offset_i]=(M_offset_i<<8|M_offset_i>>>24)&16711935|(M_offset_i<<24|M_offset_i>>>8)&4278255360}var H=this._hash.words;var M_offset_0=M[offset+0];var M_offset_1=M[offset+1];var M_offset_2=M[offset+2];var M_offset_3=M[offset+3];var M_offset_4=M[offset+4];var M_offset_5=M[offset+5];var M_offset_6=M[offset+6];var M_offset_7=M[offset+7];var M_offset_8=M[offset+8];var M_offset_9=M[offset+9];var M_offset_10=M[offset+10];var M_offset_11=M[offset+11];var M_offset_12=M[offset+12];var M_offset_13=M[offset+13];var M_offset_14=M[offset+14];var M_offset_15=M[offset+15];var a=H[0];var b=H[1];var c=H[2];var d=H[3];a=FF(a,b,c,d,M_offset_0,7,T[0]);d=FF(d,a,b,c,M_offset_1,12,T[1]);c=FF(c,d,a,b,M_offset_2,17,T[2]);b=FF(b,c,d,a,M_offset_3,22,T[3]);a=FF(a,b,c,d,M_offset_4,7,T[4]);d=FF(d,a,b,c,M_offset_5,12,T[5]);c=FF(c,d,a,b,M_offset_6,17,T[6]);b=FF(b,c,d,a,M_offset_7,22,T[7]);a=FF(a,b,c,d,M_offset_8,7,T[8]);d=FF(d,a,b,c,M_offset_9,12,T[9]);c=FF(c,d,a,b,M_offset_10,17,T[10]);b=FF(b,c,d,a,M_offset_11,22,T[11]);a=FF(a,b,c,d,M_offset_12,7,T[12]);d=FF(d,a,b,c,M_offset_13,12,T[13]);c=FF(c,d,a,b,M_offset_14,17,T[14]);b=FF(b,c,d,a,M_offset_15,22,T[15]);a=GG(a,b,c,d,M_offset_1,5,T[16]);d=GG(d,a,b,c,M_offset_6,9,T[17]);c=GG(c,d,a,b,M_offset_11,14,T[18]);b=GG(b,c,d,a,M_offset_0,20,T[19]);a=GG(a,b,c,d,M_offset_5,5,T[20]);d=GG(d,a,b,c,M_offset_10,9,T[21]);c=GG(c,d,a,b,M_offset_15,14,T[22]);b=GG(b,c,d,a,M_offset_4,20,T[23]);a=GG(a,b,c,d,M_offset_9,5,T[24]);d=GG(d,a,b,c,M_offset_14,9,T[25]);c=GG(c,d,a,b,M_offset_3,14,T[26]);b=GG(b,c,d,a,M_offset_8,20,T[27]);a=GG(a,b,c,d,M_offset_13,5,T[28]);d=GG(d,a,b,c,M_offset_2,9,T[29]);c=GG(c,d,a,b,M_offset_7,14,T[30]);b=GG(b,c,d,a,M_offset_12,20,T[31]);a=HH(a,b,c,d,M_offset_5,4,T[32]);d=HH(d,a,b,c,M_offset_8,11,T[33]);c=HH(c,d,a,b,M_offset_11,16,T[34]);b=HH(b,c,d,a,M_offset_14,23,T[35]);a=HH(a,b,c,d,M_offset_1,4,T[36]);d=HH(d,a,b,c,M_offset_4,11,T[37]);c=HH(c,d,a,b,M_offset_7,16,T[38]);b=HH(b,c,d,a,M_offset_10,23,T[39]);a=HH(a,b,c,d,M_offset_13,4,T[40]);d=HH(d,a,b,c,M_offset_0,11,T[41]);c=HH(c,d,a,b,M_offset_3,16,T[42]);b=HH(b,c,d,a,M_offset_6,23,T[43]);a=HH(a,b,c,d,M_offset_9,4,T[44]);d=HH(d,a,b,c,M_offset_12,11,T[45]);c=HH(c,d,a,b,M_offset_15,16,T[46]);b=HH(b,c,d,a,M_offset_2,23,T[47]);a=II(a,b,c,d,M_offset_0,6,T[48]);d=II(d,a,b,c,M_offset_7,10,T[49]);c=II(c,d,a,b,M_offset_14,15,T[50]);b=II(b,c,d,a,M_offset_5,21,T[51]);a=II(a,b,c,d,M_offset_12,6,T[52]);d=II(d,a,b,c,M_offset_3,10,T[53]);c=II(c,d,a,b,M_offset_10,15,T[54]);b=II(b,c,d,a,M_offset_1,21,T[55]);a=II(a,b,c,d,M_offset_8,6,T[56]);d=II(d,a,b,c,M_offset_15,10,T[57]);c=II(c,d,a,b,M_offset_6,15,T[58]);b=II(b,c,d,a,M_offset_13,21,T[59]);a=II(a,b,c,d,M_offset_4,6,T[60]);d=II(d,a,b,c,M_offset_11,10,T[61]);c=II(c,d,a,b,M_offset_2,15,T[62]);b=II(b,c,d,a,M_offset_9,21,T[63]);H[0]=H[0]+a|0;H[1]=H[1]+b|0;H[2]=H[2]+c|0;H[3]=H[3]+d|0},_doFinalize:function(){var data=this._data;var dataWords=data.words;var nBitsTotal=this._nDataBytes*8;var nBitsLeft=data.sigBytes*8;dataWords[nBitsLeft>>>5]|=128<<24-nBitsLeft%32;var nBitsTotalH=Math.floor(nBitsTotal/4294967296);var nBitsTotalL=nBitsTotal;dataWords[(nBitsLeft+64>>>9<<4)+15]=(nBitsTotalH<<8|nBitsTotalH>>>24)&16711935|(nBitsTotalH<<24|nBitsTotalH>>>8)&4278255360;dataWords[(nBitsLeft+64>>>9<<4)+14]=(nBitsTotalL<<8|nBitsTotalL>>>24)&16711935|(nBitsTotalL<<24|nBitsTotalL>>>8)&4278255360;data.sigBytes=(dataWords.length+1)*4;this._process();var hash=this._hash;var H=hash.words;for(var i=0;i<4;i++){var H_i=H[i];H[i]=(H_i<<8|H_i>>>24)&16711935|(H_i<<24|H_i>>>8)&4278255360}return hash},clone:function(){var clone=Hasher.clone.call(this);clone._hash=this._hash.clone();return clone}});function FF(a,b,c,d,x,s,t){var n=a+(b&c|~b&d)+x+t;return(n<<s|n>>>32-s)+b}function GG(a,b,c,d,x,s,t){var n=a+(b&d|c&~d)+x+t;return(n<<s|n>>>32-s)+b}function HH(a,b,c,d,x,s,t){var n=a+(b^c^d)+x+t;return(n<<s|n>>>32-s)+b}function II(a,b,c,d,x,s,t){var n=a+(c^(b|~d))+x+t;return(n<<s|n>>>32-s)+b}C.MD5=Hasher._createHelper(MD5);C.HmacMD5=Hasher._createHmacHelper(MD5)})(Math)},{}],17:[function(require,module,exports){var CryptoJS=CryptoJS||function(Math,undefined){var C={};var C_lib=C.lib={};var Base=C_lib.Base=function(){function F(){}return{extend:function(overrides){F.prototype=this;var subtype=new F;if(overrides){subtype.mixIn(overrides)}if(!subtype.hasOwnProperty("init")){subtype.init=function(){subtype.$super.init.apply(this,arguments)}}subtype.init.prototype=subtype;subtype.$super=this;return subtype},create:function(){var instance=this.extend();instance.init.apply(instance,arguments);return instance},init:function(){},mixIn:function(properties){for(var propertyName in properties){if(properties.hasOwnProperty(propertyName)){this[propertyName]=properties[propertyName]}}if(properties.hasOwnProperty("toString")){this.toString=properties.toString}},clone:function(){return this.init.prototype.extend(this)}}}();var WordArray=C_lib.WordArray=Base.extend({init:function(words,sigBytes){words=this.words=words||[];if(sigBytes!=undefined){this.sigBytes=sigBytes}else{this.sigBytes=words.length*4}},toString:function(encoder){return(encoder||Hex).stringify(this)},concat:function(wordArray){var thisWords=this.words;var thatWords=wordArray.words;var thisSigBytes=this.sigBytes;var thatSigBytes=wordArray.sigBytes;this.clamp();if(thisSigBytes%4){for(var i=0;i<thatSigBytes;i++){var thatByte=thatWords[i>>>2]>>>24-i%4*8&255;thisWords[thisSigBytes+i>>>2]|=thatByte<<24-(thisSigBytes+i)%4*8}}else if(thatWords.length>65535){for(var i=0;i<thatSigBytes;i+=4){thisWords[thisSigBytes+i>>>2]=thatWords[i>>>2]}}else{thisWords.push.apply(thisWords,thatWords)}this.sigBytes+=thatSigBytes;return this},clamp:function(){var words=this.words;var sigBytes=this.sigBytes;words[sigBytes>>>2]&=4294967295<<32-sigBytes%4*8;words.length=Math.ceil(sigBytes/4)},clone:function(){var clone=Base.clone.call(this);clone.words=this.words.slice(0);return clone},random:function(nBytes){var words=[];for(var i=0;i<nBytes;i+=4){words.push(Math.random()*4294967296|0)}return new WordArray.init(words,nBytes)}});var C_enc=C.enc={};var Hex=C_enc.Hex={stringify:function(wordArray){var words=wordArray.words;var sigBytes=wordArray.sigBytes;var hexChars=[];for(var i=0;i<sigBytes;i++){var bite=words[i>>>2]>>>24-i%4*8&255;hexChars.push((bite>>>4).toString(16));hexChars.push((bite&15).toString(16))}return hexChars.join("")},parse:function(hexStr){var hexStrLength=hexStr.length;var words=[];for(var i=0;i<hexStrLength;i+=2){words[i>>>3]|=parseInt(hexStr.substr(i,2),16)<<24-i%8*4}return new WordArray.init(words,hexStrLength/2)}};var Latin1=C_enc.Latin1={stringify:function(wordArray){var words=wordArray.words;var sigBytes=wordArray.sigBytes;var latin1Chars=[];for(var i=0;i<sigBytes;i++){var bite=words[i>>>2]>>>24-i%4*8&255;latin1Chars.push(String.fromCharCode(bite))}return latin1Chars.join("")},parse:function(latin1Str){var latin1StrLength=latin1Str.length;var words=[];for(var i=0;i<latin1StrLength;i++){words[i>>>2]|=(latin1Str.charCodeAt(i)&255)<<24-i%4*8}return new WordArray.init(words,latin1StrLength)}};var Utf8=C_enc.Utf8={stringify:function(wordArray){try{return decodeURIComponent(escape(Latin1.stringify(wordArray)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(utf8Str){return Latin1.parse(unescape(encodeURIComponent(utf8Str)))}};var BufferedBlockAlgorithm=C_lib.BufferedBlockAlgorithm=Base.extend({reset:function(){this._data=new WordArray.init;this._nDataBytes=0},_append:function(data){if(typeof data=="string"){data=Utf8.parse(data)}this._data.concat(data);this._nDataBytes+=data.sigBytes},_process:function(doFlush){var data=this._data;var dataWords=data.words;var dataSigBytes=data.sigBytes;var blockSize=this.blockSize;var blockSizeBytes=blockSize*4;var nBlocksReady=dataSigBytes/blockSizeBytes;if(doFlush){nBlocksReady=Math.ceil(nBlocksReady)}else{nBlocksReady=Math.max((nBlocksReady|0)-this._minBufferSize,0)}var nWordsReady=nBlocksReady*blockSize;var nBytesReady=Math.min(nWordsReady*4,dataSigBytes);if(nWordsReady){for(var offset=0;offset<nWordsReady;offset+=blockSize){this._doProcessBlock(dataWords,offset)}var processedWords=dataWords.splice(0,nWordsReady);data.sigBytes-=nBytesReady}return new WordArray.init(processedWords,nBytesReady)},clone:function(){var clone=Base.clone.call(this);clone._data=this._data.clone();return clone},_minBufferSize:0});var Hasher=C_lib.Hasher=BufferedBlockAlgorithm.extend({cfg:Base.extend(),init:function(cfg){this.cfg=this.cfg.extend(cfg);this.reset()},reset:function(){BufferedBlockAlgorithm.reset.call(this);this._doReset()},update:function(messageUpdate){this._append(messageUpdate);this._process();return this},finalize:function(messageUpdate){if(messageUpdate){this._append(messageUpdate)}var hash=this._doFinalize();return hash},blockSize:512/32,_createHelper:function(hasher){return function(message,cfg){return new hasher.init(cfg).finalize(message)}},_createHmacHelper:function(hasher){return function(message,key){return new C_algo.HMAC.init(hasher,key).finalize(message)}}});var C_algo=C.algo={};return C}(Math);module.exports=CryptoJS},{}],18:[function(require,module,exports){"use strict";var _interopRequireWildcard=function(obj){return obj&&obj.__esModule?obj:{"default":obj}};exports.__esModule=true;var _runtime=require("./handlebars.runtime");var _runtime2=_interopRequireWildcard(_runtime);var _AST=require("./handlebars/compiler/ast");var _AST2=_interopRequireWildcard(_AST);var _Parser$parse=require("./handlebars/compiler/base");var _Compiler$compile$precompile=require("./handlebars/compiler/compiler");var _JavaScriptCompiler=require("./handlebars/compiler/javascript-compiler");var _JavaScriptCompiler2=_interopRequireWildcard(_JavaScriptCompiler);var _Visitor=require("./handlebars/compiler/visitor");var _Visitor2=_interopRequireWildcard(_Visitor);var _noConflict=require("./handlebars/no-conflict");var _noConflict2=_interopRequireWildcard(_noConflict);var _create=_runtime2["default"].create;function create(){var hb=_create();hb.compile=function(input,options){return _Compiler$compile$precompile.compile(input,options,hb)};hb.precompile=function(input,options){return _Compiler$compile$precompile.precompile(input,options,hb)};hb.AST=_AST2["default"];hb.Compiler=_Compiler$compile$precompile.Compiler;hb.JavaScriptCompiler=_JavaScriptCompiler2["default"];hb.Parser=_Parser$parse.parser;hb.parse=_Parser$parse.parse;return hb}var inst=create();inst.create=create;_noConflict2["default"](inst);inst.Visitor=_Visitor2["default"];inst["default"]=inst;exports["default"]=inst;module.exports=exports["default"]},{"./handlebars.runtime":19,"./handlebars/compiler/ast":21,"./handlebars/compiler/base":22,"./handlebars/compiler/compiler":24,"./handlebars/compiler/javascript-compiler":26,"./handlebars/compiler/visitor":29,"./handlebars/no-conflict":32}],19:[function(require,module,exports){"use strict";var _interopRequireWildcard=function(obj){return obj&&obj.__esModule?obj:{"default":obj}};exports.__esModule=true;var _import=require("./handlebars/base");var base=_interopRequireWildcard(_import);var _SafeString=require("./handlebars/safe-string");var _SafeString2=_interopRequireWildcard(_SafeString);var _Exception=require("./handlebars/exception");var _Exception2=_interopRequireWildcard(_Exception);var _import2=require("./handlebars/utils");var Utils=_interopRequireWildcard(_import2);var _import3=require("./handlebars/runtime");var runtime=_interopRequireWildcard(_import3);var _noConflict=require("./handlebars/no-conflict");var _noConflict2=_interopRequireWildcard(_noConflict);function create(){var hb=new base.HandlebarsEnvironment;Utils.extend(hb,base);hb.SafeString=_SafeString2["default"];hb.Exception=_Exception2["default"];hb.Utils=Utils;hb.escapeExpression=Utils.escapeExpression;hb.VM=runtime;hb.template=function(spec){return runtime.template(spec,hb)};return hb}var inst=create();inst.create=create;_noConflict2["default"](inst);inst["default"]=inst;exports["default"]=inst;module.exports=exports["default"]},{"./handlebars/base":20,"./handlebars/exception":31,"./handlebars/no-conflict":32,"./handlebars/runtime":33,"./handlebars/safe-string":34,"./handlebars/utils":35}],20:[function(require,module,exports){"use strict";var _interopRequireWildcard=function(obj){return obj&&obj.__esModule?obj:{"default":obj}};exports.__esModule=true;exports.HandlebarsEnvironment=HandlebarsEnvironment;exports.createFrame=createFrame;var _import=require("./utils");var Utils=_interopRequireWildcard(_import);var _Exception=require("./exception");var _Exception2=_interopRequireWildcard(_Exception);var VERSION="3.0.1";exports.VERSION=VERSION;var COMPILER_REVISION=6;exports.COMPILER_REVISION=COMPILER_REVISION;var REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};exports.REVISION_CHANGES=REVISION_CHANGES;var isArray=Utils.isArray,isFunction=Utils.isFunction,toString=Utils.toString,objectType="[object Object]";function HandlebarsEnvironment(helpers,partials){this.helpers=helpers||{};this.partials=partials||{};registerDefaultHelpers(this)}HandlebarsEnvironment.prototype={constructor:HandlebarsEnvironment,logger:logger,log:log,registerHelper:function registerHelper(name,fn){if(toString.call(name)===objectType){if(fn){throw new _Exception2["default"]("Arg not supported with multiple helpers")}Utils.extend(this.helpers,name)}else{this.helpers[name]=fn}},unregisterHelper:function unregisterHelper(name){delete this.helpers[name]},registerPartial:function registerPartial(name,partial){if(toString.call(name)===objectType){Utils.extend(this.partials,name)}else{if(typeof partial==="undefined"){throw new _Exception2["default"]("Attempting to register a partial as undefined")}this.partials[name]=partial}},unregisterPartial:function unregisterPartial(name){delete this.partials[name]}};function registerDefaultHelpers(instance){instance.registerHelper("helperMissing",function(){if(arguments.length===1){return undefined}else{throw new _Exception2["default"]('Missing helper: "'+arguments[arguments.length-1].name+'"')}});instance.registerHelper("blockHelperMissing",function(context,options){var inverse=options.inverse,fn=options.fn;if(context===true){return fn(this)}else if(context===false||context==null){return inverse(this)}else if(isArray(context)){if(context.length>0){if(options.ids){options.ids=[options.name]}return instance.helpers.each(context,options)}else{return inverse(this)}}else{if(options.data&&options.ids){var data=createFrame(options.data);data.contextPath=Utils.appendContextPath(options.data.contextPath,options.name);options={data:data}}return fn(context,options)}});instance.registerHelper("each",function(context,options){if(!options){throw new _Exception2["default"]("Must pass iterator to #each")}var fn=options.fn,inverse=options.inverse,i=0,ret="",data=undefined,contextPath=undefined;if(options.data&&options.ids){contextPath=Utils.appendContextPath(options.data.contextPath,options.ids[0])+"."}if(isFunction(context)){context=context.call(this)}if(options.data){data=createFrame(options.data)}function execIteration(field,index,last){if(data){data.key=field;data.index=index;data.first=index===0;data.last=!!last;if(contextPath){data.contextPath=contextPath+field}}ret=ret+fn(context[field],{data:data,blockParams:Utils.blockParams([context[field],field],[contextPath+field,null])})}if(context&&typeof context==="object"){if(isArray(context)){for(var j=context.length;i<j;i++){execIteration(i,i,i===context.length-1)}}else{var priorKey=undefined;for(var key in context){if(context.hasOwnProperty(key)){if(priorKey){execIteration(priorKey,i-1)}priorKey=key;i++}}if(priorKey){execIteration(priorKey,i-1,true)}}}if(i===0){ret=inverse(this)}return ret});instance.registerHelper("if",function(conditional,options){if(isFunction(conditional)){conditional=conditional.call(this)}if(!options.hash.includeZero&&!conditional||Utils.isEmpty(conditional)){return options.inverse(this)}else{return options.fn(this)}});instance.registerHelper("unless",function(conditional,options){return instance.helpers["if"].call(this,conditional,{fn:options.inverse,inverse:options.fn,hash:options.hash})});instance.registerHelper("with",function(context,options){if(isFunction(context)){context=context.call(this)}var fn=options.fn;if(!Utils.isEmpty(context)){if(options.data&&options.ids){var data=createFrame(options.data);data.contextPath=Utils.appendContextPath(options.data.contextPath,options.ids[0]);options={data:data}}return fn(context,options)}else{return options.inverse(this)}});instance.registerHelper("log",function(message,options){var level=options.data&&options.data.level!=null?parseInt(options.data.level,10):1;instance.log(level,message)});instance.registerHelper("lookup",function(obj,field){return obj&&obj[field]})}var logger={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:1,log:function log(level,message){if(typeof console!=="undefined"&&logger.level<=level){var method=logger.methodMap[level];(console[method]||console.log).call(console,message)}}};exports.logger=logger;var log=logger.log;exports.log=log;function createFrame(object){var frame=Utils.extend({},object);frame._parent=object;
return frame}},{"./exception":31,"./utils":35}],21:[function(require,module,exports){"use strict";exports.__esModule=true;var AST={Program:function Program(statements,blockParams,strip,locInfo){this.loc=locInfo;this.type="Program";this.body=statements;this.blockParams=blockParams;this.strip=strip},MustacheStatement:function MustacheStatement(path,params,hash,escaped,strip,locInfo){this.loc=locInfo;this.type="MustacheStatement";this.path=path;this.params=params||[];this.hash=hash;this.escaped=escaped;this.strip=strip},BlockStatement:function BlockStatement(path,params,hash,program,inverse,openStrip,inverseStrip,closeStrip,locInfo){this.loc=locInfo;this.type="BlockStatement";this.path=path;this.params=params||[];this.hash=hash;this.program=program;this.inverse=inverse;this.openStrip=openStrip;this.inverseStrip=inverseStrip;this.closeStrip=closeStrip},PartialStatement:function PartialStatement(name,params,hash,strip,locInfo){this.loc=locInfo;this.type="PartialStatement";this.name=name;this.params=params||[];this.hash=hash;this.indent="";this.strip=strip},ContentStatement:function ContentStatement(string,locInfo){this.loc=locInfo;this.type="ContentStatement";this.original=this.value=string},CommentStatement:function CommentStatement(comment,strip,locInfo){this.loc=locInfo;this.type="CommentStatement";this.value=comment;this.strip=strip},SubExpression:function SubExpression(path,params,hash,locInfo){this.loc=locInfo;this.type="SubExpression";this.path=path;this.params=params||[];this.hash=hash},PathExpression:function PathExpression(data,depth,parts,original,locInfo){this.loc=locInfo;this.type="PathExpression";this.data=data;this.original=original;this.parts=parts;this.depth=depth},StringLiteral:function StringLiteral(string,locInfo){this.loc=locInfo;this.type="StringLiteral";this.original=this.value=string},NumberLiteral:function NumberLiteral(number,locInfo){this.loc=locInfo;this.type="NumberLiteral";this.original=this.value=Number(number)},BooleanLiteral:function BooleanLiteral(bool,locInfo){this.loc=locInfo;this.type="BooleanLiteral";this.original=this.value=bool==="true"},UndefinedLiteral:function UndefinedLiteral(locInfo){this.loc=locInfo;this.type="UndefinedLiteral";this.original=this.value=undefined},NullLiteral:function NullLiteral(locInfo){this.loc=locInfo;this.type="NullLiteral";this.original=this.value=null},Hash:function Hash(pairs,locInfo){this.loc=locInfo;this.type="Hash";this.pairs=pairs},HashPair:function HashPair(key,value,locInfo){this.loc=locInfo;this.type="HashPair";this.key=key;this.value=value},helpers:{helperExpression:function helperExpression(node){return!!(node.type==="SubExpression"||node.params.length||node.hash)},scopedId:function scopedId(path){return/^\.|this\b/.test(path.original)},simpleId:function simpleId(path){return path.parts.length===1&&!AST.helpers.scopedId(path)&&!path.depth}}};exports["default"]=AST;module.exports=exports["default"]},{}],22:[function(require,module,exports){"use strict";var _interopRequireWildcard=function(obj){return obj&&obj.__esModule?obj:{"default":obj}};exports.__esModule=true;exports.parse=parse;var _parser=require("./parser");var _parser2=_interopRequireWildcard(_parser);var _AST=require("./ast");var _AST2=_interopRequireWildcard(_AST);var _WhitespaceControl=require("./whitespace-control");var _WhitespaceControl2=_interopRequireWildcard(_WhitespaceControl);var _import=require("./helpers");var Helpers=_interopRequireWildcard(_import);var _extend=require("../utils");exports.parser=_parser2["default"];var yy={};_extend.extend(yy,Helpers,_AST2["default"]);function parse(input,options){if(input.type==="Program"){return input}_parser2["default"].yy=yy;yy.locInfo=function(locInfo){return new yy.SourceLocation(options&&options.srcName,locInfo)};var strip=new _WhitespaceControl2["default"];return strip.accept(_parser2["default"].parse(input))}},{"../utils":35,"./ast":21,"./helpers":25,"./parser":27,"./whitespace-control":30}],23:[function(require,module,exports){"use strict";exports.__esModule=true;var _isArray=require("../utils");var SourceNode=undefined;try{if(typeof define!=="function"||!define.amd){var SourceMap=require("source-map");SourceNode=SourceMap.SourceNode}}catch(err){}if(!SourceNode){SourceNode=function(line,column,srcFile,chunks){this.src="";if(chunks){this.add(chunks)}};SourceNode.prototype={add:function add(chunks){if(_isArray.isArray(chunks)){chunks=chunks.join("")}this.src+=chunks},prepend:function prepend(chunks){if(_isArray.isArray(chunks)){chunks=chunks.join("")}this.src=chunks+this.src},toStringWithSourceMap:function toStringWithSourceMap(){return{code:this.toString()}},toString:function toString(){return this.src}}}function castChunk(chunk,codeGen,loc){if(_isArray.isArray(chunk)){var ret=[];for(var i=0,len=chunk.length;i<len;i++){ret.push(codeGen.wrap(chunk[i],loc))}return ret}else if(typeof chunk==="boolean"||typeof chunk==="number"){return chunk+""}return chunk}function CodeGen(srcFile){this.srcFile=srcFile;this.source=[]}CodeGen.prototype={prepend:function prepend(source,loc){this.source.unshift(this.wrap(source,loc))},push:function push(source,loc){this.source.push(this.wrap(source,loc))},merge:function merge(){var source=this.empty();this.each(function(line){source.add(["  ",line,"\n"])});return source},each:function each(iter){for(var i=0,len=this.source.length;i<len;i++){iter(this.source[i])}},empty:function empty(){var loc=arguments[0]===undefined?this.currentLocation||{start:{}}:arguments[0];return new SourceNode(loc.start.line,loc.start.column,this.srcFile)},wrap:function wrap(chunk){var loc=arguments[1]===undefined?this.currentLocation||{start:{}}:arguments[1];if(chunk instanceof SourceNode){return chunk}chunk=castChunk(chunk,this,loc);return new SourceNode(loc.start.line,loc.start.column,this.srcFile,chunk)},functionCall:function functionCall(fn,type,params){params=this.generateList(params);return this.wrap([fn,type?"."+type+"(":"(",params,")"])},quotedString:function quotedString(str){return'"'+(str+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function objectLiteral(obj){var pairs=[];for(var key in obj){if(obj.hasOwnProperty(key)){var value=castChunk(obj[key],this);if(value!=="undefined"){pairs.push([this.quotedString(key),":",value])}}}var ret=this.generateList(pairs);ret.prepend("{");ret.add("}");return ret},generateList:function generateList(entries,loc){var ret=this.empty(loc);for(var i=0,len=entries.length;i<len;i++){if(i){ret.add(",")}ret.add(castChunk(entries[i],this,loc))}return ret},generateArray:function generateArray(entries,loc){var ret=this.generateList(entries,loc);ret.prepend("[");ret.add("]");return ret}};exports["default"]=CodeGen;module.exports=exports["default"]},{"../utils":35,"source-map":37}],24:[function(require,module,exports){"use strict";var _interopRequireWildcard=function(obj){return obj&&obj.__esModule?obj:{"default":obj}};exports.__esModule=true;exports.Compiler=Compiler;exports.precompile=precompile;exports.compile=compile;var _Exception=require("../exception");var _Exception2=_interopRequireWildcard(_Exception);var _isArray$indexOf=require("../utils");var _AST=require("./ast");var _AST2=_interopRequireWildcard(_AST);var slice=[].slice;function Compiler(){}Compiler.prototype={compiler:Compiler,equals:function equals(other){var len=this.opcodes.length;if(other.opcodes.length!==len){return false}for(var i=0;i<len;i++){var opcode=this.opcodes[i],otherOpcode=other.opcodes[i];if(opcode.opcode!==otherOpcode.opcode||!argEquals(opcode.args,otherOpcode.args)){return false}}len=this.children.length;for(var i=0;i<len;i++){if(!this.children[i].equals(other.children[i])){return false}}return true},guid:0,compile:function compile(program,options){this.sourceNode=[];this.opcodes=[];this.children=[];this.options=options;this.stringParams=options.stringParams;this.trackIds=options.trackIds;options.blockParams=options.blockParams||[];var knownHelpers=options.knownHelpers;options.knownHelpers={helperMissing:true,blockHelperMissing:true,each:true,"if":true,unless:true,"with":true,log:true,lookup:true};if(knownHelpers){for(var _name in knownHelpers){if(_name in knownHelpers){options.knownHelpers[_name]=knownHelpers[_name]}}}return this.accept(program)},compileProgram:function compileProgram(program){var childCompiler=new this.compiler,result=childCompiler.compile(program,this.options),guid=this.guid++;this.usePartial=this.usePartial||result.usePartial;this.children[guid]=result;this.useDepths=this.useDepths||result.useDepths;return guid},accept:function accept(node){this.sourceNode.unshift(node);var ret=this[node.type](node);this.sourceNode.shift();return ret},Program:function Program(program){this.options.blockParams.unshift(program.blockParams);var body=program.body,bodyLength=body.length;for(var i=0;i<bodyLength;i++){this.accept(body[i])}this.options.blockParams.shift();this.isSimple=bodyLength===1;this.blockParams=program.blockParams?program.blockParams.length:0;return this},BlockStatement:function BlockStatement(block){transformLiteralToPath(block);var program=block.program,inverse=block.inverse;program=program&&this.compileProgram(program);inverse=inverse&&this.compileProgram(inverse);var type=this.classifySexpr(block);if(type==="helper"){this.helperSexpr(block,program,inverse)}else if(type==="simple"){this.simpleSexpr(block);this.opcode("pushProgram",program);this.opcode("pushProgram",inverse);this.opcode("emptyHash");this.opcode("blockValue",block.path.original)}else{this.ambiguousSexpr(block,program,inverse);this.opcode("pushProgram",program);this.opcode("pushProgram",inverse);this.opcode("emptyHash");this.opcode("ambiguousBlockValue")}this.opcode("append")},PartialStatement:function PartialStatement(partial){this.usePartial=true;var params=partial.params;if(params.length>1){throw new _Exception2["default"]("Unsupported number of partial arguments: "+params.length,partial)}else if(!params.length){params.push({type:"PathExpression",parts:[],depth:0})}var partialName=partial.name.original,isDynamic=partial.name.type==="SubExpression";if(isDynamic){this.accept(partial.name)}this.setupFullMustacheParams(partial,undefined,undefined,true);var indent=partial.indent||"";if(this.options.preventIndent&&indent){this.opcode("appendContent",indent);indent=""}this.opcode("invokePartial",isDynamic,partialName,indent);this.opcode("append")},MustacheStatement:function MustacheStatement(mustache){this.SubExpression(mustache);if(mustache.escaped&&!this.options.noEscape){this.opcode("appendEscaped")}else{this.opcode("append")}},ContentStatement:function ContentStatement(content){if(content.value){this.opcode("appendContent",content.value)}},CommentStatement:function CommentStatement(){},SubExpression:function SubExpression(sexpr){transformLiteralToPath(sexpr);var type=this.classifySexpr(sexpr);if(type==="simple"){this.simpleSexpr(sexpr)}else if(type==="helper"){this.helperSexpr(sexpr)}else{this.ambiguousSexpr(sexpr)}},ambiguousSexpr:function ambiguousSexpr(sexpr,program,inverse){var path=sexpr.path,name=path.parts[0],isBlock=program!=null||inverse!=null;this.opcode("getContext",path.depth);this.opcode("pushProgram",program);this.opcode("pushProgram",inverse);this.accept(path);this.opcode("invokeAmbiguous",name,isBlock)},simpleSexpr:function simpleSexpr(sexpr){this.accept(sexpr.path);this.opcode("resolvePossibleLambda")},helperSexpr:function helperSexpr(sexpr,program,inverse){var params=this.setupFullMustacheParams(sexpr,program,inverse),path=sexpr.path,name=path.parts[0];if(this.options.knownHelpers[name]){this.opcode("invokeKnownHelper",params.length,name)}else if(this.options.knownHelpersOnly){throw new _Exception2["default"]("You specified knownHelpersOnly, but used the unknown helper "+name,sexpr)}else{path.falsy=true;this.accept(path);this.opcode("invokeHelper",params.length,path.original,_AST2["default"].helpers.simpleId(path))}},PathExpression:function PathExpression(path){this.addDepth(path.depth);this.opcode("getContext",path.depth);var name=path.parts[0],scoped=_AST2["default"].helpers.scopedId(path),blockParamId=!path.depth&&!scoped&&this.blockParamIndex(name);if(blockParamId){this.opcode("lookupBlockParam",blockParamId,path.parts)}else if(!name){this.opcode("pushContext")}else if(path.data){this.options.data=true;this.opcode("lookupData",path.depth,path.parts)}else{this.opcode("lookupOnContext",path.parts,path.falsy,scoped)}},StringLiteral:function StringLiteral(string){this.opcode("pushString",string.value)},NumberLiteral:function NumberLiteral(number){this.opcode("pushLiteral",number.value)},BooleanLiteral:function BooleanLiteral(bool){this.opcode("pushLiteral",bool.value)},UndefinedLiteral:function UndefinedLiteral(){this.opcode("pushLiteral","undefined")},NullLiteral:function NullLiteral(){this.opcode("pushLiteral","null")},Hash:function Hash(hash){var pairs=hash.pairs,i=0,l=pairs.length;this.opcode("pushHash");for(;i<l;i++){this.pushParam(pairs[i].value)}while(i--){this.opcode("assignToHash",pairs[i].key)}this.opcode("popHash")},opcode:function opcode(name){this.opcodes.push({opcode:name,args:slice.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function addDepth(depth){if(!depth){return}this.useDepths=true},classifySexpr:function classifySexpr(sexpr){var isSimple=_AST2["default"].helpers.simpleId(sexpr.path);var isBlockParam=isSimple&&!!this.blockParamIndex(sexpr.path.parts[0]);var isHelper=!isBlockParam&&_AST2["default"].helpers.helperExpression(sexpr);var isEligible=!isBlockParam&&(isHelper||isSimple);if(isEligible&&!isHelper){var _name2=sexpr.path.parts[0],options=this.options;if(options.knownHelpers[_name2]){isHelper=true}else if(options.knownHelpersOnly){isEligible=false}}if(isHelper){return"helper"}else if(isEligible){return"ambiguous"}else{return"simple"}},pushParams:function pushParams(params){for(var i=0,l=params.length;i<l;i++){this.pushParam(params[i])}},pushParam:function pushParam(val){var value=val.value!=null?val.value:val.original||"";if(this.stringParams){if(value.replace){value=value.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")}if(val.depth){this.addDepth(val.depth)}this.opcode("getContext",val.depth||0);this.opcode("pushStringParam",value,val.type);if(val.type==="SubExpression"){this.accept(val)}}else{if(this.trackIds){var blockParamIndex=undefined;if(val.parts&&!_AST2["default"].helpers.scopedId(val)&&!val.depth){blockParamIndex=this.blockParamIndex(val.parts[0])}if(blockParamIndex){var blockParamChild=val.parts.slice(1).join(".");this.opcode("pushId","BlockParam",blockParamIndex,blockParamChild)}else{value=val.original||value;if(value.replace){value=value.replace(/^\.\//g,"").replace(/^\.$/g,"")}this.opcode("pushId",val.type,value)}}this.accept(val)}},setupFullMustacheParams:function setupFullMustacheParams(sexpr,program,inverse,omitEmpty){var params=sexpr.params;this.pushParams(params);this.opcode("pushProgram",program);this.opcode("pushProgram",inverse);if(sexpr.hash){this.accept(sexpr.hash)}else{this.opcode("emptyHash",omitEmpty)}return params},blockParamIndex:function blockParamIndex(name){for(var depth=0,len=this.options.blockParams.length;depth<len;depth++){var blockParams=this.options.blockParams[depth],param=blockParams&&_isArray$indexOf.indexOf(blockParams,name);if(blockParams&&param>=0){return[depth,param]}}}};function precompile(input,options,env){if(input==null||typeof input!=="string"&&input.type!=="Program"){throw new _Exception2["default"]("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+input)}options=options||{};if(!("data"in options)){options.data=true}if(options.compat){options.useDepths=true}var ast=env.parse(input,options),environment=(new env.Compiler).compile(ast,options);return(new env.JavaScriptCompiler).compile(environment,options)}function compile(input,_x,env){var options=arguments[1]===undefined?{}:arguments[1];if(input==null||typeof input!=="string"&&input.type!=="Program"){throw new _Exception2["default"]("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+input)}if(!("data"in options)){options.data=true}if(options.compat){options.useDepths=true}var compiled=undefined;function compileInput(){var ast=env.parse(input,options),environment=(new env.Compiler).compile(ast,options),templateSpec=(new env.JavaScriptCompiler).compile(environment,options,undefined,true);return env.template(templateSpec)}function ret(context,execOptions){if(!compiled){compiled=compileInput()}return compiled.call(this,context,execOptions)}ret._setup=function(setupOptions){if(!compiled){compiled=compileInput()}return compiled._setup(setupOptions)};ret._child=function(i,data,blockParams,depths){if(!compiled){compiled=compileInput()}return compiled._child(i,data,blockParams,depths)};return ret}function argEquals(a,b){if(a===b){return true}if(_isArray$indexOf.isArray(a)&&_isArray$indexOf.isArray(b)&&a.length===b.length){for(var i=0;i<a.length;i++){if(!argEquals(a[i],b[i])){return false}}return true}}function transformLiteralToPath(sexpr){if(!sexpr.path.parts){var literal=sexpr.path;sexpr.path=new _AST2["default"].PathExpression(false,0,[literal.original+""],literal.original+"",literal.loc)}}},{"../exception":31,"../utils":35,"./ast":21}],25:[function(require,module,exports){"use strict";var _interopRequireWildcard=function(obj){return obj&&obj.__esModule?obj:{"default":obj}};exports.__esModule=true;exports.SourceLocation=SourceLocation;exports.id=id;exports.stripFlags=stripFlags;exports.stripComment=stripComment;exports.preparePath=preparePath;exports.prepareMustache=prepareMustache;exports.prepareRawBlock=prepareRawBlock;exports.prepareBlock=prepareBlock;var _Exception=require("../exception");var _Exception2=_interopRequireWildcard(_Exception);function SourceLocation(source,locInfo){this.source=source;this.start={line:locInfo.first_line,column:locInfo.first_column};this.end={line:locInfo.last_line,column:locInfo.last_column}}function id(token){if(/^\[.*\]$/.test(token)){return token.substr(1,token.length-2)}else{return token}}function stripFlags(open,close){return{open:open.charAt(2)==="~",close:close.charAt(close.length-3)==="~"}}function stripComment(comment){return comment.replace(/^\{\{~?\!-?-?/,"").replace(/-?-?~?\}\}$/,"")}function preparePath(data,parts,locInfo){locInfo=this.locInfo(locInfo);var original=data?"@":"",dig=[],depth=0,depthString="";for(var i=0,l=parts.length;i<l;i++){var part=parts[i].part,isLiteral=parts[i].original!==part;original+=(parts[i].separator||"")+part;if(!isLiteral&&(part===".."||part==="."||part==="this")){if(dig.length>0){throw new _Exception2["default"]("Invalid path: "+original,{loc:locInfo})}else if(part===".."){depth++;depthString+="../"}}else{dig.push(part)}}return new this.PathExpression(data,depth,dig,original,locInfo)}function prepareMustache(path,params,hash,open,strip,locInfo){var escapeFlag=open.charAt(3)||open.charAt(2),escaped=escapeFlag!=="{"&&escapeFlag!=="&";return new this.MustacheStatement(path,params,hash,escaped,strip,this.locInfo(locInfo))}function prepareRawBlock(openRawBlock,content,close,locInfo){if(openRawBlock.path.original!==close){var errorNode={loc:openRawBlock.path.loc};throw new _Exception2["default"](openRawBlock.path.original+" doesn't match "+close,errorNode)}locInfo=this.locInfo(locInfo);var program=new this.Program([content],null,{},locInfo);return new this.BlockStatement(openRawBlock.path,openRawBlock.params,openRawBlock.hash,program,undefined,{},{},{},locInfo)}function prepareBlock(openBlock,program,inverseAndProgram,close,inverted,locInfo){if(close&&close.path&&openBlock.path.original!==close.path.original){var errorNode={loc:openBlock.path.loc};throw new _Exception2["default"](openBlock.path.original+" doesn't match "+close.path.original,errorNode)}program.blockParams=openBlock.blockParams;var inverse=undefined,inverseStrip=undefined;if(inverseAndProgram){if(inverseAndProgram.chain){inverseAndProgram.program.body[0].closeStrip=close.strip}inverseStrip=inverseAndProgram.strip;inverse=inverseAndProgram.program}if(inverted){inverted=inverse;inverse=program;program=inverted}return new this.BlockStatement(openBlock.path,openBlock.params,openBlock.hash,program,inverse,openBlock.strip,inverseStrip,close&&close.strip,this.locInfo(locInfo))}},{"../exception":31}],26:[function(require,module,exports){"use strict";var _interopRequireWildcard=function(obj){return obj&&obj.__esModule?obj:{"default":obj}};exports.__esModule=true;var _COMPILER_REVISION$REVISION_CHANGES=require("../base");var _Exception=require("../exception");var _Exception2=_interopRequireWildcard(_Exception);var _isArray=require("../utils");var _CodeGen=require("./code-gen");var _CodeGen2=_interopRequireWildcard(_CodeGen);function Literal(value){this.value=value}function JavaScriptCompiler(){}JavaScriptCompiler.prototype={nameLookup:function nameLookup(parent,name){if(JavaScriptCompiler.isValidJavaScriptVariableName(name)){return[parent,".",name]}else{return[parent,"['",name,"']"]}},depthedLookup:function depthedLookup(name){return[this.aliasable("this.lookup"),'(depths, "',name,'")']},compilerInfo:function compilerInfo(){var revision=_COMPILER_REVISION$REVISION_CHANGES.COMPILER_REVISION,versions=_COMPILER_REVISION$REVISION_CHANGES.REVISION_CHANGES[revision];return[revision,versions]},appendToBuffer:function appendToBuffer(source,location,explicit){if(!_isArray.isArray(source)){source=[source]}source=this.source.wrap(source,location);if(this.environment.isSimple){return["return ",source,";"]}else if(explicit){return["buffer += ",source,";"]}else{source.appendToBuffer=true;return source}},initializeBuffer:function initializeBuffer(){return this.quotedString("")},compile:function compile(environment,options,context,asObject){this.environment=environment;this.options=options;this.stringParams=this.options.stringParams;this.trackIds=this.options.trackIds;this.precompile=!asObject;this.name=this.environment.name;this.isChild=!!context;this.context=context||{programs:[],environments:[]};this.preamble();this.stackSlot=0;this.stackVars=[];this.aliases={};this.registers={list:[]};this.hashes=[];this.compileStack=[];this.inlineStack=[];this.blockParams=[];this.compileChildren(environment,options);this.useDepths=this.useDepths||environment.useDepths||this.options.compat;this.useBlockParams=this.useBlockParams||environment.useBlockParams;var opcodes=environment.opcodes,opcode=undefined,firstLoc=undefined,i=undefined,l=undefined;for(i=0,l=opcodes.length;i<l;i++){opcode=opcodes[i];this.source.currentLocation=opcode.loc;firstLoc=firstLoc||opcode.loc;this[opcode.opcode].apply(this,opcode.args)}this.source.currentLocation=firstLoc;this.pushSource("");if(this.stackSlot||this.inlineStack.length||this.compileStack.length){throw new _Exception2["default"]("Compile completed with content left on stack")}var fn=this.createFunctionContext(asObject);if(!this.isChild){var ret={compiler:this.compilerInfo(),main:fn};var programs=this.context.programs;for(i=0,l=programs.length;i<l;i++){if(programs[i]){ret[i]=programs[i]}}if(this.environment.usePartial){ret.usePartial=true}if(this.options.data){ret.useData=true}if(this.useDepths){ret.useDepths=true}if(this.useBlockParams){ret.useBlockParams=true}if(this.options.compat){ret.compat=true}if(!asObject){ret.compiler=JSON.stringify(ret.compiler);this.source.currentLocation={start:{line:1,column:0}};ret=this.objectLiteral(ret);if(options.srcName){ret=ret.toStringWithSourceMap({file:options.destName});ret.map=ret.map&&ret.map.toString()}else{ret=ret.toString()}}else{ret.compilerOptions=this.options}return ret}else{return fn}},preamble:function preamble(){this.lastContext=0;this.source=new _CodeGen2["default"](this.options.srcName)},createFunctionContext:function createFunctionContext(asObject){var varDeclarations="";var locals=this.stackVars.concat(this.registers.list);if(locals.length>0){varDeclarations+=", "+locals.join(", ")}var aliasCount=0;for(var alias in this.aliases){var node=this.aliases[alias];if(this.aliases.hasOwnProperty(alias)&&node.children&&node.referenceCount>1){varDeclarations+=", alias"+ ++aliasCount+"="+alias;node.children[0]="alias"+aliasCount}}var params=["depth0","helpers","partials","data"];if(this.useBlockParams||this.useDepths){params.push("blockParams")}if(this.useDepths){params.push("depths")}var source=this.mergeSource(varDeclarations);if(asObject){params.push(source);return Function.apply(this,params)}else{return this.source.wrap(["function(",params.join(","),") {\n  ",source,"}"])}},mergeSource:function mergeSource(varDeclarations){var isSimple=this.environment.isSimple,appendOnly=!this.forceBuffer,appendFirst=undefined,sourceSeen=undefined,bufferStart=undefined,bufferEnd=undefined;this.source.each(function(line){if(line.appendToBuffer){if(bufferStart){line.prepend("  + ")}else{bufferStart=line}bufferEnd=line}else{if(bufferStart){if(!sourceSeen){appendFirst=true}else{bufferStart.prepend("buffer += ")}bufferEnd.add(";");bufferStart=bufferEnd=undefined}sourceSeen=true;if(!isSimple){appendOnly=false}}});if(appendOnly){if(bufferStart){bufferStart.prepend("return ");bufferEnd.add(";")}else if(!sourceSeen){this.source.push('return "";')}}else{varDeclarations+=", buffer = "+(appendFirst?"":this.initializeBuffer());if(bufferStart){bufferStart.prepend("return buffer + ");bufferEnd.add(";")}else{this.source.push("return buffer;")}}if(varDeclarations){this.source.prepend("var "+varDeclarations.substring(2)+(appendFirst?"":";\n"))}return this.source.merge()},blockValue:function blockValue(name){var blockHelperMissing=this.aliasable("helpers.blockHelperMissing"),params=[this.contextName(0)];this.setupHelperArgs(name,0,params);var blockName=this.popStack();params.splice(1,0,blockName);this.push(this.source.functionCall(blockHelperMissing,"call",params))},ambiguousBlockValue:function ambiguousBlockValue(){var blockHelperMissing=this.aliasable("helpers.blockHelperMissing"),params=[this.contextName(0)];this.setupHelperArgs("",0,params,true);this.flushInline();var current=this.topStack();params.splice(1,0,current);this.pushSource(["if (!",this.lastHelper,") { ",current," = ",this.source.functionCall(blockHelperMissing,"call",params),"}"])},appendContent:function appendContent(content){if(this.pendingContent){content=this.pendingContent+content}else{this.pendingLocation=this.source.currentLocation}this.pendingContent=content},append:function append(){if(this.isInline()){this.replaceStack(function(current){return[" != null ? ",current,' : ""']});this.pushSource(this.appendToBuffer(this.popStack()))}else{var local=this.popStack();this.pushSource(["if (",local," != null) { ",this.appendToBuffer(local,undefined,true)," }"]);if(this.environment.isSimple){this.pushSource(["else { ",this.appendToBuffer("''",undefined,true)," }"])}}},appendEscaped:function appendEscaped(){this.pushSource(this.appendToBuffer([this.aliasable("this.escapeExpression"),"(",this.popStack(),")"]))},getContext:function getContext(depth){this.lastContext=depth},pushContext:function pushContext(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function lookupOnContext(parts,falsy,scoped){var i=0;if(!scoped&&this.options.compat&&!this.lastContext){this.push(this.depthedLookup(parts[i++]))}else{this.pushContext()}this.resolvePath("context",parts,i,falsy)},lookupBlockParam:function lookupBlockParam(blockParamId,parts){this.useBlockParams=true;this.push(["blockParams[",blockParamId[0],"][",blockParamId[1],"]"]);this.resolvePath("context",parts,1)},lookupData:function lookupData(depth,parts){if(!depth){this.pushStackLiteral("data")}else{this.pushStackLiteral("this.data(data, "+depth+")")}this.resolvePath("data",parts,0,true)},resolvePath:function resolvePath(type,parts,i,falsy){var _this=this;if(this.options.strict||this.options.assumeObjects){this.push(strictLookup(this.options.strict,this,parts,type));return}var len=parts.length;for(;i<len;i++){this.replaceStack(function(current){var lookup=_this.nameLookup(current,parts[i],type);if(!falsy){return[" != null ? ",lookup," : ",current]}else{return[" && ",lookup]}})}},resolvePossibleLambda:function resolvePossibleLambda(){this.push([this.aliasable("this.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function pushStringParam(string,type){this.pushContext();this.pushString(type);if(type!=="SubExpression"){if(typeof string==="string"){this.pushString(string)}else{this.pushStackLiteral(string)}}},emptyHash:function emptyHash(omitEmpty){if(this.trackIds){this.push("{}")}if(this.stringParams){this.push("{}");this.push("{}")}this.pushStackLiteral(omitEmpty?"undefined":"{}")},pushHash:function pushHash(){if(this.hash){this.hashes.push(this.hash)}this.hash={values:[],types:[],contexts:[],ids:[]}},popHash:function popHash(){var hash=this.hash;this.hash=this.hashes.pop();if(this.trackIds){this.push(this.objectLiteral(hash.ids))}if(this.stringParams){this.push(this.objectLiteral(hash.contexts));this.push(this.objectLiteral(hash.types))}this.push(this.objectLiteral(hash.values))},pushString:function pushString(string){this.pushStackLiteral(this.quotedString(string))},pushLiteral:function pushLiteral(value){this.pushStackLiteral(value)},pushProgram:function pushProgram(guid){if(guid!=null){this.pushStackLiteral(this.programExpression(guid))}else{this.pushStackLiteral(null)}},invokeHelper:function invokeHelper(paramSize,name,isSimple){var nonHelper=this.popStack(),helper=this.setupHelper(paramSize,name),simple=isSimple?[helper.name," || "]:"";var lookup=["("].concat(simple,nonHelper);if(!this.options.strict){lookup.push(" || ",this.aliasable("helpers.helperMissing"))}lookup.push(")");this.push(this.source.functionCall(lookup,"call",helper.callParams))},invokeKnownHelper:function invokeKnownHelper(paramSize,name){var helper=this.setupHelper(paramSize,name);this.push(this.source.functionCall(helper.name,"call",helper.callParams))},invokeAmbiguous:function invokeAmbiguous(name,helperCall){this.useRegister("helper");var nonHelper=this.popStack();this.emptyHash();var helper=this.setupHelper(0,name,helperCall);var helperName=this.lastHelper=this.nameLookup("helpers",name,"helper");var lookup=["(","(helper = ",helperName," || ",nonHelper,")"];if(!this.options.strict){lookup[0]="(helper = ";lookup.push(" != null ? helper : ",this.aliasable("helpers.helperMissing"))}this.push(["(",lookup,helper.paramsInit?["),(",helper.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",helper.callParams)," : helper))"])},invokePartial:function invokePartial(isDynamic,name,indent){var params=[],options=this.setupParams(name,1,params,false);if(isDynamic){name=this.popStack();delete options.name}if(indent){options.indent=JSON.stringify(indent)}options.helpers="helpers";options.partials="partials";if(!isDynamic){params.unshift(this.nameLookup("partials",name,"partial"))}else{params.unshift(name)}if(this.options.compat){options.depths="depths"}options=this.objectLiteral(options);params.push(options);this.push(this.source.functionCall("this.invokePartial","",params))},assignToHash:function assignToHash(key){var value=this.popStack(),context=undefined,type=undefined,id=undefined;if(this.trackIds){id=this.popStack()}if(this.stringParams){type=this.popStack();context=this.popStack()}var hash=this.hash;if(context){hash.contexts[key]=context}if(type){hash.types[key]=type}if(id){hash.ids[key]=id}hash.values[key]=value},pushId:function pushId(type,name,child){if(type==="BlockParam"){this.pushStackLiteral("blockParams["+name[0]+"].path["+name[1]+"]"+(child?" + "+JSON.stringify("."+child):""))}else if(type==="PathExpression"){this.pushString(name)}else if(type==="SubExpression"){this.pushStackLiteral("true")}else{this.pushStackLiteral("null")}},compiler:JavaScriptCompiler,compileChildren:function compileChildren(environment,options){var children=environment.children,child=undefined,compiler=undefined;for(var i=0,l=children.length;i<l;i++){child=children[i];
compiler=new this.compiler;var index=this.matchExistingProgram(child);if(index==null){this.context.programs.push("");index=this.context.programs.length;child.index=index;child.name="program"+index;this.context.programs[index]=compiler.compile(child,options,this.context,!this.precompile);this.context.environments[index]=child;this.useDepths=this.useDepths||compiler.useDepths;this.useBlockParams=this.useBlockParams||compiler.useBlockParams}else{child.index=index;child.name="program"+index;this.useDepths=this.useDepths||child.useDepths;this.useBlockParams=this.useBlockParams||child.useBlockParams}}},matchExistingProgram:function matchExistingProgram(child){for(var i=0,len=this.context.environments.length;i<len;i++){var environment=this.context.environments[i];if(environment&&environment.equals(child)){return i}}},programExpression:function programExpression(guid){var child=this.environment.children[guid],programParams=[child.index,"data",child.blockParams];if(this.useBlockParams||this.useDepths){programParams.push("blockParams")}if(this.useDepths){programParams.push("depths")}return"this.program("+programParams.join(", ")+")"},useRegister:function useRegister(name){if(!this.registers[name]){this.registers[name]=true;this.registers.list.push(name)}},push:function push(expr){if(!(expr instanceof Literal)){expr=this.source.wrap(expr)}this.inlineStack.push(expr);return expr},pushStackLiteral:function pushStackLiteral(item){this.push(new Literal(item))},pushSource:function pushSource(source){if(this.pendingContent){this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation));this.pendingContent=undefined}if(source){this.source.push(source)}},replaceStack:function replaceStack(callback){var prefix=["("],stack=undefined,createdStack=undefined,usedLiteral=undefined;if(!this.isInline()){throw new _Exception2["default"]("replaceStack on non-inline")}var top=this.popStack(true);if(top instanceof Literal){stack=[top.value];prefix=["(",stack];usedLiteral=true}else{createdStack=true;var _name=this.incrStack();prefix=["((",this.push(_name)," = ",top,")"];stack=this.topStack()}var item=callback.call(this,stack);if(!usedLiteral){this.popStack()}if(createdStack){this.stackSlot--}this.push(prefix.concat(item,")"))},incrStack:function incrStack(){this.stackSlot++;if(this.stackSlot>this.stackVars.length){this.stackVars.push("stack"+this.stackSlot)}return this.topStackName()},topStackName:function topStackName(){return"stack"+this.stackSlot},flushInline:function flushInline(){var inlineStack=this.inlineStack;this.inlineStack=[];for(var i=0,len=inlineStack.length;i<len;i++){var entry=inlineStack[i];if(entry instanceof Literal){this.compileStack.push(entry)}else{var stack=this.incrStack();this.pushSource([stack," = ",entry,";"]);this.compileStack.push(stack)}}},isInline:function isInline(){return this.inlineStack.length},popStack:function popStack(wrapped){var inline=this.isInline(),item=(inline?this.inlineStack:this.compileStack).pop();if(!wrapped&&item instanceof Literal){return item.value}else{if(!inline){if(!this.stackSlot){throw new _Exception2["default"]("Invalid stack pop")}this.stackSlot--}return item}},topStack:function topStack(){var stack=this.isInline()?this.inlineStack:this.compileStack,item=stack[stack.length-1];if(item instanceof Literal){return item.value}else{return item}},contextName:function contextName(context){if(this.useDepths&&context){return"depths["+context+"]"}else{return"depth"+context}},quotedString:function quotedString(str){return this.source.quotedString(str)},objectLiteral:function objectLiteral(obj){return this.source.objectLiteral(obj)},aliasable:function aliasable(name){var ret=this.aliases[name];if(ret){ret.referenceCount++;return ret}ret=this.aliases[name]=this.source.wrap(name);ret.aliasable=true;ret.referenceCount=1;return ret},setupHelper:function setupHelper(paramSize,name,blockHelper){var params=[],paramsInit=this.setupHelperArgs(name,paramSize,params,blockHelper);var foundHelper=this.nameLookup("helpers",name,"helper");return{params:params,paramsInit:paramsInit,name:foundHelper,callParams:[this.contextName(0)].concat(params)}},setupParams:function setupParams(helper,paramSize,params){var options={},contexts=[],types=[],ids=[],param=undefined;options.name=this.quotedString(helper);options.hash=this.popStack();if(this.trackIds){options.hashIds=this.popStack()}if(this.stringParams){options.hashTypes=this.popStack();options.hashContexts=this.popStack()}var inverse=this.popStack(),program=this.popStack();if(program||inverse){options.fn=program||"this.noop";options.inverse=inverse||"this.noop"}var i=paramSize;while(i--){param=this.popStack();params[i]=param;if(this.trackIds){ids[i]=this.popStack()}if(this.stringParams){types[i]=this.popStack();contexts[i]=this.popStack()}}if(this.trackIds){options.ids=this.source.generateArray(ids)}if(this.stringParams){options.types=this.source.generateArray(types);options.contexts=this.source.generateArray(contexts)}if(this.options.data){options.data="data"}if(this.useBlockParams){options.blockParams="blockParams"}return options},setupHelperArgs:function setupHelperArgs(helper,paramSize,params,useRegister){var options=this.setupParams(helper,paramSize,params,true);options=this.objectLiteral(options);if(useRegister){this.useRegister("options");params.push("options");return["options=",options]}else{params.push(options);return""}}};(function(){var reservedWords=("break else new var"+" case finally return void"+" catch for switch while"+" continue function this with"+" default if throw"+" delete in try"+" do instanceof typeof"+" abstract enum int short"+" boolean export interface static"+" byte extends long super"+" char final native synchronized"+" class float package throws"+" const goto private transient"+" debugger implements protected volatile"+" double import public let yield await"+" null true false").split(" ");var compilerWords=JavaScriptCompiler.RESERVED_WORDS={};for(var i=0,l=reservedWords.length;i<l;i++){compilerWords[reservedWords[i]]=true}})();JavaScriptCompiler.isValidJavaScriptVariableName=function(name){return!JavaScriptCompiler.RESERVED_WORDS[name]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(name)};function strictLookup(requireTerminal,compiler,parts,type){var stack=compiler.popStack(),i=0,len=parts.length;if(requireTerminal){len--}for(;i<len;i++){stack=compiler.nameLookup(stack,parts[i],type)}if(requireTerminal){return[compiler.aliasable("this.strict"),"(",stack,", ",compiler.quotedString(parts[i]),")"]}else{return stack}}exports["default"]=JavaScriptCompiler;module.exports=exports["default"]},{"../base":20,"../exception":31,"../utils":35,"./code-gen":23}],27:[function(require,module,exports){"use strict";exports.__esModule=true;var handlebars=function(){var parser={trace:function trace(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,content:12,COMMENT:13,CONTENT:14,openRawBlock:15,END_RAW_BLOCK:16,OPEN_RAW_BLOCK:17,helperName:18,openRawBlock_repetition0:19,openRawBlock_option0:20,CLOSE_RAW_BLOCK:21,openBlock:22,block_option0:23,closeBlock:24,openInverse:25,block_option1:26,OPEN_BLOCK:27,openBlock_repetition0:28,openBlock_option0:29,openBlock_option1:30,CLOSE:31,OPEN_INVERSE:32,openInverse_repetition0:33,openInverse_option0:34,openInverse_option1:35,openInverseChain:36,OPEN_INVERSE_CHAIN:37,openInverseChain_repetition0:38,openInverseChain_option0:39,openInverseChain_option1:40,inverseAndProgram:41,INVERSE:42,inverseChain:43,inverseChain_option0:44,OPEN_ENDBLOCK:45,OPEN:46,mustache_repetition0:47,mustache_option0:48,OPEN_UNESCAPED:49,mustache_repetition1:50,mustache_option1:51,CLOSE_UNESCAPED:52,OPEN_PARTIAL:53,partialName:54,partial_repetition0:55,partial_option0:56,param:57,sexpr:58,OPEN_SEXPR:59,sexpr_repetition0:60,sexpr_option0:61,CLOSE_SEXPR:62,hash:63,hash_repetition_plus0:64,hashSegment:65,ID:66,EQUALS:67,blockParams:68,OPEN_BLOCK_PARAMS:69,blockParams_repetition_plus0:70,CLOSE_BLOCK_PARAMS:71,path:72,dataName:73,STRING:74,NUMBER:75,BOOLEAN:76,UNDEFINED:77,NULL:78,DATA:79,pathSegments:80,SEP:81,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",13:"COMMENT",14:"CONTENT",16:"END_RAW_BLOCK",17:"OPEN_RAW_BLOCK",21:"CLOSE_RAW_BLOCK",27:"OPEN_BLOCK",31:"CLOSE",32:"OPEN_INVERSE",37:"OPEN_INVERSE_CHAIN",42:"INVERSE",45:"OPEN_ENDBLOCK",46:"OPEN",49:"OPEN_UNESCAPED",52:"CLOSE_UNESCAPED",53:"OPEN_PARTIAL",59:"OPEN_SEXPR",62:"CLOSE_SEXPR",66:"ID",67:"EQUALS",69:"OPEN_BLOCK_PARAMS",71:"CLOSE_BLOCK_PARAMS",74:"STRING",75:"NUMBER",76:"BOOLEAN",77:"UNDEFINED",78:"NULL",79:"DATA",81:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[12,1],[10,3],[15,5],[9,4],[9,4],[22,6],[25,6],[36,6],[41,2],[43,3],[43,1],[24,3],[8,5],[8,5],[11,5],[57,1],[57,1],[58,5],[63,1],[65,3],[68,3],[18,1],[18,1],[18,1],[18,1],[18,1],[18,1],[18,1],[54,1],[54,1],[73,2],[72,1],[80,3],[80,1],[6,0],[6,2],[19,0],[19,2],[20,0],[20,1],[23,0],[23,1],[26,0],[26,1],[28,0],[28,2],[29,0],[29,1],[30,0],[30,1],[33,0],[33,2],[34,0],[34,1],[35,0],[35,1],[38,0],[38,2],[39,0],[39,1],[40,0],[40,1],[44,0],[44,1],[47,0],[47,2],[48,0],[48,1],[50,0],[50,2],[51,0],[51,1],[55,0],[55,2],[56,0],[56,1],[60,0],[60,2],[61,0],[61,1],[64,1],[64,2],[70,1],[70,2]],performAction:function anonymous(yytext,yyleng,yylineno,yy,yystate,$$,_$){var $0=$$.length-1;switch(yystate){case 1:return $$[$0-1];break;case 2:this.$=new yy.Program($$[$0],null,{},yy.locInfo(this._$));break;case 3:this.$=$$[$0];break;case 4:this.$=$$[$0];break;case 5:this.$=$$[$0];break;case 6:this.$=$$[$0];break;case 7:this.$=$$[$0];break;case 8:this.$=new yy.CommentStatement(yy.stripComment($$[$0]),yy.stripFlags($$[$0],$$[$0]),yy.locInfo(this._$));break;case 9:this.$=new yy.ContentStatement($$[$0],yy.locInfo(this._$));break;case 10:this.$=yy.prepareRawBlock($$[$0-2],$$[$0-1],$$[$0],this._$);break;case 11:this.$={path:$$[$0-3],params:$$[$0-2],hash:$$[$0-1]};break;case 12:this.$=yy.prepareBlock($$[$0-3],$$[$0-2],$$[$0-1],$$[$0],false,this._$);break;case 13:this.$=yy.prepareBlock($$[$0-3],$$[$0-2],$$[$0-1],$$[$0],true,this._$);break;case 14:this.$={path:$$[$0-4],params:$$[$0-3],hash:$$[$0-2],blockParams:$$[$0-1],strip:yy.stripFlags($$[$0-5],$$[$0])};break;case 15:this.$={path:$$[$0-4],params:$$[$0-3],hash:$$[$0-2],blockParams:$$[$0-1],strip:yy.stripFlags($$[$0-5],$$[$0])};break;case 16:this.$={path:$$[$0-4],params:$$[$0-3],hash:$$[$0-2],blockParams:$$[$0-1],strip:yy.stripFlags($$[$0-5],$$[$0])};break;case 17:this.$={strip:yy.stripFlags($$[$0-1],$$[$0-1]),program:$$[$0]};break;case 18:var inverse=yy.prepareBlock($$[$0-2],$$[$0-1],$$[$0],$$[$0],false,this._$),program=new yy.Program([inverse],null,{},yy.locInfo(this._$));program.chained=true;this.$={strip:$$[$0-2].strip,program:program,chain:true};break;case 19:this.$=$$[$0];break;case 20:this.$={path:$$[$0-1],strip:yy.stripFlags($$[$0-2],$$[$0])};break;case 21:this.$=yy.prepareMustache($$[$0-3],$$[$0-2],$$[$0-1],$$[$0-4],yy.stripFlags($$[$0-4],$$[$0]),this._$);break;case 22:this.$=yy.prepareMustache($$[$0-3],$$[$0-2],$$[$0-1],$$[$0-4],yy.stripFlags($$[$0-4],$$[$0]),this._$);break;case 23:this.$=new yy.PartialStatement($$[$0-3],$$[$0-2],$$[$0-1],yy.stripFlags($$[$0-4],$$[$0]),yy.locInfo(this._$));break;case 24:this.$=$$[$0];break;case 25:this.$=$$[$0];break;case 26:this.$=new yy.SubExpression($$[$0-3],$$[$0-2],$$[$0-1],yy.locInfo(this._$));break;case 27:this.$=new yy.Hash($$[$0],yy.locInfo(this._$));break;case 28:this.$=new yy.HashPair(yy.id($$[$0-2]),$$[$0],yy.locInfo(this._$));break;case 29:this.$=yy.id($$[$0-1]);break;case 30:this.$=$$[$0];break;case 31:this.$=$$[$0];break;case 32:this.$=new yy.StringLiteral($$[$0],yy.locInfo(this._$));break;case 33:this.$=new yy.NumberLiteral($$[$0],yy.locInfo(this._$));break;case 34:this.$=new yy.BooleanLiteral($$[$0],yy.locInfo(this._$));break;case 35:this.$=new yy.UndefinedLiteral(yy.locInfo(this._$));break;case 36:this.$=new yy.NullLiteral(yy.locInfo(this._$));break;case 37:this.$=$$[$0];break;case 38:this.$=$$[$0];break;case 39:this.$=yy.preparePath(true,$$[$0],this._$);break;case 40:this.$=yy.preparePath(false,$$[$0],this._$);break;case 41:$$[$0-2].push({part:yy.id($$[$0]),original:$$[$0],separator:$$[$0-1]});this.$=$$[$0-2];break;case 42:this.$=[{part:yy.id($$[$0]),original:$$[$0]}];break;case 43:this.$=[];break;case 44:$$[$0-1].push($$[$0]);break;case 45:this.$=[];break;case 46:$$[$0-1].push($$[$0]);break;case 53:this.$=[];break;case 54:$$[$0-1].push($$[$0]);break;case 59:this.$=[];break;case 60:$$[$0-1].push($$[$0]);break;case 65:this.$=[];break;case 66:$$[$0-1].push($$[$0]);break;case 73:this.$=[];break;case 74:$$[$0-1].push($$[$0]);break;case 77:this.$=[];break;case 78:$$[$0-1].push($$[$0]);break;case 81:this.$=[];break;case 82:$$[$0-1].push($$[$0]);break;case 85:this.$=[];break;case 86:$$[$0-1].push($$[$0]);break;case 89:this.$=[$$[$0]];break;case 90:$$[$0-1].push($$[$0]);break;case 91:this.$=[$$[$0]];break;case 92:$$[$0-1].push($$[$0]);break}},table:[{3:1,4:2,5:[2,43],6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],46:[2,43],49:[2,43],53:[2,43]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:[1,11],14:[1,18],15:16,17:[1,21],22:14,25:15,27:[1,19],32:[1,20],37:[2,2],42:[2,2],45:[2,2],46:[1,12],49:[1,13],53:[1,17]},{1:[2,1]},{5:[2,44],13:[2,44],14:[2,44],17:[2,44],27:[2,44],32:[2,44],37:[2,44],42:[2,44],45:[2,44],46:[2,44],49:[2,44],53:[2,44]},{5:[2,3],13:[2,3],14:[2,3],17:[2,3],27:[2,3],32:[2,3],37:[2,3],42:[2,3],45:[2,3],46:[2,3],49:[2,3],53:[2,3]},{5:[2,4],13:[2,4],14:[2,4],17:[2,4],27:[2,4],32:[2,4],37:[2,4],42:[2,4],45:[2,4],46:[2,4],49:[2,4],53:[2,4]},{5:[2,5],13:[2,5],14:[2,5],17:[2,5],27:[2,5],32:[2,5],37:[2,5],42:[2,5],45:[2,5],46:[2,5],49:[2,5],53:[2,5]},{5:[2,6],13:[2,6],14:[2,6],17:[2,6],27:[2,6],32:[2,6],37:[2,6],42:[2,6],45:[2,6],46:[2,6],49:[2,6],53:[2,6]},{5:[2,7],13:[2,7],14:[2,7],17:[2,7],27:[2,7],32:[2,7],37:[2,7],42:[2,7],45:[2,7],46:[2,7],49:[2,7],53:[2,7]},{5:[2,8],13:[2,8],14:[2,8],17:[2,8],27:[2,8],32:[2,8],37:[2,8],42:[2,8],45:[2,8],46:[2,8],49:[2,8],53:[2,8]},{18:22,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:33,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{4:34,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],37:[2,43],42:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{4:35,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],42:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{12:36,14:[1,18]},{18:38,54:37,58:39,59:[1,40],66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{5:[2,9],13:[2,9],14:[2,9],16:[2,9],17:[2,9],27:[2,9],32:[2,9],37:[2,9],42:[2,9],45:[2,9],46:[2,9],49:[2,9],53:[2,9]},{18:41,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:42,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:43,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{31:[2,73],47:44,59:[2,73],66:[2,73],74:[2,73],75:[2,73],76:[2,73],77:[2,73],78:[2,73],79:[2,73]},{21:[2,30],31:[2,30],52:[2,30],59:[2,30],62:[2,30],66:[2,30],69:[2,30],74:[2,30],75:[2,30],76:[2,30],77:[2,30],78:[2,30],79:[2,30]},{21:[2,31],31:[2,31],52:[2,31],59:[2,31],62:[2,31],66:[2,31],69:[2,31],74:[2,31],75:[2,31],76:[2,31],77:[2,31],78:[2,31],79:[2,31]},{21:[2,32],31:[2,32],52:[2,32],59:[2,32],62:[2,32],66:[2,32],69:[2,32],74:[2,32],75:[2,32],76:[2,32],77:[2,32],78:[2,32],79:[2,32]},{21:[2,33],31:[2,33],52:[2,33],59:[2,33],62:[2,33],66:[2,33],69:[2,33],74:[2,33],75:[2,33],76:[2,33],77:[2,33],78:[2,33],79:[2,33]},{21:[2,34],31:[2,34],52:[2,34],59:[2,34],62:[2,34],66:[2,34],69:[2,34],74:[2,34],75:[2,34],76:[2,34],77:[2,34],78:[2,34],79:[2,34]},{21:[2,35],31:[2,35],52:[2,35],59:[2,35],62:[2,35],66:[2,35],69:[2,35],74:[2,35],75:[2,35],76:[2,35],77:[2,35],78:[2,35],79:[2,35]},{21:[2,36],31:[2,36],52:[2,36],59:[2,36],62:[2,36],66:[2,36],69:[2,36],74:[2,36],75:[2,36],76:[2,36],77:[2,36],78:[2,36],79:[2,36]},{21:[2,40],31:[2,40],52:[2,40],59:[2,40],62:[2,40],66:[2,40],69:[2,40],74:[2,40],75:[2,40],76:[2,40],77:[2,40],78:[2,40],79:[2,40],81:[1,45]},{66:[1,32],80:46},{21:[2,42],31:[2,42],52:[2,42],59:[2,42],62:[2,42],66:[2,42],69:[2,42],74:[2,42],75:[2,42],76:[2,42],77:[2,42],78:[2,42],79:[2,42],81:[2,42]},{50:47,52:[2,77],59:[2,77],66:[2,77],74:[2,77],75:[2,77],76:[2,77],77:[2,77],78:[2,77],79:[2,77]},{23:48,36:50,37:[1,52],41:51,42:[1,53],43:49,45:[2,49]},{26:54,41:55,42:[1,53],45:[2,51]},{16:[1,56]},{31:[2,81],55:57,59:[2,81],66:[2,81],74:[2,81],75:[2,81],76:[2,81],77:[2,81],78:[2,81],79:[2,81]},{31:[2,37],59:[2,37],66:[2,37],74:[2,37],75:[2,37],76:[2,37],77:[2,37],78:[2,37],79:[2,37]},{31:[2,38],59:[2,38],66:[2,38],74:[2,38],75:[2,38],76:[2,38],77:[2,38],78:[2,38],79:[2,38]},{18:58,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{28:59,31:[2,53],59:[2,53],66:[2,53],69:[2,53],74:[2,53],75:[2,53],76:[2,53],77:[2,53],78:[2,53],79:[2,53]},{31:[2,59],33:60,59:[2,59],66:[2,59],69:[2,59],74:[2,59],75:[2,59],76:[2,59],77:[2,59],78:[2,59],79:[2,59]},{19:61,21:[2,45],59:[2,45],66:[2,45],74:[2,45],75:[2,45],76:[2,45],77:[2,45],78:[2,45],79:[2,45]},{18:65,31:[2,75],48:62,57:63,58:66,59:[1,40],63:64,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{66:[1,70]},{21:[2,39],31:[2,39],52:[2,39],59:[2,39],62:[2,39],66:[2,39],69:[2,39],74:[2,39],75:[2,39],76:[2,39],77:[2,39],78:[2,39],79:[2,39],81:[1,45]},{18:65,51:71,52:[2,79],57:72,58:66,59:[1,40],63:73,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{24:74,45:[1,75]},{45:[2,50]},{4:76,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],37:[2,43],42:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{45:[2,19]},{18:77,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{4:78,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{24:79,45:[1,75]},{45:[2,52]},{5:[2,10],13:[2,10],14:[2,10],17:[2,10],27:[2,10],32:[2,10],37:[2,10],42:[2,10],45:[2,10],46:[2,10],49:[2,10],53:[2,10]},{18:65,31:[2,83],56:80,57:81,58:66,59:[1,40],63:82,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{59:[2,85],60:83,62:[2,85],66:[2,85],74:[2,85],75:[2,85],76:[2,85],77:[2,85],78:[2,85],79:[2,85]},{18:65,29:84,31:[2,55],57:85,58:66,59:[1,40],63:86,64:67,65:68,66:[1,69],69:[2,55],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:65,31:[2,61],34:87,57:88,58:66,59:[1,40],63:89,64:67,65:68,66:[1,69],69:[2,61],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:65,20:90,21:[2,47],57:91,58:66,59:[1,40],63:92,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{31:[1,93]},{31:[2,74],59:[2,74],66:[2,74],74:[2,74],75:[2,74],76:[2,74],77:[2,74],78:[2,74],79:[2,74]},{31:[2,76]},{21:[2,24],31:[2,24],52:[2,24],59:[2,24],62:[2,24],66:[2,24],69:[2,24],74:[2,24],75:[2,24],76:[2,24],77:[2,24],78:[2,24],79:[2,24]},{21:[2,25],31:[2,25],52:[2,25],59:[2,25],62:[2,25],66:[2,25],69:[2,25],74:[2,25],75:[2,25],76:[2,25],77:[2,25],78:[2,25],79:[2,25]},{21:[2,27],31:[2,27],52:[2,27],62:[2,27],65:94,66:[1,95],69:[2,27]},{21:[2,89],31:[2,89],52:[2,89],62:[2,89],66:[2,89],69:[2,89]},{21:[2,42],31:[2,42],52:[2,42],59:[2,42],62:[2,42],66:[2,42],67:[1,96],69:[2,42],74:[2,42],75:[2,42],76:[2,42],77:[2,42],78:[2,42],79:[2,42],81:[2,42]},{21:[2,41],31:[2,41],52:[2,41],59:[2,41],62:[2,41],66:[2,41],69:[2,41],74:[2,41],75:[2,41],76:[2,41],77:[2,41],78:[2,41],79:[2,41],81:[2,41]},{52:[1,97]},{52:[2,78],59:[2,78],66:[2,78],74:[2,78],75:[2,78],76:[2,78],77:[2,78],78:[2,78],79:[2,78]},{52:[2,80]},{5:[2,12],13:[2,12],14:[2,12],17:[2,12],27:[2,12],32:[2,12],37:[2,12],42:[2,12],45:[2,12],46:[2,12],49:[2,12],53:[2,12]},{18:98,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{36:50,37:[1,52],41:51,42:[1,53],43:100,44:99,45:[2,71]},{31:[2,65],38:101,59:[2,65],66:[2,65],69:[2,65],74:[2,65],75:[2,65],76:[2,65],77:[2,65],78:[2,65],79:[2,65]},{45:[2,17]},{5:[2,13],13:[2,13],14:[2,13],17:[2,13],27:[2,13],32:[2,13],37:[2,13],42:[2,13],45:[2,13],46:[2,13],49:[2,13],53:[2,13]},{31:[1,102]},{31:[2,82],59:[2,82],66:[2,82],74:[2,82],75:[2,82],76:[2,82],77:[2,82],78:[2,82],79:[2,82]},{31:[2,84]},{18:65,57:104,58:66,59:[1,40],61:103,62:[2,87],63:105,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{30:106,31:[2,57],68:107,69:[1,108]},{31:[2,54],59:[2,54],66:[2,54],69:[2,54],74:[2,54],75:[2,54],76:[2,54],77:[2,54],78:[2,54],79:[2,54]},{31:[2,56],69:[2,56]},{31:[2,63],35:109,68:110,69:[1,108]},{31:[2,60],59:[2,60],66:[2,60],69:[2,60],74:[2,60],75:[2,60],76:[2,60],77:[2,60],78:[2,60],79:[2,60]},{31:[2,62],69:[2,62]},{21:[1,111]},{21:[2,46],59:[2,46],66:[2,46],74:[2,46],75:[2,46],76:[2,46],77:[2,46],78:[2,46],79:[2,46]},{21:[2,48]},{5:[2,21],13:[2,21],14:[2,21],17:[2,21],27:[2,21],32:[2,21],37:[2,21],42:[2,21],45:[2,21],46:[2,21],49:[2,21],53:[2,21]},{21:[2,90],31:[2,90],52:[2,90],62:[2,90],66:[2,90],69:[2,90]},{67:[1,96]},{18:65,57:112,58:66,59:[1,40],66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{5:[2,22],13:[2,22],14:[2,22],17:[2,22],27:[2,22],32:[2,22],37:[2,22],42:[2,22],45:[2,22],46:[2,22],49:[2,22],53:[2,22]},{31:[1,113]},{45:[2,18]},{45:[2,72]},{18:65,31:[2,67],39:114,57:115,58:66,59:[1,40],63:116,64:67,65:68,66:[1,69],69:[2,67],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{5:[2,23],13:[2,23],14:[2,23],17:[2,23],27:[2,23],32:[2,23],37:[2,23],42:[2,23],45:[2,23],46:[2,23],49:[2,23],53:[2,23]},{62:[1,117]},{59:[2,86],62:[2,86],66:[2,86],74:[2,86],75:[2,86],76:[2,86],77:[2,86],78:[2,86],79:[2,86]},{62:[2,88]},{31:[1,118]},{31:[2,58]},{66:[1,120],70:119},{31:[1,121]},{31:[2,64]},{14:[2,11]},{21:[2,28],31:[2,28],52:[2,28],62:[2,28],66:[2,28],69:[2,28]},{5:[2,20],13:[2,20],14:[2,20],17:[2,20],27:[2,20],32:[2,20],37:[2,20],42:[2,20],45:[2,20],46:[2,20],49:[2,20],53:[2,20]},{31:[2,69],40:122,68:123,69:[1,108]},{31:[2,66],59:[2,66],66:[2,66],69:[2,66],74:[2,66],75:[2,66],76:[2,66],77:[2,66],78:[2,66],79:[2,66]},{31:[2,68],69:[2,68]},{21:[2,26],31:[2,26],52:[2,26],59:[2,26],62:[2,26],66:[2,26],69:[2,26],74:[2,26],75:[2,26],76:[2,26],77:[2,26],78:[2,26],79:[2,26]},{13:[2,14],14:[2,14],17:[2,14],27:[2,14],32:[2,14],37:[2,14],42:[2,14],45:[2,14],46:[2,14],49:[2,14],53:[2,14]},{66:[1,125],71:[1,124]},{66:[2,91],71:[2,91]},{13:[2,15],14:[2,15],17:[2,15],27:[2,15],32:[2,15],42:[2,15],45:[2,15],46:[2,15],49:[2,15],53:[2,15]},{31:[1,126]},{31:[2,70]},{31:[2,29]},{66:[2,92],71:[2,92]},{13:[2,16],14:[2,16],17:[2,16],27:[2,16],32:[2,16],37:[2,16],42:[2,16],45:[2,16],46:[2,16],49:[2,16],53:[2,16]}],defaultActions:{4:[2,1],49:[2,50],51:[2,19],55:[2,52],64:[2,76],73:[2,80],78:[2,17],82:[2,84],92:[2,48],99:[2,18],100:[2,72],105:[2,88],107:[2,58],110:[2,64],111:[2,11],123:[2,70],124:[2,29]},parseError:function parseError(str,hash){throw new Error(str)},parse:function parse(input){var self=this,stack=[0],vstack=[null],lstack=[],table=this.table,yytext="",yylineno=0,yyleng=0,recovering=0,TERROR=2,EOF=1;this.lexer.setInput(input);this.lexer.yy=this.yy;this.yy.lexer=this.lexer;this.yy.parser=this;if(typeof this.lexer.yylloc=="undefined")this.lexer.yylloc={};var yyloc=this.lexer.yylloc;lstack.push(yyloc);var ranges=this.lexer.options&&this.lexer.options.ranges;if(typeof this.yy.parseError==="function")this.parseError=this.yy.parseError;function popStack(n){stack.length=stack.length-2*n;vstack.length=vstack.length-n;lstack.length=lstack.length-n}function lex(){var token;token=self.lexer.lex()||1;if(typeof token!=="number"){token=self.symbols_[token]||token}return token}var symbol,preErrorSymbol,state,action,a,r,yyval={},p,len,newState,expected;while(true){state=stack[stack.length-1];if(this.defaultActions[state]){action=this.defaultActions[state]}else{if(symbol===null||typeof symbol=="undefined"){symbol=lex()}action=table[state]&&table[state][symbol]}if(typeof action==="undefined"||!action.length||!action[0]){var errStr="";if(!recovering){expected=[];for(p in table[state])if(this.terminals_[p]&&p>2){expected.push("'"+this.terminals_[p]+"'")}if(this.lexer.showPosition){errStr="Parse error on line "+(yylineno+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+expected.join(", ")+", got '"+(this.terminals_[symbol]||symbol)+"'"}else{errStr="Parse error on line "+(yylineno+1)+": Unexpected "+(symbol==1?"end of input":"'"+(this.terminals_[symbol]||symbol)+"'")}this.parseError(errStr,{text:this.lexer.match,token:this.terminals_[symbol]||symbol,line:this.lexer.yylineno,loc:yyloc,expected:expected})}}if(action[0]instanceof Array&&action.length>1){throw new Error("Parse Error: multiple actions possible at state: "+state+", token: "+symbol)}switch(action[0]){case 1:stack.push(symbol);vstack.push(this.lexer.yytext);lstack.push(this.lexer.yylloc);stack.push(action[1]);symbol=null;if(!preErrorSymbol){yyleng=this.lexer.yyleng;yytext=this.lexer.yytext;yylineno=this.lexer.yylineno;yyloc=this.lexer.yylloc;if(recovering>0)recovering--}else{symbol=preErrorSymbol;preErrorSymbol=null}break;case 2:len=this.productions_[action[1]][1];yyval.$=vstack[vstack.length-len];yyval._$={first_line:lstack[lstack.length-(len||1)].first_line,last_line:lstack[lstack.length-1].last_line,first_column:lstack[lstack.length-(len||1)].first_column,last_column:lstack[lstack.length-1].last_column};if(ranges){yyval._$.range=[lstack[lstack.length-(len||1)].range[0],lstack[lstack.length-1].range[1]]}r=this.performAction.call(yyval,yytext,yyleng,yylineno,this.yy,action[1],vstack,lstack);if(typeof r!=="undefined"){return r}if(len){stack=stack.slice(0,-1*len*2);vstack=vstack.slice(0,-1*len);lstack=lstack.slice(0,-1*len)}stack.push(this.productions_[action[1]][0]);vstack.push(yyval.$);lstack.push(yyval._$);newState=table[stack[stack.length-2]][stack[stack.length-1]];stack.push(newState);break;case 3:return true}}return true}};var lexer=function(){var lexer={EOF:1,parseError:function parseError(str,hash){if(this.yy.parser){this.yy.parser.parseError(str,hash)}else{throw new Error(str)}},setInput:function setInput(input){this._input=input;this._more=this._less=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges)this.yylloc.range=[0,0];this.offset=0;return this},input:function input(){var ch=this._input[0];this.yytext+=ch;this.yyleng++;this.offset++;this.match+=ch;this.matched+=ch;var lines=ch.match(/(?:\r\n?|\n).*/g);if(lines){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges)this.yylloc.range[1]++;this._input=this._input.slice(1);return ch},unput:function unput(ch){var len=ch.length;var lines=ch.split(/(?:\r\n?|\n)/g);this._input=ch+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-len-1);this.offset-=len;var oldLines=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(lines.length-1)this.yylineno-=lines.length-1;var r=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:lines?(lines.length===oldLines.length?this.yylloc.first_column:0)+oldLines[oldLines.length-lines.length].length-lines[0].length:this.yylloc.first_column-len};if(this.options.ranges){this.yylloc.range=[r[0],r[0]+this.yyleng-len]}return this},more:function more(){this._more=true;return this},less:function less(n){this.unput(this.match.slice(n))},pastInput:function pastInput(){var past=this.matched.substr(0,this.matched.length-this.match.length);return(past.length>20?"...":"")+past.substr(-20).replace(/\n/g,"")},upcomingInput:function upcomingInput(){var next=this.match;if(next.length<20){next+=this._input.substr(0,20-next.length)}return(next.substr(0,20)+(next.length>20?"...":"")).replace(/\n/g,"")},showPosition:function showPosition(){var pre=this.pastInput();var c=new Array(pre.length+1).join("-");return pre+this.upcomingInput()+"\n"+c+"^"},next:function next(){if(this.done){return this.EOF}if(!this._input)this.done=true;var token,match,tempMatch,index,col,lines;if(!this._more){this.yytext="";this.match=""}var rules=this._currentRules();for(var i=0;i<rules.length;i++){tempMatch=this._input.match(this.rules[rules[i]]);if(tempMatch&&(!match||tempMatch[0].length>match[0].length)){match=tempMatch;index=i;if(!this.options.flex)break}}if(match){lines=match[0].match(/(?:\r\n?|\n).*/g);if(lines)this.yylineno+=lines.length;this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:lines?lines[lines.length-1].length-lines[lines.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+match[0].length};this.yytext+=match[0];this.match+=match[0];this.matches=match;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._input=this._input.slice(match[0].length);this.matched+=match[0];token=this.performAction.call(this,this.yy,this,rules[index],this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input)this.done=false;if(token){return token}else{return}}if(this._input===""){return this.EOF}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function lex(){var r=this.next();if(typeof r!=="undefined"){return r}else{return this.lex()}},begin:function begin(condition){this.conditionStack.push(condition)},popState:function popState(){return this.conditionStack.pop()},_currentRules:function _currentRules(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function topState(){return this.conditionStack[this.conditionStack.length-2]},pushState:function begin(condition){this.begin(condition)}};lexer.options={};lexer.performAction=function anonymous(yy,yy_,$avoiding_name_collisions,YY_START){function strip(start,end){return yy_.yytext=yy_.yytext.substr(start,yy_.yyleng-end)}var YYSTATE=YY_START;switch($avoiding_name_collisions){case 0:if(yy_.yytext.slice(-2)==="\\\\"){strip(0,1);this.begin("mu")}else if(yy_.yytext.slice(-1)==="\\"){strip(0,1);this.begin("emu")}else{this.begin("mu")}if(yy_.yytext){return 14}break;case 1:return 14;break;case 2:this.popState();return 14;break;case 3:yy_.yytext=yy_.yytext.substr(5,yy_.yyleng-9);this.popState();return 16;break;case 4:return 14;break;case 5:this.popState();return 13;break;case 6:return 59;break;case 7:return 62;break;case 8:return 17;break;case 9:this.popState();this.begin("raw");return 21;break;case 10:return 53;break;case 11:return 27;break;case 12:return 45;break;case 13:this.popState();return 42;break;case 14:this.popState();return 42;break;case 15:return 32;break;case 16:return 37;break;case 17:return 49;break;case 18:return 46;break;case 19:this.unput(yy_.yytext);this.popState();this.begin("com");break;case 20:this.popState();return 13;break;case 21:return 46;break;case 22:return 67;break;case 23:return 66;break;case 24:return 66;break;case 25:return 81;break;case 26:break;case 27:this.popState();return 52;break;case 28:this.popState();return 31;break;case 29:yy_.yytext=strip(1,2).replace(/\\"/g,'"');return 74;break;case 30:yy_.yytext=strip(1,2).replace(/\\'/g,"'");return 74;break;case 31:return 79;break;case 32:return 76;break;case 33:return 76;break;case 34:return 77;break;case 35:return 78;break;case 36:return 75;break;case 37:return 69;break;case 38:return 71;break;case 39:return 66;break;case 40:return 66;break;case 41:return"INVALID";break;case 42:return 5;break;
}};lexer.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]*?(?=(\{\{\{\{\/)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/];lexer.conditions={mu:{rules:[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42],inclusive:false},emu:{rules:[2],inclusive:false},com:{rules:[5],inclusive:false},raw:{rules:[3,4],inclusive:false},INITIAL:{rules:[0,1,42],inclusive:true}};return lexer}();parser.lexer=lexer;function Parser(){this.yy={}}Parser.prototype=parser;parser.Parser=Parser;return new Parser}();exports["default"]=handlebars;module.exports=exports["default"]},{}],28:[function(require,module,exports){"use strict";var _interopRequireWildcard=function(obj){return obj&&obj.__esModule?obj:{"default":obj}};exports.__esModule=true;exports.print=print;exports.PrintVisitor=PrintVisitor;var _Visitor=require("./visitor");var _Visitor2=_interopRequireWildcard(_Visitor);function print(ast){return(new PrintVisitor).accept(ast)}function PrintVisitor(){this.padding=0}PrintVisitor.prototype=new _Visitor2["default"];PrintVisitor.prototype.pad=function(string){var out="";for(var i=0,l=this.padding;i<l;i++){out=out+"  "}out=out+string+"\n";return out};PrintVisitor.prototype.Program=function(program){var out="",body=program.body,i=undefined,l=undefined;if(program.blockParams){var blockParams="BLOCK PARAMS: [";for(i=0,l=program.blockParams.length;i<l;i++){blockParams+=" "+program.blockParams[i]}blockParams+=" ]";out+=this.pad(blockParams)}for(i=0,l=body.length;i<l;i++){out=out+this.accept(body[i])}this.padding--;return out};PrintVisitor.prototype.MustacheStatement=function(mustache){return this.pad("{{ "+this.SubExpression(mustache)+" }}")};PrintVisitor.prototype.BlockStatement=function(block){var out="";out=out+this.pad("BLOCK:");this.padding++;out=out+this.pad(this.SubExpression(block));if(block.program){out=out+this.pad("PROGRAM:");this.padding++;out=out+this.accept(block.program);this.padding--}if(block.inverse){if(block.program){this.padding++}out=out+this.pad("{{^}}");this.padding++;out=out+this.accept(block.inverse);this.padding--;if(block.program){this.padding--}}this.padding--;return out};PrintVisitor.prototype.PartialStatement=function(partial){var content="PARTIAL:"+partial.name.original;if(partial.params[0]){content+=" "+this.accept(partial.params[0])}if(partial.hash){content+=" "+this.accept(partial.hash)}return this.pad("{{> "+content+" }}")};PrintVisitor.prototype.ContentStatement=function(content){return this.pad("CONTENT[ '"+content.value+"' ]")};PrintVisitor.prototype.CommentStatement=function(comment){return this.pad("{{! '"+comment.value+"' }}")};PrintVisitor.prototype.SubExpression=function(sexpr){var params=sexpr.params,paramStrings=[],hash=undefined;for(var i=0,l=params.length;i<l;i++){paramStrings.push(this.accept(params[i]))}params="["+paramStrings.join(", ")+"]";hash=sexpr.hash?" "+this.accept(sexpr.hash):"";return this.accept(sexpr.path)+" "+params+hash};PrintVisitor.prototype.PathExpression=function(id){var path=id.parts.join("/");return(id.data?"@":"")+"PATH:"+path};PrintVisitor.prototype.StringLiteral=function(string){return'"'+string.value+'"'};PrintVisitor.prototype.NumberLiteral=function(number){return"NUMBER{"+number.value+"}"};PrintVisitor.prototype.BooleanLiteral=function(bool){return"BOOLEAN{"+bool.value+"}"};PrintVisitor.prototype.UndefinedLiteral=function(){return"UNDEFINED"};PrintVisitor.prototype.NullLiteral=function(){return"NULL"};PrintVisitor.prototype.Hash=function(hash){var pairs=hash.pairs,joinedPairs=[];for(var i=0,l=pairs.length;i<l;i++){joinedPairs.push(this.accept(pairs[i]))}return"HASH{"+joinedPairs.join(", ")+"}"};PrintVisitor.prototype.HashPair=function(pair){return pair.key+"="+this.accept(pair.value)}},{"./visitor":29}],29:[function(require,module,exports){"use strict";var _interopRequireWildcard=function(obj){return obj&&obj.__esModule?obj:{"default":obj}};exports.__esModule=true;var _Exception=require("../exception");var _Exception2=_interopRequireWildcard(_Exception);var _AST=require("./ast");var _AST2=_interopRequireWildcard(_AST);function Visitor(){this.parents=[]}Visitor.prototype={constructor:Visitor,mutating:false,acceptKey:function acceptKey(node,name){var value=this.accept(node[name]);if(this.mutating){if(value&&(!value.type||!_AST2["default"][value.type])){throw new _Exception2["default"]('Unexpected node type "'+value.type+'" found when accepting '+name+" on "+node.type)}node[name]=value}},acceptRequired:function acceptRequired(node,name){this.acceptKey(node,name);if(!node[name]){throw new _Exception2["default"](node.type+" requires "+name)}},acceptArray:function acceptArray(array){for(var i=0,l=array.length;i<l;i++){this.acceptKey(array,i);if(!array[i]){array.splice(i,1);i--;l--}}},accept:function accept(object){if(!object){return}if(this.current){this.parents.unshift(this.current)}this.current=object;var ret=this[object.type](object);this.current=this.parents.shift();if(!this.mutating||ret){return ret}else if(ret!==false){return object}},Program:function Program(program){this.acceptArray(program.body)},MustacheStatement:function MustacheStatement(mustache){this.acceptRequired(mustache,"path");this.acceptArray(mustache.params);this.acceptKey(mustache,"hash")},BlockStatement:function BlockStatement(block){this.acceptRequired(block,"path");this.acceptArray(block.params);this.acceptKey(block,"hash");this.acceptKey(block,"program");this.acceptKey(block,"inverse")},PartialStatement:function PartialStatement(partial){this.acceptRequired(partial,"name");this.acceptArray(partial.params);this.acceptKey(partial,"hash")},ContentStatement:function ContentStatement(){},CommentStatement:function CommentStatement(){},SubExpression:function SubExpression(sexpr){this.acceptRequired(sexpr,"path");this.acceptArray(sexpr.params);this.acceptKey(sexpr,"hash")},PathExpression:function PathExpression(){},StringLiteral:function StringLiteral(){},NumberLiteral:function NumberLiteral(){},BooleanLiteral:function BooleanLiteral(){},UndefinedLiteral:function UndefinedLiteral(){},NullLiteral:function NullLiteral(){},Hash:function Hash(hash){this.acceptArray(hash.pairs)},HashPair:function HashPair(pair){this.acceptRequired(pair,"value")}};exports["default"]=Visitor;module.exports=exports["default"]},{"../exception":31,"./ast":21}],30:[function(require,module,exports){"use strict";var _interopRequireWildcard=function(obj){return obj&&obj.__esModule?obj:{"default":obj}};exports.__esModule=true;var _Visitor=require("./visitor");var _Visitor2=_interopRequireWildcard(_Visitor);function WhitespaceControl(){}WhitespaceControl.prototype=new _Visitor2["default"];WhitespaceControl.prototype.Program=function(program){var isRoot=!this.isRootSeen;this.isRootSeen=true;var body=program.body;for(var i=0,l=body.length;i<l;i++){var current=body[i],strip=this.accept(current);if(!strip){continue}var _isPrevWhitespace=isPrevWhitespace(body,i,isRoot),_isNextWhitespace=isNextWhitespace(body,i,isRoot),openStandalone=strip.openStandalone&&_isPrevWhitespace,closeStandalone=strip.closeStandalone&&_isNextWhitespace,inlineStandalone=strip.inlineStandalone&&_isPrevWhitespace&&_isNextWhitespace;if(strip.close){omitRight(body,i,true)}if(strip.open){omitLeft(body,i,true)}if(inlineStandalone){omitRight(body,i);if(omitLeft(body,i)){if(current.type==="PartialStatement"){current.indent=/([ \t]+$)/.exec(body[i-1].original)[1]}}}if(openStandalone){omitRight((current.program||current.inverse).body);omitLeft(body,i)}if(closeStandalone){omitRight(body,i);omitLeft((current.inverse||current.program).body)}}return program};WhitespaceControl.prototype.BlockStatement=function(block){this.accept(block.program);this.accept(block.inverse);var program=block.program||block.inverse,inverse=block.program&&block.inverse,firstInverse=inverse,lastInverse=inverse;if(inverse&&inverse.chained){firstInverse=inverse.body[0].program;while(lastInverse.chained){lastInverse=lastInverse.body[lastInverse.body.length-1].program}}var strip={open:block.openStrip.open,close:block.closeStrip.close,openStandalone:isNextWhitespace(program.body),closeStandalone:isPrevWhitespace((firstInverse||program).body)};if(block.openStrip.close){omitRight(program.body,null,true)}if(inverse){var inverseStrip=block.inverseStrip;if(inverseStrip.open){omitLeft(program.body,null,true)}if(inverseStrip.close){omitRight(firstInverse.body,null,true)}if(block.closeStrip.open){omitLeft(lastInverse.body,null,true)}if(isPrevWhitespace(program.body)&&isNextWhitespace(firstInverse.body)){omitLeft(program.body);omitRight(firstInverse.body)}}else if(block.closeStrip.open){omitLeft(program.body,null,true)}return strip};WhitespaceControl.prototype.MustacheStatement=function(mustache){return mustache.strip};WhitespaceControl.prototype.PartialStatement=WhitespaceControl.prototype.CommentStatement=function(node){var strip=node.strip||{};return{inlineStandalone:true,open:strip.open,close:strip.close}};function isPrevWhitespace(body,i,isRoot){if(i===undefined){i=body.length}var prev=body[i-1],sibling=body[i-2];if(!prev){return isRoot}if(prev.type==="ContentStatement"){return(sibling||!isRoot?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(prev.original)}}function isNextWhitespace(body,i,isRoot){if(i===undefined){i=-1}var next=body[i+1],sibling=body[i+2];if(!next){return isRoot}if(next.type==="ContentStatement"){return(sibling||!isRoot?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(next.original)}}function omitRight(body,i,multiple){var current=body[i==null?0:i+1];if(!current||current.type!=="ContentStatement"||!multiple&&current.rightStripped){return}var original=current.value;current.value=current.value.replace(multiple?/^\s+/:/^[ \t]*\r?\n?/,"");current.rightStripped=current.value!==original}function omitLeft(body,i,multiple){var current=body[i==null?body.length-1:i-1];if(!current||current.type!=="ContentStatement"||!multiple&&current.leftStripped){return}var original=current.value;current.value=current.value.replace(multiple?/\s+$/:/[ \t]+$/,"");current.leftStripped=current.value!==original;return current.leftStripped}exports["default"]=WhitespaceControl;module.exports=exports["default"]},{"./visitor":29}],31:[function(require,module,exports){"use strict";exports.__esModule=true;var errorProps=["description","fileName","lineNumber","message","name","number","stack"];function Exception(message,node){var loc=node&&node.loc,line=undefined,column=undefined;if(loc){line=loc.start.line;column=loc.start.column;message+=" - "+line+":"+column}var tmp=Error.prototype.constructor.call(this,message);for(var idx=0;idx<errorProps.length;idx++){this[errorProps[idx]]=tmp[errorProps[idx]]}if(Error.captureStackTrace){Error.captureStackTrace(this,Exception)}if(loc){this.lineNumber=line;this.column=column}}Exception.prototype=new Error;exports["default"]=Exception;module.exports=exports["default"]},{}],32:[function(require,module,exports){(function(global){"use strict";exports.__esModule=true;exports["default"]=function(Handlebars){var root=typeof global!=="undefined"?global:window,$Handlebars=root.Handlebars;Handlebars.noConflict=function(){if(root.Handlebars===Handlebars){root.Handlebars=$Handlebars}}};module.exports=exports["default"]}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],33:[function(require,module,exports){"use strict";var _interopRequireWildcard=function(obj){return obj&&obj.__esModule?obj:{"default":obj}};exports.__esModule=true;exports.checkRevision=checkRevision;exports.template=template;exports.wrapProgram=wrapProgram;exports.resolvePartial=resolvePartial;exports.invokePartial=invokePartial;exports.noop=noop;var _import=require("./utils");var Utils=_interopRequireWildcard(_import);var _Exception=require("./exception");var _Exception2=_interopRequireWildcard(_Exception);var _COMPILER_REVISION$REVISION_CHANGES$createFrame=require("./base");function checkRevision(compilerInfo){var compilerRevision=compilerInfo&&compilerInfo[0]||1,currentRevision=_COMPILER_REVISION$REVISION_CHANGES$createFrame.COMPILER_REVISION;if(compilerRevision!==currentRevision){if(compilerRevision<currentRevision){var runtimeVersions=_COMPILER_REVISION$REVISION_CHANGES$createFrame.REVISION_CHANGES[currentRevision],compilerVersions=_COMPILER_REVISION$REVISION_CHANGES$createFrame.REVISION_CHANGES[compilerRevision];throw new _Exception2["default"]("Template was precompiled with an older version of Handlebars than the current runtime. "+"Please update your precompiler to a newer version ("+runtimeVersions+") or downgrade your runtime to an older version ("+compilerVersions+").")}else{throw new _Exception2["default"]("Template was precompiled with a newer version of Handlebars than the current runtime. "+"Please update your runtime to a newer version ("+compilerInfo[1]+").")}}}function template(templateSpec,env){if(!env){throw new _Exception2["default"]("No environment passed to template")}if(!templateSpec||!templateSpec.main){throw new _Exception2["default"]("Unknown template object: "+typeof templateSpec)}env.VM.checkRevision(templateSpec.compiler);function invokePartialWrapper(partial,context,options){if(options.hash){context=Utils.extend({},context,options.hash)}partial=env.VM.resolvePartial.call(this,partial,context,options);var result=env.VM.invokePartial.call(this,partial,context,options);if(result==null&&env.compile){options.partials[options.name]=env.compile(partial,templateSpec.compilerOptions,env);result=options.partials[options.name](context,options)}if(result!=null){if(options.indent){var lines=result.split("\n");for(var i=0,l=lines.length;i<l;i++){if(!lines[i]&&i+1===l){break}lines[i]=options.indent+lines[i]}result=lines.join("\n")}return result}else{throw new _Exception2["default"]("The partial "+options.name+" could not be compiled when running in runtime-only mode")}}var container={strict:function strict(obj,name){if(!(name in obj)){throw new _Exception2["default"]('"'+name+'" not defined in '+obj)}return obj[name]},lookup:function lookup(depths,name){var len=depths.length;for(var i=0;i<len;i++){if(depths[i]&&depths[i][name]!=null){return depths[i][name]}}},lambda:function lambda(current,context){return typeof current==="function"?current.call(context):current},escapeExpression:Utils.escapeExpression,invokePartial:invokePartialWrapper,fn:function fn(i){return templateSpec[i]},programs:[],program:function program(i,data,declaredBlockParams,blockParams,depths){var programWrapper=this.programs[i],fn=this.fn(i);if(data||depths||blockParams||declaredBlockParams){programWrapper=wrapProgram(this,i,fn,data,declaredBlockParams,blockParams,depths)}else if(!programWrapper){programWrapper=this.programs[i]=wrapProgram(this,i,fn)}return programWrapper},data:function data(value,depth){while(value&&depth--){value=value._parent}return value},merge:function merge(param,common){var obj=param||common;if(param&&common&&param!==common){obj=Utils.extend({},common,param)}return obj},noop:env.VM.noop,compilerInfo:templateSpec.compiler};function ret(context){var options=arguments[1]===undefined?{}:arguments[1];var data=options.data;ret._setup(options);if(!options.partial&&templateSpec.useData){data=initData(context,data)}var depths=undefined,blockParams=templateSpec.useBlockParams?[]:undefined;if(templateSpec.useDepths){depths=options.depths?[context].concat(options.depths):[context]}return templateSpec.main.call(container,context,container.helpers,container.partials,data,blockParams,depths)}ret.isTop=true;ret._setup=function(options){if(!options.partial){container.helpers=container.merge(options.helpers,env.helpers);if(templateSpec.usePartial){container.partials=container.merge(options.partials,env.partials)}}else{container.helpers=options.helpers;container.partials=options.partials}};ret._child=function(i,data,blockParams,depths){if(templateSpec.useBlockParams&&!blockParams){throw new _Exception2["default"]("must pass block params")}if(templateSpec.useDepths&&!depths){throw new _Exception2["default"]("must pass parent depths")}return wrapProgram(container,i,templateSpec[i],data,0,blockParams,depths)};return ret}function wrapProgram(container,i,fn,data,declaredBlockParams,blockParams,depths){function prog(context){var options=arguments[1]===undefined?{}:arguments[1];return fn.call(container,context,container.helpers,container.partials,options.data||data,blockParams&&[options.blockParams].concat(blockParams),depths&&[context].concat(depths))}prog.program=i;prog.depth=depths?depths.length:0;prog.blockParams=declaredBlockParams||0;return prog}function resolvePartial(partial,context,options){if(!partial){partial=options.partials[options.name]}else if(!partial.call&&!options.name){options.name=partial;partial=options.partials[partial]}return partial}function invokePartial(partial,context,options){options.partial=true;if(partial===undefined){throw new _Exception2["default"]("The partial "+options.name+" could not be found")}else if(partial instanceof Function){return partial(context,options)}}function noop(){return""}function initData(context,data){if(!data||!("root"in data)){data=data?_COMPILER_REVISION$REVISION_CHANGES$createFrame.createFrame(data):{};data.root=context}return data}},{"./base":20,"./exception":31,"./utils":35}],34:[function(require,module,exports){"use strict";exports.__esModule=true;function SafeString(string){this.string=string}SafeString.prototype.toString=SafeString.prototype.toHTML=function(){return""+this.string};exports["default"]=SafeString;module.exports=exports["default"]},{}],35:[function(require,module,exports){"use strict";exports.__esModule=true;exports.extend=extend;exports.indexOf=indexOf;exports.escapeExpression=escapeExpression;exports.isEmpty=isEmpty;exports.blockParams=blockParams;exports.appendContextPath=appendContextPath;var escape={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var badChars=/[&<>"'`]/g,possible=/[&<>"'`]/;function escapeChar(chr){return escape[chr]}function extend(obj){for(var i=1;i<arguments.length;i++){for(var key in arguments[i]){if(Object.prototype.hasOwnProperty.call(arguments[i],key)){obj[key]=arguments[i][key]}}}return obj}var toString=Object.prototype.toString;exports.toString=toString;var isFunction=function isFunction(value){return typeof value==="function"};if(isFunction(/x/)){exports.isFunction=isFunction=function(value){return typeof value==="function"&&toString.call(value)==="[object Function]"}}var isFunction;exports.isFunction=isFunction;var isArray=Array.isArray||function(value){return value&&typeof value==="object"?toString.call(value)==="[object Array]":false};exports.isArray=isArray;function indexOf(array,value){for(var i=0,len=array.length;i<len;i++){if(array[i]===value){return i}}return-1}function escapeExpression(string){if(typeof string!=="string"){if(string&&string.toHTML){return string.toHTML()}else if(string==null){return""}else if(!string){return string+""}string=""+string}if(!possible.test(string)){return string}return string.replace(badChars,escapeChar)}function isEmpty(value){if(!value&&value!==0){return true}else if(isArray(value)&&value.length===0){return true}else{return false}}function blockParams(params,ids){params.path=ids;return params}function appendContextPath(contextPath,id){return(contextPath?contextPath+".":"")+id}},{}],36:[function(require,module,exports){var handlebars=require("../dist/cjs/handlebars")["default"];var printer=require("../dist/cjs/handlebars/compiler/printer");handlebars.PrintVisitor=printer.PrintVisitor;handlebars.print=printer.print;module.exports=handlebars;function extension(module,filename){var fs=require("fs");var templateString=fs.readFileSync(filename,"utf8");module.exports=handlebars.compile(templateString)}if(typeof require!=="undefined"&&require.extensions){require.extensions[".handlebars"]=extension;require.extensions[".hbs"]=extension}},{"../dist/cjs/handlebars":18,"../dist/cjs/handlebars/compiler/printer":28,fs:1}],37:[function(require,module,exports){exports.SourceMapGenerator=require("./source-map/source-map-generator").SourceMapGenerator;exports.SourceMapConsumer=require("./source-map/source-map-consumer").SourceMapConsumer;exports.SourceNode=require("./source-map/source-node").SourceNode},{"./source-map/source-map-consumer":43,"./source-map/source-map-generator":44,"./source-map/source-node":45}],38:[function(require,module,exports){if(typeof define!=="function"){var define=require("amdefine")(module,require)}define(function(require,exports,module){var util=require("./util");function ArraySet(){this._array=[];this._set={}}ArraySet.fromArray=function ArraySet_fromArray(aArray,aAllowDuplicates){var set=new ArraySet;for(var i=0,len=aArray.length;i<len;i++){set.add(aArray[i],aAllowDuplicates)}return set};ArraySet.prototype.add=function ArraySet_add(aStr,aAllowDuplicates){var isDuplicate=this.has(aStr);var idx=this._array.length;if(!isDuplicate||aAllowDuplicates){this._array.push(aStr)}if(!isDuplicate){this._set[util.toSetString(aStr)]=idx}};ArraySet.prototype.has=function ArraySet_has(aStr){return Object.prototype.hasOwnProperty.call(this._set,util.toSetString(aStr))};ArraySet.prototype.indexOf=function ArraySet_indexOf(aStr){if(this.has(aStr)){return this._set[util.toSetString(aStr)]}throw new Error('"'+aStr+'" is not in the set.')};ArraySet.prototype.at=function ArraySet_at(aIdx){if(aIdx>=0&&aIdx<this._array.length){return this._array[aIdx]}throw new Error("No element indexed by "+aIdx)};ArraySet.prototype.toArray=function ArraySet_toArray(){return this._array.slice()};exports.ArraySet=ArraySet})},{"./util":46,amdefine:47}],39:[function(require,module,exports){if(typeof define!=="function"){var define=require("amdefine")(module,require)}define(function(require,exports,module){var base64=require("./base64");var VLQ_BASE_SHIFT=5;var VLQ_BASE=1<<VLQ_BASE_SHIFT;var VLQ_BASE_MASK=VLQ_BASE-1;var VLQ_CONTINUATION_BIT=VLQ_BASE;function toVLQSigned(aValue){return aValue<0?(-aValue<<1)+1:(aValue<<1)+0}function fromVLQSigned(aValue){var isNegative=(aValue&1)===1;var shifted=aValue>>1;return isNegative?-shifted:shifted}exports.encode=function base64VLQ_encode(aValue){var encoded="";var digit;var vlq=toVLQSigned(aValue);do{digit=vlq&VLQ_BASE_MASK;vlq>>>=VLQ_BASE_SHIFT;if(vlq>0){digit|=VLQ_CONTINUATION_BIT}encoded+=base64.encode(digit)}while(vlq>0);return encoded};exports.decode=function base64VLQ_decode(aStr,aOutParam){var i=0;var strLen=aStr.length;var result=0;var shift=0;var continuation,digit;do{if(i>=strLen){throw new Error("Expected more digits in base 64 VLQ value.")}digit=base64.decode(aStr.charAt(i++));continuation=!!(digit&VLQ_CONTINUATION_BIT);digit&=VLQ_BASE_MASK;result=result+(digit<<shift);shift+=VLQ_BASE_SHIFT}while(continuation);aOutParam.value=fromVLQSigned(result);aOutParam.rest=aStr.slice(i)}})},{"./base64":40,amdefine:47}],40:[function(require,module,exports){if(typeof define!=="function"){var define=require("amdefine")(module,require)}define(function(require,exports,module){var charToIntMap={};var intToCharMap={};"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("").forEach(function(ch,index){charToIntMap[ch]=index;intToCharMap[index]=ch});exports.encode=function base64_encode(aNumber){if(aNumber in intToCharMap){return intToCharMap[aNumber]}throw new TypeError("Must be between 0 and 63: "+aNumber)};exports.decode=function base64_decode(aChar){if(aChar in charToIntMap){return charToIntMap[aChar]}throw new TypeError("Not a valid base 64 digit: "+aChar)}})},{amdefine:47}],41:[function(require,module,exports){if(typeof define!=="function"){var define=require("amdefine")(module,require)}define(function(require,exports,module){function recursiveSearch(aLow,aHigh,aNeedle,aHaystack,aCompare){var mid=Math.floor((aHigh-aLow)/2)+aLow;var cmp=aCompare(aNeedle,aHaystack[mid],true);if(cmp===0){return mid}else if(cmp>0){if(aHigh-mid>1){return recursiveSearch(mid,aHigh,aNeedle,aHaystack,aCompare)}return mid}else{if(mid-aLow>1){return recursiveSearch(aLow,mid,aNeedle,aHaystack,aCompare)}return aLow<0?-1:aLow}}exports.search=function search(aNeedle,aHaystack,aCompare){if(aHaystack.length===0){return-1}return recursiveSearch(-1,aHaystack.length,aNeedle,aHaystack,aCompare)}})},{amdefine:47}],42:[function(require,module,exports){if(typeof define!=="function"){var define=require("amdefine")(module,require)}define(function(require,exports,module){var util=require("./util");function generatedPositionAfter(mappingA,mappingB){var lineA=mappingA.generatedLine;var lineB=mappingB.generatedLine;var columnA=mappingA.generatedColumn;var columnB=mappingB.generatedColumn;return lineB>lineA||lineB==lineA&&columnB>=columnA||util.compareByGeneratedPositions(mappingA,mappingB)<=0}function MappingList(){this._array=[];this._sorted=true;this._last={generatedLine:-1,generatedColumn:0}}MappingList.prototype.unsortedForEach=function MappingList_forEach(aCallback,aThisArg){this._array.forEach(aCallback,aThisArg)};MappingList.prototype.add=function MappingList_add(aMapping){var mapping;if(generatedPositionAfter(this._last,aMapping)){this._last=aMapping;this._array.push(aMapping)}else{this._sorted=false;this._array.push(aMapping)}};MappingList.prototype.toArray=function MappingList_toArray(){if(!this._sorted){this._array.sort(util.compareByGeneratedPositions);this._sorted=true}return this._array};exports.MappingList=MappingList})},{"./util":46,amdefine:47}],43:[function(require,module,exports){if(typeof define!=="function"){var define=require("amdefine")(module,require)}define(function(require,exports,module){var util=require("./util");var binarySearch=require("./binary-search");var ArraySet=require("./array-set").ArraySet;var base64VLQ=require("./base64-vlq");function SourceMapConsumer(aSourceMap){var sourceMap=aSourceMap;if(typeof aSourceMap==="string"){sourceMap=JSON.parse(aSourceMap.replace(/^\)\]\}'/,""))}var version=util.getArg(sourceMap,"version");var sources=util.getArg(sourceMap,"sources");var names=util.getArg(sourceMap,"names",[]);var sourceRoot=util.getArg(sourceMap,"sourceRoot",null);var sourcesContent=util.getArg(sourceMap,"sourcesContent",null);var mappings=util.getArg(sourceMap,"mappings");var file=util.getArg(sourceMap,"file",null);if(version!=this._version){throw new Error("Unsupported version: "+version)}sources=sources.map(util.normalize);this._names=ArraySet.fromArray(names,true);this._sources=ArraySet.fromArray(sources,true);this.sourceRoot=sourceRoot;this.sourcesContent=sourcesContent;this._mappings=mappings;this.file=file}SourceMapConsumer.fromSourceMap=function SourceMapConsumer_fromSourceMap(aSourceMap){var smc=Object.create(SourceMapConsumer.prototype);smc._names=ArraySet.fromArray(aSourceMap._names.toArray(),true);smc._sources=ArraySet.fromArray(aSourceMap._sources.toArray(),true);smc.sourceRoot=aSourceMap._sourceRoot;smc.sourcesContent=aSourceMap._generateSourcesContent(smc._sources.toArray(),smc.sourceRoot);smc.file=aSourceMap._file;smc.__generatedMappings=aSourceMap._mappings.toArray().slice();smc.__originalMappings=aSourceMap._mappings.toArray().slice().sort(util.compareByOriginalPositions);return smc};SourceMapConsumer.prototype._version=3;Object.defineProperty(SourceMapConsumer.prototype,"sources",{get:function(){return this._sources.toArray().map(function(s){return this.sourceRoot!=null?util.join(this.sourceRoot,s):s},this)}});SourceMapConsumer.prototype.__generatedMappings=null;Object.defineProperty(SourceMapConsumer.prototype,"_generatedMappings",{get:function(){if(!this.__generatedMappings){this.__generatedMappings=[];this.__originalMappings=[];this._parseMappings(this._mappings,this.sourceRoot)}return this.__generatedMappings}});SourceMapConsumer.prototype.__originalMappings=null;Object.defineProperty(SourceMapConsumer.prototype,"_originalMappings",{get:function(){if(!this.__originalMappings){this.__generatedMappings=[];this.__originalMappings=[];this._parseMappings(this._mappings,this.sourceRoot)}return this.__originalMappings}});SourceMapConsumer.prototype._nextCharIsMappingSeparator=function SourceMapConsumer_nextCharIsMappingSeparator(aStr){var c=aStr.charAt(0);return c===";"||c===","};SourceMapConsumer.prototype._parseMappings=function SourceMapConsumer_parseMappings(aStr,aSourceRoot){var generatedLine=1;var previousGeneratedColumn=0;var previousOriginalLine=0;var previousOriginalColumn=0;var previousSource=0;var previousName=0;var str=aStr;var temp={};var mapping;while(str.length>0){if(str.charAt(0)===";"){generatedLine++;str=str.slice(1);previousGeneratedColumn=0}else if(str.charAt(0)===","){str=str.slice(1)}else{mapping={};mapping.generatedLine=generatedLine;base64VLQ.decode(str,temp);mapping.generatedColumn=previousGeneratedColumn+temp.value;previousGeneratedColumn=mapping.generatedColumn;str=temp.rest;if(str.length>0&&!this._nextCharIsMappingSeparator(str)){base64VLQ.decode(str,temp);mapping.source=this._sources.at(previousSource+temp.value);previousSource+=temp.value;str=temp.rest;if(str.length===0||this._nextCharIsMappingSeparator(str)){throw new Error("Found a source, but no line and column")}base64VLQ.decode(str,temp);mapping.originalLine=previousOriginalLine+temp.value;previousOriginalLine=mapping.originalLine;mapping.originalLine+=1;str=temp.rest;if(str.length===0||this._nextCharIsMappingSeparator(str)){throw new Error("Found a source and line, but no column")}base64VLQ.decode(str,temp);mapping.originalColumn=previousOriginalColumn+temp.value;previousOriginalColumn=mapping.originalColumn;str=temp.rest;if(str.length>0&&!this._nextCharIsMappingSeparator(str)){base64VLQ.decode(str,temp);mapping.name=this._names.at(previousName+temp.value);previousName+=temp.value;str=temp.rest}}this.__generatedMappings.push(mapping);if(typeof mapping.originalLine==="number"){this.__originalMappings.push(mapping)}}}this.__generatedMappings.sort(util.compareByGeneratedPositions);this.__originalMappings.sort(util.compareByOriginalPositions)};SourceMapConsumer.prototype._findMapping=function SourceMapConsumer_findMapping(aNeedle,aMappings,aLineName,aColumnName,aComparator){if(aNeedle[aLineName]<=0){throw new TypeError("Line must be greater than or equal to 1, got "+aNeedle[aLineName])}if(aNeedle[aColumnName]<0){throw new TypeError("Column must be greater than or equal to 0, got "+aNeedle[aColumnName])}return binarySearch.search(aNeedle,aMappings,aComparator)};SourceMapConsumer.prototype.computeColumnSpans=function SourceMapConsumer_computeColumnSpans(){for(var index=0;index<this._generatedMappings.length;++index){var mapping=this._generatedMappings[index];if(index+1<this._generatedMappings.length){var nextMapping=this._generatedMappings[index+1];if(mapping.generatedLine===nextMapping.generatedLine){mapping.lastGeneratedColumn=nextMapping.generatedColumn-1;continue}}mapping.lastGeneratedColumn=Infinity}};SourceMapConsumer.prototype.originalPositionFor=function SourceMapConsumer_originalPositionFor(aArgs){var needle={generatedLine:util.getArg(aArgs,"line"),generatedColumn:util.getArg(aArgs,"column")};var index=this._findMapping(needle,this._generatedMappings,"generatedLine","generatedColumn",util.compareByGeneratedPositions);if(index>=0){var mapping=this._generatedMappings[index];if(mapping.generatedLine===needle.generatedLine){
var source=util.getArg(mapping,"source",null);if(source!=null&&this.sourceRoot!=null){source=util.join(this.sourceRoot,source)}return{source:source,line:util.getArg(mapping,"originalLine",null),column:util.getArg(mapping,"originalColumn",null),name:util.getArg(mapping,"name",null)}}}return{source:null,line:null,column:null,name:null}};SourceMapConsumer.prototype.sourceContentFor=function SourceMapConsumer_sourceContentFor(aSource){if(!this.sourcesContent){return null}if(this.sourceRoot!=null){aSource=util.relative(this.sourceRoot,aSource)}if(this._sources.has(aSource)){return this.sourcesContent[this._sources.indexOf(aSource)]}var url;if(this.sourceRoot!=null&&(url=util.urlParse(this.sourceRoot))){var fileUriAbsPath=aSource.replace(/^file:\/\//,"");if(url.scheme=="file"&&this._sources.has(fileUriAbsPath)){return this.sourcesContent[this._sources.indexOf(fileUriAbsPath)]}if((!url.path||url.path=="/")&&this._sources.has("/"+aSource)){return this.sourcesContent[this._sources.indexOf("/"+aSource)]}}throw new Error('"'+aSource+'" is not in the SourceMap.')};SourceMapConsumer.prototype.generatedPositionFor=function SourceMapConsumer_generatedPositionFor(aArgs){var needle={source:util.getArg(aArgs,"source"),originalLine:util.getArg(aArgs,"line"),originalColumn:util.getArg(aArgs,"column")};if(this.sourceRoot!=null){needle.source=util.relative(this.sourceRoot,needle.source)}var index=this._findMapping(needle,this._originalMappings,"originalLine","originalColumn",util.compareByOriginalPositions);if(index>=0){var mapping=this._originalMappings[index];return{line:util.getArg(mapping,"generatedLine",null),column:util.getArg(mapping,"generatedColumn",null),lastColumn:util.getArg(mapping,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}};SourceMapConsumer.prototype.allGeneratedPositionsFor=function SourceMapConsumer_allGeneratedPositionsFor(aArgs){var needle={source:util.getArg(aArgs,"source"),originalLine:util.getArg(aArgs,"line"),originalColumn:Infinity};if(this.sourceRoot!=null){needle.source=util.relative(this.sourceRoot,needle.source)}var mappings=[];var index=this._findMapping(needle,this._originalMappings,"originalLine","originalColumn",util.compareByOriginalPositions);if(index>=0){var mapping=this._originalMappings[index];while(mapping&&mapping.originalLine===needle.originalLine){mappings.push({line:util.getArg(mapping,"generatedLine",null),column:util.getArg(mapping,"generatedColumn",null),lastColumn:util.getArg(mapping,"lastGeneratedColumn",null)});mapping=this._originalMappings[--index]}}return mappings.reverse()};SourceMapConsumer.GENERATED_ORDER=1;SourceMapConsumer.ORIGINAL_ORDER=2;SourceMapConsumer.prototype.eachMapping=function SourceMapConsumer_eachMapping(aCallback,aContext,aOrder){var context=aContext||null;var order=aOrder||SourceMapConsumer.GENERATED_ORDER;var mappings;switch(order){case SourceMapConsumer.GENERATED_ORDER:mappings=this._generatedMappings;break;case SourceMapConsumer.ORIGINAL_ORDER:mappings=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var sourceRoot=this.sourceRoot;mappings.map(function(mapping){var source=mapping.source;if(source!=null&&sourceRoot!=null){source=util.join(sourceRoot,source)}return{source:source,generatedLine:mapping.generatedLine,generatedColumn:mapping.generatedColumn,originalLine:mapping.originalLine,originalColumn:mapping.originalColumn,name:mapping.name}}).forEach(aCallback,context)};exports.SourceMapConsumer=SourceMapConsumer})},{"./array-set":38,"./base64-vlq":39,"./binary-search":41,"./util":46,amdefine:47}],44:[function(require,module,exports){if(typeof define!=="function"){var define=require("amdefine")(module,require)}define(function(require,exports,module){var base64VLQ=require("./base64-vlq");var util=require("./util");var ArraySet=require("./array-set").ArraySet;var MappingList=require("./mapping-list").MappingList;function SourceMapGenerator(aArgs){if(!aArgs){aArgs={}}this._file=util.getArg(aArgs,"file",null);this._sourceRoot=util.getArg(aArgs,"sourceRoot",null);this._skipValidation=util.getArg(aArgs,"skipValidation",false);this._sources=new ArraySet;this._names=new ArraySet;this._mappings=new MappingList;this._sourcesContents=null}SourceMapGenerator.prototype._version=3;SourceMapGenerator.fromSourceMap=function SourceMapGenerator_fromSourceMap(aSourceMapConsumer){var sourceRoot=aSourceMapConsumer.sourceRoot;var generator=new SourceMapGenerator({file:aSourceMapConsumer.file,sourceRoot:sourceRoot});aSourceMapConsumer.eachMapping(function(mapping){var newMapping={generated:{line:mapping.generatedLine,column:mapping.generatedColumn}};if(mapping.source!=null){newMapping.source=mapping.source;if(sourceRoot!=null){newMapping.source=util.relative(sourceRoot,newMapping.source)}newMapping.original={line:mapping.originalLine,column:mapping.originalColumn};if(mapping.name!=null){newMapping.name=mapping.name}}generator.addMapping(newMapping)});aSourceMapConsumer.sources.forEach(function(sourceFile){var content=aSourceMapConsumer.sourceContentFor(sourceFile);if(content!=null){generator.setSourceContent(sourceFile,content)}});return generator};SourceMapGenerator.prototype.addMapping=function SourceMapGenerator_addMapping(aArgs){var generated=util.getArg(aArgs,"generated");var original=util.getArg(aArgs,"original",null);var source=util.getArg(aArgs,"source",null);var name=util.getArg(aArgs,"name",null);if(!this._skipValidation){this._validateMapping(generated,original,source,name)}if(source!=null&&!this._sources.has(source)){this._sources.add(source)}if(name!=null&&!this._names.has(name)){this._names.add(name)}this._mappings.add({generatedLine:generated.line,generatedColumn:generated.column,originalLine:original!=null&&original.line,originalColumn:original!=null&&original.column,source:source,name:name})};SourceMapGenerator.prototype.setSourceContent=function SourceMapGenerator_setSourceContent(aSourceFile,aSourceContent){var source=aSourceFile;if(this._sourceRoot!=null){source=util.relative(this._sourceRoot,source)}if(aSourceContent!=null){if(!this._sourcesContents){this._sourcesContents={}}this._sourcesContents[util.toSetString(source)]=aSourceContent}else if(this._sourcesContents){delete this._sourcesContents[util.toSetString(source)];if(Object.keys(this._sourcesContents).length===0){this._sourcesContents=null}}};SourceMapGenerator.prototype.applySourceMap=function SourceMapGenerator_applySourceMap(aSourceMapConsumer,aSourceFile,aSourceMapPath){var sourceFile=aSourceFile;if(aSourceFile==null){if(aSourceMapConsumer.file==null){throw new Error("SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, "+'or the source map\'s "file" property. Both were omitted.')}sourceFile=aSourceMapConsumer.file}var sourceRoot=this._sourceRoot;if(sourceRoot!=null){sourceFile=util.relative(sourceRoot,sourceFile)}var newSources=new ArraySet;var newNames=new ArraySet;this._mappings.unsortedForEach(function(mapping){if(mapping.source===sourceFile&&mapping.originalLine!=null){var original=aSourceMapConsumer.originalPositionFor({line:mapping.originalLine,column:mapping.originalColumn});if(original.source!=null){mapping.source=original.source;if(aSourceMapPath!=null){mapping.source=util.join(aSourceMapPath,mapping.source)}if(sourceRoot!=null){mapping.source=util.relative(sourceRoot,mapping.source)}mapping.originalLine=original.line;mapping.originalColumn=original.column;if(original.name!=null){mapping.name=original.name}}}var source=mapping.source;if(source!=null&&!newSources.has(source)){newSources.add(source)}var name=mapping.name;if(name!=null&&!newNames.has(name)){newNames.add(name)}},this);this._sources=newSources;this._names=newNames;aSourceMapConsumer.sources.forEach(function(sourceFile){var content=aSourceMapConsumer.sourceContentFor(sourceFile);if(content!=null){if(aSourceMapPath!=null){sourceFile=util.join(aSourceMapPath,sourceFile)}if(sourceRoot!=null){sourceFile=util.relative(sourceRoot,sourceFile)}this.setSourceContent(sourceFile,content)}},this)};SourceMapGenerator.prototype._validateMapping=function SourceMapGenerator_validateMapping(aGenerated,aOriginal,aSource,aName){if(aGenerated&&"line"in aGenerated&&"column"in aGenerated&&aGenerated.line>0&&aGenerated.column>=0&&!aOriginal&&!aSource&&!aName){return}else if(aGenerated&&"line"in aGenerated&&"column"in aGenerated&&aOriginal&&"line"in aOriginal&&"column"in aOriginal&&aGenerated.line>0&&aGenerated.column>=0&&aOriginal.line>0&&aOriginal.column>=0&&aSource){return}else{throw new Error("Invalid mapping: "+JSON.stringify({generated:aGenerated,source:aSource,original:aOriginal,name:aName}))}};SourceMapGenerator.prototype._serializeMappings=function SourceMapGenerator_serializeMappings(){var previousGeneratedColumn=0;var previousGeneratedLine=1;var previousOriginalColumn=0;var previousOriginalLine=0;var previousName=0;var previousSource=0;var result="";var mapping;var mappings=this._mappings.toArray();for(var i=0,len=mappings.length;i<len;i++){mapping=mappings[i];if(mapping.generatedLine!==previousGeneratedLine){previousGeneratedColumn=0;while(mapping.generatedLine!==previousGeneratedLine){result+=";";previousGeneratedLine++}}else{if(i>0){if(!util.compareByGeneratedPositions(mapping,mappings[i-1])){continue}result+=","}}result+=base64VLQ.encode(mapping.generatedColumn-previousGeneratedColumn);previousGeneratedColumn=mapping.generatedColumn;if(mapping.source!=null){result+=base64VLQ.encode(this._sources.indexOf(mapping.source)-previousSource);previousSource=this._sources.indexOf(mapping.source);result+=base64VLQ.encode(mapping.originalLine-1-previousOriginalLine);previousOriginalLine=mapping.originalLine-1;result+=base64VLQ.encode(mapping.originalColumn-previousOriginalColumn);previousOriginalColumn=mapping.originalColumn;if(mapping.name!=null){result+=base64VLQ.encode(this._names.indexOf(mapping.name)-previousName);previousName=this._names.indexOf(mapping.name)}}}return result};SourceMapGenerator.prototype._generateSourcesContent=function SourceMapGenerator_generateSourcesContent(aSources,aSourceRoot){return aSources.map(function(source){if(!this._sourcesContents){return null}if(aSourceRoot!=null){source=util.relative(aSourceRoot,source)}var key=util.toSetString(source);return Object.prototype.hasOwnProperty.call(this._sourcesContents,key)?this._sourcesContents[key]:null},this)};SourceMapGenerator.prototype.toJSON=function SourceMapGenerator_toJSON(){var map={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};if(this._file!=null){map.file=this._file}if(this._sourceRoot!=null){map.sourceRoot=this._sourceRoot}if(this._sourcesContents){map.sourcesContent=this._generateSourcesContent(map.sources,map.sourceRoot)}return map};SourceMapGenerator.prototype.toString=function SourceMapGenerator_toString(){return JSON.stringify(this)};exports.SourceMapGenerator=SourceMapGenerator})},{"./array-set":38,"./base64-vlq":39,"./mapping-list":42,"./util":46,amdefine:47}],45:[function(require,module,exports){if(typeof define!=="function"){var define=require("amdefine")(module,require)}define(function(require,exports,module){var SourceMapGenerator=require("./source-map-generator").SourceMapGenerator;var util=require("./util");var REGEX_NEWLINE=/(\r?\n)/;var NEWLINE_CODE=10;var isSourceNode="$$$isSourceNode$$$";function SourceNode(aLine,aColumn,aSource,aChunks,aName){this.children=[];this.sourceContents={};this.line=aLine==null?null:aLine;this.column=aColumn==null?null:aColumn;this.source=aSource==null?null:aSource;this.name=aName==null?null:aName;this[isSourceNode]=true;if(aChunks!=null)this.add(aChunks)}SourceNode.fromStringWithSourceMap=function SourceNode_fromStringWithSourceMap(aGeneratedCode,aSourceMapConsumer,aRelativePath){var node=new SourceNode;var remainingLines=aGeneratedCode.split(REGEX_NEWLINE);var shiftNextLine=function(){var lineContents=remainingLines.shift();var newLine=remainingLines.shift()||"";return lineContents+newLine};var lastGeneratedLine=1,lastGeneratedColumn=0;var lastMapping=null;aSourceMapConsumer.eachMapping(function(mapping){if(lastMapping!==null){if(lastGeneratedLine<mapping.generatedLine){var code="";addMappingWithCode(lastMapping,shiftNextLine());lastGeneratedLine++;lastGeneratedColumn=0}else{var nextLine=remainingLines[0];var code=nextLine.substr(0,mapping.generatedColumn-lastGeneratedColumn);remainingLines[0]=nextLine.substr(mapping.generatedColumn-lastGeneratedColumn);lastGeneratedColumn=mapping.generatedColumn;addMappingWithCode(lastMapping,code);lastMapping=mapping;return}}while(lastGeneratedLine<mapping.generatedLine){node.add(shiftNextLine());lastGeneratedLine++}if(lastGeneratedColumn<mapping.generatedColumn){var nextLine=remainingLines[0];node.add(nextLine.substr(0,mapping.generatedColumn));remainingLines[0]=nextLine.substr(mapping.generatedColumn);lastGeneratedColumn=mapping.generatedColumn}lastMapping=mapping},this);if(remainingLines.length>0){if(lastMapping){addMappingWithCode(lastMapping,shiftNextLine())}node.add(remainingLines.join(""))}aSourceMapConsumer.sources.forEach(function(sourceFile){var content=aSourceMapConsumer.sourceContentFor(sourceFile);if(content!=null){if(aRelativePath!=null){sourceFile=util.join(aRelativePath,sourceFile)}node.setSourceContent(sourceFile,content)}});return node;function addMappingWithCode(mapping,code){if(mapping===null||mapping.source===undefined){node.add(code)}else{var source=aRelativePath?util.join(aRelativePath,mapping.source):mapping.source;node.add(new SourceNode(mapping.originalLine,mapping.originalColumn,source,code,mapping.name))}}};SourceNode.prototype.add=function SourceNode_add(aChunk){if(Array.isArray(aChunk)){aChunk.forEach(function(chunk){this.add(chunk)},this)}else if(aChunk[isSourceNode]||typeof aChunk==="string"){if(aChunk){this.children.push(aChunk)}}else{throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+aChunk)}return this};SourceNode.prototype.prepend=function SourceNode_prepend(aChunk){if(Array.isArray(aChunk)){for(var i=aChunk.length-1;i>=0;i--){this.prepend(aChunk[i])}}else if(aChunk[isSourceNode]||typeof aChunk==="string"){this.children.unshift(aChunk)}else{throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+aChunk)}return this};SourceNode.prototype.walk=function SourceNode_walk(aFn){var chunk;for(var i=0,len=this.children.length;i<len;i++){chunk=this.children[i];if(chunk[isSourceNode]){chunk.walk(aFn)}else{if(chunk!==""){aFn(chunk,{source:this.source,line:this.line,column:this.column,name:this.name})}}}};SourceNode.prototype.join=function SourceNode_join(aSep){var newChildren;var i;var len=this.children.length;if(len>0){newChildren=[];for(i=0;i<len-1;i++){newChildren.push(this.children[i]);newChildren.push(aSep)}newChildren.push(this.children[i]);this.children=newChildren}return this};SourceNode.prototype.replaceRight=function SourceNode_replaceRight(aPattern,aReplacement){var lastChild=this.children[this.children.length-1];if(lastChild[isSourceNode]){lastChild.replaceRight(aPattern,aReplacement)}else if(typeof lastChild==="string"){this.children[this.children.length-1]=lastChild.replace(aPattern,aReplacement)}else{this.children.push("".replace(aPattern,aReplacement))}return this};SourceNode.prototype.setSourceContent=function SourceNode_setSourceContent(aSourceFile,aSourceContent){this.sourceContents[util.toSetString(aSourceFile)]=aSourceContent};SourceNode.prototype.walkSourceContents=function SourceNode_walkSourceContents(aFn){for(var i=0,len=this.children.length;i<len;i++){if(this.children[i][isSourceNode]){this.children[i].walkSourceContents(aFn)}}var sources=Object.keys(this.sourceContents);for(var i=0,len=sources.length;i<len;i++){aFn(util.fromSetString(sources[i]),this.sourceContents[sources[i]])}};SourceNode.prototype.toString=function SourceNode_toString(){var str="";this.walk(function(chunk){str+=chunk});return str};SourceNode.prototype.toStringWithSourceMap=function SourceNode_toStringWithSourceMap(aArgs){var generated={code:"",line:1,column:0};var map=new SourceMapGenerator(aArgs);var sourceMappingActive=false;var lastOriginalSource=null;var lastOriginalLine=null;var lastOriginalColumn=null;var lastOriginalName=null;this.walk(function(chunk,original){generated.code+=chunk;if(original.source!==null&&original.line!==null&&original.column!==null){if(lastOriginalSource!==original.source||lastOriginalLine!==original.line||lastOriginalColumn!==original.column||lastOriginalName!==original.name){map.addMapping({source:original.source,original:{line:original.line,column:original.column},generated:{line:generated.line,column:generated.column},name:original.name})}lastOriginalSource=original.source;lastOriginalLine=original.line;lastOriginalColumn=original.column;lastOriginalName=original.name;sourceMappingActive=true}else if(sourceMappingActive){map.addMapping({generated:{line:generated.line,column:generated.column}});lastOriginalSource=null;sourceMappingActive=false}for(var idx=0,length=chunk.length;idx<length;idx++){if(chunk.charCodeAt(idx)===NEWLINE_CODE){generated.line++;generated.column=0;if(idx+1===length){lastOriginalSource=null;sourceMappingActive=false}else if(sourceMappingActive){map.addMapping({source:original.source,original:{line:original.line,column:original.column},generated:{line:generated.line,column:generated.column},name:original.name})}}else{generated.column++}}});this.walkSourceContents(function(sourceFile,sourceContent){map.setSourceContent(sourceFile,sourceContent)});return{code:generated.code,map:map}};exports.SourceNode=SourceNode})},{"./source-map-generator":44,"./util":46,amdefine:47}],46:[function(require,module,exports){if(typeof define!=="function"){var define=require("amdefine")(module,require)}define(function(require,exports,module){function getArg(aArgs,aName,aDefaultValue){if(aName in aArgs){return aArgs[aName]}else if(arguments.length===3){return aDefaultValue}else{throw new Error('"'+aName+'" is a required argument.')}}exports.getArg=getArg;var urlRegexp=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.]*)(?::(\d+))?(\S*)$/;var dataUrlRegexp=/^data:.+\,.+$/;function urlParse(aUrl){var match=aUrl.match(urlRegexp);if(!match){return null}return{scheme:match[1],auth:match[2],host:match[3],port:match[4],path:match[5]}}exports.urlParse=urlParse;function urlGenerate(aParsedUrl){var url="";if(aParsedUrl.scheme){url+=aParsedUrl.scheme+":"}url+="//";if(aParsedUrl.auth){url+=aParsedUrl.auth+"@"}if(aParsedUrl.host){url+=aParsedUrl.host}if(aParsedUrl.port){url+=":"+aParsedUrl.port}if(aParsedUrl.path){url+=aParsedUrl.path}return url}exports.urlGenerate=urlGenerate;function normalize(aPath){var path=aPath;var url=urlParse(aPath);if(url){if(!url.path){return aPath}path=url.path}var isAbsolute=path.charAt(0)==="/";var parts=path.split(/\/+/);for(var part,up=0,i=parts.length-1;i>=0;i--){part=parts[i];if(part==="."){parts.splice(i,1)}else if(part===".."){up++}else if(up>0){if(part===""){parts.splice(i+1,up);up=0}else{parts.splice(i,2);up--}}}path=parts.join("/");if(path===""){path=isAbsolute?"/":"."}if(url){url.path=path;return urlGenerate(url)}return path}exports.normalize=normalize;function join(aRoot,aPath){if(aRoot===""){aRoot="."}if(aPath===""){aPath="."}var aPathUrl=urlParse(aPath);var aRootUrl=urlParse(aRoot);if(aRootUrl){aRoot=aRootUrl.path||"/"}if(aPathUrl&&!aPathUrl.scheme){if(aRootUrl){aPathUrl.scheme=aRootUrl.scheme}return urlGenerate(aPathUrl)}if(aPathUrl||aPath.match(dataUrlRegexp)){return aPath}if(aRootUrl&&!aRootUrl.host&&!aRootUrl.path){aRootUrl.host=aPath;return urlGenerate(aRootUrl)}var joined=aPath.charAt(0)==="/"?aPath:normalize(aRoot.replace(/\/+$/,"")+"/"+aPath);if(aRootUrl){aRootUrl.path=joined;return urlGenerate(aRootUrl)}return joined}exports.join=join;function relative(aRoot,aPath){if(aRoot===""){aRoot="."}aRoot=aRoot.replace(/\/$/,"");var url=urlParse(aRoot);if(aPath.charAt(0)=="/"&&url&&url.path=="/"){return aPath.slice(1)}return aPath.indexOf(aRoot+"/")===0?aPath.substr(aRoot.length+1):aPath}exports.relative=relative;function toSetString(aStr){return"$"+aStr}exports.toSetString=toSetString;function fromSetString(aStr){return aStr.substr(1)}exports.fromSetString=fromSetString;function strcmp(aStr1,aStr2){var s1=aStr1||"";var s2=aStr2||"";return(s1>s2)-(s1<s2)}function compareByOriginalPositions(mappingA,mappingB,onlyCompareOriginal){var cmp;cmp=strcmp(mappingA.source,mappingB.source);if(cmp){return cmp}cmp=mappingA.originalLine-mappingB.originalLine;if(cmp){return cmp}cmp=mappingA.originalColumn-mappingB.originalColumn;if(cmp||onlyCompareOriginal){return cmp}cmp=strcmp(mappingA.name,mappingB.name);if(cmp){return cmp}cmp=mappingA.generatedLine-mappingB.generatedLine;if(cmp){return cmp}return mappingA.generatedColumn-mappingB.generatedColumn}exports.compareByOriginalPositions=compareByOriginalPositions;function compareByGeneratedPositions(mappingA,mappingB,onlyCompareGenerated){var cmp;cmp=mappingA.generatedLine-mappingB.generatedLine;if(cmp){return cmp}cmp=mappingA.generatedColumn-mappingB.generatedColumn;if(cmp||onlyCompareGenerated){return cmp}cmp=strcmp(mappingA.source,mappingB.source);if(cmp){return cmp}cmp=mappingA.originalLine-mappingB.originalLine;if(cmp){return cmp}cmp=mappingA.originalColumn-mappingB.originalColumn;if(cmp){return cmp}return strcmp(mappingA.name,mappingB.name)}exports.compareByGeneratedPositions=compareByGeneratedPositions})},{amdefine:47}],47:[function(require,module,exports){(function(process,__filename){"use strict";function amdefine(module,requireFn){"use strict";var defineCache={},loaderCache={},alreadyCalled=false,path=require("path"),makeRequire,stringRequire;function trimDots(ary){var i,part;for(i=0;ary[i];i+=1){part=ary[i];if(part==="."){ary.splice(i,1);i-=1}else if(part===".."){if(i===1&&(ary[2]===".."||ary[0]==="..")){break}else if(i>0){ary.splice(i-1,2);i-=2}}}}function normalize(name,baseName){var baseParts;if(name&&name.charAt(0)==="."){if(baseName){baseParts=baseName.split("/");baseParts=baseParts.slice(0,baseParts.length-1);baseParts=baseParts.concat(name.split("/"));trimDots(baseParts);name=baseParts.join("/")}}return name}function makeNormalize(relName){return function(name){return normalize(name,relName)}}function makeLoad(id){function load(value){loaderCache[id]=value}load.fromText=function(id,text){throw new Error("amdefine does not implement load.fromText")};return load}makeRequire=function(systemRequire,exports,module,relId){function amdRequire(deps,callback){if(typeof deps==="string"){return stringRequire(systemRequire,exports,module,deps,relId)}else{deps=deps.map(function(depName){return stringRequire(systemRequire,exports,module,depName,relId)});if(callback){process.nextTick(function(){callback.apply(null,deps)})}}}amdRequire.toUrl=function(filePath){if(filePath.indexOf(".")===0){return normalize(filePath,path.dirname(module.filename))}else{return filePath}};return amdRequire};requireFn=requireFn||function req(){return module.require.apply(module,arguments)};function runFactory(id,deps,factory){var r,e,m,result;if(id){e=loaderCache[id]={};m={id:id,uri:__filename,exports:e};r=makeRequire(requireFn,e,m,id)}else{if(alreadyCalled){throw new Error("amdefine with no module ID cannot be called more than once per file.")}alreadyCalled=true;e=module.exports;m=module;r=makeRequire(requireFn,e,m,module.id)}if(deps){deps=deps.map(function(depName){return r(depName)})}if(typeof factory==="function"){result=factory.apply(m.exports,deps)}else{result=factory}if(result!==undefined){m.exports=result;if(id){loaderCache[id]=m.exports}}}stringRequire=function(systemRequire,exports,module,id,relId){var index=id.indexOf("!"),originalId=id,prefix,plugin;if(index===-1){id=normalize(id,relId);if(id==="require"){return makeRequire(systemRequire,exports,module,relId)}else if(id==="exports"){return exports}else if(id==="module"){return module}else if(loaderCache.hasOwnProperty(id)){return loaderCache[id]}else if(defineCache[id]){runFactory.apply(null,defineCache[id]);return loaderCache[id]}else{if(systemRequire){return systemRequire(originalId)}else{throw new Error("No module with ID: "+id)}}}else{prefix=id.substring(0,index);id=id.substring(index+1,id.length);plugin=stringRequire(systemRequire,exports,module,prefix,relId);if(plugin.normalize){id=plugin.normalize(id,makeNormalize(relId))}else{id=normalize(id,relId)}if(loaderCache[id]){return loaderCache[id]}else{plugin.load(id,makeRequire(systemRequire,exports,module,relId),makeLoad(id),{});return loaderCache[id]}}};function define(id,deps,factory){if(Array.isArray(id)){factory=deps;deps=id;id=undefined}else if(typeof id!=="string"){factory=id;id=deps=undefined}if(deps&&!Array.isArray(deps)){factory=deps;deps=undefined}if(!deps){deps=["require","exports","module"]}if(id){defineCache[id]=[id,deps,factory]}else{runFactory(id,deps,factory)}}define.require=function(id){if(loaderCache[id]){return loaderCache[id]}if(defineCache[id]){runFactory.apply(null,defineCache[id]);return loaderCache[id]}};define.amd={};return define}module.exports=amdefine}).call(this,require("_process"),"/node_modules\\handlebars\\node_modules\\source-map\\node_modules\\amdefine\\amdefine.js")},{_process:3,path:2}],48:[function(require,module,exports){module.exports=require("./dist/cjs/handlebars.runtime")["default"]},{"./dist/cjs/handlebars.runtime":19}],49:[function(require,module,exports){module.exports=require("handlebars/runtime")["default"]},{"handlebars/runtime":48}],50:[function(require,module,exports){(function(global,factory){if(typeof module==="object"&&typeof module.exports==="object"){module.exports=global.document?factory(global,true):function(w){if(!w.document){throw new Error("jQuery requires a window with a document")}return factory(w)}}else{factory(global)}})(typeof window!=="undefined"?window:this,function(window,noGlobal){var arr=[];var slice=arr.slice;var concat=arr.concat;var push=arr.push;var indexOf=arr.indexOf;var class2type={};var toString=class2type.toString;var hasOwn=class2type.hasOwnProperty;var support={};var document=window.document,version="2.1.4",jQuery=function(selector,context){return new jQuery.fn.init(selector,context)},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase()};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,selector:"",length:0,toArray:function(){return slice.call(this)},get:function(num){return num!=null?num<0?this[num+this.length]:this[num]:slice.call(this)},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);ret.prevObject=this;ret.context=this.context;return ret},each:function(callback,args){return jQuery.each(this,callback,args)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=0&&j<len?[this[j]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:push,sort:arr.sort,splice:arr.splice};jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[i]||{};i++}if(typeof target!=="object"&&!jQuery.isFunction(target)){target={}}if(i===length){target=this;i--}for(;i<length;i++){if((options=arguments[i])!=null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue}if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&jQuery.isArray(src)?src:[]}else{clone=src&&jQuery.isPlainObject(src)?src:{}}target[name]=jQuery.extend(deep,clone,copy)}else if(copy!==undefined){target[name]=copy}}}}return target};jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:true,error:function(msg){throw new Error(msg)},noop:function(){},isFunction:function(obj){return jQuery.type(obj)==="function"},isArray:Array.isArray,isWindow:function(obj){return obj!=null&&obj===obj.window},isNumeric:function(obj){return!jQuery.isArray(obj)&&obj-parseFloat(obj)+1>=0},isPlainObject:function(obj){if(jQuery.type(obj)!=="object"||obj.nodeType||jQuery.isWindow(obj)){return false}if(obj.constructor&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf")){return false}return true},isEmptyObject:function(obj){var name;for(name in obj){return false}return true},type:function(obj){if(obj==null){return obj+""}return typeof obj==="object"||typeof obj==="function"?class2type[toString.call(obj)]||"object":typeof obj},globalEval:function(code){var script,indirect=eval;code=jQuery.trim(code);if(code){if(code.indexOf("use strict")===1){script=document.createElement("script");script.text=code;document.head.appendChild(script).parentNode.removeChild(script)}else{indirect(code)}}},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray){for(;i<length;i++){value=callback.apply(obj[i],args);if(value===false){break}}}else{for(i in obj){value=callback.apply(obj[i],args);if(value===false){break}}}}else{if(isArray){for(;i<length;i++){value=callback.call(obj[i],i,obj[i]);if(value===false){break}}}else{for(i in obj){value=callback.call(obj[i],i,obj[i]);if(value===false){break}}}}return obj},trim:function(text){return text==null?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];if(arr!=null){if(isArraylike(Object(arr))){jQuery.merge(ret,typeof arr==="string"?[arr]:arr)}else{push.call(ret,arr)}}return ret},inArray:function(elem,arr,i){return arr==null?-1:indexOf.call(arr,elem,i)},merge:function(first,second){var len=+second.length,j=0,i=first.length;for(;j<len;j++){first[i++]=second[j]}first.length=i;return first},grep:function(elems,callback,invert){var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;for(;i<length;i++){callbackInverse=!callback(elems[i],i);if(callbackInverse!==callbackExpect){matches.push(elems[i])}}return matches},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray){for(;i<length;i++){value=callback(elems[i],i,arg);if(value!=null){ret.push(value)}}}else{for(i in elems){value=callback(elems[i],i,arg);if(value!=null){ret.push(value)}}}return concat.apply([],ret)},guid:1,proxy:function(fn,context){var tmp,args,proxy;if(typeof context==="string"){tmp=fn[context];context=fn;fn=tmp}if(!jQuery.isFunction(fn)){return undefined}args=slice.call(arguments,2);proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))};proxy.guid=fn.guid=fn.guid||jQuery.guid++;return proxy},now:Date.now,support:support});jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});function isArraylike(obj){var length="length"in obj&&obj.length,type=jQuery.type(obj);if(type==="function"||jQuery.isWindow(obj)){return false}if(obj.nodeType===1&&length){return true}return type==="array"||length===0||typeof length==="number"&&length>0&&length-1 in obj}var Sizzle=function(window){var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+1*new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){if(a===b){hasDuplicate=true}return 0},MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=function(list,elem){
var i=0,len=list.length;for(;i<len;i++){if(list[i]===elem){return i}}return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\(("+"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|"+"((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|"+".*"+")\\)|)",rwhitespace=new RegExp(whitespace+"+","g"),rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+characterEncoding+")"),CLASS:new RegExp("^\\.("+characterEncoding+")"),TAG:new RegExp("^("+characterEncoding.replace("w","w*")+")"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,high&1023|56320)},unloadHandler=function(){setDocument()};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes);arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){var j=target.length,i=0;while(target[j++]=els[i++]){}target.length=j-1}}}function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document){setDocument(context)}context=context||document;results=results||[];nodeType=context.nodeType;if(typeof selector!=="string"||!selector||nodeType!==1&&nodeType!==9&&nodeType!==11){return results}if(!seed&&documentIsHTML){if(nodeType!==11&&(match=rquickExpr.exec(selector))){if(m=match[1]){if(nodeType===9){elem=context.getElementById(m);if(elem&&elem.parentNode){if(elem.id===m){results.push(elem);return results}}else{return results}}else{if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m){results.push(elem);return results}}}else if(match[2]){push.apply(results,context.getElementsByTagName(selector));return results}else if((m=match[3])&&support.getElementsByClassName){push.apply(results,context.getElementsByClassName(m));return results}}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){nid=old=expando;newContext=context;newSelector=nodeType!==1&&selector;if(nodeType===1&&context.nodeName.toLowerCase()!=="object"){groups=tokenize(selector);if(old=context.getAttribute("id")){nid=old.replace(rescape,"\\$&")}else{context.setAttribute("id",nid)}nid="[id='"+nid+"'] ";i=groups.length;while(i--){groups[i]=nid+toSelector(groups[i])}newContext=rsibling.test(selector)&&testContext(context.parentNode)||context;newSelector=groups.join(",")}if(newSelector){try{push.apply(results,newContext.querySelectorAll(newSelector));return results}catch(qsaError){}finally{if(!old){context.removeAttribute("id")}}}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){var keys=[];function cache(key,value){if(keys.push(key+" ")>Expr.cacheLength){delete cache[keys.shift()]}return cache[key+" "]=value}return cache}function markFunction(fn){fn[expando]=true;return fn}function assert(fn){var div=document.createElement("div");try{return!!fn(div)}catch(e){return false}finally{if(div.parentNode){div.parentNode.removeChild(div)}div=null}}function addHandle(attrs,handler){var arr=attrs.split("|"),i=attrs.length;while(i--){Expr.attrHandle[arr[i]]=handler}}function siblingCheck(a,b){var cur=b&&a,diff=cur&&a.nodeType===1&&b.nodeType===1&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff){return diff}if(cur){while(cur=cur.nextSibling){if(cur===b){return-1}}}return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){argument=+argument;return markFunction(function(seed,matches){var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;while(i--){if(seed[j=matchIndexes[i]]){seed[j]=!(matches[j]=seed[j])}}})})}function testContext(context){return context&&typeof context.getElementsByTagName!=="undefined"&&context}support=Sizzle.support={};isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?documentElement.nodeName!=="HTML":false};setDocument=Sizzle.setDocument=function(node){var hasCompare,parent,doc=node?node.ownerDocument||node:preferredDoc;if(doc===document||doc.nodeType!==9||!doc.documentElement){return document}document=doc;docElem=doc.documentElement;parent=doc.defaultView;if(parent&&parent!==parent.top){if(parent.addEventListener){parent.addEventListener("unload",unloadHandler,false)}else if(parent.attachEvent){parent.attachEvent("onunload",unloadHandler)}}documentIsHTML=!isXML(doc);support.attributes=assert(function(div){div.className="i";return!div.getAttribute("className")});support.getElementsByTagName=assert(function(div){div.appendChild(doc.createComment(""));return!div.getElementsByTagName("*").length});support.getElementsByClassName=rnative.test(doc.getElementsByClassName);support.getById=assert(function(div){docElem.appendChild(div).id=expando;return!doc.getElementsByName||!doc.getElementsByName(expando).length});if(support.getById){Expr.find["ID"]=function(id,context){if(typeof context.getElementById!=="undefined"&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}};Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}}else{delete Expr.find["ID"];Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!=="undefined"&&elem.getAttributeNode("id");return node&&node.value===attrId}}}Expr.find["TAG"]=support.getElementsByTagName?function(tag,context){if(typeof context.getElementsByTagName!=="undefined"){return context.getElementsByTagName(tag)}else if(support.qsa){return context.querySelectorAll(tag)}}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if(tag==="*"){while(elem=results[i++]){if(elem.nodeType===1){tmp.push(elem)}}return tmp}return results};Expr.find["CLASS"]=support.getElementsByClassName&&function(className,context){if(documentIsHTML){return context.getElementsByClassName(className)}};rbuggyMatches=[];rbuggyQSA=[];if(support.qsa=rnative.test(doc.querySelectorAll)){assert(function(div){docElem.appendChild(div).innerHTML="<a id='"+expando+"'></a>"+"<select id='"+expando+"-\f]' msallowcapture=''>"+"<option selected=''></option></select>";if(div.querySelectorAll("[msallowcapture^='']").length){rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")")}if(!div.querySelectorAll("[selected]").length){rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")")}if(!div.querySelectorAll("[id~="+expando+"-]").length){rbuggyQSA.push("~=")}if(!div.querySelectorAll(":checked").length){rbuggyQSA.push(":checked")}if(!div.querySelectorAll("a#"+expando+"+*").length){rbuggyQSA.push(".#.+[+~]")}});assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden");div.appendChild(input).setAttribute("name","D");if(div.querySelectorAll("[name=d]").length){rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?=")}if(!div.querySelectorAll(":enabled").length){rbuggyQSA.push(":enabled",":disabled")}div.querySelectorAll("*,:x");rbuggyQSA.push(",.*:")})}if(support.matchesSelector=rnative.test(matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector)){assert(function(div){support.disconnectedMatch=matches.call(div,"div");matches.call(div,"[s!='']:x");rbuggyMatches.push("!=",pseudos)})}rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|"));rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|"));hasCompare=rnative.test(docElem.compareDocumentPosition);contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=a.nodeType===9?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!!(bup&&bup.nodeType===1&&(adown.contains?adown.contains(bup):a.compareDocumentPosition&&a.compareDocumentPosition(bup)&16))}:function(a,b){if(b){while(b=b.parentNode){if(b===a){return true}}}return false};sortOrder=hasCompare?function(a,b){if(a===b){hasDuplicate=true;return 0}var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;if(compare){return compare}compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1;if(compare&1||!support.sortDetached&&b.compareDocumentPosition(a)===compare){if(a===doc||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)){return-1}if(b===doc||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)){return 1}return sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0}return compare&4?-1:1}:function(a,b){if(a===b){hasDuplicate=true;return 0}var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup){return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0}else if(aup===bup){return siblingCheck(a,b)}cur=a;while(cur=cur.parentNode){ap.unshift(cur)}cur=b;while(cur=cur.parentNode){bp.unshift(cur)}while(ap[i]===bp[i]){i++}return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0};return doc};Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)};Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document){setDocument(elem)}expr=expr.replace(rattributeQuotes,"='$1']");if(support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr))){try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&elem.document.nodeType!==11){return ret}}catch(e){}}return Sizzle(expr,document,null,[elem]).length>0};Sizzle.contains=function(context,elem){if((context.ownerDocument||context)!==document){setDocument(context)}return contains(context,elem)};Sizzle.attr=function(elem,name){if((elem.ownerDocument||elem)!==document){setDocument(elem)}var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;return val!==undefined?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)};Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;hasDuplicate=!support.detectDuplicates;sortInput=!support.sortStable&&results.slice(0);results.sort(sortOrder);if(hasDuplicate){while(elem=results[i++]){if(elem===results[i]){j=duplicates.push(i)}}while(j--){results.splice(duplicates[j],1)}}sortInput=null;return results};getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(!nodeType){while(node=elem[i++]){ret+=getText(node)}}else if(nodeType===1||nodeType===9||nodeType===11){if(typeof elem.textContent==="string"){return elem.textContent}else{for(elem=elem.firstChild;elem;elem=elem.nextSibling){ret+=getText(elem)}}}else if(nodeType===3||nodeType===4){return elem.nodeValue}return ret};Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){match[1]=match[1].replace(runescape,funescape);match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape);if(match[2]==="~="){match[3]=" "+match[3]+" "}return match.slice(0,4)},CHILD:function(match){match[1]=match[1].toLowerCase();if(match[1].slice(0,3)==="nth"){if(!match[3]){Sizzle.error(match[0])}match[4]=+(match[4]?match[5]+(match[6]||1):2*(match[3]==="even"||match[3]==="odd"));match[5]=+(match[7]+match[8]||match[3]==="odd")}else if(match[3]){Sizzle.error(match[0])}return match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];if(matchExpr["CHILD"].test(match[0])){return null}if(match[3]){match[2]=match[4]||match[5]||""}else if(unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,true))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)){match[0]=match[0].slice(0,excess);match[2]=unquoted.slice(0,excess)}return match.slice(0,3)}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return nodeNameSelector==="*"?function(){return true}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test(typeof elem.className==="string"&&elem.className||typeof elem.getAttribute!=="undefined"&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);if(result==null){return operator==="!="}if(!operator){return true}result+="";return operator==="="?result===check:operator==="!="?result!==check:operator==="^="?check&&result.indexOf(check)===0:operator==="*="?check&&result.indexOf(check)>-1:operator==="$="?check&&result.slice(-check.length)===check:operator==="~="?(" "+result.replace(rwhitespace," ")+" ").indexOf(check)>-1:operator==="|="?result===check||result.slice(0,check.length+1)===check+"-":false}},CHILD:function(type,what,argument,first,last){var simple=type.slice(0,3)!=="nth",forward=type.slice(-4)!=="last",ofType=what==="of-type";return first===1&&last===0?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){while(dir){node=elem;while(node=node[dir]){if(ofType?node.nodeName.toLowerCase()===name:node.nodeType===1){return false}}start=dir=type==="only"&&!start&&"nextSibling"}return true}start=[forward?parent.firstChild:parent.lastChild];if(forward&&useCache){outerCache=parent[expando]||(parent[expando]={});cache=outerCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=cache[0]===dirruns&&cache[2];node=nodeIndex&&parent.childNodes[nodeIndex];while(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop()){if(node.nodeType===1&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns){diff=cache[1]}else{while(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop()){if((ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)&&++diff){if(useCache){(node[expando]||(node[expando]={}))[type]=[dirruns,diff]}if(node===elem){break}}}}diff-=last;return diff===first||diff%first===0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);if(fn[expando]){return fn(argument)}if(fn.length>1){args=[pseudo,pseudo,"",argument];return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){var idx,matched=fn(seed,argument),i=matched.length;while(i--){idx=indexOf(seed,matched[i]);seed[idx]=!(matches[idx]=matched[i])}}):function(elem){return fn(elem,0,args)}}return fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;while(i--){if(elem=unmatched[i]){seed[i]=!(matches[i]=elem)}}}):function(elem,context,xml){input[0]=elem;matcher(input,null,xml,results);input[0]=null;return!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){text=text.replace(runescape,funescape);return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){if(!ridentifier.test(lang||"")){Sizzle.error("unsupported lang: "+lang)}lang=lang.replace(runescape,funescape).toLowerCase();return function(elem){var elemLang;do{if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang")){elemLang=elemLang.toLowerCase();return elemLang===lang||elemLang.indexOf(lang+"-")===0}}while((elem=elem.parentNode)&&elem.nodeType===1);return false}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===false},disabled:function(elem){return elem.disabled===true},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return nodeName==="input"&&!!elem.checked||nodeName==="option"&&!!elem.selected},selected:function(elem){if(elem.parentNode){elem.parentNode.selectedIndex}return elem.selected===true},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling){if(elem.nodeType<6){return false}}return true},parent:function(elem){return!Expr.pseudos["empty"](elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type==="button"||name==="button"},text:function(elem){var attr;return elem.nodeName.toLowerCase()==="input"&&elem.type==="text"&&((attr=elem.getAttribute("type"))==null||attr.toLowerCase()==="text")},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){var i=0;for(;i<length;i+=2){matchIndexes.push(i)}return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){var i=1;for(;i<length;i+=2){matchIndexes.push(i)}return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;--i>=0;){matchIndexes.push(i)}return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;++i<length;){matchIndexes.push(i)}return matchIndexes})}};Expr.pseudos["nth"]=Expr.pseudos["eq"];for(i in{radio:true,checkbox:true,file:true,password:true,image:true}){Expr.pseudos[i]=createInputPseudo(i)}for(i in{submit:true,reset:true}){Expr.pseudos[i]=createButtonPseudo(i)}function setFilters(){}setFilters.prototype=Expr.filters=Expr.pseudos;Expr.setFilters=new setFilters;tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached){return parseOnly?0:cached.slice(0)}soFar=selector;groups=[];preFilters=Expr.preFilter;while(soFar){if(!matched||(match=rcomma.exec(soFar))){if(match){soFar=soFar.slice(match[0].length)||soFar}groups.push(tokens=[])}matched=false;if(match=rcombinators.exec(soFar)){matched=match.shift();tokens.push({value:matched,type:match[0].replace(rtrim," ")});soFar=soFar.slice(matched.length)}for(type in Expr.filter){if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match)))){matched=match.shift();tokens.push({value:matched,type:type,matches:match});soFar=soFar.slice(matched.length)}}if(!matched){break}}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)};function toSelector(tokens){var i=0,len=tokens.length,selector="";for(;i<len;i++){selector+=tokens[i].value}return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&dir==="parentNode",doneName=done++;return combinator.first?function(elem,context,xml){while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){return matcher(elem,context,xml)}}}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){if(matcher(elem,context,xml)){return true}}}}else{while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){outerCache=elem[expando]||(elem[expando]={});if((oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName){return newCache[2]=oldCache[2]}else{outerCache[dir]=newCache;if(newCache[2]=matcher(elem,context,xml)){return true}}}}}}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){var i=matchers.length;while(i--){if(!matchers[i](elem,context,xml)){return false}}return true}:matchers[0]}function multipleContexts(selector,contexts,results){var i=0,len=contexts.length;for(;i<len;i++){Sizzle(selector,contexts[i],results)}return results}function condense(unmatched,map,filter,context,xml){var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=map!=null;for(;i<len;i++){if(elem=unmatched[i]){if(!filter||filter(elem,context,xml)){newUnmatched.push(elem);if(mapped){map.push(i)}}}}return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){if(postFilter&&!postFilter[expando]){postFilter=setMatcher(postFilter)}if(postFinder&&!postFinder[expando]){postFinder=setMatcher(postFinder,postSelector)}return markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=preFilter&&(seed||!selector)?condense(elems,preMap,preFilter,context,xml):elems,matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher){matcher(matcherIn,matcherOut,context,xml)}if(postFilter){temp=condense(matcherOut,postMap);postFilter(temp,[],context,xml);i=temp.length;while(i--){if(elem=temp[i]){matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem)}}}if(seed){if(postFinder||preFilter){if(postFinder){temp=[];i=matcherOut.length;while(i--){if(elem=matcherOut[i]){temp.push(matcherIn[i]=elem)}}postFinder(null,matcherOut=[],temp,xml)}i=matcherOut.length;while(i--){if((elem=matcherOut[i])&&(temp=postFinder?indexOf(seed,elem):preMap[i])>-1){seed[temp]=!(results[temp]=elem)}}}}else{matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut);if(postFinder){postFinder(null,results,matcherOut,xml)}else{push.apply(results,matcherOut)}}})}function matcherFromTokens(tokens){var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,true),matchAnyContext=addCombinator(function(elem){return indexOf(checkContext,elem)>-1},implicitRelative,true),matchers=[function(elem,context,xml){var ret=!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));checkContext=null;return ret}];for(;i<len;i++){if(matcher=Expr.relative[tokens[i].type]){matchers=[addCombinator(elementMatcher(matchers),matcher)]}else{matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches);if(matcher[expando]){j=++i;for(;j<len;j++){if(Expr.relative[tokens[j].type]){break}}return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:tokens[i-2].type===" "?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens(tokens=tokens.slice(j)),j<len&&toSelector(tokens))}matchers.push(matcher)}}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find["TAG"]("*",outermost),dirrunsUnique=dirruns+=contextBackup==null?1:Math.random()||.1,len=elems.length;if(outermost){outermostContext=context!==document&&context}for(;i!==len&&(elem=elems[i])!=null;i++){if(byElement&&elem){j=0;while(matcher=elementMatchers[j++]){if(matcher(elem,context,xml)){results.push(elem);break}}if(outermost){dirruns=dirrunsUnique}}if(bySet){if(elem=!matcher&&elem){matchedCount--}if(seed){unmatched.push(elem)}}}matchedCount+=i;if(bySet&&i!==matchedCount){j=0;while(matcher=setMatchers[j++]){matcher(unmatched,setMatched,context,xml)}if(seed){if(matchedCount>0){while(i--){if(!(unmatched[i]||setMatched[i])){setMatched[i]=pop.call(results)}}}setMatched=condense(setMatched)}push.apply(results,setMatched);if(outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1){Sizzle.uniqueSort(results)}}if(outermost){dirruns=dirrunsUnique;outermostContext=contextBackup}return unmatched};return bySet?markFunction(superMatcher):superMatcher}compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){if(!match){match=tokenize(selector)}i=match.length;while(i--){cached=matcherFromTokens(match[i]);if(cached[expando]){setMatchers.push(cached)}else{elementMatchers.push(cached)}}cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers));cached.selector=selector}return cached};select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled=typeof selector==="function"&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);results=results||[];if(match.length===1){tokens=match[0]=match[0].slice(0);if(tokens.length>2&&(token=tokens[0]).type==="ID"&&support.getById&&context.nodeType===9&&documentIsHTML&&Expr.relative[tokens[1].type]){context=(Expr.find["ID"](token.matches[0].replace(runescape,funescape),context)||[])[0];if(!context){return results}else if(compiled){context=context.parentNode}selector=selector.slice(tokens.shift().value.length)}i=matchExpr["needsContext"].test(selector)?0:tokens.length;while(i--){token=tokens[i];if(Expr.relative[type=token.type]){break}if(find=Expr.find[type]){if(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context)){tokens.splice(i,1);selector=seed.length&&toSelector(tokens);if(!selector){push.apply(results,seed);return results}break}}}}(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context);return results};support.sortStable=expando.split("").sort(sortOrder).join("")===expando;support.detectDuplicates=!!hasDuplicate;setDocument();support.sortDetached=assert(function(div1){return div1.compareDocumentPosition(document.createElement("div"))&1});if(!assert(function(div){div.innerHTML="<a href='#'></a>";return div.firstChild.getAttribute("href")==="#"})){addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML){return elem.getAttribute(name,name.toLowerCase()==="type"?1:2)}})}if(!support.attributes||!assert(function(div){div.innerHTML="<input/>";div.firstChild.setAttribute("value","");return div.firstChild.getAttribute("value")===""})){addHandle("value",function(elem,name,isXML){if(!isXML&&elem.nodeName.toLowerCase()==="input"){return elem.defaultValue}})}if(!assert(function(div){return div.getAttribute("disabled")==null})){addHandle(booleans,function(elem,name,isXML){var val;if(!isXML){return elem[name]===true?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}})}return Sizzle}(window);jQuery.find=Sizzle;jQuery.expr=Sizzle.selectors;jQuery.expr[":"]=jQuery.expr.pseudos;jQuery.unique=Sizzle.uniqueSort;jQuery.text=Sizzle.getText;jQuery.isXMLDoc=Sizzle.isXML;jQuery.contains=Sizzle.contains;var rneedsContext=jQuery.expr.match.needsContext;var rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/;var risSimple=/^.[^:#\[\.,]*$/;function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier)){return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not})}if(qualifier.nodeType){return jQuery.grep(elements,function(elem){return elem===qualifier!==not})}if(typeof qualifier==="string"){if(risSimple.test(qualifier)){return jQuery.filter(qualifier,elements,not)}qualifier=jQuery.filter(qualifier,elements)}return jQuery.grep(elements,function(elem){return indexOf.call(qualifier,elem)>=0!==not})}jQuery.filter=function(expr,elems,not){var elem=elems[0];if(not){expr=":not("+expr+")"}return elems.length===1&&elem.nodeType===1?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return elem.nodeType===1}))};jQuery.fn.extend({find:function(selector){var i,len=this.length,ret=[],self=this;if(typeof selector!=="string"){return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++){if(jQuery.contains(self[i],this)){return true}}}))}for(i=0;i<len;i++){jQuery.find(selector,self[i],ret)}ret=this.pushStack(len>1?jQuery.unique(ret):ret);ret.selector=this.selector?this.selector+" "+selector:selector;return ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],false))},not:function(selector){return this.pushStack(winnow(this,selector||[],true))},is:function(selector){return!!winnow(this,typeof selector==="string"&&rneedsContext.test(selector)?jQuery(selector):selector||[],false).length}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,init=jQuery.fn.init=function(selector,context){var match,elem;if(!selector){return this}if(typeof selector==="string"){if(selector[0]==="<"&&selector[selector.length-1]===">"&&selector.length>=3){match=[null,selector,null]}else{match=rquickExpr.exec(selector)}if(match&&(match[1]||!context)){if(match[1]){context=context instanceof jQuery?context[0]:context;jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,true));if(rsingleTag.test(match[1])&&jQuery.isPlainObject(context)){for(match in context){if(jQuery.isFunction(this[match])){
this[match](context[match])}else{this.attr(match,context[match])}}}return this}else{elem=document.getElementById(match[2]);if(elem&&elem.parentNode){this.length=1;this[0]=elem}this.context=document;this.selector=selector;return this}}else if(!context||context.jquery){return(context||rootjQuery).find(selector)}else{return this.constructor(context).find(selector)}}else if(selector.nodeType){this.context=this[0]=selector;this.length=1;return this}else if(jQuery.isFunction(selector)){return typeof rootjQuery.ready!=="undefined"?rootjQuery.ready(selector):selector(jQuery)}if(selector.selector!==undefined){this.selector=selector.selector;this.context=selector.context}return jQuery.makeArray(selector,this)};init.prototype=jQuery.fn;rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:true,contents:true,next:true,prev:true};jQuery.extend({dir:function(elem,dir,until){var matched=[],truncate=until!==undefined;while((elem=elem[dir])&&elem.nodeType!==9){if(elem.nodeType===1){if(truncate&&jQuery(elem).is(until)){break}matched.push(elem)}}return matched},sibling:function(n,elem){var matched=[];for(;n;n=n.nextSibling){if(n.nodeType===1&&n!==elem){matched.push(n)}}return matched}});jQuery.fn.extend({has:function(target){var targets=jQuery(target,this),l=targets.length;return this.filter(function(){var i=0;for(;i<l;i++){if(jQuery.contains(this,targets[i])){return true}}})},closest:function(selectors,context){var cur,i=0,l=this.length,matched=[],pos=rneedsContext.test(selectors)||typeof selectors!=="string"?jQuery(selectors,context||this.context):0;for(;i<l;i++){for(cur=this[i];cur&&cur!==context;cur=cur.parentNode){if(cur.nodeType<11&&(pos?pos.index(cur)>-1:cur.nodeType===1&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}}}return this.pushStack(matched.length>1?jQuery.unique(matched):matched)},index:function(elem){if(!elem){return this[0]&&this[0].parentNode?this.first().prevAll().length:-1}if(typeof elem==="string"){return indexOf.call(jQuery(elem),this[0])}return indexOf.call(this,elem.jquery?elem[0]:elem)},add:function(selector,context){return this.pushStack(jQuery.unique(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector))}});function sibling(cur,dir){while((cur=cur[dir])&&cur.nodeType!==1){}return cur}jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&parent.nodeType!==11?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return elem.contentDocument||jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var matched=jQuery.map(this,fn,until);if(name.slice(-5)!=="Until"){selector=until}if(selector&&typeof selector==="string"){matched=jQuery.filter(selector,matched)}if(this.length>1){if(!guaranteedUnique[name]){jQuery.unique(matched)}if(rparentsprev.test(name)){matched.reverse()}}return this.pushStack(matched)}});var rnotwhite=/\S+/g;var optionsCache={};function createOptions(options){var object=optionsCache[options]={};jQuery.each(options.match(rnotwhite)||[],function(_,flag){object[flag]=true});return object}jQuery.Callbacks=function(options){options=typeof options==="string"?optionsCache[options]||createOptions(options):jQuery.extend({},options);var memory,fired,firing,firingStart,firingLength,firingIndex,list=[],stack=!options.once&&[],fire=function(data){memory=options.memory&&data;fired=true;firingIndex=firingStart||0;firingStart=0;firingLength=list.length;firing=true;for(;list&&firingIndex<firingLength;firingIndex++){if(list[firingIndex].apply(data[0],data[1])===false&&options.stopOnFalse){memory=false;break}}firing=false;if(list){if(stack){if(stack.length){fire(stack.shift())}}else if(memory){list=[]}else{self.disable()}}},self={add:function(){if(list){var start=list.length;(function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);if(type==="function"){if(!options.unique||!self.has(arg)){list.push(arg)}}else if(arg&&arg.length&&type!=="string"){add(arg)}})})(arguments);if(firing){firingLength=list.length}else if(memory){firingStart=start;fire(memory)}}return this},remove:function(){if(list){jQuery.each(arguments,function(_,arg){var index;while((index=jQuery.inArray(arg,list,index))>-1){list.splice(index,1);if(firing){if(index<=firingLength){firingLength--}if(index<=firingIndex){firingIndex--}}}})}return this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!!(list&&list.length)},empty:function(){list=[];firingLength=0;return this},disable:function(){list=stack=memory=undefined;return this},disabled:function(){return!list},lock:function(){stack=undefined;if(!memory){self.disable()}return this},locked:function(){return!stack},fireWith:function(context,args){if(list&&(!fired||stack)){args=args||[];args=[context,args.slice?args.slice():args];if(firing){stack.push(args)}else{fire(args)}}return this},fire:function(){self.fireWith(this,arguments);return this},fired:function(){return!!fired}};return self};jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){deferred.done(arguments).fail(arguments);return this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);if(returned&&jQuery.isFunction(returned.promise)){returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify)}else{newDefer[tuple[0]+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)}})});fns=null}).promise()},promise:function(obj){return obj!=null?jQuery.extend(obj,promise):promise}},deferred={};promise.pipe=promise.then;jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add;if(stateString){list.add(function(){state=stateString},tuples[i^1][2].disable,tuples[2][2].lock)}deferred[tuple[0]]=function(){deferred[tuple[0]+"With"](this===deferred?promise:this,arguments);return this};deferred[tuple[0]+"With"]=list.fireWith});promise.promise(deferred);if(func){func.call(deferred,deferred)}return deferred},when:function(subordinate){var i=0,resolveValues=slice.call(arguments),length=resolveValues.length,remaining=length!==1||subordinate&&jQuery.isFunction(subordinate.promise)?length:0,deferred=remaining===1?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this;values[i]=arguments.length>1?slice.call(arguments):value;if(values===progressValues){deferred.notifyWith(contexts,values)}else if(!--remaining){deferred.resolveWith(contexts,values)}}},progressValues,progressContexts,resolveContexts;if(length>1){progressValues=new Array(length);progressContexts=new Array(length);resolveContexts=new Array(length);for(;i<length;i++){if(resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)){resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues))}else{--remaining}}}if(!remaining){deferred.resolveWith(resolveContexts,resolveValues)}return deferred.promise()}});var readyList;jQuery.fn.ready=function(fn){jQuery.ready.promise().done(fn);return this};jQuery.extend({isReady:false,readyWait:1,holdReady:function(hold){if(hold){jQuery.readyWait++}else{jQuery.ready(true)}},ready:function(wait){if(wait===true?--jQuery.readyWait:jQuery.isReady){return}jQuery.isReady=true;if(wait!==true&&--jQuery.readyWait>0){return}readyList.resolveWith(document,[jQuery]);if(jQuery.fn.triggerHandler){jQuery(document).triggerHandler("ready");jQuery(document).off("ready")}}});function completed(){document.removeEventListener("DOMContentLoaded",completed,false);window.removeEventListener("load",completed,false);jQuery.ready()}jQuery.ready.promise=function(obj){if(!readyList){readyList=jQuery.Deferred();if(document.readyState==="complete"){setTimeout(jQuery.ready)}else{document.addEventListener("DOMContentLoaded",completed,false);window.addEventListener("load",completed,false)}}return readyList.promise(obj)};jQuery.ready.promise();var access=jQuery.access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,len=elems.length,bulk=key==null;if(jQuery.type(key)==="object"){chainable=true;for(i in key){jQuery.access(elems,fn,i,key[i],true,emptyGet,raw)}}else if(value!==undefined){chainable=true;if(!jQuery.isFunction(value)){raw=true}if(bulk){if(raw){fn.call(elems,value);fn=null}else{bulk=fn;fn=function(elem,key,value){return bulk.call(jQuery(elem),value)}}}if(fn){for(;i<len;i++){fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)))}}}return chainable?elems:bulk?fn.call(elems):len?fn(elems[0],key):emptyGet};jQuery.acceptData=function(owner){return owner.nodeType===1||owner.nodeType===9||!+owner.nodeType};function Data(){Object.defineProperty(this.cache={},0,{get:function(){return{}}});this.expando=jQuery.expando+Data.uid++}Data.uid=1;Data.accepts=jQuery.acceptData;Data.prototype={key:function(owner){if(!Data.accepts(owner)){return 0}var descriptor={},unlock=owner[this.expando];if(!unlock){unlock=Data.uid++;try{descriptor[this.expando]={value:unlock};Object.defineProperties(owner,descriptor)}catch(e){descriptor[this.expando]=unlock;jQuery.extend(owner,descriptor)}}if(!this.cache[unlock]){this.cache[unlock]={}}return unlock},set:function(owner,data,value){var prop,unlock=this.key(owner),cache=this.cache[unlock];if(typeof data==="string"){cache[data]=value}else{if(jQuery.isEmptyObject(cache)){jQuery.extend(this.cache[unlock],data)}else{for(prop in data){cache[prop]=data[prop]}}}return cache},get:function(owner,key){var cache=this.cache[this.key(owner)];return key===undefined?cache:cache[key]},access:function(owner,key,value){var stored;if(key===undefined||key&&typeof key==="string"&&value===undefined){stored=this.get(owner,key);return stored!==undefined?stored:this.get(owner,jQuery.camelCase(key))}this.set(owner,key,value);return value!==undefined?value:key},remove:function(owner,key){var i,name,camel,unlock=this.key(owner),cache=this.cache[unlock];if(key===undefined){this.cache[unlock]={}}else{if(jQuery.isArray(key)){name=key.concat(key.map(jQuery.camelCase))}else{camel=jQuery.camelCase(key);if(key in cache){name=[key,camel]}else{name=camel;name=name in cache?[name]:name.match(rnotwhite)||[]}}i=name.length;while(i--){delete cache[name[i]]}}},hasData:function(owner){return!jQuery.isEmptyObject(this.cache[owner[this.expando]]||{})},discard:function(owner){if(owner[this.expando]){delete this.cache[owner[this.expando]]}}};var data_priv=new Data;var data_user=new Data;var rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/([A-Z])/g;function dataAttr(elem,key,data){var name;if(data===undefined&&elem.nodeType===1){name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();data=elem.getAttribute(name);if(typeof data==="string"){try{data=data==="true"?true:data==="false"?false:data==="null"?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}data_user.set(elem,key,data)}else{data=undefined}}return data}jQuery.extend({hasData:function(elem){return data_user.hasData(elem)||data_priv.hasData(elem)},data:function(elem,name,data){return data_user.access(elem,name,data)},removeData:function(elem,name){data_user.remove(elem,name)},_data:function(elem,name,data){return data_priv.access(elem,name,data)},_removeData:function(elem,name){data_priv.remove(elem,name)}});jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(key===undefined){if(this.length){data=data_user.get(elem);if(elem.nodeType===1&&!data_priv.get(elem,"hasDataAttrs")){i=attrs.length;while(i--){if(attrs[i]){name=attrs[i].name;if(name.indexOf("data-")===0){name=jQuery.camelCase(name.slice(5));dataAttr(elem,name,data[name])}}}data_priv.set(elem,"hasDataAttrs",true)}}return data}if(typeof key==="object"){return this.each(function(){data_user.set(this,key)})}return access(this,function(value){var data,camelKey=jQuery.camelCase(key);if(elem&&value===undefined){data=data_user.get(elem,key);if(data!==undefined){return data}data=data_user.get(elem,camelKey);if(data!==undefined){return data}data=dataAttr(elem,camelKey,undefined);if(data!==undefined){return data}return}this.each(function(){var data=data_user.get(this,camelKey);data_user.set(this,camelKey,value);if(key.indexOf("-")!==-1&&data!==undefined){data_user.set(this,key,value)}})},null,value,arguments.length>1,null,true)},removeData:function(key){return this.each(function(){data_user.remove(this,key)})}});jQuery.extend({queue:function(elem,type,data){var queue;if(elem){type=(type||"fx")+"queue";queue=data_priv.get(elem,type);if(data){if(!queue||jQuery.isArray(data)){queue=data_priv.access(elem,type,jQuery.makeArray(data))}else{queue.push(data)}}return queue||[]}},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};if(fn==="inprogress"){fn=queue.shift();startLength--}if(fn){if(type==="fx"){queue.unshift("inprogress")}delete hooks.stop;fn.call(elem,next,hooks)}if(!startLength&&hooks){hooks.empty.fire()}},_queueHooks:function(elem,type){var key=type+"queueHooks";return data_priv.get(elem,key)||data_priv.access(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){data_priv.remove(elem,[type+"queue",key])})})}});jQuery.fn.extend({queue:function(type,data){var setter=2;if(typeof type!=="string"){data=type;type="fx";setter--}if(arguments.length<setter){return jQuery.queue(this[0],type)}return data===undefined?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type);if(type==="fx"&&queue[0]!=="inprogress"){jQuery.dequeue(this,type)}})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){if(!--count){defer.resolveWith(elements,[elements])}};if(typeof type!=="string"){obj=type;type=undefined}type=type||"fx";while(i--){tmp=data_priv.get(elements[i],type+"queueHooks");if(tmp&&tmp.empty){count++;tmp.empty.add(resolve)}}resolve();return defer.promise(obj)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source;var cssExpand=["Top","Right","Bottom","Left"];var isHidden=function(elem,el){elem=el||elem;return jQuery.css(elem,"display")==="none"||!jQuery.contains(elem.ownerDocument,elem)};var rcheckableType=/^(?:checkbox|radio)$/i;(function(){var fragment=document.createDocumentFragment(),div=fragment.appendChild(document.createElement("div")),input=document.createElement("input");input.setAttribute("type","radio");input.setAttribute("checked","checked");input.setAttribute("name","t");div.appendChild(input);support.checkClone=div.cloneNode(true).cloneNode(true).lastChild.checked;div.innerHTML="<textarea>x</textarea>";support.noCloneChecked=!!div.cloneNode(true).lastChild.defaultValue})();var strundefined=typeof undefined;support.focusinBubbles="onfocusin"in window;var rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;function returnTrue(){return true}function returnFalse(){return false}function safeActiveElement(){try{return document.activeElement}catch(err){}}jQuery.event={global:{},add:function(elem,types,handler,data,selector){var handleObjIn,eventHandle,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=data_priv.get(elem);if(!elemData){return}if(handler.handler){handleObjIn=handler;handler=handleObjIn.handler;selector=handleObjIn.selector}if(!handler.guid){handler.guid=jQuery.guid++}if(!(events=elemData.events)){events=elemData.events={}}if(!(eventHandle=elemData.handle)){eventHandle=elemData.handle=function(e){return typeof jQuery!==strundefined&&jQuery.event.triggered!==e.type?jQuery.event.dispatch.apply(elem,arguments):undefined}}types=(types||"").match(rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){continue}special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;special=jQuery.event.special[type]||{};handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn);if(!(handlers=events[type])){handlers=events[type]=[];handlers.delegateCount=0;if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===false){if(elem.addEventListener){elem.addEventListener(type,eventHandle,false)}}}if(special.add){special.add.call(elem,handleObj);if(!handleObj.handler.guid){handleObj.handler.guid=handler.guid}}if(selector){handlers.splice(handlers.delegateCount++,0,handleObj)}else{handlers.push(handleObj)}jQuery.event.global[type]=true}},remove:function(elem,types,handler,selector,mappedTypes){var j,origCount,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=data_priv.hasData(elem)&&data_priv.get(elem);if(!elemData||!(events=elemData.events)){return}types=(types||"").match(rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){for(type in events){jQuery.event.remove(elem,type+types[t],handler,selector,true)}continue}special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;handlers=events[type]||[];tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)");origCount=j=handlers.length;while(j--){handleObj=handlers[j];if((mappedTypes||origType===handleObj.origType)&&(!handler||handler.guid===handleObj.guid)&&(!tmp||tmp.test(handleObj.namespace))&&(!selector||selector===handleObj.selector||selector==="**"&&handleObj.selector)){handlers.splice(j,1);if(handleObj.selector){handlers.delegateCount--}if(special.remove){special.remove.call(elem,handleObj)}}}if(origCount&&!handlers.length){if(!special.teardown||special.teardown.call(elem,namespaces,elemData.handle)===false){jQuery.removeEvent(elem,type,elemData.handle)}delete events[type]}}if(jQuery.isEmptyObject(events)){delete elemData.handle;data_priv.remove(elem,"events")}},trigger:function(event,data,elem,onlyHandlers){var i,cur,tmp,bubbleType,ontype,handle,special,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];cur=tmp=elem=elem||document;if(elem.nodeType===3||elem.nodeType===8){return}if(rfocusMorph.test(type+jQuery.event.triggered)){return}if(type.indexOf(".")>=0){namespaces=type.split(".");type=namespaces.shift();namespaces.sort()}ontype=type.indexOf(":")<0&&"on"+type;event=event[jQuery.expando]?event:new jQuery.Event(type,typeof event==="object"&&event);event.isTrigger=onlyHandlers?2:3;event.namespace=namespaces.join(".");event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;event.result=undefined;if(!event.target){event.target=elem}data=data==null?[event]:jQuery.makeArray(data,[event]);special=jQuery.event.special[type]||{};if(!onlyHandlers&&special.trigger&&special.trigger.apply(elem,data)===false){return}if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){bubbleType=special.delegateType||type;if(!rfocusMorph.test(bubbleType+type)){cur=cur.parentNode}for(;cur;cur=cur.parentNode){eventPath.push(cur);tmp=cur}if(tmp===(elem.ownerDocument||document)){eventPath.push(tmp.defaultView||tmp.parentWindow||window)}}i=0;while((cur=eventPath[i++])&&!event.isPropagationStopped()){event.type=i>1?bubbleType:special.bindType||type;handle=(data_priv.get(cur,"events")||{})[event.type]&&data_priv.get(cur,"handle");if(handle){handle.apply(cur,data)}handle=ontype&&cur[ontype];if(handle&&handle.apply&&jQuery.acceptData(cur)){event.result=handle.apply(cur,data);if(event.result===false){event.preventDefault()}}}event.type=type;if(!onlyHandlers&&!event.isDefaultPrevented()){if((!special._default||special._default.apply(eventPath.pop(),data)===false)&&jQuery.acceptData(elem)){if(ontype&&jQuery.isFunction(elem[type])&&!jQuery.isWindow(elem)){tmp=elem[ontype];if(tmp){elem[ontype]=null}jQuery.event.triggered=type;elem[type]();jQuery.event.triggered=undefined;if(tmp){elem[ontype]=tmp}}}}return event.result},dispatch:function(event){event=jQuery.event.fix(event);var i,j,ret,matched,handleObj,handlerQueue=[],args=slice.call(arguments),handlers=(data_priv.get(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};args[0]=event;event.delegateTarget=this;if(special.preDispatch&&special.preDispatch.call(this,event)===false){return}handlerQueue=jQuery.event.handlers.call(this,event,handlers);i=0;while((matched=handlerQueue[i++])&&!event.isPropagationStopped()){event.currentTarget=matched.elem;j=0;while((handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped()){if(!event.namespace_re||event.namespace_re.test(handleObj.namespace)){event.handleObj=handleObj;event.data=handleObj.data;ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args);if(ret!==undefined){if((event.result=ret)===false){event.preventDefault();event.stopPropagation()}}}}}if(special.postDispatch){special.postDispatch.call(this,event)}return event.result},handlers:function(event,handlers){var i,matches,sel,handleObj,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||event.type!=="click")){for(;cur!==this;cur=cur.parentNode||this){if(cur.disabled!==true||event.type!=="click"){matches=[];for(i=0;i<delegateCount;i++){handleObj=handlers[i];sel=handleObj.selector+" ";if(matches[sel]===undefined){matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length}if(matches[sel]){matches.push(handleObj)}}if(matches.length){handlerQueue.push({elem:cur,handlers:matches})}}}}if(delegateCount<handlers.length){handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)})}return handlerQueue},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){if(event.which==null){event.which=original.charCode!=null?original.charCode:original.keyCode}return event}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var eventDoc,doc,body,button=original.button;if(event.pageX==null&&original.clientX!=null){eventDoc=event.target.ownerDocument||document;doc=eventDoc.documentElement;body=eventDoc.body;event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}if(!event.which&&button!==undefined){event.which=button&1?1:button&2?3:button&4?2:0}return event}},fix:function(event){if(event[jQuery.expando]){return event}var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];if(!fixHook){this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{}}copy=fixHook.props?this.props.concat(fixHook.props):this.props;event=new jQuery.Event(originalEvent);i=copy.length;while(i--){prop=copy[i];event[prop]=originalEvent[prop]}if(!event.target){event.target=document}if(event.target.nodeType===3){event.target=event.target.parentNode}return fixHook.filter?fixHook.filter(event,originalEvent):event},special:{load:{noBubble:true},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus){this.focus();return false}},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur){this.blur();return false}},delegateType:"focusout"},click:{trigger:function(){if(this.type==="checkbox"&&this.click&&jQuery.nodeName(this,"input")){this.click();return false}},_default:function(event){return jQuery.nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){if(event.result!==undefined&&event.originalEvent){event.originalEvent.returnValue=event.result}}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:true,originalEvent:{}});if(bubble){jQuery.event.trigger(e,null,elem)}else{jQuery.event.dispatch.call(elem,e)}if(e.isDefaultPrevented()){event.preventDefault()}}};jQuery.removeEvent=function(elem,type,handle){if(elem.removeEventListener){elem.removeEventListener(type,handle,false)}};jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event)){return new jQuery.Event(src,props)}if(src&&src.type){this.originalEvent=src;this.type=src.type;this.isDefaultPrevented=src.defaultPrevented||src.defaultPrevented===undefined&&src.returnValue===false?returnTrue:returnFalse}else{this.type=src}if(props){jQuery.extend(this,props)}this.timeStamp=src&&src.timeStamp||jQuery.now();this[jQuery.expando]=true};jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue;if(e&&e.preventDefault){e.preventDefault()}},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue;if(e&&e.stopPropagation){e.stopPropagation()}},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue;if(e&&e.stopImmediatePropagation){e.stopImmediatePropagation()}this.stopPropagation()}};jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;if(!related||related!==target&&!jQuery.contains(target,related)){event.type=handleObj.origType;ret=handleObj.handler.apply(this,arguments);event.type=fix}return ret}}});if(!support.focusinBubbles){jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),true)};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=data_priv.access(doc,fix);if(!attaches){doc.addEventListener(orig,handler,true)}data_priv.access(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this,attaches=data_priv.access(doc,fix)-1;if(!attaches){doc.removeEventListener(orig,handler,true);data_priv.remove(doc,fix)}else{data_priv.access(doc,fix,attaches)}}}})}jQuery.fn.extend({on:function(types,selector,data,fn,one){var origFn,type;if(typeof types==="object"){if(typeof selector!=="string"){data=data||selector;selector=undefined}for(type in types){this.on(type,selector,data,types[type],one)}return this}if(data==null&&fn==null){fn=selector;data=selector=undefined}else if(fn==null){if(typeof selector==="string"){fn=data;data=undefined}else{fn=data;data=selector;selector=undefined}}if(fn===false){fn=returnFalse}else if(!fn){return this}if(one===1){origFn=fn;fn=function(event){jQuery().off(event);return origFn.apply(this,arguments)};fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)}return this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj){handleObj=types.handleObj;jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler);return this}if(typeof types==="object"){for(type in types){this.off(type,selector,types[type])}return this}if(selector===false||typeof selector==="function"){fn=selector;selector=undefined}if(fn===false){fn=returnFalse}return this.each(function(){jQuery.event.remove(this,types,fn,selector)})},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];if(elem){return jQuery.event.trigger(type,data,elem,true)}}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option;wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;wrapMap.th=wrapMap.td;function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(content.nodeType!==11?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function disableScript(elem){elem.type=(elem.getAttribute("type")!==null)+"/"+elem.type;return elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);if(match){elem.type=match[1]}else{elem.removeAttribute("type")}return elem}function setGlobalEval(elems,refElements){var i=0,l=elems.length;for(;i<l;i++){data_priv.set(elems[i],"globalEval",!refElements||data_priv.get(refElements[i],"globalEval"))}}function cloneCopyEvent(src,dest){var i,l,type,pdataOld,pdataCur,udataOld,udataCur,events;if(dest.nodeType!==1){return}if(data_priv.hasData(src)){pdataOld=data_priv.access(src);pdataCur=data_priv.set(dest,pdataOld);events=pdataOld.events;if(events){delete pdataCur.handle;pdataCur.events={};for(type in events){for(i=0,l=events[type].length;i<l;i++){jQuery.event.add(dest,type,events[type][i])}}}}if(data_user.hasData(src)){udataOld=data_user.access(src);udataCur=jQuery.extend({},udataOld);data_user.set(dest,udataCur)}}function getAll(context,tag){var ret=context.getElementsByTagName?context.getElementsByTagName(tag||"*"):context.querySelectorAll?context.querySelectorAll(tag||"*"):[];return tag===undefined||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],ret):ret}function fixInput(src,dest){var nodeName=dest.nodeName.toLowerCase();if(nodeName==="input"&&rcheckableType.test(src.type)){dest.checked=src.checked}else if(nodeName==="input"||nodeName==="textarea"){dest.defaultValue=src.defaultValue;
}}jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var i,l,srcElements,destElements,clone=elem.cloneNode(true),inPage=jQuery.contains(elem.ownerDocument,elem);if(!support.noCloneChecked&&(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){destElements=getAll(clone);srcElements=getAll(elem);for(i=0,l=srcElements.length;i<l;i++){fixInput(srcElements[i],destElements[i])}}if(dataAndEvents){if(deepDataAndEvents){srcElements=srcElements||getAll(elem);destElements=destElements||getAll(clone);for(i=0,l=srcElements.length;i<l;i++){cloneCopyEvent(srcElements[i],destElements[i])}}else{cloneCopyEvent(elem,clone)}}destElements=getAll(clone,"script");if(destElements.length>0){setGlobalEval(destElements,!inPage&&getAll(elem,"script"))}return clone},buildFragment:function(elems,context,scripts,selection){var elem,tmp,tag,wrap,contains,j,fragment=context.createDocumentFragment(),nodes=[],i=0,l=elems.length;for(;i<l;i++){elem=elems[i];if(elem||elem===0){if(jQuery.type(elem)==="object"){jQuery.merge(nodes,elem.nodeType?[elem]:elem)}else if(!rhtml.test(elem)){nodes.push(context.createTextNode(elem))}else{tmp=tmp||fragment.appendChild(context.createElement("div"));tag=(rtagName.exec(elem)||["",""])[1].toLowerCase();wrap=wrapMap[tag]||wrapMap._default;tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2];j=wrap[0];while(j--){tmp=tmp.lastChild}jQuery.merge(nodes,tmp.childNodes);tmp=fragment.firstChild;tmp.textContent=""}}}fragment.textContent="";i=0;while(elem=nodes[i++]){if(selection&&jQuery.inArray(elem,selection)!==-1){continue}contains=jQuery.contains(elem.ownerDocument,elem);tmp=getAll(fragment.appendChild(elem),"script");if(contains){setGlobalEval(tmp)}if(scripts){j=0;while(elem=tmp[j++]){if(rscriptType.test(elem.type||"")){scripts.push(elem)}}}}return fragment},cleanData:function(elems){var data,elem,type,key,special=jQuery.event.special,i=0;for(;(elem=elems[i])!==undefined;i++){if(jQuery.acceptData(elem)){key=elem[data_priv.expando];if(key&&(data=data_priv.cache[key])){if(data.events){for(type in data.events){if(special[type]){jQuery.event.remove(elem,type)}else{jQuery.removeEvent(elem,type,data.handle)}}}if(data_priv.cache[key]){delete data_priv.cache[key]}}}delete data_user.cache[elem[data_user.expando]]}}});jQuery.fn.extend({text:function(value){return access(this,function(value){return value===undefined?jQuery.text(this):this.empty().each(function(){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){this.textContent=value}})},null,value,arguments.length)},append:function(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this)}})},after:function(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this.nextSibling)}})},remove:function(selector,keepData){var elem,elems=selector?jQuery.filter(selector,this):this,i=0;for(;(elem=elems[i])!=null;i++){if(!keepData&&elem.nodeType===1){jQuery.cleanData(getAll(elem))}if(elem.parentNode){if(keepData&&jQuery.contains(elem.ownerDocument,elem)){setGlobalEval(getAll(elem,"script"))}elem.parentNode.removeChild(elem)}}return this},empty:function(){var elem,i=0;for(;(elem=this[i])!=null;i++){if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));elem.textContent=""}}return this},clone:function(dataAndEvents,deepDataAndEvents){dataAndEvents=dataAndEvents==null?false:dataAndEvents;deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;return this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(value===undefined&&elem.nodeType===1){return elem.innerHTML}if(typeof value==="string"&&!rnoInnerhtml.test(value)&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;i<l;i++){elem=this[i]||{};if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));elem.innerHTML=value}}elem=0}catch(e){}}if(elem){this.empty().append(value)}},null,value,arguments.length)},replaceWith:function(){var arg=arguments[0];this.domManip(arguments,function(elem){arg=this.parentNode;jQuery.cleanData(getAll(this));if(arg){arg.replaceChild(elem,this)}});return arg&&(arg.length||arg.nodeType)?this:this.remove()},detach:function(selector){return this.remove(selector,true)},domManip:function(args,callback){args=concat.apply([],args);var fragment,first,scripts,hasScripts,node,doc,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||l>1&&typeof value==="string"&&!support.checkClone&&rchecked.test(value)){return this.each(function(index){var self=set.eq(index);if(isFunction){args[0]=value.call(this,index,self.html())}self.domManip(args,callback)})}if(l){fragment=jQuery.buildFragment(args,this[0].ownerDocument,false,this);first=fragment.firstChild;if(fragment.childNodes.length===1){fragment=first}if(first){scripts=jQuery.map(getAll(fragment,"script"),disableScript);hasScripts=scripts.length;for(;i<l;i++){node=fragment;if(i!==iNoClone){node=jQuery.clone(node,true,true);if(hasScripts){jQuery.merge(scripts,getAll(node,"script"))}}callback.call(this[i],node,i)}if(hasScripts){doc=scripts[scripts.length-1].ownerDocument;jQuery.map(scripts,restoreScript);for(i=0;i<hasScripts;i++){node=scripts[i];if(rscriptType.test(node.type||"")&&!data_priv.access(node,"globalEval")&&jQuery.contains(doc,node)){if(node.src){if(jQuery._evalUrl){jQuery._evalUrl(node.src)}}else{jQuery.globalEval(node.textContent.replace(rcleanScript,""))}}}}}}return this}});jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var elems,ret=[],insert=jQuery(selector),last=insert.length-1,i=0;for(;i<=last;i++){elems=i===last?this:this.clone(true);jQuery(insert[i])[original](elems);push.apply(ret,elems.get())}return this.pushStack(ret)}});var iframe,elemdisplay={};function actualDisplay(name,doc){var style,elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=window.getDefaultComputedStyle&&(style=window.getDefaultComputedStyle(elem[0]))?style.display:jQuery.css(elem[0],"display");elem.detach();return display}function defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];if(!display){display=actualDisplay(nodeName,doc);if(display==="none"||!display){iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement);doc=iframe[0].contentDocument;doc.write();doc.close();display=actualDisplay(nodeName,doc);iframe.detach()}elemdisplay[nodeName]=display}return display}var rmargin=/^margin/;var rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i");var getStyles=function(elem){if(elem.ownerDocument.defaultView.opener){return elem.ownerDocument.defaultView.getComputedStyle(elem,null)}return window.getComputedStyle(elem,null)};function curCSS(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;computed=computed||getStyles(elem);if(computed){ret=computed.getPropertyValue(name)||computed[name]}if(computed){if(ret===""&&!jQuery.contains(elem.ownerDocument,elem)){ret=jQuery.style(elem,name)}if(rnumnonpx.test(ret)&&rmargin.test(name)){width=style.width;minWidth=style.minWidth;maxWidth=style.maxWidth;style.minWidth=style.maxWidth=style.width=ret;ret=computed.width;style.width=width;style.minWidth=minWidth;style.maxWidth=maxWidth}}return ret!==undefined?ret+"":ret}function addGetHookIf(conditionFn,hookFn){return{get:function(){if(conditionFn()){delete this.get;return}return(this.get=hookFn).apply(this,arguments)}}}(function(){var pixelPositionVal,boxSizingReliableVal,docElem=document.documentElement,container=document.createElement("div"),div=document.createElement("div");if(!div.style){return}div.style.backgroundClip="content-box";div.cloneNode(true).style.backgroundClip="";support.clearCloneStyle=div.style.backgroundClip==="content-box";container.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;"+"position:absolute";container.appendChild(div);function computePixelPositionAndBoxSizingReliable(){div.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;"+"box-sizing:border-box;display:block;margin-top:1%;top:1%;"+"border:1px;padding:1px;width:4px;position:absolute";div.innerHTML="";docElem.appendChild(container);var divStyle=window.getComputedStyle(div,null);pixelPositionVal=divStyle.top!=="1%";boxSizingReliableVal=divStyle.width==="4px";docElem.removeChild(container)}if(window.getComputedStyle){jQuery.extend(support,{pixelPosition:function(){computePixelPositionAndBoxSizingReliable();return pixelPositionVal},boxSizingReliable:function(){if(boxSizingReliableVal==null){computePixelPositionAndBoxSizingReliable()}return boxSizingReliableVal},reliableMarginRight:function(){var ret,marginDiv=div.appendChild(document.createElement("div"));marginDiv.style.cssText=div.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;"+"box-sizing:content-box;display:block;margin:0;border:0;padding:0";marginDiv.style.marginRight=marginDiv.style.width="0";div.style.width="1px";docElem.appendChild(container);ret=!parseFloat(window.getComputedStyle(marginDiv,null).marginRight);docElem.removeChild(container);div.removeChild(marginDiv);return ret}})}})();jQuery.swap=function(elem,options,callback,args){var ret,name,old={};for(name in options){old[name]=elem.style[name];elem.style[name]=options[name]}ret=callback.apply(elem,args||[]);for(name in options){elem.style[name]=old[name]}return ret};var rdisplayswap=/^(none|table(?!-c[ea]).+)/,rnumsplit=new RegExp("^("+pnum+")(.*)$","i"),rrelNum=new RegExp("^([+-])=("+pnum+")","i"),cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","O","Moz","ms"];function vendorPropName(style,name){if(name in style){return name}var capName=name[0].toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;while(i--){name=cssPrefixes[i]+capName;if(name in style){return name}}return origName}function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){var i=extra===(isBorderBox?"border":"content")?4:name==="width"?1:0,val=0;for(;i<4;i+=2){if(extra==="margin"){val+=jQuery.css(elem,extra+cssExpand[i],true,styles)}if(isBorderBox){if(extra==="content"){val-=jQuery.css(elem,"padding"+cssExpand[i],true,styles)}if(extra!=="margin"){val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles)}}else{val+=jQuery.css(elem,"padding"+cssExpand[i],true,styles);if(extra!=="padding"){val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles)}}}return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=true,val=name==="width"?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox=jQuery.css(elem,"boxSizing",false,styles)==="border-box";if(val<=0||val==null){val=curCSS(elem,name,styles);if(val<0||val==null){val=elem.style[name]}if(rnumnonpx.test(val)){return val}valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]);val=parseFloat(val)||0}return val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px"}function showHide(elements,show){var display,elem,hidden,values=[],index=0,length=elements.length;for(;index<length;index++){elem=elements[index];if(!elem.style){continue}values[index]=data_priv.get(elem,"olddisplay");display=elem.style.display;if(show){if(!values[index]&&display==="none"){elem.style.display=""}if(elem.style.display===""&&isHidden(elem)){values[index]=data_priv.access(elem,"olddisplay",defaultDisplay(elem.nodeName))}}else{hidden=isHidden(elem);if(display!=="none"||!hidden){data_priv.set(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))}}}for(index=0;index<length;index++){elem=elements[index];if(!elem.style){continue}if(!show||elem.style.display==="none"||elem.style.display===""){elem.style.display=show?values[index]||"":"none"}}return elements}jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return ret===""?"1":ret}}}},cssNumber:{columnCount:true,fillOpacity:true,flexGrow:true,flexShrink:true,fontWeight:true,lineHeight:true,opacity:true,order:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{"float":"cssFloat"},style:function(elem,name,value,extra){if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style){return}var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(value!==undefined){type=typeof value;if(type==="string"&&(ret=rrelNum.exec(value))){value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name));type="number"}if(value==null||value!==value){return}if(type==="number"&&!jQuery.cssNumber[origName]){value+="px"}if(!support.clearCloneStyle&&value===""&&name.indexOf("background")===0){style[name]="inherit"}if(!hooks||!("set"in hooks)||(value=hooks.set(elem,value,extra))!==undefined){style[name]=value}}else{if(hooks&&"get"in hooks&&(ret=hooks.get(elem,false,extra))!==undefined){return ret}return style[name]}},css:function(elem,name,extra,styles){var val,num,hooks,origName=jQuery.camelCase(name);name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(hooks&&"get"in hooks){val=hooks.get(elem,true,extra)}if(val===undefined){val=curCSS(elem,name,styles)}if(val==="normal"&&name in cssNormalTransform){val=cssNormalTransform[name]}if(extra===""||extra){num=parseFloat(val);return extra===true||jQuery.isNumeric(num)?num||0:val}return val}});jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){if(computed){return rdisplayswap.test(jQuery.css(elem,"display"))&&elem.offsetWidth===0?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):getWidthOrHeight(elem,name,extra)}},set:function(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,jQuery.css(elem,"boxSizing",false,styles)==="border-box",styles):0)}}});jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,function(elem,computed){if(computed){return jQuery.swap(elem,{display:"inline-block"},curCSS,[elem,"marginRight"])}});jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){var i=0,expanded={},parts=typeof value==="string"?value.split(" "):[value];for(;i<4;i++){expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0]}return expanded}};if(!rmargin.test(prefix)){jQuery.cssHooks[prefix+suffix].set=setPositiveNumber}});jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(jQuery.isArray(name)){styles=getStyles(elem);len=name.length;for(;i<len;i++){map[name[i]]=jQuery.css(elem,name[i],false,styles)}return map}return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)},show:function(){return showHide(this,true)},hide:function(){return showHide(this)},toggle:function(state){if(typeof state==="boolean"){return state?this.show():this.hide()}return this.each(function(){if(isHidden(this)){jQuery(this).show()}else{jQuery(this).hide()}})}});function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}jQuery.Tween=Tween;Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem;this.prop=prop;this.easing=easing||"swing";this.options=options;this.start=this.now=this.cur();this.end=end;this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];if(this.options.duration){this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration)}else{this.pos=eased=percent}this.now=(this.end-this.start)*eased+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this)}if(hooks&&hooks.set){hooks.set(this)}else{Tween.propHooks._default.set(this)}return this}};Tween.prototype.init.prototype=Tween.prototype;Tween.propHooks={_default:{get:function(tween){var result;if(tween.elem[tween.prop]!=null&&(!tween.elem.style||tween.elem.style[tween.prop]==null)){return tween.elem[tween.prop]}result=jQuery.css(tween.elem,tween.prop,"");return!result||result==="auto"?0:result},set:function(tween){if(jQuery.fx.step[tween.prop]){jQuery.fx.step[tween.prop](tween)}else if(tween.elem.style&&(tween.elem.style[jQuery.cssProps[tween.prop]]!=null||jQuery.cssHooks[tween.prop])){jQuery.style(tween.elem,tween.prop,tween.now+tween.unit)}else{tween.elem[tween.prop]=tween.now}}}};Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){if(tween.elem.nodeType&&tween.elem.parentNode){tween.elem[tween.prop]=tween.now}}};jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2}};jQuery.fx=Tween.prototype.init;jQuery.fx.step={};var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||unit!=="px"&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;if(start&&start[3]!==unit){unit=unit||start[3];parts=parts||[];start=+target||1;do{scale=scale||".5";start=start/scale;jQuery.style(tween.elem,prop,start+unit)}while(scale!==(scale=tween.cur()/target)&&scale!==1&&--maxIterations)}if(parts){start=tween.start=+start||+target||0;tween.unit=unit;tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2]}return tween}]};function createFxNow(){setTimeout(function(){fxNow=undefined});return fxNow=jQuery.now()}function genFx(type,includeWidth){var which,i=0,attrs={height:type};includeWidth=includeWidth?1:0;for(;i<4;i+=2-includeWidth){which=cssExpand[i];attrs["margin"+which]=attrs["padding"+which]=type}if(includeWidth){attrs.opacity=attrs.width=type}return attrs}function createTween(value,prop,animation){var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;for(;index<length;index++){if(tween=collection[index].call(animation,prop,value)){return tween}}}function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,display,checkDisplay,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=data_priv.get(elem,"fxshow");if(!opts.queue){hooks=jQuery._queueHooks(elem,"fx");if(hooks.unqueued==null){hooks.unqueued=0;oldfire=hooks.empty.fire;hooks.empty.fire=function(){if(!hooks.unqueued){oldfire()}}}hooks.unqueued++;anim.always(function(){anim.always(function(){hooks.unqueued--;if(!jQuery.queue(elem,"fx").length){hooks.empty.fire()}})})}if(elem.nodeType===1&&("height"in props||"width"in props)){opts.overflow=[style.overflow,style.overflowX,style.overflowY];display=jQuery.css(elem,"display");checkDisplay=display==="none"?data_priv.get(elem,"olddisplay")||defaultDisplay(elem.nodeName):display;if(checkDisplay==="inline"&&jQuery.css(elem,"float")==="none"){style.display="inline-block"}}if(opts.overflow){style.overflow="hidden";anim.always(function(){style.overflow=opts.overflow[0];style.overflowX=opts.overflow[1];style.overflowY=opts.overflow[2]})}for(prop in props){value=props[prop];if(rfxtypes.exec(value)){delete props[prop];toggle=toggle||value==="toggle";if(value===(hidden?"hide":"show")){if(value==="show"&&dataShow&&dataShow[prop]!==undefined){hidden=true}else{continue}}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}else{display=undefined}}if(!jQuery.isEmptyObject(orig)){if(dataShow){if("hidden"in dataShow){hidden=dataShow.hidden}}else{dataShow=data_priv.access(elem,"fxshow",{})}if(toggle){dataShow.hidden=!hidden}if(hidden){jQuery(elem).show()}else{anim.done(function(){jQuery(elem).hide()})}anim.done(function(){var prop;data_priv.remove(elem,"fxshow");for(prop in orig){jQuery.style(elem,prop,orig[prop])}});for(prop in orig){tween=createTween(hidden?dataShow[prop]:0,prop,anim);if(!(prop in dataShow)){dataShow[prop]=tween.start;if(hidden){tween.end=tween.start;tween.start=prop==="width"||prop==="height"?1:0}}}}else if((display==="none"?defaultDisplay(elem.nodeName):display)==="inline"){style.display=display}}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props){name=jQuery.camelCase(index);easing=specialEasing[name];value=props[index];if(jQuery.isArray(value)){easing=value[1];value=props[index]=value[0]}if(index!==name){props[name]=value;delete props[index]}hooks=jQuery.cssHooks[name];if(hooks&&"expand"in hooks){value=hooks.expand(value);delete props[name];for(index in value){if(!(index in props)){props[index]=value[index];specialEasing[index]=easing}}}else{specialEasing[name]=easing}}}function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped){return false}var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;for(;index<length;index++){animation.tweens[index].run(percent)}deferred.notifyWith(elem,[animation,percent,remaining]);if(percent<1&&length){return remaining}else{deferred.resolveWith(elem,[animation]);return false}},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(true,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);animation.tweens.push(tween);return tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped){return this}stopped=true;for(;index<length;index++){animation.tweens[index].run(1)}if(gotoEnd){deferred.resolveWith(elem,[animation,gotoEnd])}else{deferred.rejectWith(elem,[animation,gotoEnd])}return this}}),props=animation.props;propFilter(props,animation.opts.specialEasing);for(;index<length;index++){result=animationPrefilters[index].call(animation,elem,props,animation.opts);if(result){return result}}jQuery.map(props,createTween,animation);if(jQuery.isFunction(animation.opts.start)){animation.opts.start.call(elem,animation)}jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue}));return animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){if(jQuery.isFunction(props)){callback=props;props=["*"]}else{props=props.split(" ")}var prop,index=0,length=props.length;for(;index<length;index++){prop=props[index];tweeners[prop]=tweeners[prop]||[];tweeners[prop].unshift(callback)}},prefilter:function(callback,prepend){if(prepend){animationPrefilters.unshift(callback)}else{animationPrefilters.push(callback)}}});jQuery.speed=function(speed,easing,fn){var opt=speed&&typeof speed==="object"?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};opt.duration=jQuery.fx.off?0:typeof opt.duration==="number"?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default;if(opt.queue==null||opt.queue===true){opt.queue="fx"}opt.old=opt.complete;opt.complete=function(){if(jQuery.isFunction(opt.old)){opt.old.call(this)}if(opt.queue){jQuery.dequeue(this,opt.queue)}};return opt};jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);if(empty||data_priv.get(this,"finish")){anim.stop(true)}};doAnimation.finish=doAnimation;return empty||optall.queue===false?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop;stop(gotoEnd)};if(typeof type!=="string"){gotoEnd=clearQueue;clearQueue=type;type=undefined}if(clearQueue&&type!==false){this.queue(type||"fx",[])}return this.each(function(){var dequeue=true,index=type!=null&&type+"queueHooks",timers=jQuery.timers,data=data_priv.get(this);if(index){if(data[index]&&data[index].stop){stopQueue(data[index])}}else{for(index in data){if(data[index]&&data[index].stop&&rrun.test(index)){stopQueue(data[index])}}}for(index=timers.length;index--;){if(timers[index].elem===this&&(type==null||timers[index].queue===type)){timers[index].anim.stop(gotoEnd);dequeue=false;timers.splice(index,1)}}if(dequeue||!gotoEnd){jQuery.dequeue(this,type)}})},finish:function(type){if(type!==false){type=type||"fx"}return this.each(function(){var index,data=data_priv.get(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;data.finish=true;jQuery.queue(this,type,[]);if(hooks&&hooks.stop){hooks.stop.call(this,true)}for(index=timers.length;index--;){if(timers[index].elem===this&&timers[index].queue===type){timers[index].anim.stop(true);timers.splice(index,1)}}for(index=0;index<length;index++){if(queue[index]&&queue[index].finish){queue[index].finish.call(this)}}delete data.finish})}});jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return speed==null||typeof speed==="boolean"?cssFn.apply(this,arguments):this.animate(genFx(name,true),speed,easing,callback)}});jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}});jQuery.timers=[];jQuery.fx.tick=function(){var timer,i=0,timers=jQuery.timers;fxNow=jQuery.now();for(;i<timers.length;i++){timer=timers[i];if(!timer()&&timers[i]===timer){timers.splice(i--,1)}}if(!timers.length){jQuery.fx.stop()}fxNow=undefined};jQuery.fx.timer=function(timer){jQuery.timers.push(timer);if(timer()){jQuery.fx.start()}else{jQuery.timers.pop()}};jQuery.fx.interval=13;jQuery.fx.start=function(){if(!timerId){timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval)}};jQuery.fx.stop=function(){clearInterval(timerId);timerId=null};jQuery.fx.speeds={slow:600,fast:200,_default:400};jQuery.fn.delay=function(time,type){time=jQuery.fx?jQuery.fx.speeds[time]||time:time;type=type||"fx";return this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})};(function(){var input=document.createElement("input"),select=document.createElement("select"),opt=select.appendChild(document.createElement("option"));input.type="checkbox";support.checkOn=input.value!=="";support.optSelected=opt.selected;select.disabled=true;support.optDisabled=!opt.disabled;input=document.createElement("input");input.value="t";input.type="radio";support.radioValue=input.value==="t"})();var nodeHook,boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}});jQuery.extend({attr:function(elem,name,value){var hooks,ret,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return}if(typeof elem.getAttribute===strundefined){return jQuery.prop(elem,name,value)}if(nType!==1||!jQuery.isXMLDoc(elem)){name=name.toLowerCase();hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook)}if(value!==undefined){if(value===null){jQuery.removeAttr(elem,name)}else if(hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined){return ret}else{elem.setAttribute(name,value+"");return value}}else if(hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null){return ret}else{ret=jQuery.find.attr(elem,name);return ret==null?undefined:ret}},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(rnotwhite);if(attrNames&&elem.nodeType===1){while(name=attrNames[i++]){propName=jQuery.propFix[name]||name;if(jQuery.expr.match.bool.test(name)){elem[propName]=false}elem.removeAttribute(name)}}},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&value==="radio"&&jQuery.nodeName(elem,"input")){var val=elem.value;elem.setAttribute("type",value);if(val){elem.value=val}return value}}}}});boolHook={set:function(elem,value,name){if(value===false){jQuery.removeAttr(elem,name)}else{elem.setAttribute(name,name)}return name}};jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=function(elem,name,isXML){var ret,handle;if(!isXML){handle=attrHandle[name];attrHandle[name]=ret;ret=getter(elem,name,isXML)!=null?name.toLowerCase():null;attrHandle[name]=handle}return ret}});var rfocusable=/^(?:input|select|textarea|button)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return this.each(function(){delete this[jQuery.propFix[name]||name]})}});jQuery.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return}notxml=nType!==1||!jQuery.isXMLDoc(elem);if(notxml){name=jQuery.propFix[name]||name;hooks=jQuery.propHooks[name]}if(value!==undefined){return hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined?ret:elem[name]=value}else{return hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null?ret:elem[name]}},propHooks:{tabIndex:{get:function(elem){return elem.hasAttribute("tabindex")||rfocusable.test(elem.nodeName)||elem.href?elem.tabIndex:-1}}}});if(!support.optSelected){jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;if(parent&&parent.parentNode){parent.parentNode.selectedIndex}return null}}}jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this});var rclass=/[\t\r\n\f]/g;jQuery.fn.extend({addClass:function(value){var classes,elem,cur,clazz,j,finalValue,proceed=typeof value==="string"&&value,i=0,len=this.length;if(jQuery.isFunction(value)){
return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))})}if(proceed){classes=(value||"").match(rnotwhite)||[];for(;i<len;i++){elem=this[i];cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ");if(cur){j=0;while(clazz=classes[j++]){if(cur.indexOf(" "+clazz+" ")<0){cur+=clazz+" "}}finalValue=jQuery.trim(cur);if(elem.className!==finalValue){elem.className=finalValue}}}}return this},removeClass:function(value){var classes,elem,cur,clazz,j,finalValue,proceed=arguments.length===0||typeof value==="string"&&value,i=0,len=this.length;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))})}if(proceed){classes=(value||"").match(rnotwhite)||[];for(;i<len;i++){elem=this[i];cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"");if(cur){j=0;while(clazz=classes[j++]){while(cur.indexOf(" "+clazz+" ")>=0){cur=cur.replace(" "+clazz+" "," ")}}finalValue=value?jQuery.trim(cur):"";if(elem.className!==finalValue){elem.className=finalValue}}}}return this},toggleClass:function(value,stateVal){var type=typeof value;if(typeof stateVal==="boolean"&&type==="string"){return stateVal?this.addClass(value):this.removeClass(value)}if(jQuery.isFunction(value)){return this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)})}return this.each(function(){if(type==="string"){var className,i=0,self=jQuery(this),classNames=value.match(rnotwhite)||[];while(className=classNames[i++]){if(self.hasClass(className)){self.removeClass(className)}else{self.addClass(className)}}}else if(type===strundefined||type==="boolean"){if(this.className){data_priv.set(this,"__className__",this.className)}this.className=this.className||value===false?"":data_priv.get(this,"__className__")||""}})},hasClass:function(selector){var className=" "+selector+" ",i=0,l=this.length;for(;i<l;i++){if(this[i].nodeType===1&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0){return true}}return false}});var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,isFunction,elem=this[0];if(!arguments.length){if(elem){hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()];if(hooks&&"get"in hooks&&(ret=hooks.get(elem,"value"))!==undefined){return ret}ret=elem.value;return typeof ret==="string"?ret.replace(rreturn,""):ret==null?"":ret}return}isFunction=jQuery.isFunction(value);return this.each(function(i){var val;if(this.nodeType!==1){return}if(isFunction){val=value.call(this,i,jQuery(this).val())}else{val=value}if(val==null){val=""}else if(typeof val==="number"){val+=""}else if(jQuery.isArray(val)){val=jQuery.map(val,function(value){return value==null?"":value+""})}hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];if(!hooks||!("set"in hooks)||hooks.set(this,val,"value")===undefined){this.value=val}})}});jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return val!=null?val:jQuery.trim(jQuery.text(elem))}},select:{get:function(elem){var value,option,options=elem.options,index=elem.selectedIndex,one=elem.type==="select-one"||index<0,values=one?null:[],max=one?index+1:options.length,i=index<0?max:one?index:0;for(;i<max;i++){option=options[i];if((option.selected||i===index)&&(support.optDisabled?!option.disabled:option.getAttribute("disabled")===null)&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){value=jQuery(option).val();if(one){return value}values.push(value)}}return values},set:function(elem,value){var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;while(i--){option=options[i];if(option.selected=jQuery.inArray(option.value,values)>=0){optionSet=true}}if(!optionSet){elem.selectedIndex=-1}return values}}}});jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(jQuery.isArray(value)){return elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0}}};if(!support.checkOn){jQuery.valHooks[this].get=function(elem){return elem.getAttribute("value")===null?"on":elem.value}}});jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup error contextmenu").split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}});jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return arguments.length===1?this.off(selector,"**"):this.off(types,selector||"**",fn)}});var nonce=jQuery.now();var rquery=/\?/;jQuery.parseJSON=function(data){return JSON.parse(data+"")};jQuery.parseXML=function(data){var xml,tmp;if(!data||typeof data!=="string"){return null}try{tmp=new DOMParser;xml=tmp.parseFromString(data,"text/xml")}catch(e){xml=undefined}if(!xml||xml.getElementsByTagName("parsererror").length){jQuery.error("Invalid XML: "+data)}return xml};var rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,prefilters={},transports={},allTypes="*/".concat("*"),ajaxLocation=window.location.href,ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[];function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){if(typeof dataTypeExpression!=="string"){func=dataTypeExpression;dataTypeExpression="*"}var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnotwhite)||[];if(jQuery.isFunction(func)){while(dataType=dataTypes[i++]){if(dataType[0]==="+"){dataType=dataType.slice(1)||"*";(structure[dataType]=structure[dataType]||[]).unshift(func)}else{(structure[dataType]=structure[dataType]||[]).push(func)}}}}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){var inspected={},seekingTransport=structure===transports;function inspect(dataType){var selected;inspected[dataType]=true;jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);if(typeof dataTypeOrTransport==="string"&&!seekingTransport&&!inspected[dataTypeOrTransport]){options.dataTypes.unshift(dataTypeOrTransport);inspect(dataTypeOrTransport);return false}else if(seekingTransport){return!(selected=dataTypeOrTransport)}});return selected}return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src){if(src[key]!==undefined){(flatOptions[key]?target:deep||(deep={}))[key]=src[key]}}if(deep){jQuery.extend(true,target,deep)}return target}function ajaxHandleResponses(s,jqXHR,responses){var ct,type,finalDataType,firstDataType,contents=s.contents,dataTypes=s.dataTypes;while(dataTypes[0]==="*"){dataTypes.shift();if(ct===undefined){ct=s.mimeType||jqXHR.getResponseHeader("Content-Type")}}if(ct){for(type in contents){if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}}}if(dataTypes[0]in responses){finalDataType=dataTypes[0]}else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}if(!firstDataType){firstDataType=type}}finalDataType=finalDataType||firstDataType}if(finalDataType){if(finalDataType!==dataTypes[0]){dataTypes.unshift(finalDataType)}return responses[finalDataType]}}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1]){for(conv in s.converters){converters[conv.toLowerCase()]=s.converters[conv]}}current=dataTypes.shift();while(current){if(s.responseFields[current]){jqXHR[s.responseFields[current]]=response}if(!prev&&isSuccess&&s.dataFilter){response=s.dataFilter(response,s.dataType)}prev=current;current=dataTypes.shift();if(current){if(current==="*"){current=prev}else if(prev!=="*"&&prev!==current){conv=converters[prev+" "+current]||converters["* "+current];if(!conv){for(conv2 in converters){tmp=conv2.split(" ");if(tmp[1]===current){conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]];if(conv){if(conv===true){conv=converters[conv2]}else if(converters[conv2]!==true){current=tmp[0];dataTypes.unshift(tmp[1])}break}}}}if(conv!==true){if(conv&&s["throws"]){response=conv(response)}else{try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}}}}}return{state:"success",data:response}}jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){if(typeof url==="object"){options=url;url=undefined}options=options||{};var transport,cacheURL,responseHeadersString,responseHeaders,timeoutTimer,parts,fireGlobals,i,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(state===2){if(!responseHeaders){responseHeaders={};while(match=rheaders.exec(responseHeadersString)){responseHeaders[match[1].toLowerCase()]=match[2]}}match=responseHeaders[key.toLowerCase()]}return match==null?null:match},getAllResponseHeaders:function(){return state===2?responseHeadersString:null},setRequestHeader:function(name,value){var lname=name.toLowerCase();if(!state){name=requestHeadersNames[lname]=requestHeadersNames[lname]||name;requestHeaders[name]=value}return this},overrideMimeType:function(type){if(!state){s.mimeType=type}return this},statusCode:function(map){var code;if(map){if(state<2){for(code in map){statusCode[code]=[statusCode[code],map[code]]}}else{jqXHR.always(map[jqXHR.status])}}return this},abort:function(statusText){var finalText=statusText||strAbort;if(transport){transport.abort(finalText)}done(0,finalText);return this}};deferred.promise(jqXHR).complete=completeDeferred.add;jqXHR.success=jqXHR.done;jqXHR.error=jqXHR.fail;s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//");s.type=options.method||options.type||s.method||s.type;s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(rnotwhite)||[""];if(s.crossDomain==null){parts=rurl.exec(s.url.toLowerCase());s.crossDomain=!!(parts&&(parts[1]!==ajaxLocParts[1]||parts[2]!==ajaxLocParts[2]||(parts[3]||(parts[1]==="http:"?"80":"443"))!==(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?"80":"443"))))}if(s.data&&s.processData&&typeof s.data!=="string"){s.data=jQuery.param(s.data,s.traditional)}inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);if(state===2){return jqXHR}fireGlobals=jQuery.event&&s.global;if(fireGlobals&&jQuery.active++===0){jQuery.event.trigger("ajaxStart")}s.type=s.type.toUpperCase();s.hasContent=!rnoContent.test(s.type);cacheURL=s.url;if(!s.hasContent){if(s.data){cacheURL=s.url+=(rquery.test(cacheURL)?"&":"?")+s.data;delete s.data}if(s.cache===false){s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+nonce++):cacheURL+(rquery.test(cacheURL)?"&":"?")+"_="+nonce++}}if(s.ifModified){if(jQuery.lastModified[cacheURL]){jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL])}if(jQuery.etag[cacheURL]){jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])}}if(s.data&&s.hasContent&&s.contentType!==false||options.contentType){jqXHR.setRequestHeader("Content-Type",s.contentType)}jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers){jqXHR.setRequestHeader(i,s.headers[i])}if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===false||state===2)){return jqXHR.abort()}strAbort="abort";for(i in{success:1,error:1,complete:1}){jqXHR[i](s[i])}transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);if(!transport){done(-1,"No Transport")}else{jqXHR.readyState=1;if(fireGlobals){globalEventContext.trigger("ajaxSend",[jqXHR,s])}if(s.async&&s.timeout>0){timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout)}try{state=1;transport.send(requestHeaders,done)}catch(e){if(state<2){done(-1,e)}else{throw e}}}function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;if(state===2){return}state=2;if(timeoutTimer){clearTimeout(timeoutTimer)}transport=undefined;responseHeadersString=headers||"";jqXHR.readyState=status>0?4:0;isSuccess=status>=200&&status<300||status===304;if(responses){response=ajaxHandleResponses(s,jqXHR,responses)}response=ajaxConvert(s,response,jqXHR,isSuccess);if(isSuccess){if(s.ifModified){modified=jqXHR.getResponseHeader("Last-Modified");if(modified){jQuery.lastModified[cacheURL]=modified}modified=jqXHR.getResponseHeader("etag");if(modified){jQuery.etag[cacheURL]=modified}}if(status===204||s.type==="HEAD"){statusText="nocontent"}else if(status===304){statusText="notmodified"}else{statusText=response.state;success=response.data;error=response.error;isSuccess=!error}}else{error=statusText;if(status||!statusText){statusText="error";if(status<0){status=0}}}jqXHR.status=status;jqXHR.statusText=(nativeStatusText||statusText)+"";if(isSuccess){deferred.resolveWith(callbackContext,[success,statusText,jqXHR])}else{deferred.rejectWith(callbackContext,[jqXHR,statusText,error])}jqXHR.statusCode(statusCode);statusCode=undefined;if(fireGlobals){globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error])}completeDeferred.fireWith(callbackContext,[jqXHR,statusText]);if(fireGlobals){globalEventContext.trigger("ajaxComplete",[jqXHR,s]);if(!--jQuery.active){jQuery.event.trigger("ajaxStop")}}}return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script")}});jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){if(jQuery.isFunction(data)){type=type||callback;callback=data;data=undefined}return jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback})}});jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:false,global:false,"throws":true})};jQuery.fn.extend({wrapAll:function(html){var wrap;if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))})}if(this[0]){wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){wrap.insertBefore(this[0])}wrap.map(function(){var elem=this;while(elem.firstElementChild){elem=elem.firstElementChild}return elem}).append(this)}return this},wrapInner:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapInner(html.call(this,i))})}return this.each(function(){var self=jQuery(this),contents=self.contents();if(contents.length){contents.wrapAll(html)}else{self.append(html)}})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){if(!jQuery.nodeName(this,"body")){jQuery(this).replaceWith(this.childNodes)}}).end()}});jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0};jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem)};var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj)){jQuery.each(obj,function(i,v){if(traditional||rbracket.test(prefix)){add(prefix,v)}else{buildParams(prefix+"["+(typeof v==="object"?i:"")+"]",v,traditional,add)}})}else if(!traditional&&jQuery.type(obj)==="object"){for(name in obj){buildParams(prefix+"["+name+"]",obj[name],traditional,add)}}else{add(prefix,obj)}}jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():value==null?"":value;s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(traditional===undefined){traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional}if(jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a)){jQuery.each(a,function(){add(this.name,this.value)})}else{for(prefix in a){buildParams(prefix,a[prefix],traditional,add)}}return s.join("&").replace(r20,"+")};jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return val==null?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}});jQuery.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var xhrId=0,xhrCallbacks={},xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();if(window.attachEvent){window.attachEvent("onunload",function(){for(var key in xhrCallbacks){xhrCallbacks[key]()}})}support.cors=!!xhrSupported&&"withCredentials"in xhrSupported;support.ajax=xhrSupported=!!xhrSupported;jQuery.ajaxTransport(function(options){var callback;if(support.cors||xhrSupported&&!options.crossDomain){return{send:function(headers,complete){var i,xhr=options.xhr(),id=++xhrId;xhr.open(options.type,options.url,options.async,options.username,options.password);if(options.xhrFields){for(i in options.xhrFields){xhr[i]=options.xhrFields[i]}}if(options.mimeType&&xhr.overrideMimeType){xhr.overrideMimeType(options.mimeType)}if(!options.crossDomain&&!headers["X-Requested-With"]){headers["X-Requested-With"]="XMLHttpRequest"}for(i in headers){xhr.setRequestHeader(i,headers[i])}callback=function(type){return function(){if(callback){delete xhrCallbacks[id];callback=xhr.onload=xhr.onerror=null;if(type==="abort"){xhr.abort()}else if(type==="error"){complete(xhr.status,xhr.statusText)}else{complete(xhrSuccessStatus[xhr.status]||xhr.status,xhr.statusText,typeof xhr.responseText==="string"?{text:xhr.responseText}:undefined,xhr.getAllResponseHeaders())}}}};xhr.onload=callback();xhr.onerror=callback("error");callback=xhrCallbacks[id]=callback("abort");try{xhr.send(options.hasContent&&options.data||null)}catch(e){if(callback){throw e}}},abort:function(){if(callback){callback()}}}}});jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){jQuery.globalEval(text);return text}}});jQuery.ajaxPrefilter("script",function(s){if(s.cache===undefined){s.cache=false}if(s.crossDomain){s.type="GET"}});jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,callback;return{send:function(_,complete){script=jQuery("<script>").prop({async:true,charset:s.scriptCharset,src:s.url}).on("load error",callback=function(evt){script.remove();callback=null;if(evt){complete(evt.type==="error"?404:200,evt.type)}});document.head.appendChild(script[0])},abort:function(){if(callback){callback()}}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;this[callback]=true;return callback}});jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==false&&(rjsonp.test(s.url)?"url":typeof s.data==="string"&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");if(jsonProp||s.dataTypes[0]==="jsonp"){callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback;if(jsonProp){s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName)}else if(s.jsonp!==false){s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName}s.converters["script json"]=function(){if(!responseContainer){jQuery.error(callbackName+" was not called")}return responseContainer[0]};s.dataTypes[0]="json";overwritten=window[callbackName];window[callbackName]=function(){responseContainer=arguments};jqXHR.always(function(){window[callbackName]=overwritten;if(s[callbackName]){s.jsonpCallback=originalSettings.jsonpCallback;oldCallbacks.push(callbackName)}if(responseContainer&&jQuery.isFunction(overwritten)){overwritten(responseContainer[0])}responseContainer=overwritten=undefined});return"script"}});jQuery.parseHTML=function(data,context,keepScripts){if(!data||typeof data!=="string"){return null}if(typeof context==="boolean"){keepScripts=context;context=false}context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];if(parsed){return[context.createElement(parsed[1])]}parsed=jQuery.buildFragment([data],context,scripts);if(scripts&&scripts.length){jQuery(scripts).remove()}return jQuery.merge([],parsed.childNodes)};var _load=jQuery.fn.load;jQuery.fn.load=function(url,params,callback){if(typeof url!=="string"&&_load){return _load.apply(this,arguments)}var selector,type,response,self=this,off=url.indexOf(" ");if(off>=0){selector=jQuery.trim(url.slice(off));url=url.slice(0,off)}if(jQuery.isFunction(params)){callback=params;params=undefined}else if(params&&typeof params==="object"){type="POST"}if(self.length>0){jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments;self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR])})}return this};jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}});jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length};var docElem=window.document.documentElement;function getWindow(elem){return jQuery.isWindow(elem)?elem:elem.nodeType===9&&elem.defaultView}jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};if(position==="static"){elem.style.position="relative"}curOffset=curElem.offset();curCSSTop=jQuery.css(elem,"top");curCSSLeft=jQuery.css(elem,"left");calculatePosition=(position==="absolute"||position==="fixed")&&(curCSSTop+curCSSLeft).indexOf("auto")>-1;if(calculatePosition){curPosition=curElem.position();curTop=curPosition.top;curLeft=curPosition.left}else{curTop=parseFloat(curCSSTop)||0;curLeft=parseFloat(curCSSLeft)||0}if(jQuery.isFunction(options)){options=options.call(elem,i,curOffset)}if(options.top!=null){props.top=options.top-curOffset.top+curTop}if(options.left!=null){props.left=options.left-curOffset.left+curLeft}if("using"in options){options.using.call(elem,props)}else{curElem.css(props)}}};jQuery.fn.extend({offset:function(options){if(arguments.length){return options===undefined?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)})}var docElem,win,elem=this[0],box={top:0,left:0},doc=elem&&elem.ownerDocument;if(!doc){return}docElem=doc.documentElement;if(!jQuery.contains(docElem,elem)){return box}if(typeof elem.getBoundingClientRect!==strundefined){box=elem.getBoundingClientRect()}win=getWindow(doc);return{top:box.top+win.pageYOffset-docElem.clientTop,left:box.left+win.pageXOffset-docElem.clientLeft}},position:function(){if(!this[0]){return}var offsetParent,offset,elem=this[0],parentOffset={top:0,left:0};if(jQuery.css(elem,"position")==="fixed"){offset=elem.getBoundingClientRect()}else{offsetParent=this.offsetParent();offset=this.offset();if(!jQuery.nodeName(offsetParent[0],"html")){parentOffset=offsetParent.offset()}parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",true);parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",true)}return{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",true),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",true)}},offsetParent:function(){return this.map(function(){var offsetParent=this.offsetParent||docElem;while(offsetParent&&(!jQuery.nodeName(offsetParent,"html")&&jQuery.css(offsetParent,"position")==="static")){offsetParent=offsetParent.offsetParent}return offsetParent||docElem})}});jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top="pageYOffset"===prop;jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win=getWindow(elem);if(val===undefined){return win?win[prop]:elem[method]}if(win){win.scrollTo(!top?val:window.pageXOffset,top?val:window.pageYOffset)}else{elem[method]=val}},method,val,arguments.length,null)}});jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){if(computed){computed=curCSS(elem,prop);return rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed}})});jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||typeof margin!=="boolean"),extra=defaultExtra||(margin===true||value===true?"margin":"border");return access(this,function(elem,type,value){var doc;if(jQuery.isWindow(elem)){return elem.document.documentElement["client"+name]}if(elem.nodeType===9){doc=elem.documentElement;return Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])}return value===undefined?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:undefined,chainable,null)}})});jQuery.fn.size=function(){return this.length};jQuery.fn.andSelf=jQuery.fn.addBack;if(typeof define==="function"&&define.amd){define("jquery",[],function(){return jQuery})}var _jQuery=window.jQuery,_$=window.$;jQuery.noConflict=function(deep){if(window.$===jQuery){window.$=_$}if(deep&&window.jQuery===jQuery){window.jQuery=_jQuery}return jQuery};if(typeof noGlobal===strundefined){window.jQuery=window.$=jQuery}return jQuery})},{}],51:[function(require,module,exports){(function(factory){"use strict";if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else if(typeof exports==="object"){factory(require("jquery"))}else{factory(jQuery)}})(function($,undefined){"use strict";if($.jstree){return}var instance_counter=0,ccp_node=false,ccp_mode=false,ccp_inst=false,themes_loaded=[],src=$("script:last").attr("src"),document=window.document,_node=document.createElement("LI"),_temp1,_temp2;_node.setAttribute("role","treeitem");_temp1=document.createElement("I");_temp1.className="jstree-icon jstree-ocl";_temp1.setAttribute("role","presentation");_node.appendChild(_temp1);_temp1=document.createElement("A");_temp1.className="jstree-anchor";_temp1.setAttribute("href","#");_temp1.setAttribute("tabindex","-1");_temp2=document.createElement("I");_temp2.className="jstree-icon jstree-themeicon";_temp2.setAttribute("role","presentation");_temp1.appendChild(_temp2);_node.appendChild(_temp1);_temp1=_temp2=null;$.jstree={version:"3.1.1",defaults:{plugins:[]},plugins:{},path:src&&src.indexOf("/")!==-1?src.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g};$.jstree.create=function(el,options){var tmp=new $.jstree.core(++instance_counter),opt=options;options=$.extend(true,{},$.jstree.defaults,options);if(opt&&opt.plugins){options.plugins=opt.plugins}$.each(options.plugins,function(i,k){if(i!=="core"){tmp=tmp.plugin(k,options[k])}});$(el).data("jstree",tmp);tmp.init(el,options);return tmp};$.jstree.destroy=function(){$(".jstree:jstree").jstree("destroy");$(document).off(".jstree")};$.jstree.core=function(id){this._id=id;this._cnt=0;this._wrk=null;this._data={core:{themes:{name:false,dots:false,icons:false},selected:[],last_error:{},working:false,worker_queue:[],focused:null}}};$.jstree.reference=function(needle){var tmp=null,obj=null;if(needle&&needle.id&&(!needle.tagName||!needle.nodeType)){needle=needle.id}if(!obj||!obj.length){try{obj=$(needle)}catch(ignore){}}if(!obj||!obj.length){try{obj=$("#"+needle.replace($.jstree.idregex,"\\$&"))}catch(ignore){}}if(obj&&obj.length&&(obj=obj.closest(".jstree")).length&&(obj=obj.data("jstree"))){tmp=obj}else{$(".jstree").each(function(){var inst=$(this).data("jstree");if(inst&&inst._model.data[needle]){tmp=inst;return false}})}return tmp};$.fn.jstree=function(arg){var is_method=typeof arg==="string",args=Array.prototype.slice.call(arguments,1),result=null;if(arg===true&&!this.length){return false}this.each(function(){var instance=$.jstree.reference(this),method=is_method&&instance?instance[arg]:null;result=is_method&&method?method.apply(instance,args):null;if(!instance&&!is_method&&(arg===undefined||$.isPlainObject(arg))){$.jstree.create(this,arg)}if(instance&&!is_method||arg===true){result=instance||false}if(result!==null&&result!==undefined){return false}});return result!==null&&result!==undefined?result:this};$.expr[":"].jstree=$.expr.createPseudo(function(search){return function(a){return $(a).hasClass("jstree")&&$(a).data("jstree")!==undefined}});$.jstree.defaults.core={data:false,strings:false,check_callback:false,error:$.noop,animation:200,multiple:true,themes:{name:false,url:false,dir:false,dots:true,icons:true,stripes:false,variant:false,responsive:false},expand_selected_onload:true,worker:true,force_text:false,dblclick_toggle:true};$.jstree.core.prototype={plugin:function(deco,opts){var Child=$.jstree.plugins[deco];if(Child){this._data[deco]={};Child.prototype=this;return new Child(opts,this)}return this},init:function(el,options){this._model={data:{"#":{id:"#",parent:null,parents:[],children:[],children_d:[],state:{loaded:false}}},changed:[],force_full_redraw:false,redraw_timeout:false,default_state:{loaded:true,opened:false,selected:false,disabled:false}};this.element=$(el).addClass("jstree jstree-"+this._id);this.settings=options;this._data.core.ready=false;this._data.core.loaded=false;
this._data.core.rtl=this.element.css("direction")==="rtl";this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl");this.element.attr("role","tree");if(this.settings.core.multiple){this.element.attr("aria-multiselectable",true)}if(!this.element.attr("tabindex")){this.element.attr("tabindex","0")}this.bind();this.trigger("init");this._data.core.original_container_html=this.element.find(" > ul > li").clone(true);this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return this.nodeType===3&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove();this.element.html("<"+"ul class='jstree-container-ul jstree-children' role='group'><"+"li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='tree-item'><i class='jstree-icon jstree-ocl'></i><"+"a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>");this.element.attr("aria-activedescendant","j"+this._id+"_loading");this._data.core.li_height=this.get_container_ul().children("li").first().height()||24;this.trigger("loading");this.load_node("#")},destroy:function(keep_html){if(this._wrk){try{window.URL.revokeObjectURL(this._wrk);this._wrk=null}catch(ignore){}}if(!keep_html){this.element.empty()}this.teardown()},teardown:function(){this.unbind();this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")});this.element=null},bind:function(){var word="",tout=null,was_click=0;this.element.on("dblclick.jstree",function(){if(document.selection&&document.selection.empty){document.selection.empty()}else{if(window.getSelection){var sel=window.getSelection();try{sel.removeAllRanges();sel.collapse()}catch(ignore){}}}}).on("mousedown.jstree",$.proxy(function(e){if(e.target===this.element[0]){e.preventDefault();was_click=+new Date}},this)).on("mousedown.jstree",".jstree-ocl",function(e){e.preventDefault()}).on("click.jstree",".jstree-ocl",$.proxy(function(e){this.toggle_node(e.target)},this)).on("dblclick.jstree",".jstree-anchor",$.proxy(function(e){if(this.settings.core.dblclick_toggle){this.toggle_node(e.target)}},this)).on("click.jstree",".jstree-anchor",$.proxy(function(e){e.preventDefault();if(e.currentTarget!==document.activeElement){$(e.currentTarget).focus()}this.activate_node(e.currentTarget,e)},this)).on("keydown.jstree",".jstree-anchor",$.proxy(function(e){if(e.target.tagName==="INPUT"){return true}if(e.which!==32&&e.which!==13&&(e.shiftKey||e.ctrlKey||e.altKey||e.metaKey)){return true}var o=null;if(this._data.core.rtl){if(e.which===37){e.which=39}else if(e.which===39){e.which=37}}switch(e.which){case 32:if(e.ctrlKey){e.type="click";$(e.currentTarget).trigger(e)}break;case 13:e.type="click";$(e.currentTarget).trigger(e);break;case 37:e.preventDefault();if(this.is_open(e.currentTarget)){this.close_node(e.currentTarget)}else{o=this.get_parent(e.currentTarget);if(o&&o.id!=="#"){this.get_node(o,true).children(".jstree-anchor").focus()}}break;case 38:e.preventDefault();o=this.get_prev_dom(e.currentTarget);if(o&&o.length){o.children(".jstree-anchor").focus()}break;case 39:e.preventDefault();if(this.is_closed(e.currentTarget)){this.open_node(e.currentTarget,function(o){this.get_node(o,true).children(".jstree-anchor").focus()})}else if(this.is_open(e.currentTarget)){o=this.get_node(e.currentTarget,true).children(".jstree-children")[0];if(o){$(this._firstChild(o)).children(".jstree-anchor").focus()}}break;case 40:e.preventDefault();o=this.get_next_dom(e.currentTarget);if(o&&o.length){o.children(".jstree-anchor").focus()}break;case 106:this.open_all();break;case 36:e.preventDefault();o=this._firstChild(this.get_container_ul()[0]);if(o){$(o).children(".jstree-anchor").filter(":visible").focus()}break;case 35:e.preventDefault();this.element.find(".jstree-anchor").filter(":visible").last().focus();break}},this)).on("load_node.jstree",$.proxy(function(e,data){if(data.status){if(data.node.id==="#"&&!this._data.core.loaded){this._data.core.loaded=true;if(this._firstChild(this.get_container_ul()[0])){this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id)}this.trigger("loaded")}if(!this._data.core.ready){setTimeout($.proxy(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){this._data.core.ready=true;if(this._data.core.selected.length){if(this.settings.core.expand_selected_onload){var tmp=[],i,j;for(i=0,j=this._data.core.selected.length;i<j;i++){tmp=tmp.concat(this._model.data[this._data.core.selected[i]].parents)}tmp=$.vakata.array_unique(tmp);for(i=0,j=tmp.length;i<j;i++){this.open_node(tmp[i],false,0)}}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}},this),0)}}},this)).on("keypress.jstree",$.proxy(function(e){if(e.target.tagName==="INPUT"){return true}if(tout){clearTimeout(tout)}tout=setTimeout(function(){word=""},500);var chr=String.fromCharCode(e.which).toLowerCase(),col=this.element.find(".jstree-anchor").filter(":visible"),ind=col.index(document.activeElement)||0,end=false;word+=chr;if(word.length>1){col.slice(ind).each($.proxy(function(i,v){if($(v).text().toLowerCase().indexOf(word)===0){$(v).focus();end=true;return false}},this));if(end){return}col.slice(0,ind).each($.proxy(function(i,v){if($(v).text().toLowerCase().indexOf(word)===0){$(v).focus();end=true;return false}},this));if(end){return}}if(new RegExp("^"+chr+"+$").test(word)){col.slice(ind+1).each($.proxy(function(i,v){if($(v).text().toLowerCase().charAt(0)===chr){$(v).focus();end=true;return false}},this));if(end){return}col.slice(0,ind+1).each($.proxy(function(i,v){if($(v).text().toLowerCase().charAt(0)===chr){$(v).focus();end=true;return false}},this));if(end){return}}},this)).on("init.jstree",$.proxy(function(){var s=this.settings.core.themes;this._data.core.themes.dots=s.dots;this._data.core.themes.stripes=s.stripes;this._data.core.themes.icons=s.icons;this.set_theme(s.name||"default",s.url);this.set_theme_variant(s.variant)},this)).on("loading.jstree",$.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"]();this[this._data.core.themes.icons?"show_icons":"hide_icons"]();this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"]()},this)).on("blur.jstree",".jstree-anchor",$.proxy(function(e){this._data.core.focused=null;$(e.currentTarget).filter(".jstree-hovered").mouseleave();this.element.attr("tabindex","0")},this)).on("focus.jstree",".jstree-anchor",$.proxy(function(e){var tmp=this.get_node(e.currentTarget);if(tmp&&tmp.id){this._data.core.focused=tmp.id}this.element.find(".jstree-hovered").not(e.currentTarget).mouseleave();$(e.currentTarget).mouseenter();this.element.attr("tabindex","-1")},this)).on("focus.jstree",$.proxy(function(){if(+new Date-was_click>500&&!this._data.core.focused){was_click=0;var act=this.get_node(this.element.attr("aria-activedescendant"),true);if(act){act.find("> .jstree-anchor").focus()}}},this)).on("mouseenter.jstree",".jstree-anchor",$.proxy(function(e){this.hover_node(e.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",$.proxy(function(e){this.dehover_node(e.currentTarget)},this))},unbind:function(){this.element.off(".jstree");$(document).off(".jstree-"+this._id)},trigger:function(ev,data){if(!data){data={}}data.instance=this;this.element.triggerHandler(ev.replace(".jstree","")+".jstree",data)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(key){var a=this.settings.core.strings;if($.isFunction(a)){return a.call(this,key)}if(a&&a[key]){return a[key]}return key},_firstChild:function(dom){dom=dom?dom.firstChild:null;while(dom!==null&&dom.nodeType!==1){dom=dom.nextSibling}return dom},_nextSibling:function(dom){dom=dom?dom.nextSibling:null;while(dom!==null&&dom.nodeType!==1){dom=dom.nextSibling}return dom},_previousSibling:function(dom){dom=dom?dom.previousSibling:null;while(dom!==null&&dom.nodeType!==1){dom=dom.previousSibling}return dom},get_node:function(obj,as_dom){if(obj&&obj.id){obj=obj.id}var dom;try{if(this._model.data[obj]){obj=this._model.data[obj]}else if(typeof obj==="string"&&this._model.data[obj.replace(/^#/,"")]){obj=this._model.data[obj.replace(/^#/,"")]}else if(typeof obj==="string"&&(dom=$("#"+obj.replace($.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[dom.closest(".jstree-node").attr("id")]){obj=this._model.data[dom.closest(".jstree-node").attr("id")]}else if((dom=$(obj,this.element)).length&&this._model.data[dom.closest(".jstree-node").attr("id")]){obj=this._model.data[dom.closest(".jstree-node").attr("id")]}else if((dom=$(obj,this.element)).length&&dom.hasClass("jstree")){obj=this._model.data["#"]}else{return false}if(as_dom){obj=obj.id==="#"?this.element:$("#"+obj.id.replace($.jstree.idregex,"\\$&"),this.element)}return obj}catch(ex){return false}},get_path:function(obj,glue,ids){obj=obj.parents?obj:this.get_node(obj);if(!obj||obj.id==="#"||!obj.parents){return false}var i,j,p=[];p.push(ids?obj.id:obj.text);for(i=0,j=obj.parents.length;i<j;i++){p.push(ids?obj.parents[i]:this.get_text(obj.parents[i]))}p=p.reverse().slice(1);return glue?p.join(glue):p},get_next_dom:function(obj,strict){var tmp;obj=this.get_node(obj,true);if(obj[0]===this.element[0]){tmp=this._firstChild(this.get_container_ul()[0]);while(tmp&&tmp.offsetHeight===0){tmp=this._nextSibling(tmp)}return tmp?$(tmp):false}if(!obj||!obj.length){return false}if(strict){tmp=obj[0];do{tmp=this._nextSibling(tmp)}while(tmp&&tmp.offsetHeight===0);return tmp?$(tmp):false}if(obj.hasClass("jstree-open")){tmp=this._firstChild(obj.children(".jstree-children")[0]);while(tmp&&tmp.offsetHeight===0){tmp=this._nextSibling(tmp)}if(tmp!==null){return $(tmp)}}tmp=obj[0];do{tmp=this._nextSibling(tmp)}while(tmp&&tmp.offsetHeight===0);if(tmp!==null){return $(tmp)}return obj.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(obj,strict){var tmp;obj=this.get_node(obj,true);if(obj[0]===this.element[0]){tmp=this.get_container_ul()[0].lastChild;while(tmp&&tmp.offsetHeight===0){tmp=this._previousSibling(tmp)}return tmp?$(tmp):false}if(!obj||!obj.length){return false}if(strict){tmp=obj[0];do{tmp=this._previousSibling(tmp)}while(tmp&&tmp.offsetHeight===0);return tmp?$(tmp):false}tmp=obj[0];do{tmp=this._previousSibling(tmp)}while(tmp&&tmp.offsetHeight===0);if(tmp!==null){obj=$(tmp);while(obj.hasClass("jstree-open")){obj=obj.children(".jstree-children").first().children(".jstree-node:visible:last")}return obj}tmp=obj[0].parentNode.parentNode;return tmp&&tmp.className&&tmp.className.indexOf("jstree-node")!==-1?$(tmp):false},get_parent:function(obj){obj=this.get_node(obj);if(!obj||obj.id==="#"){return false}return obj.parent},get_children_dom:function(obj){obj=this.get_node(obj,true);if(obj[0]===this.element[0]){return this.get_container_ul().children(".jstree-node")}if(!obj||!obj.length){return false}return obj.children(".jstree-children").children(".jstree-node")},is_parent:function(obj){obj=this.get_node(obj);return obj&&(obj.state.loaded===false||obj.children.length>0)},is_loaded:function(obj){obj=this.get_node(obj);return obj&&obj.state.loaded},is_loading:function(obj){obj=this.get_node(obj);return obj&&obj.state&&obj.state.loading},is_open:function(obj){obj=this.get_node(obj);return obj&&obj.state.opened},is_closed:function(obj){obj=this.get_node(obj);return obj&&this.is_parent(obj)&&!obj.state.opened},is_leaf:function(obj){return!this.is_parent(obj)},load_node:function(obj,callback){var k,l,i,j,c;if($.isArray(obj)){this._load_nodes(obj.slice(),callback);return true}obj=this.get_node(obj);if(!obj){if(callback){callback.call(this,obj,false)}return false}if(obj.state.loaded){obj.state.loaded=false;for(k=0,l=obj.children_d.length;k<l;k++){for(i=0,j=obj.parents.length;i<j;i++){this._model.data[obj.parents[i]].children_d=$.vakata.array_remove_item(this._model.data[obj.parents[i]].children_d,obj.children_d[k])}if(this._model.data[obj.children_d[k]].state.selected){c=true;this._data.core.selected=$.vakata.array_remove_item(this._data.core.selected,obj.children_d[k])}delete this._model.data[obj.children_d[k]]}obj.children=[];obj.children_d=[];if(c){this.trigger("changed",{action:"load_node",node:obj,selected:this._data.core.selected})}}obj.state.failed=false;obj.state.loading=true;this.get_node(obj,true).addClass("jstree-loading").attr("aria-busy",true);this._load_node(obj,$.proxy(function(status){obj=this._model.data[obj.id];obj.state.loading=false;obj.state.loaded=status;obj.state.failed=!obj.state.loaded;var dom=this.get_node(obj,true);if(obj.state.loaded&&!obj.children.length&&dom&&dom.length&&!dom.hasClass("jstree-leaf")){dom.removeClass("jstree-closed jstree-open").addClass("jstree-leaf")}dom.removeClass("jstree-loading").attr("aria-busy",false);this.trigger("load_node",{node:obj,status:status});if(callback){callback.call(this,obj,status)}},this));return true},_load_nodes:function(nodes,callback,is_callback){var r=true,c=function(){this._load_nodes(nodes,callback,true)},m=this._model.data,i,j,tmp=[];for(i=0,j=nodes.length;i<j;i++){if(m[nodes[i]]&&(!m[nodes[i]].state.loaded&&!m[nodes[i]].state.failed||!is_callback)){if(!this.is_loading(nodes[i])){this.load_node(nodes[i],c)}r=false}}if(r){for(i=0,j=nodes.length;i<j;i++){if(m[nodes[i]]&&m[nodes[i]].state.loaded){tmp.push(nodes[i])}}if(callback&&!callback.done){callback.call(this,tmp);callback.done=true}}},load_all:function(obj,callback){if(!obj){obj="#"}obj=this.get_node(obj);if(!obj){return false}var to_load=[],m=this._model.data,c=m[obj.id].children_d,i,j;if(obj.state&&!obj.state.loaded){to_load.push(obj.id)}for(i=0,j=c.length;i<j;i++){if(m[c[i]]&&m[c[i]].state&&!m[c[i]].state.loaded){to_load.push(c[i])}}if(to_load.length){this._load_nodes(to_load,function(){this.load_all(obj,callback)})}else{if(callback){callback.call(this,obj)}this.trigger("load_all",{node:obj})}},_load_node:function(obj,callback){var s=this.settings.core.data,t;if(!s){if(obj.id==="#"){return this._append_html_data(obj,this._data.core.original_container_html.clone(true),function(status){callback.call(this,status)})}else{return callback.call(this,false)}}if($.isFunction(s)){return s.call(this,obj,$.proxy(function(d){if(d===false){callback.call(this,false)}this[typeof d==="string"?"_append_html_data":"_append_json_data"](obj,typeof d==="string"?$($.parseHTML(d)).filter(function(){return this.nodeType!==3}):d,function(status){callback.call(this,status)})},this))}if(typeof s==="object"){if(s.url){s=$.extend(true,{},s);if($.isFunction(s.url)){s.url=s.url.call(this,obj)}if($.isFunction(s.data)){s.data=s.data.call(this,obj)}return $.ajax(s).done($.proxy(function(d,t,x){var type=x.getResponseHeader("Content-Type");if(type&&type.indexOf("json")!==-1||typeof d==="object"){return this._append_json_data(obj,d,function(status){callback.call(this,status)})}if(type&&type.indexOf("html")!==-1||typeof d==="string"){return this._append_html_data(obj,$($.parseHTML(d)).filter(function(){return this.nodeType!==3}),function(status){callback.call(this,status)})}this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:obj.id,xhr:x})};this.settings.core.error.call(this,this._data.core.last_error);return callback.call(this,false)},this)).fail($.proxy(function(f){callback.call(this,false);this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:obj.id,xhr:f})};this.settings.core.error.call(this,this._data.core.last_error)},this))}t=$.isArray(s)||$.isPlainObject(s)?JSON.parse(JSON.stringify(s)):s;if(obj.id==="#"){return this._append_json_data(obj,t,function(status){callback.call(this,status)})}else{this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:obj.id})};this.settings.core.error.call(this,this._data.core.last_error);return callback.call(this,false)}}if(typeof s==="string"){if(obj.id==="#"){return this._append_html_data(obj,$($.parseHTML(s)).filter(function(){return this.nodeType!==3}),function(status){callback.call(this,status)})}else{this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:obj.id})};this.settings.core.error.call(this,this._data.core.last_error);return callback.call(this,false)}}return callback.call(this,false)},_node_changed:function(obj){obj=this.get_node(obj);if(obj){this._model.changed.push(obj.id)}},_append_html_data:function(dom,data,cb){dom=this.get_node(dom);dom.children=[];dom.children_d=[];var dat=data.is("ul")?data.children():data,par=dom.id,chd=[],dpc=[],m=this._model.data,p=m[par],s=this._data.core.selected.length,tmp,i,j;dat.each($.proxy(function(i,v){tmp=this._parse_model_from_html($(v),par,p.parents.concat());if(tmp){chd.push(tmp);dpc.push(tmp);if(m[tmp].children_d.length){dpc=dpc.concat(m[tmp].children_d)}}},this));p.children=chd;p.children_d=dpc;for(i=0,j=p.parents.length;i<j;i++){m[p.parents[i]].children_d=m[p.parents[i]].children_d.concat(dpc)}this.trigger("model",{nodes:dpc,parent:par});if(par!=="#"){this._node_changed(par);this.redraw()}else{this.get_container_ul().children(".jstree-initial-node").remove();this.redraw(true)}if(this._data.core.selected.length!==s){this.trigger("changed",{action:"model",selected:this._data.core.selected})}cb.call(this,true)},_append_json_data:function(dom,data,cb,force_processing){if(this.element===null){return}dom=this.get_node(dom);dom.children=[];dom.children_d=[];if(data.d){data=data.d;if(typeof data==="string"){data=JSON.parse(data)}}if(!$.isArray(data)){data=[data]}var w=null,args={df:this._model.default_state,dat:data,par:dom.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},func=function(data,undefined){if(data.data){data=data.data}var dat=data.dat,par=data.par,chd=[],dpc=[],add=[],df=data.df,t_id=data.t_id,t_cnt=data.t_cnt,m=data.m,p=m[par],sel=data.sel,tmp,i,j,rslt,parse_flat=function(d,p,ps){if(!ps){ps=[]}else{ps=ps.concat()}if(p){ps.unshift(p)}var tid=d.id.toString(),i,j,c,e,tmp={id:tid,text:d.text||"",icon:d.icon!==undefined?d.icon:true,parent:p,parents:ps,children:d.children||[],children_d:d.children_d||[],data:d.data,state:{},li_attr:{id:false},a_attr:{href:"#"},original:false};for(i in df){if(df.hasOwnProperty(i)){tmp.state[i]=df[i]}}if(d&&d.data&&d.data.jstree&&d.data.jstree.icon){tmp.icon=d.data.jstree.icon}if(tmp.icon===undefined||tmp.icon===null||tmp.icon===""){tmp.icon=true}if(d&&d.data){tmp.data=d.data;if(d.data.jstree){for(i in d.data.jstree){if(d.data.jstree.hasOwnProperty(i)){tmp.state[i]=d.data.jstree[i]}}}}if(d&&typeof d.state==="object"){for(i in d.state){if(d.state.hasOwnProperty(i)){tmp.state[i]=d.state[i]}}}if(d&&typeof d.li_attr==="object"){for(i in d.li_attr){if(d.li_attr.hasOwnProperty(i)){tmp.li_attr[i]=d.li_attr[i]}}}if(!tmp.li_attr.id){tmp.li_attr.id=tid}if(d&&typeof d.a_attr==="object"){for(i in d.a_attr){if(d.a_attr.hasOwnProperty(i)){tmp.a_attr[i]=d.a_attr[i]}}}if(d&&d.children&&d.children===true){tmp.state.loaded=false;tmp.children=[];tmp.children_d=[]}m[tmp.id]=tmp;for(i=0,j=tmp.children.length;i<j;i++){c=parse_flat(m[tmp.children[i]],tmp.id,ps);e=m[c];tmp.children_d.push(c);if(e.children_d.length){tmp.children_d=tmp.children_d.concat(e.children_d)}}delete d.data;delete d.children;m[tmp.id].original=d;if(tmp.state.selected){add.push(tmp.id)}return tmp.id},parse_nest=function(d,p,ps){if(!ps){ps=[]}else{ps=ps.concat()}if(p){ps.unshift(p)}var tid=false,i,j,c,e,tmp;do{tid="j"+t_id+"_"+ ++t_cnt}while(m[tid]);tmp={id:false,text:typeof d==="string"?d:"",icon:typeof d==="object"&&d.icon!==undefined?d.icon:true,parent:p,parents:ps,children:[],children_d:[],data:null,state:{},li_attr:{id:false},a_attr:{href:"#"},original:false};for(i in df){if(df.hasOwnProperty(i)){tmp.state[i]=df[i]}}if(d&&d.id){tmp.id=d.id.toString()}if(d&&d.text){tmp.text=d.text}if(d&&d.data&&d.data.jstree&&d.data.jstree.icon){tmp.icon=d.data.jstree.icon}if(tmp.icon===undefined||tmp.icon===null||tmp.icon===""){tmp.icon=true}if(d&&d.data){tmp.data=d.data;if(d.data.jstree){for(i in d.data.jstree){if(d.data.jstree.hasOwnProperty(i)){tmp.state[i]=d.data.jstree[i]}}}}if(d&&typeof d.state==="object"){for(i in d.state){if(d.state.hasOwnProperty(i)){tmp.state[i]=d.state[i]}}}if(d&&typeof d.li_attr==="object"){for(i in d.li_attr){if(d.li_attr.hasOwnProperty(i)){tmp.li_attr[i]=d.li_attr[i]}}}if(tmp.li_attr.id&&!tmp.id){tmp.id=tmp.li_attr.id.toString()}if(!tmp.id){tmp.id=tid}if(!tmp.li_attr.id){tmp.li_attr.id=tmp.id}if(d&&typeof d.a_attr==="object"){for(i in d.a_attr){if(d.a_attr.hasOwnProperty(i)){tmp.a_attr[i]=d.a_attr[i]}}}if(d&&d.children&&d.children.length){for(i=0,j=d.children.length;i<j;i++){c=parse_nest(d.children[i],tmp.id,ps);e=m[c];tmp.children.push(c);if(e.children_d.length){tmp.children_d=tmp.children_d.concat(e.children_d)}}tmp.children_d=tmp.children_d.concat(tmp.children)}if(d&&d.children&&d.children===true){tmp.state.loaded=false;tmp.children=[];tmp.children_d=[]}delete d.data;delete d.children;tmp.original=d;m[tmp.id]=tmp;if(tmp.state.selected){add.push(tmp.id)}return tmp.id};if(dat.length&&dat[0].id!==undefined&&dat[0].parent!==undefined){for(i=0,j=dat.length;i<j;i++){if(!dat[i].children){dat[i].children=[]}m[dat[i].id.toString()]=dat[i]}for(i=0,j=dat.length;i<j;i++){m[dat[i].parent.toString()].children.push(dat[i].id.toString());p.children_d.push(dat[i].id.toString())}for(i=0,j=p.children.length;i<j;i++){tmp=parse_flat(m[p.children[i]],par,p.parents.concat());dpc.push(tmp);if(m[tmp].children_d.length){dpc=dpc.concat(m[tmp].children_d)}}for(i=0,j=p.parents.length;i<j;i++){m[p.parents[i]].children_d=m[p.parents[i]].children_d.concat(dpc)}rslt={cnt:t_cnt,mod:m,sel:sel,par:par,dpc:dpc,add:add}}else{for(i=0,j=dat.length;i<j;i++){tmp=parse_nest(dat[i],par,p.parents.concat());if(tmp){chd.push(tmp);dpc.push(tmp);if(m[tmp].children_d.length){dpc=dpc.concat(m[tmp].children_d)}}}p.children=chd;p.children_d=dpc;for(i=0,j=p.parents.length;i<j;i++){m[p.parents[i]].children_d=m[p.parents[i]].children_d.concat(dpc)}rslt={cnt:t_cnt,mod:m,sel:sel,par:par,dpc:dpc,add:add}}if(typeof window==="undefined"||typeof window.document==="undefined"){postMessage(rslt)}else{return rslt}},rslt=function(rslt,worker){if(this.element===null){return}this._cnt=rslt.cnt;this._model.data=rslt.mod;if(worker){var i,j,a=rslt.add,r=rslt.sel,s=this._data.core.selected.slice(),m=this._model.data;if(r.length!==s.length||$.vakata.array_unique(r.concat(s)).length!==r.length){for(i=0,j=r.length;i<j;i++){if($.inArray(r[i],a)===-1&&$.inArray(r[i],s)===-1){m[r[i]].state.selected=false}}for(i=0,j=s.length;i<j;i++){if($.inArray(s[i],r)===-1){m[s[i]].state.selected=true}}}}if(rslt.add.length){this._data.core.selected=this._data.core.selected.concat(rslt.add)}this.trigger("model",{nodes:rslt.dpc,parent:rslt.par});if(rslt.par!=="#"){this._node_changed(rslt.par);this.redraw()}else{this.redraw(true)}if(rslt.add.length){this.trigger("changed",{action:"model",selected:this._data.core.selected})}cb.call(this,true)};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker){try{if(this._wrk===null){this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+func.toString()],{type:"text/javascript"}))}if(!this._data.core.working||force_processing){this._data.core.working=true;w=new window.Worker(this._wrk);w.onmessage=$.proxy(function(e){rslt.call(this,e.data,true);try{w.terminate();w=null}catch(ignore){}if(this._data.core.worker_queue.length){this._append_json_data.apply(this,this._data.core.worker_queue.shift())}else{this._data.core.working=false}},this);if(!args.par){if(this._data.core.worker_queue.length){this._append_json_data.apply(this,this._data.core.worker_queue.shift())}else{this._data.core.working=false}}else{w.postMessage(args)}}else{this._data.core.worker_queue.push([dom,data,cb,true])}}catch(e){rslt.call(this,func(args),false);if(this._data.core.worker_queue.length){this._append_json_data.apply(this,this._data.core.worker_queue.shift())}else{this._data.core.working=false}}}else{rslt.call(this,func(args),false)}},_parse_model_from_html:function(d,p,ps){if(!ps){ps=[]}else{ps=[].concat(ps)}if(p){ps.unshift(p)}var c,e,m=this._model.data,data={id:false,text:false,icon:true,parent:p,parents:ps,children:[],children_d:[],data:null,state:{},li_attr:{id:false},a_attr:{href:"#"},original:false},i,tmp,tid;for(i in this._model.default_state){if(this._model.default_state.hasOwnProperty(i)){data.state[i]=this._model.default_state[i]}}tmp=$.vakata.attributes(d,true);$.each(tmp,function(i,v){v=$.trim(v);if(!v.length){return true}data.li_attr[i]=v;if(i==="id"){data.id=v.toString()}});tmp=d.children("a").first();if(tmp.length){tmp=$.vakata.attributes(tmp,true);$.each(tmp,function(i,v){v=$.trim(v);if(v.length){data.a_attr[i]=v}})}tmp=d.children("a").first().length?d.children("a").first().clone():d.clone();tmp.children("ins, i, ul").remove();tmp=tmp.html();tmp=$("<div />").html(tmp);data.text=this.settings.core.force_text?tmp.text():tmp.html();tmp=d.data();data.data=tmp?$.extend(true,{},tmp):null;data.state.opened=d.hasClass("jstree-open");data.state.selected=d.children("a").hasClass("jstree-clicked");data.state.disabled=d.children("a").hasClass("jstree-disabled");if(data.data&&data.data.jstree){for(i in data.data.jstree){if(data.data.jstree.hasOwnProperty(i)){data.state[i]=data.data.jstree[i]}}}tmp=d.children("a").children(".jstree-themeicon");if(tmp.length){data.icon=tmp.hasClass("jstree-themeicon-hidden")?false:tmp.attr("rel")}if(data.state.icon!==undefined){data.icon=data.state.icon}if(data.icon===undefined||data.icon===null||data.icon===""){data.icon=true}tmp=d.children("ul").children("li");do{tid="j"+this._id+"_"+ ++this._cnt}while(m[tid]);data.id=data.li_attr.id?data.li_attr.id.toString():tid;if(tmp.length){tmp.each($.proxy(function(i,v){c=this._parse_model_from_html($(v),data.id,ps);e=this._model.data[c];data.children.push(c);if(e.children_d.length){data.children_d=data.children_d.concat(e.children_d)}},this));data.children_d=data.children_d.concat(data.children)}else{if(d.hasClass("jstree-closed")){data.state.loaded=false}}if(data.li_attr["class"]){data.li_attr["class"]=data.li_attr["class"].replace("jstree-closed","").replace("jstree-open","")}if(data.a_attr["class"]){data.a_attr["class"]=data.a_attr["class"].replace("jstree-clicked","").replace("jstree-disabled","")}m[data.id]=data;if(data.state.selected){this._data.core.selected.push(data.id)}return data.id},_parse_model_from_flat_json:function(d,p,ps){if(!ps){ps=[]}else{ps=ps.concat()}if(p){ps.unshift(p)}var tid=d.id.toString(),m=this._model.data,df=this._model.default_state,i,j,c,e,tmp={id:tid,text:d.text||"",icon:d.icon!==undefined?d.icon:true,parent:p,parents:ps,children:d.children||[],children_d:d.children_d||[],data:d.data,state:{},li_attr:{id:false},a_attr:{href:"#"},original:false};for(i in df){if(df.hasOwnProperty(i)){tmp.state[i]=df[i]}}if(d&&d.data&&d.data.jstree&&d.data.jstree.icon){tmp.icon=d.data.jstree.icon}if(tmp.icon===undefined||tmp.icon===null||tmp.icon===""){tmp.icon=true}if(d&&d.data){tmp.data=d.data;if(d.data.jstree){for(i in d.data.jstree){if(d.data.jstree.hasOwnProperty(i)){tmp.state[i]=d.data.jstree[i]}}}}if(d&&typeof d.state==="object"){for(i in d.state){if(d.state.hasOwnProperty(i)){tmp.state[i]=d.state[i]}}}if(d&&typeof d.li_attr==="object"){for(i in d.li_attr){if(d.li_attr.hasOwnProperty(i)){tmp.li_attr[i]=d.li_attr[i]}}}if(!tmp.li_attr.id){tmp.li_attr.id=tid}if(d&&typeof d.a_attr==="object"){for(i in d.a_attr){if(d.a_attr.hasOwnProperty(i)){tmp.a_attr[i]=d.a_attr[i]}}}if(d&&d.children&&d.children===true){tmp.state.loaded=false;tmp.children=[];tmp.children_d=[]}m[tmp.id]=tmp;for(i=0,j=tmp.children.length;i<j;i++){c=this._parse_model_from_flat_json(m[tmp.children[i]],tmp.id,ps);e=m[c];tmp.children_d.push(c);if(e.children_d.length){tmp.children_d=tmp.children_d.concat(e.children_d)}}delete d.data;delete d.children;m[tmp.id].original=d;if(tmp.state.selected){this._data.core.selected.push(tmp.id)}return tmp.id},_parse_model_from_json:function(d,p,ps){if(!ps){ps=[]}else{ps=ps.concat()}if(p){ps.unshift(p)}var tid=false,i,j,c,e,m=this._model.data,df=this._model.default_state,tmp;do{tid="j"+this._id+"_"+ ++this._cnt}while(m[tid]);tmp={id:false,text:typeof d==="string"?d:"",icon:typeof d==="object"&&d.icon!==undefined?d.icon:true,parent:p,parents:ps,children:[],children_d:[],data:null,state:{},li_attr:{id:false},a_attr:{href:"#"},original:false};for(i in df){if(df.hasOwnProperty(i)){tmp.state[i]=df[i]}}if(d&&d.id){tmp.id=d.id.toString()}if(d&&d.text){tmp.text=d.text}if(d&&d.data&&d.data.jstree&&d.data.jstree.icon){tmp.icon=d.data.jstree.icon}if(tmp.icon===undefined||tmp.icon===null||tmp.icon===""){tmp.icon=true}if(d&&d.data){tmp.data=d.data;if(d.data.jstree){for(i in d.data.jstree){if(d.data.jstree.hasOwnProperty(i)){tmp.state[i]=d.data.jstree[i]}}}}if(d&&typeof d.state==="object"){for(i in d.state){if(d.state.hasOwnProperty(i)){tmp.state[i]=d.state[i]}}}if(d&&typeof d.li_attr==="object"){for(i in d.li_attr){if(d.li_attr.hasOwnProperty(i)){tmp.li_attr[i]=d.li_attr[i]}}}if(tmp.li_attr.id&&!tmp.id){tmp.id=tmp.li_attr.id.toString()}if(!tmp.id){tmp.id=tid}if(!tmp.li_attr.id){tmp.li_attr.id=tmp.id}if(d&&typeof d.a_attr==="object"){for(i in d.a_attr){if(d.a_attr.hasOwnProperty(i)){tmp.a_attr[i]=d.a_attr[i]}}}if(d&&d.children&&d.children.length){for(i=0,j=d.children.length;i<j;i++){c=this._parse_model_from_json(d.children[i],tmp.id,ps);e=m[c];tmp.children.push(c);if(e.children_d.length){tmp.children_d=tmp.children_d.concat(e.children_d)}}tmp.children_d=tmp.children_d.concat(tmp.children)}if(d&&d.children&&d.children===true){tmp.state.loaded=false;tmp.children=[];tmp.children_d=[]}delete d.data;delete d.children;tmp.original=d;m[tmp.id]=tmp;if(tmp.state.selected){this._data.core.selected.push(tmp.id)}return tmp.id},_redraw:function(){var nodes=this._model.force_full_redraw?this._model.data["#"].children.concat([]):this._model.changed.concat([]),f=document.createElement("UL"),tmp,i,j,fe=this._data.core.focused;for(i=0,j=nodes.length;i<j;i++){tmp=this.redraw_node(nodes[i],true,this._model.force_full_redraw);if(tmp&&this._model.force_full_redraw){f.appendChild(tmp)}}if(this._model.force_full_redraw){f.className=this.get_container_ul()[0].className;f.setAttribute("role","group");this.element.empty().append(f)}if(fe!==null){tmp=this.get_node(fe,true);if(tmp&&tmp.length&&tmp.children(".jstree-anchor")[0]!==document.activeElement){tmp.children(".jstree-anchor").focus()}else{this._data.core.focused=null}}this._model.force_full_redraw=false;this._model.changed=[];this.trigger("redraw",{nodes:nodes})},redraw:function(full){if(full){this._model.force_full_redraw=true}this._redraw()},draw_children:function(node){var obj=this.get_node(node),i=false,j=false,k=false,d=document;if(!obj){return false}if(obj.id==="#"){return this.redraw(true)}node=this.get_node(node,true);if(!node||!node.length){return false}node.children(".jstree-children").remove();node=node[0];if(obj.children.length&&obj.state.loaded){k=d.createElement("UL");k.setAttribute("role","group");k.className="jstree-children";for(i=0,j=obj.children.length;i<j;i++){k.appendChild(this.redraw_node(obj.children[i],true,true))}node.appendChild(k)}},redraw_node:function(node,deep,is_callback,force_render){var obj=this.get_node(node),par=false,ind=false,old=false,i=false,j=false,k=false,c="",d=document,m=this._model.data,f=false,s=false,tmp=null,t=0,l=0;if(!obj){return false}if(obj.id==="#"){return this.redraw(true)}deep=deep||obj.children.length===0;node=!document.querySelector?document.getElementById(obj.id):this.element[0].querySelector("#"+("0123456789".indexOf(obj.id[0])!==-1?"\\3"+obj.id[0]+" "+obj.id.substr(1).replace($.jstree.idregex,"\\$&"):obj.id.replace($.jstree.idregex,"\\$&")));
if(!node){deep=true;if(!is_callback){par=obj.parent!=="#"?$("#"+obj.parent.replace($.jstree.idregex,"\\$&"),this.element)[0]:null;if(par!==null&&(!par||!m[obj.parent].state.opened)){return false}ind=$.inArray(obj.id,par===null?m["#"].children:m[obj.parent].children)}}else{node=$(node);if(!is_callback){par=node.parent().parent()[0];if(par===this.element[0]){par=null}ind=node.index()}if(!deep&&obj.children.length&&!node.children(".jstree-children").length){deep=true}if(!deep){old=node.children(".jstree-children")[0]}f=node.children(".jstree-anchor")[0]===document.activeElement;node.remove()}node=_node.cloneNode(true);c="jstree-node ";for(i in obj.li_attr){if(obj.li_attr.hasOwnProperty(i)){if(i==="id"){continue}if(i!=="class"){node.setAttribute(i,obj.li_attr[i])}else{c+=obj.li_attr[i]}}}if(!obj.a_attr.id){obj.a_attr.id=obj.id+"_anchor"}node.setAttribute("aria-selected",!!obj.state.selected);node.setAttribute("aria-level",obj.parents.length);node.setAttribute("aria-labelledby",obj.a_attr.id);if(obj.state.disabled){node.setAttribute("aria-disabled",true)}if(obj.state.loaded&&!obj.children.length){c+=" jstree-leaf"}else{c+=obj.state.opened&&obj.state.loaded?" jstree-open":" jstree-closed";node.setAttribute("aria-expanded",obj.state.opened&&obj.state.loaded)}if(obj.parent!==null&&m[obj.parent].children[m[obj.parent].children.length-1]===obj.id){c+=" jstree-last"}node.id=obj.id;node.className=c;c=(obj.state.selected?" jstree-clicked":"")+(obj.state.disabled?" jstree-disabled":"");for(j in obj.a_attr){if(obj.a_attr.hasOwnProperty(j)){if(j==="href"&&obj.a_attr[j]==="#"){continue}if(j!=="class"){node.childNodes[1].setAttribute(j,obj.a_attr[j])}else{c+=" "+obj.a_attr[j]}}}if(c.length){node.childNodes[1].className="jstree-anchor "+c}if(obj.icon&&obj.icon!==true||obj.icon===false){if(obj.icon===false){node.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden"}else if(obj.icon.indexOf("/")===-1&&obj.icon.indexOf(".")===-1){node.childNodes[1].childNodes[0].className+=" "+obj.icon+" jstree-themeicon-custom"}else{node.childNodes[1].childNodes[0].style.backgroundImage="url("+obj.icon+")";node.childNodes[1].childNodes[0].style.backgroundPosition="center center";node.childNodes[1].childNodes[0].style.backgroundSize="auto";node.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom"}}if(this.settings.core.force_text){node.childNodes[1].appendChild(d.createTextNode(obj.text))}else{node.childNodes[1].innerHTML+=obj.text}if(deep&&obj.children.length&&(obj.state.opened||force_render)&&obj.state.loaded){k=d.createElement("UL");k.setAttribute("role","group");k.className="jstree-children";for(i=0,j=obj.children.length;i<j;i++){k.appendChild(this.redraw_node(obj.children[i],deep,true))}node.appendChild(k)}if(old){node.appendChild(old)}if(!is_callback){if(!par){par=this.element[0]}for(i=0,j=par.childNodes.length;i<j;i++){if(par.childNodes[i]&&par.childNodes[i].className&&par.childNodes[i].className.indexOf("jstree-children")!==-1){tmp=par.childNodes[i];break}}if(!tmp){tmp=d.createElement("UL");tmp.setAttribute("role","group");tmp.className="jstree-children";par.appendChild(tmp)}par=tmp;if(ind<par.childNodes.length){par.insertBefore(node,par.childNodes[ind])}else{par.appendChild(node)}if(f){t=this.element[0].scrollTop;l=this.element[0].scrollLeft;node.childNodes[1].focus();this.element[0].scrollTop=t;this.element[0].scrollLeft=l}}if(obj.state.opened&&!obj.state.loaded){obj.state.opened=false;setTimeout($.proxy(function(){this.open_node(obj.id,false,0)},this),0)}return node},open_node:function(obj,callback,animation){var t1,t2,d,t;if($.isArray(obj)){obj=obj.slice();for(t1=0,t2=obj.length;t1<t2;t1++){this.open_node(obj[t1],callback,animation)}return true}obj=this.get_node(obj);if(!obj||obj.id==="#"){return false}animation=animation===undefined?this.settings.core.animation:animation;if(!this.is_closed(obj)){if(callback){callback.call(this,obj,false)}return false}if(!this.is_loaded(obj)){if(this.is_loading(obj)){return setTimeout($.proxy(function(){this.open_node(obj,callback,animation)},this),500)}this.load_node(obj,function(o,ok){return ok?this.open_node(o,callback,animation):callback?callback.call(this,o,false):false})}else{d=this.get_node(obj,true);t=this;if(d.length){if(animation&&d.children(".jstree-children").length){d.children(".jstree-children").stop(true,true)}if(obj.children.length&&!this._firstChild(d.children(".jstree-children")[0])){this.draw_children(obj)}if(!animation){this.trigger("before_open",{node:obj});d[0].className=d[0].className.replace("jstree-closed","jstree-open");d[0].setAttribute("aria-expanded",true)}else{this.trigger("before_open",{node:obj});d.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",true).children(".jstree-children").stop(true,true).slideDown(animation,function(){this.style.display="";t.trigger("after_open",{node:obj})})}}obj.state.opened=true;if(callback){callback.call(this,obj,true)}if(!d.length){this.trigger("before_open",{node:obj})}this.trigger("open_node",{node:obj});if(!animation||!d.length){this.trigger("after_open",{node:obj})}}},_open_to:function(obj){obj=this.get_node(obj);if(!obj||obj.id==="#"){return false}var i,j,p=obj.parents;for(i=0,j=p.length;i<j;i+=1){if(i!=="#"){this.open_node(p[i],false,0)}}return $("#"+obj.id.replace($.jstree.idregex,"\\$&"),this.element)},close_node:function(obj,animation){var t1,t2,t,d;if($.isArray(obj)){obj=obj.slice();for(t1=0,t2=obj.length;t1<t2;t1++){this.close_node(obj[t1],animation)}return true}obj=this.get_node(obj);if(!obj||obj.id==="#"){return false}if(this.is_closed(obj)){return false}animation=animation===undefined?this.settings.core.animation:animation;t=this;d=this.get_node(obj,true);if(d.length){if(!animation){d[0].className=d[0].className.replace("jstree-open","jstree-closed");d.attr("aria-expanded",false).children(".jstree-children").remove()}else{d.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",false).children(".jstree-children").stop(true,true).slideUp(animation,function(){this.style.display="";d.children(".jstree-children").remove();t.trigger("after_close",{node:obj})})}}obj.state.opened=false;this.trigger("close_node",{node:obj});if(!animation||!d.length){this.trigger("after_close",{node:obj})}},toggle_node:function(obj){var t1,t2;if($.isArray(obj)){obj=obj.slice();for(t1=0,t2=obj.length;t1<t2;t1++){this.toggle_node(obj[t1])}return true}if(this.is_closed(obj)){return this.open_node(obj)}if(this.is_open(obj)){return this.close_node(obj)}},open_all:function(obj,animation,original_obj){if(!obj){obj="#"}obj=this.get_node(obj);if(!obj){return false}var dom=obj.id==="#"?this.get_container_ul():this.get_node(obj,true),i,j,_this;if(!dom.length){for(i=0,j=obj.children_d.length;i<j;i++){if(this.is_closed(this._model.data[obj.children_d[i]])){this._model.data[obj.children_d[i]].state.opened=true}}return this.trigger("open_all",{node:obj})}original_obj=original_obj||dom;_this=this;dom=this.is_closed(obj)?dom.find(".jstree-closed").addBack():dom.find(".jstree-closed");dom.each(function(){_this.open_node(this,function(node,status){if(status&&this.is_parent(node)){this.open_all(node,animation,original_obj)}},animation||0)});if(original_obj.find(".jstree-closed").length===0){this.trigger("open_all",{node:this.get_node(original_obj)})}},close_all:function(obj,animation){if(!obj){obj="#"}obj=this.get_node(obj);if(!obj){return false}var dom=obj.id==="#"?this.get_container_ul():this.get_node(obj,true),_this=this,i,j;if(!dom.length){for(i=0,j=obj.children_d.length;i<j;i++){this._model.data[obj.children_d[i]].state.opened=false}return this.trigger("close_all",{node:obj})}dom=this.is_open(obj)?dom.find(".jstree-open").addBack():dom.find(".jstree-open");$(dom.get().reverse()).each(function(){_this.close_node(this,animation||0)});this.trigger("close_all",{node:obj})},is_disabled:function(obj){obj=this.get_node(obj);return obj&&obj.state&&obj.state.disabled},enable_node:function(obj){var t1,t2;if($.isArray(obj)){obj=obj.slice();for(t1=0,t2=obj.length;t1<t2;t1++){this.enable_node(obj[t1])}return true}obj=this.get_node(obj);if(!obj||obj.id==="#"){return false}obj.state.disabled=false;this.get_node(obj,true).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",false);this.trigger("enable_node",{node:obj})},disable_node:function(obj){var t1,t2;if($.isArray(obj)){obj=obj.slice();for(t1=0,t2=obj.length;t1<t2;t1++){this.disable_node(obj[t1])}return true}obj=this.get_node(obj);if(!obj||obj.id==="#"){return false}obj.state.disabled=true;this.get_node(obj,true).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",true);this.trigger("disable_node",{node:obj})},activate_node:function(obj,e){if(this.is_disabled(obj)){return false}this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==undefined?this.get_node(this._data.core.last_clicked.id):null;if(this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected){this._data.core.last_clicked=null}if(!this._data.core.last_clicked&&this._data.core.selected.length){this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])}if(!this.settings.core.multiple||!e.metaKey&&!e.ctrlKey&&!e.shiftKey||e.shiftKey&&(!this._data.core.last_clicked||!this.get_parent(obj)||this.get_parent(obj)!==this._data.core.last_clicked.parent)){if(!this.settings.core.multiple&&(e.metaKey||e.ctrlKey||e.shiftKey)&&this.is_selected(obj)){this.deselect_node(obj,false,e)}else{this.deselect_all(true);this.select_node(obj,false,false,e);this._data.core.last_clicked=this.get_node(obj)}}else{if(e.shiftKey){var o=this.get_node(obj).id,l=this._data.core.last_clicked.id,p=this.get_node(this._data.core.last_clicked.parent).children,c=false,i,j;for(i=0,j=p.length;i<j;i+=1){if(p[i]===o){c=!c}if(p[i]===l){c=!c}if(!this.is_disabled(p[i])&&(c||p[i]===o||p[i]===l)){this.select_node(p[i],true,false,e)}else{this.deselect_node(p[i],true,e)}}this.trigger("changed",{action:"select_node",node:this.get_node(obj),selected:this._data.core.selected,event:e})}else{if(!this.is_selected(obj)){this.select_node(obj,false,false,e)}else{this.deselect_node(obj,false,e)}}}this.trigger("activate_node",{node:this.get_node(obj)})},hover_node:function(obj){obj=this.get_node(obj,true);if(!obj||!obj.length||obj.children(".jstree-hovered").length){return false}var o=this.element.find(".jstree-hovered"),t=this.element;if(o&&o.length){this.dehover_node(o)}obj.children(".jstree-anchor").addClass("jstree-hovered");this.trigger("hover_node",{node:this.get_node(obj)});setTimeout(function(){t.attr("aria-activedescendant",obj[0].id)},0)},dehover_node:function(obj){obj=this.get_node(obj,true);if(!obj||!obj.length||!obj.children(".jstree-hovered").length){return false}obj.children(".jstree-anchor").removeClass("jstree-hovered");this.trigger("dehover_node",{node:this.get_node(obj)})},select_node:function(obj,supress_event,prevent_open,e){var dom,t1,t2,th;if($.isArray(obj)){obj=obj.slice();for(t1=0,t2=obj.length;t1<t2;t1++){this.select_node(obj[t1],supress_event,prevent_open,e)}return true}obj=this.get_node(obj);if(!obj||obj.id==="#"){return false}dom=this.get_node(obj,true);if(!obj.state.selected){obj.state.selected=true;this._data.core.selected.push(obj.id);if(!prevent_open){dom=this._open_to(obj)}if(dom&&dom.length){dom.attr("aria-selected",true).children(".jstree-anchor").addClass("jstree-clicked")}this.trigger("select_node",{node:obj,selected:this._data.core.selected,event:e});if(!supress_event){this.trigger("changed",{action:"select_node",node:obj,selected:this._data.core.selected,event:e})}}},deselect_node:function(obj,supress_event,e){var t1,t2,dom;if($.isArray(obj)){obj=obj.slice();for(t1=0,t2=obj.length;t1<t2;t1++){this.deselect_node(obj[t1],supress_event,e)}return true}obj=this.get_node(obj);if(!obj||obj.id==="#"){return false}dom=this.get_node(obj,true);if(obj.state.selected){obj.state.selected=false;this._data.core.selected=$.vakata.array_remove_item(this._data.core.selected,obj.id);if(dom.length){dom.attr("aria-selected",false).children(".jstree-anchor").removeClass("jstree-clicked")}this.trigger("deselect_node",{node:obj,selected:this._data.core.selected,event:e});if(!supress_event){this.trigger("changed",{action:"deselect_node",node:obj,selected:this._data.core.selected,event:e})}}},select_all:function(supress_event){var tmp=this._data.core.selected.concat([]),i,j;this._data.core.selected=this._model.data["#"].children_d.concat();for(i=0,j=this._data.core.selected.length;i<j;i++){if(this._model.data[this._data.core.selected[i]]){this._model.data[this._data.core.selected[i]].state.selected=true}}this.redraw(true);this.trigger("select_all",{selected:this._data.core.selected});if(!supress_event){this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:tmp})}},deselect_all:function(supress_event){var tmp=this._data.core.selected.concat([]),i,j;for(i=0,j=this._data.core.selected.length;i<j;i++){if(this._model.data[this._data.core.selected[i]]){this._model.data[this._data.core.selected[i]].state.selected=false}}this._data.core.selected=[];this.element.find(".jstree-clicked").removeClass("jstree-clicked").parent().attr("aria-selected",false);this.trigger("deselect_all",{selected:this._data.core.selected,node:tmp});if(!supress_event){this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:tmp})}},is_selected:function(obj){obj=this.get_node(obj);if(!obj||obj.id==="#"){return false}return obj.state.selected},get_selected:function(full){return full?$.map(this._data.core.selected,$.proxy(function(i){return this.get_node(i)},this)):this._data.core.selected.slice()},get_top_selected:function(full){var tmp=this.get_selected(true),obj={},i,j,k,l;for(i=0,j=tmp.length;i<j;i++){obj[tmp[i].id]=tmp[i]}for(i=0,j=tmp.length;i<j;i++){for(k=0,l=tmp[i].children_d.length;k<l;k++){if(obj[tmp[i].children_d[k]]){delete obj[tmp[i].children_d[k]]}}}tmp=[];for(i in obj){if(obj.hasOwnProperty(i)){tmp.push(i)}}return full?$.map(tmp,$.proxy(function(i){return this.get_node(i)},this)):tmp},get_bottom_selected:function(full){var tmp=this.get_selected(true),obj=[],i,j;for(i=0,j=tmp.length;i<j;i++){if(!tmp[i].children.length){obj.push(tmp[i].id)}}return full?$.map(obj,$.proxy(function(i){return this.get_node(i)},this)):obj},get_state:function(){var state={core:{open:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}},i;for(i in this._model.data){if(this._model.data.hasOwnProperty(i)){if(i!=="#"){if(this._model.data[i].state.opened){state.core.open.push(i)}if(this._model.data[i].state.selected){state.core.selected.push(i)}}}}return state},set_state:function(state,callback){if(state){if(state.core){var res,n,t,_this,i;if(state.core.open){if(!$.isArray(state.core.open)||!state.core.open.length){delete state.core.open;this.set_state(state,callback)}else{this._load_nodes(state.core.open,function(nodes){this.open_node(nodes,false,0);delete state.core.open;this.set_state(state,callback)},true)}return false}if(state.core.scroll){if(state.core.scroll&&state.core.scroll.left!==undefined){this.element.scrollLeft(state.core.scroll.left)}if(state.core.scroll&&state.core.scroll.top!==undefined){this.element.scrollTop(state.core.scroll.top)}delete state.core.scroll;this.set_state(state,callback);return false}if(state.core.selected){_this=this;this.deselect_all();$.each(state.core.selected,function(i,v){_this.select_node(v,false,true)});delete state.core.selected;this.set_state(state,callback);return false}for(i in state){if(state.hasOwnProperty(i)&&i!=="core"&&$.inArray(i,this.settings.plugins)===-1){delete state[i]}}if($.isEmptyObject(state.core)){delete state.core;this.set_state(state,callback);return false}}if($.isEmptyObject(state)){state=null;if(callback){callback.call(this)}this.trigger("set_state");return false}return true}return false},refresh:function(skip_loading,forget_state){this._data.core.state=forget_state===true?{}:this.get_state();if(forget_state&&$.isFunction(forget_state)){this._data.core.state=forget_state.call(this,this._data.core.state)}this._cnt=0;this._model.data={"#":{id:"#",parent:null,parents:[],children:[],children_d:[],state:{loaded:false}}};var c=this.get_container_ul()[0].className;if(!skip_loading){this.element.html("<"+"ul class='"+c+"' role='group'><"+"li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='treeitem' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><"+"a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>");this.element.attr("aria-activedescendant","j"+this._id+"_loading")}this.load_node("#",function(o,s){if(s){this.get_container_ul()[0].className=c;if(this._firstChild(this.get_container_ul()[0])){this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id)}this.set_state($.extend(true,{},this._data.core.state),function(){this.trigger("refresh")})}this._data.core.state=null})},refresh_node:function(obj){obj=this.get_node(obj);if(!obj||obj.id==="#"){return false}var opened=[],to_load=[],s=this._data.core.selected.concat([]);to_load.push(obj.id);if(obj.state.opened===true){opened.push(obj.id)}this.get_node(obj,true).find(".jstree-open").each(function(){opened.push(this.id)});this._load_nodes(to_load,$.proxy(function(nodes){this.open_node(opened,false,0);this.select_node(this._data.core.selected);this.trigger("refresh_node",{node:obj,nodes:nodes})},this))},set_id:function(obj,id){obj=this.get_node(obj);if(!obj||obj.id==="#"){return false}var i,j,m=this._model.data;id=id.toString();m[obj.parent].children[$.inArray(obj.id,m[obj.parent].children)]=id;for(i=0,j=obj.parents.length;i<j;i++){m[obj.parents[i]].children_d[$.inArray(obj.id,m[obj.parents[i]].children_d)]=id}for(i=0,j=obj.children.length;i<j;i++){m[obj.children[i]].parent=id}for(i=0,j=obj.children_d.length;i<j;i++){m[obj.children_d[i]].parents[$.inArray(obj.id,m[obj.children_d[i]].parents)]=id}i=$.inArray(obj.id,this._data.core.selected);if(i!==-1){this._data.core.selected[i]=id}i=this.get_node(obj.id,true);if(i){i.attr("id",id).children(".jstree-anchor").attr("id",id+"_anchor").end().attr("aria-labelledby",id+"_anchor");if(this.element.attr("aria-activedescendant")===obj.id){this.element.attr("aria-activedescendant",id)}}delete m[obj.id];obj.id=id;obj.li_attr.id=id;m[id]=obj;return true},get_text:function(obj){obj=this.get_node(obj);return!obj||obj.id==="#"?false:obj.text},set_text:function(obj,val){var t1,t2;if($.isArray(obj)){obj=obj.slice();for(t1=0,t2=obj.length;t1<t2;t1++){this.set_text(obj[t1],val)}return true}obj=this.get_node(obj);if(!obj||obj.id==="#"){return false}obj.text=val;if(this.get_node(obj,true).length){this.redraw_node(obj.id)}this.trigger("set_text",{obj:obj,text:val});return true},get_json:function(obj,options,flat){obj=this.get_node(obj||"#");if(!obj){return false}if(options&&options.flat&&!flat){flat=[]}var tmp={id:obj.id,text:obj.text,icon:this.get_icon(obj),li_attr:$.extend(true,{},obj.li_attr),a_attr:$.extend(true,{},obj.a_attr),state:{},data:options&&options.no_data?false:$.extend(true,{},obj.data)},i,j;if(options&&options.flat){tmp.parent=obj.parent}else{tmp.children=[]}if(!options||!options.no_state){for(i in obj.state){if(obj.state.hasOwnProperty(i)){tmp.state[i]=obj.state[i]}}}if(options&&options.no_id){delete tmp.id;if(tmp.li_attr&&tmp.li_attr.id){delete tmp.li_attr.id}if(tmp.a_attr&&tmp.a_attr.id){delete tmp.a_attr.id}}if(options&&options.flat&&obj.id!=="#"){flat.push(tmp)}if(!options||!options.no_children){for(i=0,j=obj.children.length;i<j;i++){if(options&&options.flat){this.get_json(obj.children[i],options,flat)}else{tmp.children.push(this.get_json(obj.children[i],options))}}}return options&&options.flat?flat:obj.id==="#"?tmp.children:tmp},create_node:function(par,node,pos,callback,is_loaded){if(par===null){par="#"}par=this.get_node(par);if(!par){return false}pos=pos===undefined?"last":pos;if(!pos.toString().match(/^(before|after)$/)&&!is_loaded&&!this.is_loaded(par)){return this.load_node(par,function(){this.create_node(par,node,pos,callback,true)})}if(!node){node={text:this.get_string("New node")}}if(typeof node==="string"){node={text:node}}if(node.text===undefined){node.text=this.get_string("New node")}var tmp,dpc,i,j;if(par.id==="#"){if(pos==="before"){pos="first"}if(pos==="after"){pos="last"}}switch(pos){case"before":tmp=this.get_node(par.parent);pos=$.inArray(par.id,tmp.children);par=tmp;break;case"after":tmp=this.get_node(par.parent);pos=$.inArray(par.id,tmp.children)+1;par=tmp;break;case"inside":case"first":pos=0;break;case"last":pos=par.children.length;break;default:if(!pos){pos=0}break}if(pos>par.children.length){pos=par.children.length}if(!node.id){node.id=true}if(!this.check("create_node",node,par,pos)){this.settings.core.error.call(this,this._data.core.last_error);return false}if(node.id===true){delete node.id}node=this._parse_model_from_json(node,par.id,par.parents.concat());if(!node){return false}tmp=this.get_node(node);dpc=[];dpc.push(node);dpc=dpc.concat(tmp.children_d);this.trigger("model",{nodes:dpc,parent:par.id});par.children_d=par.children_d.concat(dpc);for(i=0,j=par.parents.length;i<j;i++){this._model.data[par.parents[i]].children_d=this._model.data[par.parents[i]].children_d.concat(dpc)}node=tmp;tmp=[];for(i=0,j=par.children.length;i<j;i++){tmp[i>=pos?i+1:i]=par.children[i]}tmp[pos]=node.id;par.children=tmp;this.redraw_node(par,true);if(callback){callback.call(this,this.get_node(node))}this.trigger("create_node",{node:this.get_node(node),parent:par.id,position:pos});return node.id},rename_node:function(obj,val){var t1,t2,old;if($.isArray(obj)){obj=obj.slice();for(t1=0,t2=obj.length;t1<t2;t1++){this.rename_node(obj[t1],val)}return true}obj=this.get_node(obj);if(!obj||obj.id==="#"){return false}old=obj.text;if(!this.check("rename_node",obj,this.get_parent(obj),val)){this.settings.core.error.call(this,this._data.core.last_error);return false}this.set_text(obj,val);this.trigger("rename_node",{node:obj,text:val,old:old});return true},delete_node:function(obj){var t1,t2,par,pos,tmp,i,j,k,l,c;if($.isArray(obj)){obj=obj.slice();for(t1=0,t2=obj.length;t1<t2;t1++){this.delete_node(obj[t1])}return true}obj=this.get_node(obj);if(!obj||obj.id==="#"){return false}par=this.get_node(obj.parent);pos=$.inArray(obj.id,par.children);c=false;if(!this.check("delete_node",obj,par,pos)){this.settings.core.error.call(this,this._data.core.last_error);return false}if(pos!==-1){par.children=$.vakata.array_remove(par.children,pos)}tmp=obj.children_d.concat([]);tmp.push(obj.id);for(k=0,l=tmp.length;k<l;k++){for(i=0,j=obj.parents.length;i<j;i++){pos=$.inArray(tmp[k],this._model.data[obj.parents[i]].children_d);if(pos!==-1){this._model.data[obj.parents[i]].children_d=$.vakata.array_remove(this._model.data[obj.parents[i]].children_d,pos)}}if(this._model.data[tmp[k]].state.selected){c=true;pos=$.inArray(tmp[k],this._data.core.selected);if(pos!==-1){this._data.core.selected=$.vakata.array_remove(this._data.core.selected,pos)}}}this.trigger("delete_node",{node:obj,parent:par.id});if(c){this.trigger("changed",{action:"delete_node",node:obj,selected:this._data.core.selected,parent:par.id})}for(k=0,l=tmp.length;k<l;k++){delete this._model.data[tmp[k]]}this.redraw_node(par,true);return true},check:function(chk,obj,par,pos,more){obj=obj&&obj.id?obj:this.get_node(obj);par=par&&par.id?par:this.get_node(par);var tmp=chk.match(/^move_node|copy_node|create_node$/i)?par:obj,chc=this.settings.core.check_callback;if(chk==="move_node"||chk==="copy_node"){if((!more||!more.is_multi)&&(obj.id===par.id||$.inArray(obj.id,par.children)===pos||$.inArray(par.id,obj.children_d)!==-1)){this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:chk,pos:pos,obj:obj&&obj.id?obj.id:false,par:par&&par.id?par.id:false})};return false}}if(tmp&&tmp.data){tmp=tmp.data}if(tmp&&tmp.functions&&(tmp.functions[chk]===false||tmp.functions[chk]===true)){if(tmp.functions[chk]===false){this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+chk,data:JSON.stringify({chk:chk,pos:pos,obj:obj&&obj.id?obj.id:false,par:par&&par.id?par.id:false})}}return tmp.functions[chk]}if(chc===false||$.isFunction(chc)&&chc.call(this,chk,obj,par,pos,more)===false||chc&&chc[chk]===false){this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+chk,data:JSON.stringify({chk:chk,pos:pos,obj:obj&&obj.id?obj.id:false,par:par&&par.id?par.id:false})};return false}return true},last_error:function(){return this._data.core.last_error},move_node:function(obj,par,pos,callback,is_loaded,skip_redraw,origin){var t1,t2,old_par,old_pos,new_par,old_ins,is_multi,dpc,tmp,i,j,k,l,p;par=this.get_node(par);pos=pos===undefined?0:pos;if(!par){return false}if(!pos.toString().match(/^(before|after)$/)&&!is_loaded&&!this.is_loaded(par)){return this.load_node(par,function(){this.move_node(obj,par,pos,callback,true,false,origin)})}if($.isArray(obj)){if(obj.length===1){obj=obj[0]}else{for(t1=0,t2=obj.length;t1<t2;t1++){if(tmp=this.move_node(obj[t1],par,pos,callback,is_loaded,false,origin)){par=tmp;pos="after"}}this.redraw();return true}}obj=obj&&obj.id?obj:this.get_node(obj);if(!obj||obj.id==="#"){return false}old_par=(obj.parent||"#").toString();new_par=!pos.toString().match(/^(before|after)$/)||par.id==="#"?par:this.get_node(par.parent);old_ins=origin?origin:this._model.data[obj.id]?this:$.jstree.reference(obj.id);is_multi=!old_ins||!old_ins._id||this._id!==old_ins._id;old_pos=old_ins&&old_ins._id&&old_par&&old_ins._model.data[old_par]&&old_ins._model.data[old_par].children?$.inArray(obj.id,old_ins._model.data[old_par].children):-1;if(old_ins&&old_ins._id){obj=old_ins._model.data[obj.id]}if(is_multi){if(tmp=this.copy_node(obj,par,pos,callback,is_loaded,false,origin)){if(old_ins){old_ins.delete_node(obj)}return tmp}return false}if(par.id==="#"){if(pos==="before"){pos="first"}if(pos==="after"){pos="last"}}switch(pos){case"before":pos=$.inArray(par.id,new_par.children);break;case"after":pos=$.inArray(par.id,new_par.children)+1;break;case"inside":case"first":pos=0;break;case"last":pos=new_par.children.length;break;default:if(!pos){pos=0}break}if(pos>new_par.children.length){pos=new_par.children.length}if(!this.check("move_node",obj,new_par,pos,{core:true,origin:origin,is_multi:old_ins&&old_ins._id&&old_ins._id!==this._id,is_foreign:!old_ins||!old_ins._id})){this.settings.core.error.call(this,this._data.core.last_error);return false}if(obj.parent===new_par.id){dpc=new_par.children.concat();tmp=$.inArray(obj.id,dpc);if(tmp!==-1){dpc=$.vakata.array_remove(dpc,tmp);if(pos>tmp){pos--}}tmp=[];for(i=0,j=dpc.length;i<j;i++){tmp[i>=pos?i+1:i]=dpc[i]}tmp[pos]=obj.id;new_par.children=tmp;this._node_changed(new_par.id);this.redraw(new_par.id==="#")}else{tmp=obj.children_d.concat();tmp.push(obj.id);for(i=0,j=obj.parents.length;i<j;i++){dpc=[];p=old_ins._model.data[obj.parents[i]].children_d;for(k=0,l=p.length;k<l;k++){if($.inArray(p[k],tmp)===-1){dpc.push(p[k])}}old_ins._model.data[obj.parents[i]].children_d=dpc}old_ins._model.data[old_par].children=$.vakata.array_remove_item(old_ins._model.data[old_par].children,obj.id);for(i=0,j=new_par.parents.length;i<j;i++){this._model.data[new_par.parents[i]].children_d=this._model.data[new_par.parents[i]].children_d.concat(tmp)}dpc=[];for(i=0,j=new_par.children.length;i<j;i++){dpc[i>=pos?i+1:i]=new_par.children[i]}dpc[pos]=obj.id;new_par.children=dpc;new_par.children_d.push(obj.id);new_par.children_d=new_par.children_d.concat(obj.children_d);obj.parent=new_par.id;tmp=new_par.parents.concat();tmp.unshift(new_par.id);p=obj.parents.length;obj.parents=tmp;tmp=tmp.concat();for(i=0,j=obj.children_d.length;i<j;i++){this._model.data[obj.children_d[i]].parents=this._model.data[obj.children_d[i]].parents.slice(0,p*-1);Array.prototype.push.apply(this._model.data[obj.children_d[i]].parents,tmp)}if(old_par==="#"||new_par.id==="#"){this._model.force_full_redraw=true}if(!this._model.force_full_redraw){this._node_changed(old_par);this._node_changed(new_par.id)}if(!skip_redraw){this.redraw()}}if(callback){callback.call(this,obj,new_par,pos)}this.trigger("move_node",{node:obj,parent:new_par.id,position:pos,old_parent:old_par,old_position:old_pos,is_multi:old_ins&&old_ins._id&&old_ins._id!==this._id,is_foreign:!old_ins||!old_ins._id,old_instance:old_ins,new_instance:this});return obj.id},copy_node:function(obj,par,pos,callback,is_loaded,skip_redraw,origin){var t1,t2,dpc,tmp,i,j,node,old_par,new_par,old_ins,is_multi;par=this.get_node(par);pos=pos===undefined?0:pos;if(!par){return false}if(!pos.toString().match(/^(before|after)$/)&&!is_loaded&&!this.is_loaded(par)){return this.load_node(par,function(){this.copy_node(obj,par,pos,callback,true,false,origin)})}if($.isArray(obj)){if(obj.length===1){obj=obj[0]}else{for(t1=0,t2=obj.length;t1<t2;t1++){if(tmp=this.copy_node(obj[t1],par,pos,callback,is_loaded,true,origin)){par=tmp;pos="after"}}this.redraw();return true}}obj=obj&&obj.id?obj:this.get_node(obj);if(!obj||obj.id==="#"){return false}old_par=(obj.parent||"#").toString();new_par=!pos.toString().match(/^(before|after)$/)||par.id==="#"?par:this.get_node(par.parent);old_ins=origin?origin:this._model.data[obj.id]?this:$.jstree.reference(obj.id);is_multi=!old_ins||!old_ins._id||this._id!==old_ins._id;if(old_ins&&old_ins._id){obj=old_ins._model.data[obj.id]}if(par.id==="#"){if(pos==="before"){pos="first"}if(pos==="after"){pos="last"}}switch(pos){case"before":pos=$.inArray(par.id,new_par.children);break;case"after":pos=$.inArray(par.id,new_par.children)+1;break;case"inside":case"first":pos=0;break;case"last":pos=new_par.children.length;break;default:if(!pos){pos=0}break}if(pos>new_par.children.length){pos=new_par.children.length}if(!this.check("copy_node",obj,new_par,pos,{core:true,origin:origin,is_multi:old_ins&&old_ins._id&&old_ins._id!==this._id,is_foreign:!old_ins||!old_ins._id})){this.settings.core.error.call(this,this._data.core.last_error);return false}node=old_ins?old_ins.get_json(obj,{no_id:true,no_data:true,no_state:true}):obj;if(!node){return false}if(node.id===true){delete node.id}node=this._parse_model_from_json(node,new_par.id,new_par.parents.concat());if(!node){return false}tmp=this.get_node(node);if(obj&&obj.state&&obj.state.loaded===false){tmp.state.loaded=false}dpc=[];dpc.push(node);dpc=dpc.concat(tmp.children_d);this.trigger("model",{nodes:dpc,parent:new_par.id});for(i=0,j=new_par.parents.length;i<j;i++){this._model.data[new_par.parents[i]].children_d=this._model.data[new_par.parents[i]].children_d.concat(dpc)}dpc=[];for(i=0,j=new_par.children.length;i<j;i++){dpc[i>=pos?i+1:i]=new_par.children[i]}dpc[pos]=tmp.id;new_par.children=dpc;new_par.children_d.push(tmp.id);new_par.children_d=new_par.children_d.concat(tmp.children_d);if(new_par.id==="#"){this._model.force_full_redraw=true}if(!this._model.force_full_redraw){this._node_changed(new_par.id)}if(!skip_redraw){this.redraw(new_par.id==="#")}if(callback){callback.call(this,tmp,new_par,pos)}this.trigger("copy_node",{node:tmp,original:obj,parent:new_par.id,position:pos,old_parent:old_par,old_position:old_ins&&old_ins._id&&old_par&&old_ins._model.data[old_par]&&old_ins._model.data[old_par].children?$.inArray(obj.id,old_ins._model.data[old_par].children):-1,is_multi:old_ins&&old_ins._id&&old_ins._id!==this._id,is_foreign:!old_ins||!old_ins._id,old_instance:old_ins,new_instance:this});return tmp.id},cut:function(obj){if(!obj){obj=this._data.core.selected.concat()}if(!$.isArray(obj)){obj=[obj]}if(!obj.length){return false}var tmp=[],o,t1,t2;for(t1=0,t2=obj.length;t1<t2;t1++){o=this.get_node(obj[t1]);if(o&&o.id&&o.id!=="#"){tmp.push(o)}}if(!tmp.length){
return false}ccp_node=tmp;ccp_inst=this;ccp_mode="move_node";this.trigger("cut",{node:obj})},copy:function(obj){if(!obj){obj=this._data.core.selected.concat()}if(!$.isArray(obj)){obj=[obj]}if(!obj.length){return false}var tmp=[],o,t1,t2;for(t1=0,t2=obj.length;t1<t2;t1++){o=this.get_node(obj[t1]);if(o&&o.id&&o.id!=="#"){tmp.push(o)}}if(!tmp.length){return false}ccp_node=tmp;ccp_inst=this;ccp_mode="copy_node";this.trigger("copy",{node:obj})},get_buffer:function(){return{mode:ccp_mode,node:ccp_node,inst:ccp_inst}},can_paste:function(){return ccp_mode!==false&&ccp_node!==false},paste:function(obj,pos){obj=this.get_node(obj);if(!obj||!ccp_mode||!ccp_mode.match(/^(copy_node|move_node)$/)||!ccp_node){return false}if(this[ccp_mode](ccp_node,obj,pos,false,false,false,ccp_inst)){this.trigger("paste",{parent:obj.id,node:ccp_node,mode:ccp_mode})}ccp_node=false;ccp_mode=false;ccp_inst=false},clear_buffer:function(){ccp_node=false;ccp_mode=false;ccp_inst=false;this.trigger("clear_buffer")},edit:function(obj,default_text,callback){var rtl,w,a,s,t,h1,h2,fn,tmp;obj=this.get_node(obj);if(!obj){return false}if(this.settings.core.check_callback===false){this._data.core.last_error={error:"check",plugin:"core",id:"core_07",reason:"Could not edit node because of check_callback"};this.settings.core.error.call(this,this._data.core.last_error);return false}tmp=obj;default_text=typeof default_text==="string"?default_text:obj.text;this.set_text(obj,"");obj=this._open_to(obj);tmp.text=default_text;rtl=this._data.core.rtl;w=this.element.width();a=obj.children(".jstree-anchor");s=$("<span>");t=default_text;h1=$("<"+"div />",{css:{position:"absolute",top:"-200px",left:rtl?"0px":"-1000px",visibility:"hidden"}}).appendTo("body");h2=$("<"+"input />",{value:t,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:$.proxy(function(){var i=s.children(".jstree-rename-input"),v=i.val(),f=this.settings.core.force_text,nv;if(v===""){v=t}h1.remove();s.replaceWith(a);s.remove();t=f?t:$("<div></div>").append($.parseHTML(t)).html();this.set_text(obj,t);nv=!!this.rename_node(obj,f?$("<div></div>").text(v).text():$("<div></div>").append($.parseHTML(v)).html());if(!nv){this.set_text(obj,t)}if(callback){callback.call(this,tmp,nv)}},this),keydown:function(event){var key=event.which;if(key===27){this.value=t}if(key===27||key===13||key===37||key===38||key===39||key===40||key===32){event.stopImmediatePropagation()}if(key===27||key===13){event.preventDefault();this.blur()}},click:function(e){e.stopImmediatePropagation()},mousedown:function(e){e.stopImmediatePropagation()},keyup:function(event){h2.width(Math.min(h1.text("pW"+this.value).width(),w))},keypress:function(event){if(event.which===13){return false}}});fn={fontFamily:a.css("fontFamily")||"",fontSize:a.css("fontSize")||"",fontWeight:a.css("fontWeight")||"",fontStyle:a.css("fontStyle")||"",fontStretch:a.css("fontStretch")||"",fontVariant:a.css("fontVariant")||"",letterSpacing:a.css("letterSpacing")||"",wordSpacing:a.css("wordSpacing")||""};s.attr("class",a.attr("class")).append(a.contents().clone()).append(h2);a.replaceWith(s);h1.css(fn);h2.css(fn).width(Math.min(h1.text("pW"+h2[0].value).width(),w))[0].select()},set_theme:function(theme_name,theme_url){if(!theme_name){return false}if(theme_url===true){var dir=this.settings.core.themes.dir;if(!dir){dir=$.jstree.path+"/themes"}theme_url=dir+"/"+theme_name+"/style.css"}if(theme_url&&$.inArray(theme_url,themes_loaded)===-1){$("head").append("<"+'link rel="stylesheet" href="'+theme_url+'" type="text/css" />');themes_loaded.push(theme_url)}if(this._data.core.themes.name){this.element.removeClass("jstree-"+this._data.core.themes.name)}this._data.core.themes.name=theme_name;this.element.addClass("jstree-"+theme_name);this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+theme_name+"-responsive");this.trigger("set_theme",{theme:theme_name})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(variant_name){if(this._data.core.themes.variant){this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)}this._data.core.themes.variant=variant_name;if(variant_name){this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)}},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=true;this.get_container_ul().addClass("jstree-striped")},hide_stripes:function(){this._data.core.themes.stripes=false;this.get_container_ul().removeClass("jstree-striped")},toggle_stripes:function(){if(this._data.core.themes.stripes){this.hide_stripes()}else{this.show_stripes()}},show_dots:function(){this._data.core.themes.dots=true;this.get_container_ul().removeClass("jstree-no-dots")},hide_dots:function(){this._data.core.themes.dots=false;this.get_container_ul().addClass("jstree-no-dots")},toggle_dots:function(){if(this._data.core.themes.dots){this.hide_dots()}else{this.show_dots()}},show_icons:function(){this._data.core.themes.icons=true;this.get_container_ul().removeClass("jstree-no-icons")},hide_icons:function(){this._data.core.themes.icons=false;this.get_container_ul().addClass("jstree-no-icons")},toggle_icons:function(){if(this._data.core.themes.icons){this.hide_icons()}else{this.show_icons()}},set_icon:function(obj,icon){var t1,t2,dom,old;if($.isArray(obj)){obj=obj.slice();for(t1=0,t2=obj.length;t1<t2;t1++){this.set_icon(obj[t1],icon)}return true}obj=this.get_node(obj);if(!obj||obj.id==="#"){return false}old=obj.icon;obj.icon=icon===true||icon===null||icon===undefined||icon===""?true:icon;dom=this.get_node(obj,true).children(".jstree-anchor").children(".jstree-themeicon");if(icon===false){this.hide_icon(obj)}else if(icon===true||icon===null||icon===undefined||icon===""){dom.removeClass("jstree-themeicon-custom "+old).css("background","").removeAttr("rel");if(old===false){this.show_icon(obj)}}else if(icon.indexOf("/")===-1&&icon.indexOf(".")===-1){dom.removeClass(old).css("background","");dom.addClass(icon+" jstree-themeicon-custom").attr("rel",icon);if(old===false){this.show_icon(obj)}}else{dom.removeClass(old).css("background","");dom.addClass("jstree-themeicon-custom").css("background","url('"+icon+"') center center no-repeat").attr("rel",icon);if(old===false){this.show_icon(obj)}}return true},get_icon:function(obj){obj=this.get_node(obj);return!obj||obj.id==="#"?false:obj.icon},hide_icon:function(obj){var t1,t2;if($.isArray(obj)){obj=obj.slice();for(t1=0,t2=obj.length;t1<t2;t1++){this.hide_icon(obj[t1])}return true}obj=this.get_node(obj);if(!obj||obj==="#"){return false}obj.icon=false;this.get_node(obj,true).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden");return true},show_icon:function(obj){var t1,t2,dom;if($.isArray(obj)){obj=obj.slice();for(t1=0,t2=obj.length;t1<t2;t1++){this.show_icon(obj[t1])}return true}obj=this.get_node(obj);if(!obj||obj==="#"){return false}dom=this.get_node(obj,true);obj.icon=dom.length?dom.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"):true;if(!obj.icon){obj.icon=true}dom.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden");return true}};$.vakata={};$.vakata.attributes=function(node,with_values){node=$(node)[0];var attr=with_values?{}:[];if(node&&node.attributes){$.each(node.attributes,function(i,v){if($.inArray(v.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])!==-1){return}if(v.value!==null&&$.trim(v.value)!==""){if(with_values){attr[v.name]=v.value}else{attr.push(v.name)}}})}return attr};$.vakata.array_unique=function(array){var a=[],i,j,l,o={};for(i=0,l=array.length;i<l;i++){if(o[array[i]]===undefined){a.push(array[i]);o[array[i]]=true}}return a};$.vakata.array_remove=function(array,from,to){var rest=array.slice((to||from)+1||array.length);array.length=from<0?array.length+from:from;array.push.apply(array,rest);return array};$.vakata.array_remove_item=function(array,item){var tmp=$.inArray(item,array);return tmp!==-1?$.vakata.array_remove(array,tmp):array};var _i=document.createElement("I");_i.className="jstree-icon jstree-checkbox";_i.setAttribute("role","presentation");$.jstree.defaults.checkbox={visible:true,three_state:true,whole_node:true,keep_selected_style:true,cascade:"",tie_selection:true};$.jstree.plugins.checkbox=function(options,parent){this.bind=function(){parent.bind.call(this);this._data.checkbox.uto=false;this._data.checkbox.selected=[];if(this.settings.checkbox.three_state){this.settings.checkbox.cascade="up+down+undetermined"}this.element.on("init.jstree",$.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible;if(!this.settings.checkbox.keep_selected_style){this.element.addClass("jstree-checkbox-no-clicked")}if(this.settings.checkbox.tie_selection){this.element.addClass("jstree-checkbox-selection")}},this)).on("loading.jstree",$.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this));if(this.settings.checkbox.cascade.indexOf("undetermined")!==-1){this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",$.proxy(function(){if(this._data.checkbox.uto){clearTimeout(this._data.checkbox.uto)}this._data.checkbox.uto=setTimeout($.proxy(this._undetermined,this),50)},this))}if(!this.settings.checkbox.tie_selection){this.element.on("model.jstree",$.proxy(function(e,data){var m=this._model.data,p=m[data.parent],dpc=data.nodes,i,j;for(i=0,j=dpc.length;i<j;i++){m[dpc[i]].state.checked=m[dpc[i]].original&&m[dpc[i]].original.state&&m[dpc[i]].original.state.checked;if(m[dpc[i]].state.checked){this._data.checkbox.selected.push(dpc[i])}}},this))}if(this.settings.checkbox.cascade.indexOf("up")!==-1||this.settings.checkbox.cascade.indexOf("down")!==-1){this.element.on("model.jstree",$.proxy(function(e,data){var m=this._model.data,p=m[data.parent],dpc=data.nodes,chd=[],c,i,j,k,l,tmp,s=this.settings.checkbox.cascade,t=this.settings.checkbox.tie_selection;if(s.indexOf("down")!==-1){if(p.state[t?"selected":"checked"]){for(i=0,j=dpc.length;i<j;i++){m[dpc[i]].state[t?"selected":"checked"]=true}this._data[t?"core":"checkbox"].selected=this._data[t?"core":"checkbox"].selected.concat(dpc)}else{for(i=0,j=dpc.length;i<j;i++){if(m[dpc[i]].state[t?"selected":"checked"]){for(k=0,l=m[dpc[i]].children_d.length;k<l;k++){m[m[dpc[i]].children_d[k]].state[t?"selected":"checked"]=true}this._data[t?"core":"checkbox"].selected=this._data[t?"core":"checkbox"].selected.concat(m[dpc[i]].children_d)}}}}if(s.indexOf("up")!==-1){for(i=0,j=p.children_d.length;i<j;i++){if(!m[p.children_d[i]].children.length){chd.push(m[p.children_d[i]].parent)}}chd=$.vakata.array_unique(chd);for(k=0,l=chd.length;k<l;k++){p=m[chd[k]];while(p&&p.id!=="#"){c=0;for(i=0,j=p.children.length;i<j;i++){c+=m[p.children[i]].state[t?"selected":"checked"]}if(c===j){p.state[t?"selected":"checked"]=true;this._data[t?"core":"checkbox"].selected.push(p.id);tmp=this.get_node(p,true);if(tmp&&tmp.length){tmp.attr("aria-selected",true).children(".jstree-anchor").addClass(t?"jstree-clicked":"jstree-checked")}}else{break}p=this.get_node(p.parent)}}}this._data[t?"core":"checkbox"].selected=$.vakata.array_unique(this._data[t?"core":"checkbox"].selected)},this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",$.proxy(function(e,data){var obj=data.node,m=this._model.data,par=this.get_node(obj.parent),dom=this.get_node(obj,true),i,j,c,tmp,s=this.settings.checkbox.cascade,t=this.settings.checkbox.tie_selection;if(s.indexOf("down")!==-1){this._data[t?"core":"checkbox"].selected=$.vakata.array_unique(this._data[t?"core":"checkbox"].selected.concat(obj.children_d));for(i=0,j=obj.children_d.length;i<j;i++){tmp=m[obj.children_d[i]];tmp.state[t?"selected":"checked"]=true;if(tmp&&tmp.original&&tmp.original.state&&tmp.original.state.undetermined){tmp.original.state.undetermined=false}}}if(s.indexOf("up")!==-1){while(par&&par.id!=="#"){c=0;for(i=0,j=par.children.length;i<j;i++){c+=m[par.children[i]].state[t?"selected":"checked"]}if(c===j){par.state[t?"selected":"checked"]=true;this._data[t?"core":"checkbox"].selected.push(par.id);tmp=this.get_node(par,true);if(tmp&&tmp.length){tmp.attr("aria-selected",true).children(".jstree-anchor").addClass(t?"jstree-clicked":"jstree-checked")}}else{break}par=this.get_node(par.parent)}}if(s.indexOf("down")!==-1&&dom.length){dom.find(".jstree-anchor").addClass(t?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",true)}},this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",$.proxy(function(e,data){var obj=this.get_node("#"),m=this._model.data,i,j,tmp;for(i=0,j=obj.children_d.length;i<j;i++){tmp=m[obj.children_d[i]];if(tmp&&tmp.original&&tmp.original.state&&tmp.original.state.undetermined){tmp.original.state.undetermined=false}}},this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",$.proxy(function(e,data){var obj=data.node,dom=this.get_node(obj,true),i,j,tmp,s=this.settings.checkbox.cascade,t=this.settings.checkbox.tie_selection;if(obj&&obj.original&&obj.original.state&&obj.original.state.undetermined){obj.original.state.undetermined=false}if(s.indexOf("down")!==-1){for(i=0,j=obj.children_d.length;i<j;i++){tmp=this._model.data[obj.children_d[i]];tmp.state[t?"selected":"checked"]=false;if(tmp&&tmp.original&&tmp.original.state&&tmp.original.state.undetermined){tmp.original.state.undetermined=false}}}if(s.indexOf("up")!==-1){for(i=0,j=obj.parents.length;i<j;i++){tmp=this._model.data[obj.parents[i]];tmp.state[t?"selected":"checked"]=false;if(tmp&&tmp.original&&tmp.original.state&&tmp.original.state.undetermined){tmp.original.state.undetermined=false}tmp=this.get_node(obj.parents[i],true);if(tmp&&tmp.length){tmp.attr("aria-selected",false).children(".jstree-anchor").removeClass(t?"jstree-clicked":"jstree-checked")}}}tmp=[];for(i=0,j=this._data[t?"core":"checkbox"].selected.length;i<j;i++){if((s.indexOf("down")===-1||$.inArray(this._data[t?"core":"checkbox"].selected[i],obj.children_d)===-1)&&(s.indexOf("up")===-1||$.inArray(this._data[t?"core":"checkbox"].selected[i],obj.parents)===-1)){tmp.push(this._data[t?"core":"checkbox"].selected[i])}}this._data[t?"core":"checkbox"].selected=$.vakata.array_unique(tmp);if(s.indexOf("down")!==-1&&dom.length){dom.find(".jstree-anchor").removeClass(t?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",false)}},this))}if(this.settings.checkbox.cascade.indexOf("up")!==-1){this.element.on("delete_node.jstree",$.proxy(function(e,data){var p=this.get_node(data.parent),m=this._model.data,i,j,c,tmp,t=this.settings.checkbox.tie_selection;while(p&&p.id!=="#"){c=0;for(i=0,j=p.children.length;i<j;i++){c+=m[p.children[i]].state[t?"selected":"checked"]}if(c===j){p.state[t?"selected":"checked"]=true;this._data[t?"core":"checkbox"].selected.push(p.id);tmp=this.get_node(p,true);if(tmp&&tmp.length){tmp.attr("aria-selected",true).children(".jstree-anchor").addClass(t?"jstree-clicked":"jstree-checked")}}else{break}p=this.get_node(p.parent)}},this)).on("move_node.jstree",$.proxy(function(e,data){var is_multi=data.is_multi,old_par=data.old_parent,new_par=this.get_node(data.parent),m=this._model.data,p,c,i,j,tmp,t=this.settings.checkbox.tie_selection;if(!is_multi){p=this.get_node(old_par);while(p&&p.id!=="#"){c=0;for(i=0,j=p.children.length;i<j;i++){c+=m[p.children[i]].state[t?"selected":"checked"]}if(c===j){p.state[t?"selected":"checked"]=true;this._data[t?"core":"checkbox"].selected.push(p.id);tmp=this.get_node(p,true);if(tmp&&tmp.length){tmp.attr("aria-selected",true).children(".jstree-anchor").addClass(t?"jstree-clicked":"jstree-checked")}}else{break}p=this.get_node(p.parent)}}p=new_par;while(p&&p.id!=="#"){c=0;for(i=0,j=p.children.length;i<j;i++){c+=m[p.children[i]].state[t?"selected":"checked"]}if(c===j){if(!p.state[t?"selected":"checked"]){p.state[t?"selected":"checked"]=true;this._data[t?"core":"checkbox"].selected.push(p.id);tmp=this.get_node(p,true);if(tmp&&tmp.length){tmp.attr("aria-selected",true).children(".jstree-anchor").addClass(t?"jstree-clicked":"jstree-checked")}}}else{if(p.state[t?"selected":"checked"]){p.state[t?"selected":"checked"]=false;this._data[t?"core":"checkbox"].selected=$.vakata.array_remove_item(this._data[t?"core":"checkbox"].selected,p.id);tmp=this.get_node(p,true);if(tmp&&tmp.length){tmp.attr("aria-selected",false).children(".jstree-anchor").removeClass(t?"jstree-clicked":"jstree-checked")}}else{break}}p=this.get_node(p.parent)}},this))}};this._undetermined=function(){if(this.element===null){return}var i,j,k,l,o={},m=this._model.data,t=this.settings.checkbox.tie_selection,s=this._data[t?"core":"checkbox"].selected,p=[],tt=this;for(i=0,j=s.length;i<j;i++){if(m[s[i]]&&m[s[i]].parents){for(k=0,l=m[s[i]].parents.length;k<l;k++){if(o[m[s[i]].parents[k]]===undefined&&m[s[i]].parents[k]!=="#"){o[m[s[i]].parents[k]]=true;p.push(m[s[i]].parents[k])}}}}this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var tmp=tt.get_node(this),tmp2;if(!tmp.state.loaded){if(tmp.original&&tmp.original.state&&tmp.original.state.undetermined&&tmp.original.state.undetermined===true){if(o[tmp.id]===undefined&&tmp.id!=="#"){o[tmp.id]=true;p.push(tmp.id)}for(k=0,l=tmp.parents.length;k<l;k++){if(o[tmp.parents[k]]===undefined&&tmp.parents[k]!=="#"){o[tmp.parents[k]]=true;p.push(tmp.parents[k])}}}}else{for(i=0,j=tmp.children_d.length;i<j;i++){tmp2=m[tmp.children_d[i]];if(!tmp2.state.loaded&&tmp2.original&&tmp2.original.state&&tmp2.original.state.undetermined&&tmp2.original.state.undetermined===true){if(o[tmp2.id]===undefined&&tmp2.id!=="#"){o[tmp2.id]=true;p.push(tmp2.id)}for(k=0,l=tmp2.parents.length;k<l;k++){if(o[tmp2.parents[k]]===undefined&&tmp2.parents[k]!=="#"){o[tmp2.parents[k]]=true;p.push(tmp2.parents[k])}}}}}});this.element.find(".jstree-undetermined").removeClass("jstree-undetermined");for(i=0,j=p.length;i<j;i++){if(!m[p[i]].state[t?"selected":"checked"]){s=this.get_node(p[i],true);if(s&&s.length){s.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined")}}}};this.redraw_node=function(obj,deep,is_callback,force_render){obj=parent.redraw_node.apply(this,arguments);if(obj){var i,j,tmp=null;for(i=0,j=obj.childNodes.length;i<j;i++){if(obj.childNodes[i]&&obj.childNodes[i].className&&obj.childNodes[i].className.indexOf("jstree-anchor")!==-1){tmp=obj.childNodes[i];break}}if(tmp){if(!this.settings.checkbox.tie_selection&&this._model.data[obj.id].state.checked){tmp.className+=" jstree-checked"}tmp.insertBefore(_i.cloneNode(false),tmp.childNodes[0])}}if(!is_callback&&this.settings.checkbox.cascade.indexOf("undetermined")!==-1){if(this._data.checkbox.uto){clearTimeout(this._data.checkbox.uto)}this._data.checkbox.uto=setTimeout($.proxy(this._undetermined,this),50)}return obj};this.show_checkboxes=function(){this._data.core.themes.checkboxes=true;this.get_container_ul().removeClass("jstree-no-checkboxes")};this.hide_checkboxes=function(){this._data.core.themes.checkboxes=false;this.get_container_ul().addClass("jstree-no-checkboxes")};this.toggle_checkboxes=function(){if(this._data.core.themes.checkboxes){this.hide_checkboxes()}else{this.show_checkboxes()}};this.is_undetermined=function(obj){obj=this.get_node(obj);var s=this.settings.checkbox.cascade,i,j,t=this.settings.checkbox.tie_selection,d=this._data[t?"core":"checkbox"].selected,m=this._model.data;if(!obj||obj.state[t?"selected":"checked"]===true||s.indexOf("undetermined")===-1||s.indexOf("down")===-1&&s.indexOf("up")===-1){return false}if(!obj.state.loaded&&obj.original.state.undetermined===true){return true}for(i=0,j=obj.children_d.length;i<j;i++){if($.inArray(obj.children_d[i],d)!==-1||!m[obj.children_d[i]].state.loaded&&m[obj.children_d[i]].original.state.undetermined){return true}}return false};this.activate_node=function(obj,e){if(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||$(e.target).hasClass("jstree-checkbox"))){e.ctrlKey=true}if(this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!$(e.target).hasClass("jstree-checkbox")){return parent.activate_node.call(this,obj,e)}if(this.is_disabled(obj)){return false}if(this.is_checked(obj)){this.uncheck_node(obj,e)}else{this.check_node(obj,e)}this.trigger("activate_node",{node:this.get_node(obj)})};this.check_node=function(obj,e){if(this.settings.checkbox.tie_selection){return this.select_node(obj,false,true,e)}var dom,t1,t2,th;if($.isArray(obj)){obj=obj.slice();for(t1=0,t2=obj.length;t1<t2;t1++){this.check_node(obj[t1],e)}return true}obj=this.get_node(obj);if(!obj||obj.id==="#"){return false}dom=this.get_node(obj,true);if(!obj.state.checked){obj.state.checked=true;this._data.checkbox.selected.push(obj.id);if(dom&&dom.length){dom.children(".jstree-anchor").addClass("jstree-checked")}this.trigger("check_node",{node:obj,selected:this._data.checkbox.selected,event:e})}};this.uncheck_node=function(obj,e){if(this.settings.checkbox.tie_selection){return this.deselect_node(obj,false,e)}var t1,t2,dom;if($.isArray(obj)){obj=obj.slice();for(t1=0,t2=obj.length;t1<t2;t1++){this.uncheck_node(obj[t1],e)}return true}obj=this.get_node(obj);if(!obj||obj.id==="#"){return false}dom=this.get_node(obj,true);if(obj.state.checked){obj.state.checked=false;this._data.checkbox.selected=$.vakata.array_remove_item(this._data.checkbox.selected,obj.id);if(dom.length){dom.children(".jstree-anchor").removeClass("jstree-checked")}this.trigger("uncheck_node",{node:obj,selected:this._data.checkbox.selected,event:e})}};this.check_all=function(){if(this.settings.checkbox.tie_selection){return this.select_all()}var tmp=this._data.checkbox.selected.concat([]),i,j;this._data.checkbox.selected=this._model.data["#"].children_d.concat();for(i=0,j=this._data.checkbox.selected.length;i<j;i++){if(this._model.data[this._data.checkbox.selected[i]]){this._model.data[this._data.checkbox.selected[i]].state.checked=true}}this.redraw(true);this.trigger("check_all",{selected:this._data.checkbox.selected})};this.uncheck_all=function(){if(this.settings.checkbox.tie_selection){return this.deselect_all()}var tmp=this._data.checkbox.selected.concat([]),i,j;for(i=0,j=this._data.checkbox.selected.length;i<j;i++){if(this._model.data[this._data.checkbox.selected[i]]){this._model.data[this._data.checkbox.selected[i]].state.checked=false}}this._data.checkbox.selected=[];this.element.find(".jstree-checked").removeClass("jstree-checked");this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:tmp})};this.is_checked=function(obj){if(this.settings.checkbox.tie_selection){return this.is_selected(obj)}obj=this.get_node(obj);if(!obj||obj.id==="#"){return false}return obj.state.checked};this.get_checked=function(full){if(this.settings.checkbox.tie_selection){return this.get_selected(full)}return full?$.map(this._data.checkbox.selected,$.proxy(function(i){return this.get_node(i)},this)):this._data.checkbox.selected};this.get_top_checked=function(full){if(this.settings.checkbox.tie_selection){return this.get_top_selected(full)}var tmp=this.get_checked(true),obj={},i,j,k,l;for(i=0,j=tmp.length;i<j;i++){obj[tmp[i].id]=tmp[i]}for(i=0,j=tmp.length;i<j;i++){for(k=0,l=tmp[i].children_d.length;k<l;k++){if(obj[tmp[i].children_d[k]]){delete obj[tmp[i].children_d[k]]}}}tmp=[];for(i in obj){if(obj.hasOwnProperty(i)){tmp.push(i)}}return full?$.map(tmp,$.proxy(function(i){return this.get_node(i)},this)):tmp};this.get_bottom_checked=function(full){if(this.settings.checkbox.tie_selection){return this.get_bottom_selected(full)}var tmp=this.get_checked(true),obj=[],i,j;for(i=0,j=tmp.length;i<j;i++){if(!tmp[i].children.length){obj.push(tmp[i].id)}}return full?$.map(obj,$.proxy(function(i){return this.get_node(i)},this)):obj};this.load_node=function(obj,callback){var k,l,i,j,c,tmp;if(!$.isArray(obj)&&!this.settings.checkbox.tie_selection){tmp=this.get_node(obj);if(tmp&&tmp.state.loaded){for(k=0,l=tmp.children_d.length;k<l;k++){if(this._model.data[tmp.children_d[k]].state.checked){c=true;this._data.checkbox.selected=$.vakata.array_remove_item(this._data.checkbox.selected,tmp.children_d[k])}}}}return parent.load_node.apply(this,arguments)};this.get_state=function(){var state=parent.get_state.apply(this,arguments);if(this.settings.checkbox.tie_selection){return state}state.checkbox=this._data.checkbox.selected.slice();return state};this.set_state=function(state,callback){var res=parent.set_state.apply(this,arguments);if(res&&state.checkbox){if(!this.settings.checkbox.tie_selection){this.uncheck_all();var _this=this;$.each(state.checkbox,function(i,v){_this.check_node(v)})}delete state.checkbox;this.set_state(state,callback);return false}return res}};$.jstree.defaults.contextmenu={select_node:true,show_at_node:true,items:function(o,cb){return{create:{separator_before:false,separator_after:true,_disabled:false,label:"Create",action:function(data){var inst=$.jstree.reference(data.reference),obj=inst.get_node(data.reference);inst.create_node(obj,{},"last",function(new_node){setTimeout(function(){inst.edit(new_node)},0)})}},rename:{separator_before:false,separator_after:false,_disabled:false,label:"Rename",action:function(data){var inst=$.jstree.reference(data.reference),obj=inst.get_node(data.reference);inst.edit(obj)}},remove:{separator_before:false,icon:false,separator_after:false,_disabled:false,label:"Delete",action:function(data){var inst=$.jstree.reference(data.reference),obj=inst.get_node(data.reference);if(inst.is_selected(obj)){inst.delete_node(inst.get_selected())}else{inst.delete_node(obj)}}},ccp:{separator_before:true,icon:false,separator_after:false,label:"Edit",action:false,submenu:{cut:{separator_before:false,separator_after:false,label:"Cut",action:function(data){var inst=$.jstree.reference(data.reference),obj=inst.get_node(data.reference);if(inst.is_selected(obj)){inst.cut(inst.get_top_selected())}else{inst.cut(obj)}}},copy:{separator_before:false,icon:false,separator_after:false,label:"Copy",action:function(data){var inst=$.jstree.reference(data.reference),obj=inst.get_node(data.reference);if(inst.is_selected(obj)){inst.copy(inst.get_top_selected())}else{inst.copy(obj)}}},paste:{separator_before:false,icon:false,_disabled:function(data){return!$.jstree.reference(data.reference).can_paste()},separator_after:false,label:"Paste",action:function(data){var inst=$.jstree.reference(data.reference),obj=inst.get_node(data.reference);inst.paste(obj)}}}}}}};$.jstree.plugins.contextmenu=function(options,parent){this.bind=function(){parent.bind.call(this);var last_ts=0,cto=null,ex,ey;this.element.on("contextmenu.jstree",".jstree-anchor",$.proxy(function(e,data){e.preventDefault();last_ts=e.ctrlKey?+new Date:0;if(data||cto){last_ts=+new Date+1e4}if(cto){clearTimeout(cto)}if(!this.is_loading(e.currentTarget)){this.show_contextmenu(e.currentTarget,e.pageX,e.pageY,e)}},this)).on("click.jstree",".jstree-anchor",$.proxy(function(e){if(this._data.contextmenu.visible&&(!last_ts||+new Date-last_ts>250)){$.vakata.context.hide()}last_ts=0},this)).on("touchstart.jstree",".jstree-anchor",function(e){if(!e.originalEvent||!e.originalEvent.changedTouches||!e.originalEvent.changedTouches[0]){return}ex=e.pageX;ey=e.pageY;cto=setTimeout(function(){$(e.currentTarget).trigger("contextmenu",true)},750)}).on("touchmove.vakata.jstree",function(e){if(cto&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(Math.abs(ex-e.pageX)>50||Math.abs(ey-e.pageY)>50)){clearTimeout(cto)}}).on("touchend.vakata.jstree",function(e){if(cto){clearTimeout(cto)}});$(document).on("context_hide.vakata.jstree",$.proxy(function(){this._data.contextmenu.visible=false},this))};this.teardown=function(){if(this._data.contextmenu.visible){$.vakata.context.hide()}parent.teardown.call(this)};this.show_contextmenu=function(obj,x,y,e){obj=this.get_node(obj);if(!obj||obj.id==="#"){return false}var s=this.settings.contextmenu,d=this.get_node(obj,true),a=d.children(".jstree-anchor"),o=false,i=false;if(s.show_at_node||x===undefined||y===undefined){o=a.offset();x=o.left;y=o.top+this._data.core.li_height}if(this.settings.contextmenu.select_node&&!this.is_selected(obj)){this.activate_node(obj,e)}i=s.items;if($.isFunction(i)){i=i.call(this,obj,$.proxy(function(i){this._show_contextmenu(obj,x,y,i)},this))}if($.isPlainObject(i)){this._show_contextmenu(obj,x,y,i)}};this._show_contextmenu=function(obj,x,y,i){var d=this.get_node(obj,true),a=d.children(".jstree-anchor");$(document).one("context_show.vakata.jstree",$.proxy(function(e,data){var cls="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";$(data.element).addClass(cls)},this));this._data.contextmenu.visible=true;$.vakata.context.show(a,{x:x,y:y},i);this.trigger("show_contextmenu",{node:obj,x:x,y:y})}};(function($){var right_to_left=false,vakata_context={element:false,reference:false,position_x:0,position_y:0,items:[],html:"",is_visible:false};$.vakata.context={settings:{hide_onmouseleave:0,icons:true},_trigger:function(event_name){$(document).triggerHandler("context_"+event_name+".vakata",{reference:vakata_context.reference,element:vakata_context.element,position:{x:vakata_context.position_x,y:vakata_context.position_y}})},_execute:function(i){i=vakata_context.items[i];return i&&(!i._disabled||$.isFunction(i._disabled)&&!i._disabled({item:i,reference:vakata_context.reference,element:vakata_context.element}))&&i.action?i.action.call(null,{item:i,reference:vakata_context.reference,element:vakata_context.element,position:{x:vakata_context.position_x,y:vakata_context.position_y}}):false},_parse:function(o,is_callback){if(!o){return false}if(!is_callback){vakata_context.html="";vakata_context.items=[]}var str="",sep=false,tmp;if(is_callback){str+="<"+"ul>"}$.each(o,function(i,val){if(!val){return true}vakata_context.items.push(val);if(!sep&&val.separator_before){str+="<"+"li class='vakata-context-separator'><"+"a href='#' "+($.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;<"+"/a><"+"/li>"}sep=false;str+="<"+"li class='"+(val._class||"")+(val._disabled===true||$.isFunction(val._disabled)&&val._disabled({item:val,reference:vakata_context.reference,element:vakata_context.element})?" vakata-contextmenu-disabled ":"")+"' "+(val.shortcut?" data-shortcut='"+val.shortcut+"' ":"")+">";str+="<"+"a href='#' rel='"+(vakata_context.items.length-1)+"'>";if($.vakata.context.settings.icons){str+="<"+"i ";if(val.icon){if(val.icon.indexOf("/")!==-1||val.icon.indexOf(".")!==-1){str+=" style='background:url(\""+val.icon+"\") center center no-repeat' "}else{str+=" class='"+val.icon+"' "}}str+="><"+"/i><"+"span class='vakata-contextmenu-sep'>&#160;<"+"/span>"}str+=($.isFunction(val.label)?val.label({item:i,reference:vakata_context.reference,element:vakata_context.element}):val.label)+(val.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+val.shortcut+'">'+(val.shortcut_label||"")+"</span>":"")+"<"+"/a>";if(val.submenu){tmp=$.vakata.context._parse(val.submenu,true);if(tmp){str+=tmp}}str+="<"+"/li>";if(val.separator_after){str+="<"+"li class='vakata-context-separator'><"+"a href='#' "+($.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;<"+"/a><"+"/li>";sep=true}});str=str.replace(/<li class\='vakata-context-separator'\><\/li\>$/,"");if(is_callback){str+="</ul>"}if(!is_callback){vakata_context.html=str;$.vakata.context._trigger("parse")}return str.length>10?str:false},_show_submenu:function(o){o=$(o);if(!o.length||!o.children("ul").length){return}var e=o.children("ul"),x=o.offset().left+o.outerWidth(),y=o.offset().top,w=e.width(),h=e.height(),dw=$(window).width()+$(window).scrollLeft(),dh=$(window).height()+$(window).scrollTop();if(right_to_left){o[x-(w+10+o.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left");
}else{o[x+w+10>dw?"addClass":"removeClass"]("vakata-context-right")}if(y+h+10>dh){e.css("bottom","-1px")}e.show()},show:function(reference,position,data){var o,e,x,y,w,h,dw,dh,cond=true;if(vakata_context.element&&vakata_context.element.length){vakata_context.element.width("")}switch(cond){case!position&&!reference:return false;case!!position&&!!reference:vakata_context.reference=reference;vakata_context.position_x=position.x;vakata_context.position_y=position.y;break;case!position&&!!reference:vakata_context.reference=reference;o=reference.offset();vakata_context.position_x=o.left+reference.outerHeight();vakata_context.position_y=o.top;break;case!!position&&!reference:vakata_context.position_x=position.x;vakata_context.position_y=position.y;break}if(!!reference&&!data&&$(reference).data("vakata_contextmenu")){data=$(reference).data("vakata_contextmenu")}if($.vakata.context._parse(data)){vakata_context.element.html(vakata_context.html)}if(vakata_context.items.length){vakata_context.element.appendTo("body");e=vakata_context.element;x=vakata_context.position_x;y=vakata_context.position_y;w=e.width();h=e.height();dw=$(window).width()+$(window).scrollLeft();dh=$(window).height()+$(window).scrollTop();if(right_to_left){x-=e.outerWidth()-$(reference).outerWidth();if(x<$(window).scrollLeft()+20){x=$(window).scrollLeft()+20}}if(x+w+20>dw){x=dw-(w+20)}if(y+h+20>dh){y=dh-(h+20)}vakata_context.element.css({left:x,top:y}).show().find("a").first().focus().parent().addClass("vakata-context-hover");vakata_context.is_visible=true;$.vakata.context._trigger("show")}},hide:function(){if(vakata_context.is_visible){vakata_context.element.hide().find("ul").hide().end().find(":focus").blur().end().detach();vakata_context.is_visible=false;$.vakata.context._trigger("hide")}}};$(function(){right_to_left=$("body").css("direction")==="rtl";var to=false;vakata_context.element=$("<ul class='vakata-context'></ul>");vakata_context.element.on("mouseenter","li",function(e){e.stopImmediatePropagation();if($.contains(this,e.relatedTarget)){return}if(to){clearTimeout(to)}vakata_context.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end();$(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover");$.vakata.context._show_submenu(this)}).on("mouseleave","li",function(e){if($.contains(this,e.relatedTarget)){return}$(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(e){$(this).find(".vakata-context-hover").removeClass("vakata-context-hover");if($.vakata.context.settings.hide_onmouseleave){to=setTimeout(function(t){return function(){$.vakata.context.hide()}}(this),$.vakata.context.settings.hide_onmouseleave)}}).on("click","a",function(e){e.preventDefault();if(!$(this).blur().parent().hasClass("vakata-context-disabled")&&$.vakata.context._execute($(this).attr("rel"))!==false){$.vakata.context.hide()}}).on("keydown","a",function(e){var o=null;switch(e.which){case 13:case 32:e.type="mouseup";e.preventDefault();$(e.currentTarget).trigger(e);break;case 37:if(vakata_context.is_visible){vakata_context.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus();e.stopImmediatePropagation();e.preventDefault()}break;case 38:if(vakata_context.is_visible){o=vakata_context.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first();if(!o.length){o=vakata_context.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()}o.addClass("vakata-context-hover").children("a").focus();e.stopImmediatePropagation();e.preventDefault()}break;case 39:if(vakata_context.is_visible){vakata_context.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus();e.stopImmediatePropagation();e.preventDefault()}break;case 40:if(vakata_context.is_visible){o=vakata_context.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first();if(!o.length){o=vakata_context.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()}o.addClass("vakata-context-hover").children("a").focus();e.stopImmediatePropagation();e.preventDefault()}break;case 27:$.vakata.context.hide();e.preventDefault();break;default:break}}).on("keydown",function(e){e.preventDefault();var a=vakata_context.element.find(".vakata-contextmenu-shortcut-"+e.which).parent();if(a.parent().not(".vakata-context-disabled")){a.click()}});$(document).on("mousedown.vakata.jstree",function(e){if(vakata_context.is_visible&&!$.contains(vakata_context.element[0],e.target)){$.vakata.context.hide()}}).on("context_show.vakata.jstree",function(e,data){vakata_context.element.find("li:has(ul)").children("a").addClass("vakata-context-parent");if(right_to_left){vakata_context.element.addClass("vakata-context-rtl").css("direction","rtl")}vakata_context.element.find("ul").hide().end()})})})($);$.jstree.defaults.dnd={copy:true,open_timeout:500,is_draggable:true,check_while_dragging:true,always_copy:false,inside_pos:0,drag_selection:true,touch:true,large_drop_target:false,large_drag_target:false};$.jstree.plugins.dnd=function(options,parent){this.bind=function(){parent.bind.call(this);this.element.on("mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",$.proxy(function(e){if(this.settings.dnd.large_drag_target&&$(e.target).closest(".jstree-node")[0]!==e.currentTarget){return true}if(e.type==="touchstart"&&(!this.settings.dnd.touch||this.settings.dnd.touch==="selected"&&!$(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked"))){return true}var obj=this.get_node(e.target),mlt=this.is_selected(obj)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,txt=mlt>1?mlt+" "+this.get_string("nodes"):this.get_text(e.currentTarget);if(this.settings.core.force_text){txt=$.vakata.html.escape(txt)}if(obj&&obj.id&&obj.id!=="#"&&(e.which===1||e.type==="touchstart")&&(this.settings.dnd.is_draggable===true||$.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,mlt>1?this.get_top_selected(true):[obj]))){this.element.trigger("mousedown.jstree");return $.vakata.dnd.start(e,{jstree:true,origin:this,obj:this.get_node(obj,true),nodes:mlt>1?this.get_top_selected():[obj.id]},'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+txt+'<ins class="jstree-copy" style="display:none;">+</ins></div>')}},this))}};$(function(){var lastmv=false,laster=false,opento=false,marker=$('<div id="jstree-marker">&#160;</div>').hide();$(document).on("dnd_start.vakata.jstree",function(e,data){lastmv=false;if(!data||!data.data||!data.data.jstree){return}marker.appendTo("body")}).on("dnd_move.vakata.jstree",function(e,data){if(opento){clearTimeout(opento)}if(!data||!data.data||!data.data.jstree){return}if(data.event.target.id&&data.event.target.id==="jstree-marker"){return}var ins=$.jstree.reference(data.event.target),ref=false,off=false,rel=false,tmp,l,t,h,p,i,o,ok,t1,t2,op,ps,pr,ip,tm;if(ins&&ins._data&&ins._data.dnd){marker.attr("class","jstree-"+ins.get_theme()+(ins.settings.core.themes.responsive?" jstree-dnd-responsive":""));data.helper.children().attr("class","jstree-"+ins.get_theme()+" jstree-"+ins.get_theme()+"-"+ins.get_theme_variant()+" "+(ins.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[data.data.origin&&(data.data.origin.settings.dnd.always_copy||data.data.origin.settings.dnd.copy&&(data.event.metaKey||data.event.ctrlKey))?"show":"hide"]();if((data.event.target===ins.element[0]||data.event.target===ins.get_container_ul()[0])&&ins.get_container_ul().children().length===0){ok=true;for(t1=0,t2=data.data.nodes.length;t1<t2;t1++){ok=ok&&ins.check(data.data.origin&&(data.data.origin.settings.dnd.always_copy||data.data.origin.settings.dnd.copy&&(data.event.metaKey||data.event.ctrlKey))?"copy_node":"move_node",data.data.origin&&data.data.origin!==ins?data.data.origin.get_node(data.data.nodes[t1]):data.data.nodes[t1],"#","last",{dnd:true,ref:ins.get_node("#"),pos:"i",origin:data.data.origin,is_multi:data.data.origin&&data.data.origin!==ins,is_foreign:!data.data.origin});if(!ok){break}}if(ok){lastmv={ins:ins,par:"#",pos:"last"};marker.hide();data.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok");return}}else{ref=ins.settings.dnd.large_drop_target?$(data.event.target).closest(".jstree-node").children(".jstree-anchor"):$(data.event.target).closest(".jstree-anchor");if(ref&&ref.length&&ref.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")){off=ref.offset();rel=data.event.pageY-off.top;h=ref.outerHeight();if(rel<h/3){o=["b","i","a"]}else if(rel>h-h/3){o=["a","i","b"]}else{o=rel>h/2?["i","a","b"]:["i","b","a"]}$.each(o,function(j,v){switch(v){case"b":l=off.left-6;t=off.top;p=ins.get_parent(ref);i=ref.parent().index();break;case"i":ip=ins.settings.dnd.inside_pos;tm=ins.get_node(ref.parent());l=off.left-2;t=off.top+h/2+1;p=tm.id;i=ip==="first"?0:ip==="last"?tm.children.length:Math.min(ip,tm.children.length);break;case"a":l=off.left-6;t=off.top+h;p=ins.get_parent(ref);i=ref.parent().index()+1;break}ok=true;for(t1=0,t2=data.data.nodes.length;t1<t2;t1++){op=data.data.origin&&(data.data.origin.settings.dnd.always_copy||data.data.origin.settings.dnd.copy&&(data.event.metaKey||data.event.ctrlKey))?"copy_node":"move_node";ps=i;if(op==="move_node"&&v==="a"&&(data.data.origin&&data.data.origin===ins)&&p===ins.get_parent(data.data.nodes[t1])){pr=ins.get_node(p);if(ps>$.inArray(data.data.nodes[t1],pr.children)){ps-=1}}ok=ok&&(ins&&ins.settings&&ins.settings.dnd&&ins.settings.dnd.check_while_dragging===false||ins.check(op,data.data.origin&&data.data.origin!==ins?data.data.origin.get_node(data.data.nodes[t1]):data.data.nodes[t1],p,ps,{dnd:true,ref:ins.get_node(ref.parent()),pos:v,origin:data.data.origin,is_multi:data.data.origin&&data.data.origin!==ins,is_foreign:!data.data.origin}));if(!ok){if(ins&&ins.last_error){laster=ins.last_error()}break}}if(v==="i"&&ref.parent().is(".jstree-closed")&&ins.settings.dnd.open_timeout){opento=setTimeout(function(x,z){return function(){x.open_node(z)}}(ins,ref),ins.settings.dnd.open_timeout)}if(ok){lastmv={ins:ins,par:p,pos:v==="i"&&ip==="last"&&i===0&&!ins.is_loaded(tm)?"last":i};marker.css({left:l+"px",top:t+"px"}).show();data.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok");laster={};o=true;return false}});if(o===true){return}}}}lastmv=false;data.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er");marker.hide()}).on("dnd_scroll.vakata.jstree",function(e,data){if(!data||!data.data||!data.data.jstree){return}marker.hide();lastmv=false;data.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er")}).on("dnd_stop.vakata.jstree",function(e,data){if(opento){clearTimeout(opento)}if(!data||!data.data||!data.data.jstree){return}marker.hide().detach();var i,j,nodes=[];if(lastmv){for(i=0,j=data.data.nodes.length;i<j;i++){nodes[i]=data.data.origin?data.data.origin.get_node(data.data.nodes[i]):data.data.nodes[i]}lastmv.ins[data.data.origin&&(data.data.origin.settings.dnd.always_copy||data.data.origin.settings.dnd.copy&&(data.event.metaKey||data.event.ctrlKey))?"copy_node":"move_node"](nodes,lastmv.par,lastmv.pos,false,false,false,data.data.origin)}else{i=$(data.event.target).closest(".jstree");if(i.length&&laster&&laster.error&&laster.error==="check"){i=i.jstree(true);if(i){i.settings.core.error.call(this,laster)}}}}).on("keyup.jstree keydown.jstree",function(e,data){data=$.vakata.dnd._get();if(data&&data.data&&data.data.jstree){data.helper.find(".jstree-copy").first()[data.data.origin&&(data.data.origin.settings.dnd.always_copy||data.data.origin.settings.dnd.copy&&(e.metaKey||e.ctrlKey))?"show":"hide"]()}})});(function($){$.vakata.html={div:$("<div />"),escape:function(str){return $.vakata.html.div.text(str).html()},strip:function(str){return $.vakata.html.div.empty().append($.parseHTML(str)).text()}};var vakata_dnd={element:false,target:false,is_down:false,is_drag:false,helper:false,helper_w:0,data:false,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:false,scroll_i:false,is_touch:false};$.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:50},_trigger:function(event_name,e){var data=$.vakata.dnd._get();data.event=e;$(document).triggerHandler("dnd_"+event_name+".vakata",data)},_get:function(){return{data:vakata_dnd.data,element:vakata_dnd.element,helper:vakata_dnd.helper}},_clean:function(){if(vakata_dnd.helper){vakata_dnd.helper.remove()}if(vakata_dnd.scroll_i){clearInterval(vakata_dnd.scroll_i);vakata_dnd.scroll_i=false}vakata_dnd={element:false,target:false,is_down:false,is_drag:false,helper:false,helper_w:0,data:false,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:false,scroll_i:false,is_touch:false};$(document).off("mousemove.vakata.jstree touchmove.vakata.jstree",$.vakata.dnd.drag);$(document).off("mouseup.vakata.jstree touchend.vakata.jstree",$.vakata.dnd.stop)},_scroll:function(init_only){if(!vakata_dnd.scroll_e||!vakata_dnd.scroll_l&&!vakata_dnd.scroll_t){if(vakata_dnd.scroll_i){clearInterval(vakata_dnd.scroll_i);vakata_dnd.scroll_i=false}return false}if(!vakata_dnd.scroll_i){vakata_dnd.scroll_i=setInterval($.vakata.dnd._scroll,100);return false}if(init_only===true){return false}var i=vakata_dnd.scroll_e.scrollTop(),j=vakata_dnd.scroll_e.scrollLeft();vakata_dnd.scroll_e.scrollTop(i+vakata_dnd.scroll_t*$.vakata.dnd.settings.scroll_speed);vakata_dnd.scroll_e.scrollLeft(j+vakata_dnd.scroll_l*$.vakata.dnd.settings.scroll_speed);if(i!==vakata_dnd.scroll_e.scrollTop()||j!==vakata_dnd.scroll_e.scrollLeft()){$.vakata.dnd._trigger("scroll",vakata_dnd.scroll_e)}},start:function(e,data,html){if(e.type==="touchstart"&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]){e.pageX=e.originalEvent.changedTouches[0].pageX;e.pageY=e.originalEvent.changedTouches[0].pageY;e.target=document.elementFromPoint(e.originalEvent.changedTouches[0].pageX-window.pageXOffset,e.originalEvent.changedTouches[0].pageY-window.pageYOffset)}if(vakata_dnd.is_drag){$.vakata.dnd.stop({})}try{e.currentTarget.unselectable="on";e.currentTarget.onselectstart=function(){return false};if(e.currentTarget.style){e.currentTarget.style.MozUserSelect="none"}}catch(ignore){}vakata_dnd.init_x=e.pageX;vakata_dnd.init_y=e.pageY;vakata_dnd.data=data;vakata_dnd.is_down=true;vakata_dnd.element=e.currentTarget;vakata_dnd.target=e.target;vakata_dnd.is_touch=e.type==="touchstart";if(html!==false){vakata_dnd.helper=$("<div id='vakata-dnd'></div>").html(html).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})}$(document).on("mousemove.vakata.jstree touchmove.vakata.jstree",$.vakata.dnd.drag);$(document).on("mouseup.vakata.jstree touchend.vakata.jstree",$.vakata.dnd.stop);return false},drag:function(e){if(e.type==="touchmove"&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]){e.pageX=e.originalEvent.changedTouches[0].pageX;e.pageY=e.originalEvent.changedTouches[0].pageY;e.target=document.elementFromPoint(e.originalEvent.changedTouches[0].pageX-window.pageXOffset,e.originalEvent.changedTouches[0].pageY-window.pageYOffset)}if(!vakata_dnd.is_down){return}if(!vakata_dnd.is_drag){if(Math.abs(e.pageX-vakata_dnd.init_x)>(vakata_dnd.is_touch?$.vakata.dnd.settings.threshold_touch:$.vakata.dnd.settings.threshold)||Math.abs(e.pageY-vakata_dnd.init_y)>(vakata_dnd.is_touch?$.vakata.dnd.settings.threshold_touch:$.vakata.dnd.settings.threshold)){if(vakata_dnd.helper){vakata_dnd.helper.appendTo("body");vakata_dnd.helper_w=vakata_dnd.helper.outerWidth()}vakata_dnd.is_drag=true;$.vakata.dnd._trigger("start",e)}else{return}}var d=false,w=false,dh=false,wh=false,dw=false,ww=false,dt=false,dl=false,ht=false,hl=false;vakata_dnd.scroll_t=0;vakata_dnd.scroll_l=0;vakata_dnd.scroll_e=false;$($(e.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test($(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var t=$(this),o=t.offset();if(this.scrollHeight>this.offsetHeight){if(o.top+t.height()-e.pageY<$.vakata.dnd.settings.scroll_proximity){vakata_dnd.scroll_t=1}if(e.pageY-o.top<$.vakata.dnd.settings.scroll_proximity){vakata_dnd.scroll_t=-1}}if(this.scrollWidth>this.offsetWidth){if(o.left+t.width()-e.pageX<$.vakata.dnd.settings.scroll_proximity){vakata_dnd.scroll_l=1}if(e.pageX-o.left<$.vakata.dnd.settings.scroll_proximity){vakata_dnd.scroll_l=-1}}if(vakata_dnd.scroll_t||vakata_dnd.scroll_l){vakata_dnd.scroll_e=$(this);return false}});if(!vakata_dnd.scroll_e){d=$(document);w=$(window);dh=d.height();wh=w.height();dw=d.width();ww=w.width();dt=d.scrollTop();dl=d.scrollLeft();if(dh>wh&&e.pageY-dt<$.vakata.dnd.settings.scroll_proximity){vakata_dnd.scroll_t=-1}if(dh>wh&&wh-(e.pageY-dt)<$.vakata.dnd.settings.scroll_proximity){vakata_dnd.scroll_t=1}if(dw>ww&&e.pageX-dl<$.vakata.dnd.settings.scroll_proximity){vakata_dnd.scroll_l=-1}if(dw>ww&&ww-(e.pageX-dl)<$.vakata.dnd.settings.scroll_proximity){vakata_dnd.scroll_l=1}if(vakata_dnd.scroll_t||vakata_dnd.scroll_l){vakata_dnd.scroll_e=d}}if(vakata_dnd.scroll_e){$.vakata.dnd._scroll(true)}if(vakata_dnd.helper){ht=parseInt(e.pageY+$.vakata.dnd.settings.helper_top,10);hl=parseInt(e.pageX+$.vakata.dnd.settings.helper_left,10);if(dh&&ht+25>dh){ht=dh-50}if(dw&&hl+vakata_dnd.helper_w>dw){hl=dw-(vakata_dnd.helper_w+2)}vakata_dnd.helper.css({left:hl+"px",top:ht+"px"})}$.vakata.dnd._trigger("move",e);return false},stop:function(e){if(e.type==="touchend"&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]){e.pageX=e.originalEvent.changedTouches[0].pageX;e.pageY=e.originalEvent.changedTouches[0].pageY;e.target=document.elementFromPoint(e.originalEvent.changedTouches[0].pageX-window.pageXOffset,e.originalEvent.changedTouches[0].pageY-window.pageYOffset)}if(vakata_dnd.is_drag){$.vakata.dnd._trigger("stop",e)}else{if(e.type==="touchend"&&e.target===vakata_dnd.target){var to=setTimeout(function(){$(e.target).click()},100);$(e.target).one("click",function(){if(to){clearTimeout(to)}})}}$.vakata.dnd._clean();return false}}})($);$.jstree.defaults.massload=null;$.jstree.plugins.massload=function(options,parent){this.init=function(el,options){parent.init.call(this,el,options);this._data.massload={}};this._load_nodes=function(nodes,callback,is_callback){var s=this.settings.massload;if(is_callback&&!$.isEmptyObject(this._data.massload)){return parent._load_nodes.call(this,nodes,callback,is_callback)}if($.isFunction(s)){return s.call(this,nodes,$.proxy(function(data){if(data){for(var i in data){if(data.hasOwnProperty(i)){this._data.massload[i]=data[i]}}}parent._load_nodes.call(this,nodes,callback,is_callback)},this))}if(typeof s==="object"&&s&&s.url){s=$.extend(true,{},s);if($.isFunction(s.url)){s.url=s.url.call(this,nodes)}if($.isFunction(s.data)){s.data=s.data.call(this,nodes)}return $.ajax(s).done($.proxy(function(data,t,x){if(data){for(var i in data){if(data.hasOwnProperty(i)){this._data.massload[i]=data[i]}}}parent._load_nodes.call(this,nodes,callback,is_callback)},this)).fail($.proxy(function(f){parent._load_nodes.call(this,nodes,callback,is_callback)},this))}return parent._load_nodes.call(this,nodes,callback,is_callback)};this._load_node=function(obj,callback){var d=this._data.massload[obj.id];if(d){return this[typeof d==="string"?"_append_html_data":"_append_json_data"](obj,typeof d==="string"?$($.parseHTML(d)).filter(function(){return this.nodeType!==3}):d,function(status){callback.call(this,status);delete this._data.massload[obj.id]})}return parent._load_node.call(this,obj,callback)}};$.jstree.defaults.search={ajax:false,fuzzy:false,case_sensitive:false,show_only_matches:false,show_only_matches_children:false,close_opened_onclear:true,search_leaves_only:false,search_callback:false};$.jstree.plugins.search=function(options,parent){this.bind=function(){parent.bind.call(this);this._data.search.str="";this._data.search.dom=$();this._data.search.res=[];this._data.search.opn=[];this._data.search.som=false;this._data.search.smc=false;this.element.on("before_open.jstree",$.proxy(function(e,data){var i,j,f,r=this._data.search.res,s=[],o=$();if(r&&r.length){this._data.search.dom=$(this.element[0].querySelectorAll("#"+$.map(r,function(v){return"0123456789".indexOf(v[0])!==-1?"\\3"+v[0]+" "+v.substr(1).replace($.jstree.idregex,"\\$&"):v.replace($.jstree.idregex,"\\$&")}).join(", #")));this._data.search.dom.children(".jstree-anchor").addClass("jstree-search");if(this._data.search.som&&this._data.search.res.length){for(i=0,j=r.length;i<j;i++){s=s.concat(this.get_node(r[i]).parents)}s=$.vakata.array_remove_item($.vakata.array_unique(s),"#");o=s.length?$(this.element[0].querySelectorAll("#"+$.map(s,function(v){return"0123456789".indexOf(v[0])!==-1?"\\3"+v[0]+" "+v.substr(1).replace($.jstree.idregex,"\\$&"):v.replace($.jstree.idregex,"\\$&")}).join(", #"))):$();this.element.find(".jstree-node").hide().filter(".jstree-last").filter(function(){return this.nextSibling}).removeClass("jstree-last");o=o.add(this._data.search.dom);if(this._data.search.smc){this._data.search.dom.children(".jstree-children").find(".jstree-node").show()}o.parentsUntil(".jstree").addBack().show().filter(".jstree-children").each(function(){$(this).children(".jstree-node:visible").eq(-1).addClass("jstree-last")})}}},this)).on("search.jstree",$.proxy(function(e,data){if(this._data.search.som){if(data.nodes.length){this.element.find(".jstree-node").hide().filter(".jstree-last").filter(function(){return this.nextSibling}).removeClass("jstree-last");if(this._data.search.smc){data.nodes.children(".jstree-children").find(".jstree-node").show()}data.nodes.parentsUntil(".jstree").addBack().show().filter(".jstree-children").each(function(){$(this).children(".jstree-node:visible").eq(-1).addClass("jstree-last")})}}},this)).on("clear_search.jstree",$.proxy(function(e,data){if(this._data.search.som&&data.nodes.length){this.element.find(".jstree-node").css("display","").filter(".jstree-last").filter(function(){return this.nextSibling}).removeClass("jstree-last")}},this))};this.search=function(str,skip_async,show_only_matches,inside,append,show_only_matches_children){if(str===false||$.trim(str.toString())===""){return this.clear_search()}inside=this.get_node(inside);inside=inside&&inside.id?inside.id:null;str=str.toString();var s=this.settings.search,a=s.ajax?s.ajax:false,m=this._model.data,f=null,r=[],p=[],i,j;if(this._data.search.res.length&&!append){this.clear_search()}if(show_only_matches===undefined){show_only_matches=s.show_only_matches}if(show_only_matches_children===undefined){show_only_matches_children=s.show_only_matches_children}if(!skip_async&&a!==false){if($.isFunction(a)){return a.call(this,str,$.proxy(function(d){if(d&&d.d){d=d.d}this._load_nodes(!$.isArray(d)?[]:$.vakata.array_unique(d),function(){this.search(str,true,show_only_matches,inside,append)},true)},this),inside)}else{a=$.extend({},a);if(!a.data){a.data={}}a.data.str=str;if(inside){a.data.inside=inside}return $.ajax(a).fail($.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(a)};this.settings.core.error.call(this,this._data.core.last_error)},this)).done($.proxy(function(d){if(d&&d.d){d=d.d}this._load_nodes(!$.isArray(d)?[]:$.vakata.array_unique(d),function(){this.search(str,true,show_only_matches,inside,append)},true)},this))}}if(!append){this._data.search.str=str;this._data.search.dom=$();this._data.search.res=[];this._data.search.opn=[];this._data.search.som=show_only_matches;this._data.search.smc=show_only_matches_children}f=new $.vakata.search(str,true,{caseSensitive:s.case_sensitive,fuzzy:s.fuzzy});$.each(m[inside?inside:"#"].children_d,function(ii,i){var v=m[i];if(v.text&&(s.search_callback&&s.search_callback.call(this,str,v)||!s.search_callback&&f.search(v.text).isMatch)&&(!s.search_leaves_only||v.state.loaded&&v.children.length===0)){r.push(i);p=p.concat(v.parents)}});if(r.length){p=$.vakata.array_unique(p);this._search_open(p);if(!append){this._data.search.dom=$(this.element[0].querySelectorAll("#"+$.map(r,function(v){return"0123456789".indexOf(v[0])!==-1?"\\3"+v[0]+" "+v.substr(1).replace($.jstree.idregex,"\\$&"):v.replace($.jstree.idregex,"\\$&")}).join(", #")));this._data.search.res=r}else{this._data.search.dom=this._data.search.dom.add($(this.element[0].querySelectorAll("#"+$.map(r,function(v){return"0123456789".indexOf(v[0])!==-1?"\\3"+v[0]+" "+v.substr(1).replace($.jstree.idregex,"\\$&"):v.replace($.jstree.idregex,"\\$&")}).join(", #"))));this._data.search.res=$.vakata.array_unique(this._data.search.res.concat(r))}this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:str,res:this._data.search.res,show_only_matches:show_only_matches})};this.clear_search=function(){this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search");if(this.settings.search.close_opened_onclear){this.close_node(this._data.search.opn,0)}this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res});this._data.search.str="";this._data.search.res=[];this._data.search.opn=[];this._data.search.dom=$()};this._search_open=function(d){var t=this;$.each(d.concat([]),function(i,v){if(v==="#"){return true}try{v=$("#"+v.replace($.jstree.idregex,"\\$&"),t.element)}catch(ignore){}if(v&&v.length){if(t.is_closed(v)){t._data.search.opn.push(v[0].id);t.open_node(v,function(){t._search_open(d)},0)}}})}};(function($){$.vakata.search=function(pattern,txt,options){options=options||{};options=$.extend({},$.vakata.search.defaults,options);if(options.fuzzy!==false){options.fuzzy=true}pattern=options.caseSensitive?pattern:pattern.toLowerCase();var MATCH_LOCATION=options.location,MATCH_DISTANCE=options.distance,MATCH_THRESHOLD=options.threshold,patternLen=pattern.length,matchmask,pattern_alphabet,match_bitapScore,search;if(patternLen>32){options.fuzzy=false}if(options.fuzzy){matchmask=1<<patternLen-1;pattern_alphabet=function(){var mask={},i=0;for(i=0;i<patternLen;i++){mask[pattern.charAt(i)]=0}for(i=0;i<patternLen;i++){mask[pattern.charAt(i)]|=1<<patternLen-i-1}return mask}();match_bitapScore=function(e,x){var accuracy=e/patternLen,proximity=Math.abs(MATCH_LOCATION-x);if(!MATCH_DISTANCE){return proximity?1:accuracy}return accuracy+proximity/MATCH_DISTANCE}}search=function(text){text=options.caseSensitive?text:text.toLowerCase();if(pattern===text||text.indexOf(pattern)!==-1){return{isMatch:true,score:0}}if(!options.fuzzy){return{isMatch:false,score:1}}var i,j,textLen=text.length,scoreThreshold=MATCH_THRESHOLD,bestLoc=text.indexOf(pattern,MATCH_LOCATION),binMin,binMid,binMax=patternLen+textLen,lastRd,start,finish,rd,charMatch,score=1,locations=[];if(bestLoc!==-1){scoreThreshold=Math.min(match_bitapScore(0,bestLoc),scoreThreshold);bestLoc=text.lastIndexOf(pattern,MATCH_LOCATION+patternLen);if(bestLoc!==-1){scoreThreshold=Math.min(match_bitapScore(0,bestLoc),scoreThreshold)}}bestLoc=-1;for(i=0;i<patternLen;i++){binMin=0;binMid=binMax;while(binMin<binMid){if(match_bitapScore(i,MATCH_LOCATION+binMid)<=scoreThreshold){binMin=binMid}else{binMax=binMid}binMid=Math.floor((binMax-binMin)/2+binMin)}binMax=binMid;start=Math.max(1,MATCH_LOCATION-binMid+1);finish=Math.min(MATCH_LOCATION+binMid,textLen)+patternLen;rd=new Array(finish+2);rd[finish+1]=(1<<i)-1;for(j=finish;j>=start;j--){charMatch=pattern_alphabet[text.charAt(j-1)];if(i===0){rd[j]=(rd[j+1]<<1|1)&charMatch}else{rd[j]=(rd[j+1]<<1|1)&charMatch|((lastRd[j+1]|lastRd[j])<<1|1)|lastRd[j+1]}if(rd[j]&matchmask){score=match_bitapScore(i,j-1);if(score<=scoreThreshold){scoreThreshold=score;bestLoc=j-1;locations.push(bestLoc);if(bestLoc>MATCH_LOCATION){start=Math.max(1,2*MATCH_LOCATION-bestLoc)}else{break}}}}if(match_bitapScore(i+1,MATCH_LOCATION)>scoreThreshold){break}lastRd=rd}return{isMatch:bestLoc>=0,score:score}};return txt===true?{search:search}:search(txt)};$.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:false,caseSensitive:false}})($);$.jstree.defaults.sort=function(a,b){return this.get_text(a)>this.get_text(b)?1:-1};$.jstree.plugins.sort=function(options,parent){this.bind=function(){parent.bind.call(this);this.element.on("model.jstree",$.proxy(function(e,data){this.sort(data.parent,true)},this)).on("rename_node.jstree create_node.jstree",$.proxy(function(e,data){this.sort(data.parent||data.node.parent,false);this.redraw_node(data.parent||data.node.parent,true)},this)).on("move_node.jstree copy_node.jstree",$.proxy(function(e,data){this.sort(data.parent,false);this.redraw_node(data.parent,true)},this))};this.sort=function(obj,deep){var i,j;obj=this.get_node(obj);if(obj&&obj.children&&obj.children.length){obj.children.sort($.proxy(this.settings.sort,this));if(deep){for(i=0,j=obj.children_d.length;i<j;i++){this.sort(obj.children_d[i],false)}}}}};var to=false;$.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:false,filter:false};$.jstree.plugins.state=function(options,parent){this.bind=function(){parent.bind.call(this);var bind=$.proxy(function(){this.element.on(this.settings.state.events,$.proxy(function(){if(to){clearTimeout(to)}to=setTimeout($.proxy(function(){this.save_state()},this),100)},this));this.trigger("state_ready")},this);this.element.on("ready.jstree",$.proxy(function(e,data){this.element.one("restore_state.jstree",bind);if(!this.restore_state()){bind()}},this))};this.save_state=function(){var st={state:this.get_state(),ttl:this.settings.state.ttl,sec:+new Date};$.vakata.storage.set(this.settings.state.key,JSON.stringify(st))};this.restore_state=function(){var k=$.vakata.storage.get(this.settings.state.key);if(!!k){try{k=JSON.parse(k)}catch(ex){return false}}if(!!k&&k.ttl&&k.sec&&+new Date-k.sec>k.ttl){return false}if(!!k&&k.state){k=k.state}if(!!k&&$.isFunction(this.settings.state.filter)){k=this.settings.state.filter.call(this,k)}if(!!k){this.element.one("set_state.jstree",function(e,data){data.instance.trigger("restore_state",{state:$.extend(true,{},k)})});this.set_state(k);return true}return false};this.clear_state=function(){return $.vakata.storage.del(this.settings.state.key)}};(function($,undefined){$.vakata.storage={set:function(key,val){return window.localStorage.setItem(key,val)},get:function(key){return window.localStorage.getItem(key)},del:function(key){return window.localStorage.removeItem(key)}}})($);$.jstree.defaults.types={"#":{},"default":{}};$.jstree.plugins.types=function(options,parent){this.init=function(el,options){var i,j;if(options&&options.types&&options.types["default"]){for(i in options.types){if(i!=="default"&&i!=="#"&&options.types.hasOwnProperty(i)){for(j in options.types["default"]){if(options.types["default"].hasOwnProperty(j)&&options.types[i][j]===undefined){options.types[i][j]=options.types["default"][j]}}}}}parent.init.call(this,el,options);this._model.data["#"].type="#"};this.refresh=function(skip_loading,forget_state){parent.refresh.call(this,skip_loading,forget_state);this._model.data["#"].type="#"};this.bind=function(){
this.element.on("model.jstree",$.proxy(function(e,data){var m=this._model.data,dpc=data.nodes,t=this.settings.types,i,j,c="default";for(i=0,j=dpc.length;i<j;i++){c="default";if(m[dpc[i]].original&&m[dpc[i]].original.type&&t[m[dpc[i]].original.type]){c=m[dpc[i]].original.type}if(m[dpc[i]].data&&m[dpc[i]].data.jstree&&m[dpc[i]].data.jstree.type&&t[m[dpc[i]].data.jstree.type]){c=m[dpc[i]].data.jstree.type}m[dpc[i]].type=c;if(m[dpc[i]].icon===true&&t[c].icon!==undefined){m[dpc[i]].icon=t[c].icon}}m["#"].type="#"},this));parent.bind.call(this)};this.get_json=function(obj,options,flat){var i,j,m=this._model.data,opt=options?$.extend(true,{},options,{no_id:false}):{},tmp=parent.get_json.call(this,obj,opt,flat);if(tmp===false){return false}if($.isArray(tmp)){for(i=0,j=tmp.length;i<j;i++){tmp[i].type=tmp[i].id&&m[tmp[i].id]&&m[tmp[i].id].type?m[tmp[i].id].type:"default";if(options&&options.no_id){delete tmp[i].id;if(tmp[i].li_attr&&tmp[i].li_attr.id){delete tmp[i].li_attr.id}if(tmp[i].a_attr&&tmp[i].a_attr.id){delete tmp[i].a_attr.id}}}}else{tmp.type=tmp.id&&m[tmp.id]&&m[tmp.id].type?m[tmp.id].type:"default";if(options&&options.no_id){tmp=this._delete_ids(tmp)}}return tmp};this._delete_ids=function(tmp){if($.isArray(tmp)){for(var i=0,j=tmp.length;i<j;i++){tmp[i]=this._delete_ids(tmp[i])}return tmp}delete tmp.id;if(tmp.li_attr&&tmp.li_attr.id){delete tmp.li_attr.id}if(tmp.a_attr&&tmp.a_attr.id){delete tmp.a_attr.id}if(tmp.children&&$.isArray(tmp.children)){tmp.children=this._delete_ids(tmp.children)}return tmp};this.check=function(chk,obj,par,pos,more){if(parent.check.call(this,chk,obj,par,pos,more)===false){return false}obj=obj&&obj.id?obj:this.get_node(obj);par=par&&par.id?par:this.get_node(par);var m=obj&&obj.id?more&&more.origin?more.origin:$.jstree.reference(obj.id):null,tmp,d,i,j;m=m&&m._model&&m._model.data?m._model.data:null;switch(chk){case"create_node":case"move_node":case"copy_node":if(chk!=="move_node"||$.inArray(obj.id,par.children)===-1){tmp=this.get_rules(par);if(tmp.max_children!==undefined&&tmp.max_children!==-1&&tmp.max_children===par.children.length){this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+chk,data:JSON.stringify({chk:chk,pos:pos,obj:obj&&obj.id?obj.id:false,par:par&&par.id?par.id:false})};return false}if(tmp.valid_children!==undefined&&tmp.valid_children!==-1&&$.inArray(obj.type||"default",tmp.valid_children)===-1){this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+chk,data:JSON.stringify({chk:chk,pos:pos,obj:obj&&obj.id?obj.id:false,par:par&&par.id?par.id:false})};return false}if(m&&obj.children_d&&obj.parents){d=0;for(i=0,j=obj.children_d.length;i<j;i++){d=Math.max(d,m[obj.children_d[i]].parents.length)}d=d-obj.parents.length+1}if(d<=0||d===undefined){d=1}do{if(tmp.max_depth!==undefined&&tmp.max_depth!==-1&&tmp.max_depth<d){this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+chk,data:JSON.stringify({chk:chk,pos:pos,obj:obj&&obj.id?obj.id:false,par:par&&par.id?par.id:false})};return false}par=this.get_node(par.parent);tmp=this.get_rules(par);d++}while(par)}break}return true};this.get_rules=function(obj){obj=this.get_node(obj);if(!obj){return false}var tmp=this.get_type(obj,true);if(tmp.max_depth===undefined){tmp.max_depth=-1}if(tmp.max_children===undefined){tmp.max_children=-1}if(tmp.valid_children===undefined){tmp.valid_children=-1}return tmp};this.get_type=function(obj,rules){obj=this.get_node(obj);return!obj?false:rules?$.extend({type:obj.type},this.settings.types[obj.type]):obj.type};this.set_type=function(obj,type){var t,t1,t2,old_type,old_icon;if($.isArray(obj)){obj=obj.slice();for(t1=0,t2=obj.length;t1<t2;t1++){this.set_type(obj[t1],type)}return true}t=this.settings.types;obj=this.get_node(obj);if(!t[type]||!obj){return false}old_type=obj.type;old_icon=this.get_icon(obj);obj.type=type;if(old_icon===true||t[old_type]&&t[old_type].icon!==undefined&&old_icon===t[old_type].icon){this.set_icon(obj,t[type].icon!==undefined?t[type].icon:true)}return true}};$.jstree.defaults.unique={case_sensitive:false,duplicate:function(name,counter){return name+" ("+counter+")"}};$.jstree.plugins.unique=function(options,parent){this.check=function(chk,obj,par,pos,more){if(parent.check.call(this,chk,obj,par,pos,more)===false){return false}obj=obj&&obj.id?obj:this.get_node(obj);par=par&&par.id?par:this.get_node(par);if(!par||!par.children){return true}var n=chk==="rename_node"?pos:obj.text,c=[],s=this.settings.unique.case_sensitive,m=this._model.data,i,j;for(i=0,j=par.children.length;i<j;i++){c.push(s?m[par.children[i]].text:m[par.children[i]].text.toLowerCase())}if(!s){n=n.toLowerCase()}switch(chk){case"delete_node":return true;case"rename_node":i=$.inArray(n,c)===-1||obj.text&&obj.text[s?"toString":"toLowerCase"]()===n;if(!i){this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+n+" already exists. Preventing: "+chk,data:JSON.stringify({chk:chk,pos:pos,obj:obj&&obj.id?obj.id:false,par:par&&par.id?par.id:false})}}return i;case"create_node":i=$.inArray(n,c)===-1;if(!i){this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+n+" already exists. Preventing: "+chk,data:JSON.stringify({chk:chk,pos:pos,obj:obj&&obj.id?obj.id:false,par:par&&par.id?par.id:false})}}return i;case"copy_node":i=$.inArray(n,c)===-1;if(!i){this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+n+" already exists. Preventing: "+chk,data:JSON.stringify({chk:chk,pos:pos,obj:obj&&obj.id?obj.id:false,par:par&&par.id?par.id:false})}}return i;case"move_node":i=obj.parent===par.id&&(!more||!more.is_multi)||$.inArray(n,c)===-1;if(!i){this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+n+" already exists. Preventing: "+chk,data:JSON.stringify({chk:chk,pos:pos,obj:obj&&obj.id?obj.id:false,par:par&&par.id?par.id:false})}}return i}return true};this.create_node=function(par,node,pos,callback,is_loaded){if(!node||node.text===undefined){if(par===null){par="#"}par=this.get_node(par);if(!par){return parent.create_node.call(this,par,node,pos,callback,is_loaded)}pos=pos===undefined?"last":pos;if(!pos.toString().match(/^(before|after)$/)&&!is_loaded&&!this.is_loaded(par)){return parent.create_node.call(this,par,node,pos,callback,is_loaded)}if(!node){node={}}var tmp,n,dpc,i,j,m=this._model.data,s=this.settings.unique.case_sensitive,cb=this.settings.unique.duplicate;n=tmp=this.get_string("New node");dpc=[];for(i=0,j=par.children.length;i<j;i++){dpc.push(s?m[par.children[i]].text:m[par.children[i]].text.toLowerCase())}i=1;while($.inArray(s?n:n.toLowerCase(),dpc)!==-1){n=cb.call(this,tmp,++i).toString()}node.text=n}return parent.create_node.call(this,par,node,pos,callback,is_loaded)}};var div=document.createElement("DIV");div.setAttribute("unselectable","on");div.setAttribute("role","presentation");div.className="jstree-wholerow";div.innerHTML="&#160;";$.jstree.plugins.wholerow=function(options,parent){this.bind=function(){parent.bind.call(this);this.element.on("ready.jstree set_state.jstree",$.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",$.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",$.proxy(function(e,data){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",$.proxy(function(e,data){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");var tmp=false,i,j;for(i=0,j=data.selected.length;i<j;i++){tmp=this.get_node(data.selected[i],true);if(tmp&&tmp.length){tmp.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")}}},this)).on("open_node.jstree",$.proxy(function(e,data){this.get_node(data.node,true).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",$.proxy(function(e,data){if(e.type==="hover_node"&&this.is_disabled(data.node)){return}this.get_node(data.node,true).children(".jstree-wholerow")[e.type==="hover_node"?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",$.proxy(function(e){e.preventDefault();var tmp=$.Event("contextmenu",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,pageX:e.pageX,pageY:e.pageY});$(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(tmp)},this)).on("click.jstree",".jstree-wholerow",function(e){e.stopImmediatePropagation();var tmp=$.Event("click",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey});$(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(tmp).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",$.proxy(function(e){e.stopImmediatePropagation();var tmp=$.Event("click",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey});$(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(tmp).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",$.proxy(function(e){e.stopImmediatePropagation();if(!this.is_disabled(e.currentTarget)){this.hover_node(e.currentTarget)}return false},this)).on("mouseleave.jstree",".jstree-node",$.proxy(function(e){this.dehover_node(e.currentTarget)},this))};this.teardown=function(){if(this.settings.wholerow){this.element.find(".jstree-wholerow").remove()}parent.teardown.call(this)};this.redraw_node=function(obj,deep,callback,force_render){obj=parent.redraw_node.apply(this,arguments);if(obj){var tmp=div.cloneNode(true);if($.inArray(obj.id,this._data.core.selected)!==-1){tmp.className+=" jstree-wholerow-clicked"}if(this._data.core.focused&&this._data.core.focused===obj.id){tmp.className+=" jstree-wholerow-hovered"}obj.insertBefore(tmp,obj.childNodes[0])}return obj}};if(document.registerElement&&Object&&Object.create){var proto=Object.create(HTMLElement.prototype);proto.createdCallback=function(){var c={core:{},plugins:[]},i;for(i in $.jstree.plugins){if($.jstree.plugins.hasOwnProperty(i)&&this.attributes[i]){c.plugins.push(i);if(this.getAttribute(i)&&JSON.parse(this.getAttribute(i))){c[i]=JSON.parse(this.getAttribute(i))}}}for(i in $.jstree.defaults.core){if($.jstree.defaults.core.hasOwnProperty(i)&&this.attributes[i]){c.core[i]=JSON.parse(this.getAttribute(i))||this.getAttribute(i)}}$(this).jstree(c)};try{document.registerElement("vakata-jstree",{prototype:proto})}catch(ignore){}}})},{jquery:50}],52:[function(require,module,exports){(function(){var root=this;var previousUnderscore=root._;var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype;var push=ArrayProto.push,slice=ArrayProto.slice,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,nativeCreate=Object.create;var Ctor=function(){};var _=function(obj){if(obj instanceof _)return obj;if(!(this instanceof _))return new _(obj);this._wrapped=obj};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=_}exports._=_}else{root._=_}_.VERSION="1.8.3";var optimizeCb=function(func,context,argCount){if(context===void 0)return func;switch(argCount==null?3:argCount){case 1:return function(value){return func.call(context,value)};case 2:return function(value,other){return func.call(context,value,other)};case 3:return function(value,index,collection){return func.call(context,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(context,accumulator,value,index,collection)}}return function(){return func.apply(context,arguments)}};var cb=function(value,context,argCount){if(value==null)return _.identity;if(_.isFunction(value))return optimizeCb(value,context,argCount);if(_.isObject(value))return _.matcher(value);return _.property(value)};_.iteratee=function(value,context){return cb(value,context,Infinity)};var createAssigner=function(keysFunc,undefinedOnly){return function(obj){var length=arguments.length;if(length<2||obj==null)return obj;for(var index=1;index<length;index++){var source=arguments[index],keys=keysFunc(source),l=keys.length;for(var i=0;i<l;i++){var key=keys[i];if(!undefinedOnly||obj[key]===void 0)obj[key]=source[key]}}return obj}};var baseCreate=function(prototype){if(!_.isObject(prototype))return{};if(nativeCreate)return nativeCreate(prototype);Ctor.prototype=prototype;var result=new Ctor;Ctor.prototype=null;return result};var property=function(key){return function(obj){return obj==null?void 0:obj[key]}};var MAX_ARRAY_INDEX=Math.pow(2,53)-1;var getLength=property("length");var isArrayLike=function(collection){var length=getLength(collection);return typeof length=="number"&&length>=0&&length<=MAX_ARRAY_INDEX};_.each=_.forEach=function(obj,iteratee,context){iteratee=optimizeCb(iteratee,context);var i,length;if(isArrayLike(obj)){for(i=0,length=obj.length;i<length;i++){iteratee(obj[i],i,obj)}}else{var keys=_.keys(obj);for(i=0,length=keys.length;i<length;i++){iteratee(obj[keys[i]],keys[i],obj)}}return obj};_.map=_.collect=function(obj,iteratee,context){iteratee=cb(iteratee,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,results=Array(length);for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;results[index]=iteratee(obj[currentKey],currentKey,obj)}return results};function createReduce(dir){function iterator(obj,iteratee,memo,keys,index,length){for(;index>=0&&index<length;index+=dir){var currentKey=keys?keys[index]:index;memo=iteratee(memo,obj[currentKey],currentKey,obj)}return memo}return function(obj,iteratee,memo,context){iteratee=optimizeCb(iteratee,context,4);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=dir>0?0:length-1;if(arguments.length<3){memo=obj[keys?keys[index]:index];index+=dir}return iterator(obj,iteratee,memo,keys,index,length)}}_.reduce=_.foldl=_.inject=createReduce(1);_.reduceRight=_.foldr=createReduce(-1);_.find=_.detect=function(obj,predicate,context){var key;if(isArrayLike(obj)){key=_.findIndex(obj,predicate,context)}else{key=_.findKey(obj,predicate,context)}if(key!==void 0&&key!==-1)return obj[key]};_.filter=_.select=function(obj,predicate,context){var results=[];predicate=cb(predicate,context);_.each(obj,function(value,index,list){if(predicate(value,index,list))results.push(value)});return results};_.reject=function(obj,predicate,context){return _.filter(obj,_.negate(cb(predicate)),context)};_.every=_.all=function(obj,predicate,context){predicate=cb(predicate,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length;for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(!predicate(obj[currentKey],currentKey,obj))return false}return true};_.some=_.any=function(obj,predicate,context){predicate=cb(predicate,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length;for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(predicate(obj[currentKey],currentKey,obj))return true}return false};_.contains=_.includes=_.include=function(obj,item,fromIndex,guard){if(!isArrayLike(obj))obj=_.values(obj);if(typeof fromIndex!="number"||guard)fromIndex=0;return _.indexOf(obj,item,fromIndex)>=0};_.invoke=function(obj,method){var args=slice.call(arguments,2);var isFunc=_.isFunction(method);return _.map(obj,function(value){var func=isFunc?method:value[method];return func==null?func:func.apply(value,args)})};_.pluck=function(obj,key){return _.map(obj,_.property(key))};_.where=function(obj,attrs){return _.filter(obj,_.matcher(attrs))};_.findWhere=function(obj,attrs){return _.find(obj,_.matcher(attrs))};_.max=function(obj,iteratee,context){var result=-Infinity,lastComputed=-Infinity,value,computed;if(iteratee==null&&obj!=null){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++){value=obj[i];if(value>result){result=value}}}else{iteratee=cb(iteratee,context);_.each(obj,function(value,index,list){computed=iteratee(value,index,list);if(computed>lastComputed||computed===-Infinity&&result===-Infinity){result=value;lastComputed=computed}})}return result};_.min=function(obj,iteratee,context){var result=Infinity,lastComputed=Infinity,value,computed;if(iteratee==null&&obj!=null){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++){value=obj[i];if(value<result){result=value}}}else{iteratee=cb(iteratee,context);_.each(obj,function(value,index,list){computed=iteratee(value,index,list);if(computed<lastComputed||computed===Infinity&&result===Infinity){result=value;lastComputed=computed}})}return result};_.shuffle=function(obj){var set=isArrayLike(obj)?obj:_.values(obj);var length=set.length;var shuffled=Array(length);for(var index=0,rand;index<length;index++){rand=_.random(0,index);if(rand!==index)shuffled[index]=shuffled[rand];shuffled[rand]=set[index]}return shuffled};_.sample=function(obj,n,guard){if(n==null||guard){if(!isArrayLike(obj))obj=_.values(obj);return obj[_.random(obj.length-1)]}return _.shuffle(obj).slice(0,Math.max(0,n))};_.sortBy=function(obj,iteratee,context){iteratee=cb(iteratee,context);return _.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iteratee(value,index,list)}}).sort(function(left,right){var a=left.criteria;var b=right.criteria;if(a!==b){if(a>b||a===void 0)return 1;if(a<b||b===void 0)return-1}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,iteratee,context){var result={};iteratee=cb(iteratee,context);_.each(obj,function(value,index){var key=iteratee(value,index,obj);behavior(result,value,key)});return result}};_.groupBy=group(function(result,value,key){if(_.has(result,key))result[key].push(value);else result[key]=[value]});_.indexBy=group(function(result,value,key){result[key]=value});_.countBy=group(function(result,value,key){if(_.has(result,key))result[key]++;else result[key]=1});_.toArray=function(obj){if(!obj)return[];if(_.isArray(obj))return slice.call(obj);if(isArrayLike(obj))return _.map(obj,_.identity);return _.values(obj)};_.size=function(obj){if(obj==null)return 0;return isArrayLike(obj)?obj.length:_.keys(obj).length};_.partition=function(obj,predicate,context){predicate=cb(predicate,context);var pass=[],fail=[];_.each(obj,function(value,key,obj){(predicate(value,key,obj)?pass:fail).push(value)});return[pass,fail]};_.first=_.head=_.take=function(array,n,guard){if(array==null)return void 0;if(n==null||guard)return array[0];return _.initial(array,array.length-n)};_.initial=function(array,n,guard){return slice.call(array,0,Math.max(0,array.length-(n==null||guard?1:n)))};_.last=function(array,n,guard){if(array==null)return void 0;if(n==null||guard)return array[array.length-1];return _.rest(array,Math.max(0,array.length-n))};_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,n==null||guard?1:n)};_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,strict,startIndex){var output=[],idx=0;for(var i=startIndex||0,length=getLength(input);i<length;i++){var value=input[i];if(isArrayLike(value)&&(_.isArray(value)||_.isArguments(value))){if(!shallow)value=flatten(value,shallow,strict);var j=0,len=value.length;output.length+=len;while(j<len){output[idx++]=value[j++]}}else if(!strict){output[idx++]=value}}return output};_.flatten=function(array,shallow){return flatten(array,shallow,false)};_.without=function(array){return _.difference(array,slice.call(arguments,1))};_.uniq=_.unique=function(array,isSorted,iteratee,context){if(!_.isBoolean(isSorted)){context=iteratee;iteratee=isSorted;isSorted=false}if(iteratee!=null)iteratee=cb(iteratee,context);var result=[];var seen=[];for(var i=0,length=getLength(array);i<length;i++){var value=array[i],computed=iteratee?iteratee(value,i,array):value;if(isSorted){if(!i||seen!==computed)result.push(value);seen=computed}else if(iteratee){if(!_.contains(seen,computed)){seen.push(computed);result.push(value)}}else if(!_.contains(result,value)){result.push(value)}}return result};_.union=function(){return _.uniq(flatten(arguments,true,true))};_.intersection=function(array){var result=[];var argsLength=arguments.length;for(var i=0,length=getLength(array);i<length;i++){var item=array[i];if(_.contains(result,item))continue;for(var j=1;j<argsLength;j++){if(!_.contains(arguments[j],item))break}if(j===argsLength)result.push(item)}return result};_.difference=function(array){var rest=flatten(arguments,true,true,1);return _.filter(array,function(value){return!_.contains(rest,value)})};_.zip=function(){return _.unzip(arguments)};_.unzip=function(array){var length=array&&_.max(array,getLength).length||0;var result=Array(length);for(var index=0;index<length;index++){result[index]=_.pluck(array,index)}return result};_.object=function(list,values){var result={};for(var i=0,length=getLength(list);i<length;i++){if(values){result[list[i]]=values[i]}else{result[list[i][0]]=list[i][1]}}return result};function createPredicateIndexFinder(dir){return function(array,predicate,context){predicate=cb(predicate,context);var length=getLength(array);var index=dir>0?0:length-1;for(;index>=0&&index<length;index+=dir){if(predicate(array[index],index,array))return index}return-1}}_.findIndex=createPredicateIndexFinder(1);_.findLastIndex=createPredicateIndexFinder(-1);_.sortedIndex=function(array,obj,iteratee,context){iteratee=cb(iteratee,context,1);var value=iteratee(obj);var low=0,high=getLength(array);while(low<high){var mid=Math.floor((low+high)/2);if(iteratee(array[mid])<value)low=mid+1;else high=mid}return low};function createIndexFinder(dir,predicateFind,sortedIndex){return function(array,item,idx){var i=0,length=getLength(array);if(typeof idx=="number"){if(dir>0){i=idx>=0?idx:Math.max(idx+length,i)}else{length=idx>=0?Math.min(idx+1,length):idx+length+1}}else if(sortedIndex&&idx&&length){idx=sortedIndex(array,item);return array[idx]===item?idx:-1}if(item!==item){idx=predicateFind(slice.call(array,i,length),_.isNaN);return idx>=0?idx+i:-1}for(idx=dir>0?i:length-1;idx>=0&&idx<length;idx+=dir){if(array[idx]===item)return idx}return-1}}_.indexOf=createIndexFinder(1,_.findIndex,_.sortedIndex);_.lastIndexOf=createIndexFinder(-1,_.findLastIndex);_.range=function(start,stop,step){if(stop==null){stop=start||0;start=0}step=step||1;var length=Math.max(Math.ceil((stop-start)/step),0);var range=Array(length);for(var idx=0;idx<length;idx++,start+=step){range[idx]=start}return range};var executeBound=function(sourceFunc,boundFunc,context,callingContext,args){if(!(callingContext instanceof boundFunc))return sourceFunc.apply(context,args);var self=baseCreate(sourceFunc.prototype);var result=sourceFunc.apply(self,args);if(_.isObject(result))return result;return self};_.bind=function(func,context){if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError("Bind must be called on a function");var args=slice.call(arguments,2);var bound=function(){return executeBound(func,bound,context,this,args.concat(slice.call(arguments)))};return bound};_.partial=function(func){var boundArgs=slice.call(arguments,1);var bound=function(){var position=0,length=boundArgs.length;var args=Array(length);for(var i=0;i<length;i++){args[i]=boundArgs[i]===_?arguments[position++]:boundArgs[i]}while(position<arguments.length)args.push(arguments[position++]);return executeBound(func,bound,this,this,args)};return bound};_.bindAll=function(obj){var i,length=arguments.length,key;if(length<=1)throw new Error("bindAll must be passed function names");for(i=1;i<length;i++){key=arguments[i];obj[key]=_.bind(obj[key],obj)}return obj};_.memoize=function(func,hasher){var memoize=function(key){var cache=memoize.cache;var address=""+(hasher?hasher.apply(this,arguments):key);if(!_.has(cache,address))cache[address]=func.apply(this,arguments);return cache[address]};memoize.cache={};return memoize};_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)};_.defer=_.partial(_.delay,_,1);_.throttle=function(func,wait,options){var context,args,result;var timeout=null;var previous=0;if(!options)options={};var later=function(){previous=options.leading===false?0:_.now();timeout=null;result=func.apply(context,args);if(!timeout)context=args=null};return function(){var now=_.now();if(!previous&&options.leading===false)previous=now;var remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0||remaining>wait){if(timeout){clearTimeout(timeout);timeout=null}previous=now;result=func.apply(context,args);if(!timeout)context=args=null}else if(!timeout&&options.trailing!==false){timeout=setTimeout(later,remaining)}return result}};_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result;var later=function(){var last=_.now()-timestamp;if(last<wait&&last>=0){timeout=setTimeout(later,wait-last)}else{timeout=null;if(!immediate){result=func.apply(context,args);if(!timeout)context=args=null}}};return function(){context=this;args=arguments;timestamp=_.now();var callNow=immediate&&!timeout;if(!timeout)timeout=setTimeout(later,wait);if(callNow){result=func.apply(context,args);context=args=null}return result}};_.wrap=function(func,wrapper){return _.partial(wrapper,func)};_.negate=function(predicate){return function(){return!predicate.apply(this,arguments)}};_.compose=function(){var args=arguments;var start=args.length-1;return function(){var i=start;var result=args[start].apply(this,arguments);while(i--)result=args[i].call(this,result);return result}};_.after=function(times,func){return function(){if(--times<1){return func.apply(this,arguments)}}};_.before=function(times,func){var memo;return function(){if(--times>0){memo=func.apply(this,arguments)}if(times<=1)func=null;return memo}};_.once=_.partial(_.before,2);var hasEnumBug=!{toString:null}.propertyIsEnumerable("toString");var nonEnumerableProps=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function collectNonEnumProps(obj,keys){var nonEnumIdx=nonEnumerableProps.length;var constructor=obj.constructor;var proto=_.isFunction(constructor)&&constructor.prototype||ObjProto;var prop="constructor";if(_.has(obj,prop)&&!_.contains(keys,prop))keys.push(prop);while(nonEnumIdx--){prop=nonEnumerableProps[nonEnumIdx];if(prop in obj&&obj[prop]!==proto[prop]&&!_.contains(keys,prop)){keys.push(prop)}}}_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)if(_.has(obj,key))keys.push(key);if(hasEnumBug)collectNonEnumProps(obj,keys);return keys};_.allKeys=function(obj){if(!_.isObject(obj))return[];var keys=[];for(var key in obj)keys.push(key);if(hasEnumBug)collectNonEnumProps(obj,keys);return keys};_.values=function(obj){var keys=_.keys(obj);var length=keys.length;var values=Array(length);for(var i=0;i<length;i++){values[i]=obj[keys[i]]}return values};_.mapObject=function(obj,iteratee,context){iteratee=cb(iteratee,context);var keys=_.keys(obj),length=keys.length,results={},currentKey;for(var index=0;index<length;index++){currentKey=keys[index];results[currentKey]=iteratee(obj[currentKey],currentKey,obj)}return results};_.pairs=function(obj){var keys=_.keys(obj);var length=keys.length;var pairs=Array(length);for(var i=0;i<length;i++){pairs[i]=[keys[i],obj[keys[i]]]}return pairs};_.invert=function(obj){var result={};var keys=_.keys(obj);for(var i=0,length=keys.length;i<length;i++){result[obj[keys[i]]]=keys[i]}return result};_.functions=_.methods=function(obj){var names=[];for(var key in obj){if(_.isFunction(obj[key]))names.push(key)}return names.sort()};_.extend=createAssigner(_.allKeys);_.extendOwn=_.assign=createAssigner(_.keys);_.findKey=function(obj,predicate,context){predicate=cb(predicate,context);var keys=_.keys(obj),key;for(var i=0,length=keys.length;i<length;i++){key=keys[i];if(predicate(obj[key],key,obj))return key}};_.pick=function(object,oiteratee,context){var result={},obj=object,iteratee,keys;if(obj==null)return result;if(_.isFunction(oiteratee)){keys=_.allKeys(obj);iteratee=optimizeCb(oiteratee,context)}else{keys=flatten(arguments,false,false,1);iteratee=function(value,key,obj){return key in obj};obj=Object(obj)}for(var i=0,length=keys.length;i<length;i++){var key=keys[i];var value=obj[key];if(iteratee(value,key,obj))result[key]=value}return result};_.omit=function(obj,iteratee,context){if(_.isFunction(iteratee)){iteratee=_.negate(iteratee)}else{var keys=_.map(flatten(arguments,false,false,1),String);iteratee=function(value,key){return!_.contains(keys,key)}}return _.pick(obj,iteratee,context)};_.defaults=createAssigner(_.allKeys,true);_.create=function(prototype,props){var result=baseCreate(prototype);if(props)_.extendOwn(result,props);return result};_.clone=function(obj){if(!_.isObject(obj))return obj;return _.isArray(obj)?obj.slice():_.extend({},obj)};_.tap=function(obj,interceptor){interceptor(obj);return obj};_.isMatch=function(object,attrs){var keys=_.keys(attrs),length=keys.length;if(object==null)return!length;var obj=Object(object);for(var i=0;i<length;i++){var key=keys[i];if(attrs[key]!==obj[key]||!(key in obj))return false}return true};var eq=function(a,b,aStack,bStack){if(a===b)return a!==0||1/a===1/b;if(a==null||b==null)return a===b;if(a instanceof _)a=a._wrapped;if(b instanceof _)b=b._wrapped;var className=toString.call(a);if(className!==toString.call(b))return false;switch(className){case"[object RegExp]":case"[object String]":return""+a===""+b;case"[object Number]":if(+a!==+a)return+b!==+b;return+a===0?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}var areArrays=className==="[object Array]";if(!areArrays){if(typeof a!="object"||typeof b!="object")return false;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)&&("constructor"in a&&"constructor"in b)){return false}}aStack=aStack||[];bStack=bStack||[];var length=aStack.length;while(length--){if(aStack[length]===a)return bStack[length]===b}aStack.push(a);bStack.push(b);if(areArrays){length=a.length;if(length!==b.length)return false;while(length--){if(!eq(a[length],b[length],aStack,bStack))return false}}else{var keys=_.keys(a),key;length=keys.length;if(_.keys(b).length!==length)return false;while(length--){key=keys[length];if(!(_.has(b,key)&&eq(a[key],b[key],aStack,bStack)))return false}}aStack.pop();bStack.pop();return true};_.isEqual=function(a,b){return eq(a,b)};_.isEmpty=function(obj){if(obj==null)return true;if(isArrayLike(obj)&&(_.isArray(obj)||_.isString(obj)||_.isArguments(obj)))return obj.length===0;return _.keys(obj).length===0};_.isElement=function(obj){return!!(obj&&obj.nodeType===1)};_.isArray=nativeIsArray||function(obj){return toString.call(obj)==="[object Array]"};_.isObject=function(obj){var type=typeof obj;return type==="function"||type==="object"&&!!obj};_.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(name){_["is"+name]=function(obj){return toString.call(obj)==="[object "+name+"]"}});if(!_.isArguments(arguments)){_.isArguments=function(obj){return _.has(obj,"callee")}}if(typeof/./!="function"&&typeof Int8Array!="object"){_.isFunction=function(obj){return typeof obj=="function"||false}}_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))};_.isNaN=function(obj){return _.isNumber(obj)&&obj!==+obj};_.isBoolean=function(obj){return obj===true||obj===false||toString.call(obj)==="[object Boolean]"};_.isNull=function(obj){return obj===null};_.isUndefined=function(obj){return obj===void 0};_.has=function(obj,key){return obj!=null&&hasOwnProperty.call(obj,key)};_.noConflict=function(){
root._=previousUnderscore;return this};_.identity=function(value){return value};_.constant=function(value){return function(){return value}};_.noop=function(){};_.property=property;_.propertyOf=function(obj){return obj==null?function(){}:function(key){return obj[key]}};_.matcher=_.matches=function(attrs){attrs=_.extendOwn({},attrs);return function(obj){return _.isMatch(obj,attrs)}};_.times=function(n,iteratee,context){var accum=Array(Math.max(0,n));iteratee=optimizeCb(iteratee,context,1);for(var i=0;i<n;i++)accum[i]=iteratee(i);return accum};_.random=function(min,max){if(max==null){max=min;min=0}return min+Math.floor(Math.random()*(max-min+1))};_.now=Date.now||function(){return(new Date).getTime()};var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var unescapeMap=_.invert(escapeMap);var createEscaper=function(map){var escaper=function(match){return map[match]};var source="(?:"+_.keys(map).join("|")+")";var testRegexp=RegExp(source);var replaceRegexp=RegExp(source,"g");return function(string){string=string==null?"":""+string;return testRegexp.test(string)?string.replace(replaceRegexp,escaper):string}};_.escape=createEscaper(escapeMap);_.unescape=createEscaper(unescapeMap);_.result=function(object,property,fallback){var value=object==null?void 0:object[property];if(value===void 0){value=fallback}return _.isFunction(value)?value.call(object):value};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id};_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/;var escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"};var escaper=/\\|'|\r|\n|\u2028|\u2029/g;var escapeChar=function(match){return"\\"+escapes[match]};_.template=function(text,settings,oldSettings){if(!settings&&oldSettings)settings=oldSettings;settings=_.defaults({},settings,_.templateSettings);var matcher=RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g");var index=0;var source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){source+=text.slice(index,offset).replace(escaper,escapeChar);index=offset+match.length;if(escape){source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'"}else if(interpolate){source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'"}else if(evaluate){source+="';\n"+evaluate+"\n__p+='"}return match});source+="';\n";if(!settings.variable)source="with(obj||{}){\n"+source+"}\n";source="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{var render=new Function(settings.variable||"obj","_",source)}catch(e){e.source=source;throw e}var template=function(data){return render.call(this,data,_)};var argument=settings.variable||"obj";template.source="function("+argument+"){\n"+source+"}";return template};_.chain=function(obj){var instance=_(obj);instance._chain=true;return instance};var result=function(instance,obj){return instance._chain?_(obj).chain():obj};_.mixin=function(obj){_.each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];push.apply(args,arguments);return result(this,func.apply(_,args))}})};_.mixin(_);_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;method.apply(obj,arguments);if((name==="shift"||name==="splice")&&obj.length===0)delete obj[0];return result(this,obj)}});_.each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result(this,method.apply(this._wrapped,arguments))}});_.prototype.value=function(){return this._wrapped};_.prototype.valueOf=_.prototype.toJSON=_.prototype.value;_.prototype.toString=function(){return""+this._wrapped};if(typeof define==="function"&&define.amd){define("underscore",[],function(){return _})}}).call(this)},{}],53:[function(require,module,exports){var HandlebarsCompiler=require("hbsfy/runtime");module.exports=HandlebarsCompiler.template({compiler:[6,">= 2.0.0-beta.1"],main:function(depth0,helpers,partials,data){return'<div class="panel-heading">\n<h3 class="panel-title">\nInfo Panel\n</h3>\n</div>\n<div class="panel-body" id="infor_panel">\n	<ul class="list-group"> \n		<li class="list-group-item"><dl class="dl-horizontal">\n		<dt>Description:</dt>\n		<dd>2011469901.19m230000m22512438675%</dd>\n		<dt>GPS location:</dt>\n		<dd></dd>\n		<dt>Address:</dt>\n		<dd></dd>\n	</dl></li>\n	</ul>\n	\n</div>'},useData:true})},{"hbsfy/runtime":49}],54:[function(require,module,exports){var HandlebarsCompiler=require("hbsfy/runtime");module.exports=HandlebarsCompiler.template({compiler:[6,">= 2.0.0-beta.1"],main:function(depth0,helpers,partials,data){return'<span class="fa fa-globe" style="margin-left: 6px;"></span> <strong>WCSU</strong>\r\n<div id="graph-tree"></div>'},useData:true})},{"hbsfy/runtime":49}],55:[function(require,module,exports){var HandlebarsCompiler=require("hbsfy/runtime");module.exports=HandlebarsCompiler.template({compiler:[6,">= 2.0.0-beta.1"],main:function(depth0,helpers,partials,data){var helper;return"<strong>"+this.escapeExpression((helper=(helper=helpers.title||(depth0!=null?depth0.title:depth0))!=null?helper:helpers.helperMissing,typeof helper==="function"?helper.call(depth0,{name:"title",hash:{},data:data}):helper))+'</strong>\r\n<div role="tabpanel" class="" style="background: #f0f0f0;">\r\n<ul class="nav nav-tabs nav-justified" role="tablist">\r\n<li role="presentation" class="active"><a href="#summary" aria-controls="summary" role="tab" data-toggle="tab">Summary</a></li>\r\n<li role="presentation"><a href="#notes" aria-controls="notes" role="tab" data-toggle="tab">Notes</a></li>\r\n</ul>\r\n<div class="tab-content full-height">\r\n<div role="tabpanel" class="full-height tab-pane active" id="summary" style="background: #eee;">\r\n	<div class="panel panel-primary">\r\n  <div class="panel-heading">\r\n    <h1 class="panel-title">Statistics</h1>\r\n  </div>\r\n  <div class="panel-body table-responsive">\r\n     <table class="table table-bordered table-condensed f11">\r\n     	<tr>\r\n            <td width="35%"><b>Moving Average Power Consumption</b></td>\r\n            <td width="65%">xkW</td>\r\n        </tr>\r\n        <tr>\r\n            <td width="35%"><b>Maximun</b></td>\r\n            <td width="65%">xkW</td>\r\n        </tr>\r\n        <tr>\r\n            <td width="35%"><b>Mininum</b></td>\r\n            <td width="65%">xkW</td>\r\n        </tr>\r\n        <tr>\r\n            <td width="35%"><b>Load factor</b></td>\r\n            <td width="65%">0.1</td>\r\n        </tr>\r\n        <tr>\r\n            <td width="35%"><b>Root Mean Squared Deviation </b></td>\r\n            <td width="65%">x</td>\r\n        </tr>\r\n     </table>\r\n  </div>\r\n  <div class="list-group">\r\n  	<div class="list-group-item">\r\n  		<h4 class="list-group-heading">Baseline Deviation</h4>\r\n  		<p class="list-group-item-text">\r\n(Deviation from Baseline is calculated by taking the actual kW usage, subtracting the baseline, and finally dividing this result by the baseline. It is effectively a calculation of error; thus a negative percentage means that the building is using less power than usual, while a positive percentage implies exactly the opposite.) </p>\r\n  	</div>\r\n  	<div class="list-group-item">\r\n  		<h4 class="list-group-heading">% of Total Campus (kW)</h4>\r\n  		<p class="list-group-item-text">\r\n% of Total Campus (kW) is calculated by taking a building\'s current power usage and dividing it by the sum of the power usage of all campus buildings for which data is available. It is designed to be compared to the gauge to the right, % of Total Campus (SqFt) </p>\r\n  	</div>\r\n  	<div class="list-group-item">\r\n  		<h4 class="list-group-heading"> of Total Campus (SqFt)</h4>\r\n  		<p class="list-group-item-text">\r\n% of Total Campus (SqFt) is calculated by taking a building\'s square footage and dividing it by the sum of the square footage of all campus buildings for which data is available. It is designed to be compared to the gauge to the left, % of Total Campus (kW).</p>\r\n  	</div>\r\n  </div>\r\n</div>\r\n</div>\r\n<div role="tabpanel" class="full-height tab-pane" id="notes" style="background: #eee;">\r\n  <div class="list-group">\r\n    <div class="list-group-item">\r\n      <h4 class="list-group-heading"></h4>\r\n      <p class="list-group-item-text"> * Shift Click building and meter to display energy charts\r\n</p>\r\n    </div>\r\n    <div class="list-group-item">\r\n      <h4 class="list-group-heading"></h4>\r\n      <p class="list-group-item-text">* Maximum 4 meters can be selected at the same time\r\n</p>\r\n    </div>\r\n  </div>\r\n</div>\r\n</div>\r\n</div>'},useData:true})},{"hbsfy/runtime":49}],56:[function(require,module,exports){var HandlebarsCompiler=require("hbsfy/runtime");module.exports=HandlebarsCompiler.template({compiler:[6,">= 2.0.0-beta.1"],main:function(depth0,helpers,partials,data){return'<div id="display-chart" style="height: 500px; min-width: 600px">\r\n<div class="panel panel-default panel-body full-height">\r\n<div class="text-center vertical-middle">\r\nClick a building name to see the graph here\r\n</div>\r\n</div>\r\n</div>\r\n \r\n<br/>\r\n<br/>\r\n<div class="panel panel-default">\r\n<div class="panel-heading">\r\n<h3 class="panel-title">\r\nInfo Panel\r\n</h3>\r\n</div>\r\n<div class="panel-body" id="infor_panel">\r\n	<ul class="list-group"> \r\n		<li class="list-group-item">\r\n			<h4 class="list-group-item-heading">Building</h4>\r\n		<dl class="dl-horizontal">\r\n		<dt>Description:</dt>\r\n		<dd>2011469901.19m230000m22512438675%</dd>\r\n		<dt>GPS location:</dt>\r\n		<dd></dd>\r\n		<dt>Address:</dt>\r\n		<dd></dd>\r\n	</dl></li>\r\n	<li class="list-group-item">\r\n			<h4 class="list-group-item-heading">Building</h4>\r\n		<dl class="dl-horizontal">\r\n		<dt>Description:</dt>\r\n		<dd>2011469901.19m230000m22512438675%</dd>\r\n		<dt>GPS location:</dt>\r\n		<dd></dd>\r\n		<dt>Address:</dt>\r\n		<dd></dd>\r\n	</dl></li>\r\n	</ul>\r\n	\r\n</div>\r\n</div>'},useData:true})},{"hbsfy/runtime":49}],57:[function(require,module,exports){var Promise=require("bluebird");var $=require("./jquery");var _=require("underscore");var saveAs=require("./FileSaver");module.exports={getRequestErrorMessage:function(request){var message,msgDetail;if(!request){return null}message=request.statusText;if(request.status!==200){try{message=request.responseJSON.error||request.responseText||"Unknown Error"}catch(e){msgDetail=request.status?request.status+" - "+request.statusText:"Server was not available";message="The server returned an error ("+msgDetail+")."}}return message},handleRequestError:function(response){console.log(response);Wholeren.notifications.clearEverything();var errors=response.responseJSON||{};var errortext=response.responseText||"";var redirect=response.redirect;var delay=response.delay||5;if(errors.invalidAttributes){for(var key in errors.invalidAttributes){if(errors.invalidAttributes.hasOwnProperty(key)){var a=errors.invalidAttributes[key];a.forEach(function(item){Wholeren.notifications.addItem({type:"error",message:JSON.stringify(item),status:"passive"})})}}}else{Wholeren.notifications.addItem({type:"error",message:errortext,status:"passive"})}if(redirect){Wholeren.notifications.addItem({type:"error",message:"redirecting",status:"passive"});setTimeout(function(){window.location.href=redirect},delay*1e3)}},handleRequestSuccess:function(response){Wholeren.notifications.clearEverything();var text=response.responseText||"";var redirect=response.redirect;var delay=response.delay||5;Wholeren.notifications.addItem({type:"success",message:text,status:"passive"});if(redirect){setTimeout(function(){window.location.href=redirect},delay*1e3)}},showError:function(text){Wholeren.notifications.clearEverything();Wholeren.notifications.addItem({type:"error",message:text,status:"passive"})},ajaxGET:function(url,data){var defer=Promise.defer();$.ajax({url:url,data:data,type:"GET",headers:{"X-CSRF-Token":$("meta[name='csrf-param']").attr("content")},success:function(data){defer.resolve(data)},error:function(xhr){defer.reject(xhr)}});return defer.promise},ajaxSyncGET:function(url){var defer=Promise.defer();$.ajax({async:false,url:url,type:"GET",headers:{"X-CSRF-Token":$("meta[name='csrf-param']").attr("content")},success:function(data){defer.resolve(data)},error:function(xhr){defer.reject(xhr)}});return defer.promise},saveCSV:function(collection,colnames){var downloadName="CSV data "+(new Date).toString("yyyy-MM-dd hhmmss");var keys=_.chain(collection.first().attributes).keys().sort().value();var csvContent="";if(!colnames){csvContent+=keys.join(",")+"\n";csvContent+=collection.map(function(item){var cols=[];_.each(keys,function(key){var i=item.get(key);var topush="";if(key)if(typeof i=="string"){}else if(i!=null&&i!=undefined){topush=i.toString()}if(topush.indexOf(/,\n/g)>-1){topush='"'+topush+'"'}cols.push(topush)});return cols.join(",")}).join("\n")}else{csvContent+=_.map(colnames,function(e){return e.label}).join(",")+"\n";csvContent+=collection.map(function(item){var cols=_.map(colnames,function(e){var key=e.name;var i=item.get(key);if(e.cell._touse){var selValue=_.find(e.cell._touse,function(f){return f[1]==i});if((selValue||[]).length>0){i=selValue[0]}}i=i||"";if(typeof i!=="string"){i=i.toString()}if(i.search(/[,\n]/g)>-1){i='"'+i+'"'}return i}).join(",");return cols}).join("\n")}var blob=new Blob([csvContent],{type:"text/plain;charset=utf-8"});saveAs.saveAs(blob,"text.csv")}}},{"./FileSaver":4,"./jquery":12,bluebird:15,underscore:52}],58:[function(require,module,exports){"use strict";var _=require("underscore");var $=require("../jquery");var Backbone=require("../backbone");var JST=require("../JST");module.exports=Backbone.View.extend({templateName:"widget",template:function(data){return JST[this.templateName](data)},initialize:function(options){Backbone.View.prototype.initialize.apply(this,arguments);this.el=options.el},templateData:function(){if(this.model){return this.model.toJSON()}if(this.collection){return this.collection.toJSON()}return{}},render:function(options){if(_.isFunction(this.beforeRender)){this.beforeRender()}if(options){this.$el.html(this.template(options))}else{this.$el.html(this.template(this.templateData()))}if(_.isFunction(this.afterRender)){this.afterRender()}return this},addSubview:function(view){if(!(view instanceof Backbone.View)){throw new Error("Subview must be a Backbone.View")}this.subviews=this.subviews||[];this.subviews.push(view);return view},removeSubviews:function(){var children=this.subviews;if(!children){return this}_(children).invoke("remove");this.subviews=[];return this},remove:function(){if(this.subviews){this.removeSubviews()}return Backbone.View.prototype.remove.apply(this,arguments)}})},{"../JST":5,"../backbone":10,"../jquery":12,underscore:52}],59:[function(require,module,exports){"use strict";var $=require("../jquery");var Backbone=require("../backbone");var Models=require("../models");var JST=require("../JST");var utility=require("../util");var CryptoJS=window.CryptoJS=require("browserify-cryptojs");require("browserify-cryptojs/components/md5");var Highcharts=require("../highstock/highstock.src.js");var _=require("underscore");var base=require("./base");function iconSrc(options){var dir="/static/img/";switch(options.type||""){case"Campus":return options.selected==true?dir+"campus-on.png":dir+"campus-off.png";break;case"Building":return options.selected==true?dir+"building-on.png":dir+"building-off.png";break;case"Meter":return options.selected==true?dir+"meter-on.png":dir+"meter-off.png";break;default:return""}}var leftSideBar=base.extend({templateName:"charts_left",initialize:function(options){base.prototype.initialize.apply(this,arguments);this.centerView=options.centerView;_.bindAll(this,"showSerieInfo","unShowSeries","deSelect");this.seriesNum=0},events:{checkChange:"modifyTimeSeries"},afterRender:function(){var backendUrl="/charts/backend/buildings/";var self=this;utility.ajaxGET(backendUrl).then(function(data){var treeNodes=_.map(data,function(e){return{id:e.id,parent:e.parent||"#",text:e.name,icon:iconSrc({type:e.type,selected:false}),data:e}});$("#graph-tree").on("changed.jstree",self.showSerieInfo);$("#graph-tree").on("deselect_all.jstree",self.unShowSeries);$("#graph-tree").jstree({core:{themes:{name:"proton",responsive:true},data:treeNodes},li:{select_limit:3}})})},showSerieInfo:function(e,data){var self=this;var node=data.node;var serieName=node.data.influxKey;var event=data.event;if(data.action=="select_node"){this.seriesNum++;if(this.seriesNum>4){data.instance.deselect_node(node);return}data.instance.set_icon(node.id,"/static/img/loading.gif");var colorcode="#"+CryptoJS.MD5(serieName).toString().substring(2,8);this.centerView.addSerie({item:{value:serieName},color:colorcode}).then(function(){data.instance.set_icon(node.id,iconSrc({type:node.data.type,selected:true}));self.$("#"+node.id+"_anchor").css("background",colorcode)}).catch(function(err){data.instance.set_icon(node.id,iconSrc({type:node.data.type,selected:false}))})}else if(data.action=="deselect_node"){this.deSelect(node,data.instance)}},unShowSeries:function(e,data){var self=this;data.node.forEach(function(id){self.deSelect(data.instance.get_node(id),data.instance)})},deSelect:function(node,instance){this.centerView.removeSerie({item:{value:node.data.influxKey}});instance.set_icon(node.id,iconSrc({type:node.data.type,selected:false}));this.$("#"+node.id+"_anchor").css("background","");this.seriesNum--}});var centerContent=base.extend({templateName:"charts_center",cache:{},initialize:function(options){base.prototype.initialize.apply(this,arguments);this.infoView=new infoView({el:"#bottom_panel"})},afterRender:function(){this.charts=new Highcharts.StockChart({chart:{renderTo:"display-chart",type:"areaspline"},global:{useUTC:false},title:{text:"Energe Market Chart"},legend:{enabled:true},navigator:{adaptToUpdatedData:false},rangeSelector:{buttons:[{type:"day",count:1,text:"1d"},{type:"week",count:1,text:"1w"},{type:"week",count:6,text:"6w"},{type:"month",count:1,text:"1M"},{type:"month",count:3,text:"3M"},{type:"month",count:6,text:"6M"},{type:"year",count:1,text:"1year"},{type:"all",text:"All",count:0}],selected:1,inputEnabled:true,inputDateFormat:"%Y-%m-%d"},xAxis:{type:"datetime"},yAxis:{title:{text:"Energe Market"}},tooltip:{shared:false,valueSuffix:""},credits:{enabled:false},plotOptions:{areaspline:{fillOpacity:0},series:{marker:{enabled:false}}},series:[]})},addSerie:function(options){var backendUrl="/backend/";var self=this;var item=options.item;var json_array=[];if((item.value||"").length>0){var existserie=_.find(this.charts.series,{name:item.value.split(".")[3]});if(existserie){return Promise.resolve({})}if(this.cache[item.value]){this.charts.addSeries(this.cache[item.value]);return Promise.resolve({})}return utility.ajaxGET("/api/series/",{serieName:item.value}).then(function(data){data=data[0]||{};var points=data.points||[];points=points.reverse();var serie={name:data.name.split(".")[3],color:options.color||"#123467",data:points};self.charts.addSeries(serie);self.cache[item.value]=serie;return Promise.resolve({"new":true})})}else{return Promise.resolve({"new":false})}},removeSerie:function(options){var item=options.item;var series=this.charts.series||[];var target=item.value;if(target){var toRemove=_.find(series,{name:target.split(".")[3]});if(toRemove)toRemove.remove()}return this}});var infoView=base.extend({templateName:"info_panel"});var rightSideBar=base.extend({templateName:"charts_right"});module.exports=base.extend({initialize:function(options){this.el=options.el;this.centerView=new centerContent({el:".col-md-8.full-height"});this.leftView=new leftSideBar({el:".col-md-2.leftbar",centerView:this.centerView});this.rightView=new rightSideBar({el:".col-md-2.rightbar"});this.render()},render:function(){this.leftView.render();this.centerView.render();this.rightView.render();return this}})},{"../JST":5,"../backbone":10,"../highstock/highstock.src.js":11,"../jquery":12,"../models":13,"../util":57,"./base":58,"browserify-cryptojs":17,"browserify-cryptojs/components/md5":16,underscore:52}],60:[function(require,module,exports){"use strict";module.exports={Charts:require("./charts")}},{"./charts":59}]},{},[7]);
